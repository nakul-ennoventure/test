!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Vyu=t()}(this,(function(){"use strict";function ___$insertStyle(e){if(!e||"undefined"==typeof window)return;const t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=e,document.head.appendChild(t),e}function _AsyncGenerator(e){var t,r;function n(t,r){try{var o=e[t](r),s=o.value,a=s instanceof _OverloadYield;Promise.resolve(a?s.v:s).then((function(r){if(a){var c="return"===t?"return":"next";if(!s.k||r.done)return n(c,r);r=e[c](r).value}i(o.done?"return":"normal",r)}),(function(e){n("throw",e)}))}catch(e){i("throw",e)}}function i(e,i){switch(e){case"return":t.resolve({value:i,done:!0});break;case"throw":t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?n(t.key,t.arg):r=null}this._invoke=function(e,i){return new Promise((function(o,s){var a={key:e,arg:i,resolve:o,reject:s,next:null};r?r=r.next=a:(t=r=a,n(e,i))}))},"function"!=typeof e.return&&(this.return=void 0)}function _OverloadYield(e,t){this.v=e,this.k=t}function old_createMetadataMethodsForProperty(e,t,r,n){return{getMetadata:function(i){old_assertNotFinished(n,"getMetadata"),old_assertMetadataKey(i);var o=e[i];if(void 0!==o)if(1===t){var s=o.public;if(void 0!==s)return s[r]}else if(2===t){var a=o.private;if(void 0!==a)return a.get(r)}else if(Object.hasOwnProperty.call(o,"constructor"))return o.constructor},setMetadata:function(i,o){old_assertNotFinished(n,"setMetadata"),old_assertMetadataKey(i);var s=e[i];if(void 0===s&&(s=e[i]={}),1===t){var a=s.public;void 0===a&&(a=s.public={}),a[r]=o}else if(2===t){var c=s.priv;void 0===c&&(c=s.private=new Map),c.set(r,o)}else s.constructor=o}}}function old_convertMetadataMapToFinal(e,t){var r=e[Symbol.metadata||Symbol.for("Symbol.metadata")],n=Object.getOwnPropertySymbols(t);if(0!==n.length){for(var i=0;i<n.length;i++){var o=n[i],s=t[o],a=r?r[o]:null,c=s.public,l=a?a.public:null;c&&l&&Object.setPrototypeOf(c,l);var u=s.private;if(u){var d=Array.from(u.values()),h=a?a.private:null;h&&(d=d.concat(h)),s.private=d}a&&Object.setPrototypeOf(s,a)}r&&Object.setPrototypeOf(t,r),e[Symbol.metadata||Symbol.for("Symbol.metadata")]=t}}function old_createAddInitializerMethod(e,t){return function(r){old_assertNotFinished(t,"addInitializer"),old_assertCallable(r,"An initializer"),e.push(r)}}function old_memberDec(e,t,r,n,i,o,s,a,c){var l;switch(o){case 1:l="accessor";break;case 2:l="method";break;case 3:l="getter";break;case 4:l="setter";break;default:l="field"}var u,d,h={kind:l,name:a?"#"+t:_toPropertyKey(t),isStatic:s,isPrivate:a},f={v:!1};if(0!==o&&(h.addInitializer=old_createAddInitializerMethod(i,f)),a){u=2,d=Symbol(t);var p={};0===o?(p.get=r.get,p.set=r.set):2===o?p.get=function(){return r.value}:(1!==o&&3!==o||(p.get=function(){return r.get.call(this)}),1!==o&&4!==o||(p.set=function(e){r.set.call(this,e)})),h.access=p}else u=1,d=t;try{return e(c,Object.assign(h,old_createMetadataMethodsForProperty(n,u,d,f)))}finally{f.v=!0}}function old_assertNotFinished(e,t){if(e.v)throw new Error("attempted to call "+t+" after decoration was finished")}function old_assertMetadataKey(e){if("symbol"!=typeof e)throw new TypeError("Metadata keys must be symbols, received: "+e)}function old_assertCallable(e,t){if("function"!=typeof e)throw new TypeError(t+" must be a function")}function old_assertValidReturnValue(e,t){var r=typeof t;if(1===e){if("object"!==r||null===t)throw new TypeError("accessor decorators must return an object with get, set, or init properties or void 0");void 0!==t.get&&old_assertCallable(t.get,"accessor.get"),void 0!==t.set&&old_assertCallable(t.set,"accessor.set"),void 0!==t.init&&old_assertCallable(t.init,"accessor.init"),void 0!==t.initializer&&old_assertCallable(t.initializer,"accessor.initializer")}else if("function"!==r)throw new TypeError((0===e?"field":10===e?"class":"method")+" decorators must return a function or void 0")}function old_getInit(e){var t;return null==(t=e.init)&&(t=e.initializer)&&"undefined"!=typeof console&&console.warn(".initializer has been renamed to .init as of March 2022"),t}function old_applyMemberDec(e,t,r,n,i,o,s,a,c){var l,u,d,h,f,p,m,v=r[0];if(s?(0===i||1===i?(l={get:r[3],set:r[4]},d="get"):3===i?(l={get:r[3]},d="get"):4===i?(l={set:r[3]},d="set"):l={value:r[3]},0!==i&&(1===i&&_setFunctionName(r[4],"#"+n,"set"),_setFunctionName(r[3],"#"+n,d))):0!==i&&(l=Object.getOwnPropertyDescriptor(t,n)),1===i?h={get:l.get,set:l.set}:2===i?h=l.value:3===i?h=l.get:4===i&&(h=l.set),"function"==typeof v)void 0!==(f=old_memberDec(v,n,l,a,c,i,o,s,h))&&(old_assertValidReturnValue(i,f),0===i?u=f:1===i?(u=old_getInit(f),p=f.get||h.get,m=f.set||h.set,h={get:p,set:m}):h=f);else for(var g=v.length-1;g>=0;g--){var _;void 0!==(f=old_memberDec(v[g],n,l,a,c,i,o,s,h))&&(old_assertValidReturnValue(i,f),0===i?_=f:1===i?(_=old_getInit(f),p=f.get||h.get,m=f.set||h.set,h={get:p,set:m}):h=f,void 0!==_&&(void 0===u?u=_:"function"==typeof u?u=[u,_]:u.push(_)))}if(0===i||1===i){if(void 0===u)u=function(e,t){return t};else if("function"!=typeof u){var y=u;u=function(e,t){for(var r=t,n=0;n<y.length;n++)r=y[n].call(e,r);return r}}else{var b=u;u=function(e,t){return b.call(e,t)}}e.push(u)}0!==i&&(1===i?(l.get=h.get,l.set=h.set):2===i?l.value=h:3===i?l.get=h:4===i&&(l.set=h),s?1===i?(e.push((function(e,t){return h.get.call(e,t)})),e.push((function(e,t){return h.set.call(e,t)}))):2===i?e.push(h):e.push((function(e,t){return h.call(e,t)})):Object.defineProperty(t,n,l))}function old_applyMemberDecs(e,t,r,n,i){for(var o,s,a=new Map,c=new Map,l=0;l<i.length;l++){var u=i[l];if(Array.isArray(u)){var d,h,f,p=u[1],m=u[2],v=u.length>3,g=p>=5;if(g?(d=t,h=n,0!=(p-=5)&&(f=s=s||[])):(d=t.prototype,h=r,0!==p&&(f=o=o||[])),0!==p&&!v){var _=g?c:a,y=_.get(m)||0;if(!0===y||3===y&&4!==p||4===y&&3!==p)throw new Error("Attempted to decorate a public method/accessor that has the same name as a previously decorated public method/accessor. This is not currently supported by the decorators plugin. Property name was: "+m);!y&&p>2?_.set(m,p):_.set(m,!0)}old_applyMemberDec(e,d,u,m,p,g,v,h,f)}}old_pushInitializers(e,o),old_pushInitializers(e,s)}function old_pushInitializers(e,t){t&&e.push((function(e){for(var r=0;r<t.length;r++)t[r].call(e);return e}))}function old_applyClassDecs(e,t,r,n){if(n.length>0){for(var i=[],o=t,s=t.name,a=n.length-1;a>=0;a--){var c={v:!1};try{var l=Object.assign({kind:"class",name:s,addInitializer:old_createAddInitializerMethod(i,c)},old_createMetadataMethodsForProperty(r,0,s,c)),u=n[a](o,l)}finally{c.v=!0}void 0!==u&&(old_assertValidReturnValue(10,u),o=u)}e.push(o,(function(){for(var e=0;e<i.length;e++)i[e].call(o)}))}}function _applyDecs(e,t,r){var n=[],i={},o={};return old_applyMemberDecs(n,e,o,i,t),old_convertMetadataMapToFinal(e.prototype,o),old_applyClassDecs(n,e,i,r),old_convertMetadataMapToFinal(e,i),n}function applyDecs2203Factory(){function e(e,t){return function(n){!function(e,t){if(e.v)throw new Error("attempted to call addInitializer after decoration was finished")}(t),r(n,"An initializer"),e.push(n)}}function t(t,r,n,i,o,s,a,c){var l;switch(o){case 1:l="accessor";break;case 2:l="method";break;case 3:l="getter";break;case 4:l="setter";break;default:l="field"}var u,d,h={kind:l,name:a?"#"+r:r,static:s,private:a},f={v:!1};0!==o&&(h.addInitializer=e(i,f)),0===o?a?(u=n.get,d=n.set):(u=function(){return this[r]},d=function(e){this[r]=e}):2===o?u=function(){return n.value}:(1!==o&&3!==o||(u=function(){return n.get.call(this)}),1!==o&&4!==o||(d=function(e){n.set.call(this,e)})),h.access=u&&d?{get:u,set:d}:u?{get:u}:{set:d};try{return t(c,h)}finally{f.v=!0}}function r(e,t){if("function"!=typeof e)throw new TypeError(t+" must be a function")}function n(e,t){var n=typeof t;if(1===e){if("object"!==n||null===t)throw new TypeError("accessor decorators must return an object with get, set, or init properties or void 0");void 0!==t.get&&r(t.get,"accessor.get"),void 0!==t.set&&r(t.set,"accessor.set"),void 0!==t.init&&r(t.init,"accessor.init")}else if("function"!==n)throw new TypeError((0===e?"field":10===e?"class":"method")+" decorators must return a function or void 0")}function i(e,r,i,o,s,a,c,l){var u,d,h,f,p,m,v=i[0];if(c?u=0===s||1===s?{get:i[3],set:i[4]}:3===s?{get:i[3]}:4===s?{set:i[3]}:{value:i[3]}:0!==s&&(u=Object.getOwnPropertyDescriptor(r,o)),1===s?h={get:u.get,set:u.set}:2===s?h=u.value:3===s?h=u.get:4===s&&(h=u.set),"function"==typeof v)void 0!==(f=t(v,o,u,l,s,a,c,h))&&(n(s,f),0===s?d=f:1===s?(d=f.init,p=f.get||h.get,m=f.set||h.set,h={get:p,set:m}):h=f);else for(var g=v.length-1;g>=0;g--){var _;void 0!==(f=t(v[g],o,u,l,s,a,c,h))&&(n(s,f),0===s?_=f:1===s?(_=f.init,p=f.get||h.get,m=f.set||h.set,h={get:p,set:m}):h=f,void 0!==_&&(void 0===d?d=_:"function"==typeof d?d=[d,_]:d.push(_)))}if(0===s||1===s){if(void 0===d)d=function(e,t){return t};else if("function"!=typeof d){var y=d;d=function(e,t){for(var r=t,n=0;n<y.length;n++)r=y[n].call(e,r);return r}}else{var b=d;d=function(e,t){return b.call(e,t)}}e.push(d)}0!==s&&(1===s?(u.get=h.get,u.set=h.set):2===s?u.value=h:3===s?u.get=h:4===s&&(u.set=h),c?1===s?(e.push((function(e,t){return h.get.call(e,t)})),e.push((function(e,t){return h.set.call(e,t)}))):2===s?e.push(h):e.push((function(e,t){return h.call(e,t)})):Object.defineProperty(r,o,u))}function o(e,t){t&&e.push((function(e){for(var r=0;r<t.length;r++)t[r].call(e);return e}))}return function(t,r,s){var a=[];return function(e,t,r){for(var n,s,a=new Map,c=new Map,l=0;l<r.length;l++){var u=r[l];if(Array.isArray(u)){var d,h,f=u[1],p=u[2],m=u.length>3,v=f>=5;if(v?(d=t,0!=(f-=5)&&(h=s=s||[])):(d=t.prototype,0!==f&&(h=n=n||[])),0!==f&&!m){var g=v?c:a,_=g.get(p)||0;if(!0===_||3===_&&4!==f||4===_&&3!==f)throw new Error("Attempted to decorate a public method/accessor that has the same name as a previously decorated public method/accessor. This is not currently supported by the decorators plugin. Property name was: "+p);!_&&f>2?g.set(p,f):g.set(p,!0)}i(e,d,u,p,f,v,m,h)}}o(e,n),o(e,s)}(a,t,r),function(t,r,i){if(i.length>0){for(var o=[],s=r,a=r.name,c=i.length-1;c>=0;c--){var l={v:!1};try{var u=i[c](s,{kind:"class",name:a,addInitializer:e(o,l)})}finally{l.v=!0}void 0!==u&&(n(10,u),s=u)}t.push(s,(function(){for(var e=0;e<o.length;e++)o[e].call(s)}))}}(a,t,s),a}}var applyDecs2203Impl,REACT_ELEMENT_TYPE;function _applyDecs2203(e,t,r){return(applyDecs2203Impl=applyDecs2203Impl||applyDecs2203Factory())(e,t,r)}function applyDecs2203RFactory(){function e(e,t){return function(n){!function(e,t){if(e.v)throw new Error("attempted to call addInitializer after decoration was finished")}(t),r(n,"An initializer"),e.push(n)}}function t(t,r,n,i,o,s,a,c){var l;switch(o){case 1:l="accessor";break;case 2:l="method";break;case 3:l="getter";break;case 4:l="setter";break;default:l="field"}var u,d,h={kind:l,name:a?"#"+r:_toPropertyKey(r),static:s,private:a},f={v:!1};0!==o&&(h.addInitializer=e(i,f)),0===o?a?(u=n.get,d=n.set):(u=function(){return this[r]},d=function(e){this[r]=e}):2===o?u=function(){return n.value}:(1!==o&&3!==o||(u=function(){return n.get.call(this)}),1!==o&&4!==o||(d=function(e){n.set.call(this,e)})),h.access=u&&d?{get:u,set:d}:u?{get:u}:{set:d};try{return t(c,h)}finally{f.v=!0}}function r(e,t){if("function"!=typeof e)throw new TypeError(t+" must be a function")}function n(e,t){var n=typeof t;if(1===e){if("object"!==n||null===t)throw new TypeError("accessor decorators must return an object with get, set, or init properties or void 0");void 0!==t.get&&r(t.get,"accessor.get"),void 0!==t.set&&r(t.set,"accessor.set"),void 0!==t.init&&r(t.init,"accessor.init")}else if("function"!==n)throw new TypeError((0===e?"field":10===e?"class":"method")+" decorators must return a function or void 0")}function i(e,r,i,o,s,a,c,l){var u,d,h,f,p,m,v,g=i[0];if(c?(0===s||1===s?(u={get:i[3],set:i[4]},h="get"):3===s?(u={get:i[3]},h="get"):4===s?(u={set:i[3]},h="set"):u={value:i[3]},0!==s&&(1===s&&_setFunctionName(i[4],"#"+o,"set"),_setFunctionName(i[3],"#"+o,h))):0!==s&&(u=Object.getOwnPropertyDescriptor(r,o)),1===s?f={get:u.get,set:u.set}:2===s?f=u.value:3===s?f=u.get:4===s&&(f=u.set),"function"==typeof g)void 0!==(p=t(g,o,u,l,s,a,c,f))&&(n(s,p),0===s?d=p:1===s?(d=p.init,m=p.get||f.get,v=p.set||f.set,f={get:m,set:v}):f=p);else for(var _=g.length-1;_>=0;_--){var y;void 0!==(p=t(g[_],o,u,l,s,a,c,f))&&(n(s,p),0===s?y=p:1===s?(y=p.init,m=p.get||f.get,v=p.set||f.set,f={get:m,set:v}):f=p,void 0!==y&&(void 0===d?d=y:"function"==typeof d?d=[d,y]:d.push(y)))}if(0===s||1===s){if(void 0===d)d=function(e,t){return t};else if("function"!=typeof d){var b=d;d=function(e,t){for(var r=t,n=0;n<b.length;n++)r=b[n].call(e,r);return r}}else{var w=d;d=function(e,t){return w.call(e,t)}}e.push(d)}0!==s&&(1===s?(u.get=f.get,u.set=f.set):2===s?u.value=f:3===s?u.get=f:4===s&&(u.set=f),c?1===s?(e.push((function(e,t){return f.get.call(e,t)})),e.push((function(e,t){return f.set.call(e,t)}))):2===s?e.push(f):e.push((function(e,t){return f.call(e,t)})):Object.defineProperty(r,o,u))}function o(e,t){for(var r,n,o=[],a=new Map,c=new Map,l=0;l<t.length;l++){var u=t[l];if(Array.isArray(u)){var d,h,f=u[1],p=u[2],m=u.length>3,v=f>=5;if(v?(d=e,0!=(f-=5)&&(h=n=n||[])):(d=e.prototype,0!==f&&(h=r=r||[])),0!==f&&!m){var g=v?c:a,_=g.get(p)||0;if(!0===_||3===_&&4!==f||4===_&&3!==f)throw new Error("Attempted to decorate a public method/accessor that has the same name as a previously decorated public method/accessor. This is not currently supported by the decorators plugin. Property name was: "+p);!_&&f>2?g.set(p,f):g.set(p,!0)}i(o,d,u,p,f,v,m,h)}}return s(o,r),s(o,n),o}function s(e,t){t&&e.push((function(e){for(var r=0;r<t.length;r++)t[r].call(e);return e}))}return function(t,r,i){return{e:o(t,r),get c(){return function(t,r){if(r.length>0){for(var i=[],o=t,s=t.name,a=r.length-1;a>=0;a--){var c={v:!1};try{var l=r[a](o,{kind:"class",name:s,addInitializer:e(i,c)})}finally{c.v=!0}void 0!==l&&(n(10,l),o=l)}return[o,function(){for(var e=0;e<i.length;e++)i[e].call(o)}]}}(t,i)}}}}function _applyDecs2203R(e,t,r){return(_applyDecs2203R=applyDecs2203RFactory())(e,t,r)}function applyDecs2301Factory(){function e(e,t){return function(r){!function(e,t){if(e.v)throw new Error("attempted to call addInitializer after decoration was finished")}(t),n(r,"An initializer"),e.push(r)}}function t(e,t){if(!e(t))throw new TypeError("Attempted to access private element on non-instance")}function r(r,n,i,o,s,a,c,l,u){var d;switch(s){case 1:d="accessor";break;case 2:d="method";break;case 3:d="getter";break;case 4:d="setter";break;default:d="field"}var h,f,p={kind:d,name:c?"#"+n:_toPropertyKey(n),static:a,private:c},m={v:!1};if(0!==s&&(p.addInitializer=e(o,m)),c||0!==s&&2!==s)if(2===s)h=function(e){return t(u,e),i.value};else{var v=0===s||1===s;(v||3===s)&&(h=c?function(e){return t(u,e),i.get.call(e)}:function(e){return i.get.call(e)}),(v||4===s)&&(f=c?function(e,r){t(u,e),i.set.call(e,r)}:function(e,t){i.set.call(e,t)})}else h=function(e){return e[n]},0===s&&(f=function(e,t){e[n]=t});var g=c?u.bind():function(e){return n in e};p.access=h&&f?{get:h,set:f,has:g}:h?{get:h,has:g}:{set:f,has:g};try{return r(l,p)}finally{m.v=!0}}function n(e,t){if("function"!=typeof e)throw new TypeError(t+" must be a function")}function i(e,t){var r=typeof t;if(1===e){if("object"!==r||null===t)throw new TypeError("accessor decorators must return an object with get, set, or init properties or void 0");void 0!==t.get&&n(t.get,"accessor.get"),void 0!==t.set&&n(t.set,"accessor.set"),void 0!==t.init&&n(t.init,"accessor.init")}else if("function"!==r)throw new TypeError((0===e?"field":10===e?"class":"method")+" decorators must return a function or void 0")}function o(e){return function(t){e(this,t)}}function s(e,t,n,s,a,c,l,u,d){var h,f,p,m,v,g,_,y,b=n[0];if(l?(0===a||1===a?(h={get:(v=n[3],function(){return v(this)}),set:o(n[4])},p="get"):3===a?(h={get:n[3]},p="get"):4===a?(h={set:n[3]},p="set"):h={value:n[3]},0!==a&&(1===a&&_setFunctionName(h.set,"#"+s,"set"),_setFunctionName(h[p||"value"],"#"+s,p))):0!==a&&(h=Object.getOwnPropertyDescriptor(t,s)),1===a?m={get:h.get,set:h.set}:2===a?m=h.value:3===a?m=h.get:4===a&&(m=h.set),"function"==typeof b)void 0!==(g=r(b,s,h,u,a,c,l,m,d))&&(i(a,g),0===a?f=g:1===a?(f=g.init,_=g.get||m.get,y=g.set||m.set,m={get:_,set:y}):m=g);else for(var w=b.length-1;w>=0;w--){var k;void 0!==(g=r(b[w],s,h,u,a,c,l,m,d))&&(i(a,g),0===a?k=g:1===a?(k=g.init,_=g.get||m.get,y=g.set||m.set,m={get:_,set:y}):m=g,void 0!==k&&(void 0===f?f=k:"function"==typeof f?f=[f,k]:f.push(k)))}if(0===a||1===a){if(void 0===f)f=function(e,t){return t};else if("function"!=typeof f){var S=f;f=function(e,t){for(var r=t,n=0;n<S.length;n++)r=S[n].call(e,r);return r}}else{var E=f;f=function(e,t){return E.call(e,t)}}e.push(f)}0!==a&&(1===a?(h.get=m.get,h.set=m.set):2===a?h.value=m:3===a?h.get=m:4===a&&(h.set=m),l?1===a?(e.push((function(e,t){return m.get.call(e,t)})),e.push((function(e,t){return m.set.call(e,t)}))):2===a?e.push(m):e.push((function(e,t){return m.call(e,t)})):Object.defineProperty(t,s,h))}function a(e,t,r){for(var n,i,o,a=[],l=new Map,u=new Map,d=0;d<t.length;d++){var h=t[d];if(Array.isArray(h)){var f,p,m=h[1],v=h[2],g=h.length>3,_=m>=5,y=r;if(_?(f=e,0!=(m-=5)&&(p=i=i||[]),g&&!o&&(o=function(t){return _checkInRHS(t)===e}),y=o):(f=e.prototype,0!==m&&(p=n=n||[])),0!==m&&!g){var b=_?u:l,w=b.get(v)||0;if(!0===w||3===w&&4!==m||4===w&&3!==m)throw new Error("Attempted to decorate a public method/accessor that has the same name as a previously decorated public method/accessor. This is not currently supported by the decorators plugin. Property name was: "+v);!w&&m>2?b.set(v,m):b.set(v,!0)}s(a,f,h,v,m,_,g,p,y)}}return c(a,n),c(a,i),a}function c(e,t){t&&e.push((function(e){for(var r=0;r<t.length;r++)t[r].call(e);return e}))}return function(t,r,n,o){return{e:a(t,r,o),get c(){return function(t,r){if(r.length>0){for(var n=[],o=t,s=t.name,a=r.length-1;a>=0;a--){var c={v:!1};try{var l=r[a](o,{kind:"class",name:s,addInitializer:e(n,c)})}finally{c.v=!0}void 0!==l&&(i(10,l),o=l)}return[o,function(){for(var e=0;e<n.length;e++)n[e].call(o)}]}}(t,n)}}}}function _applyDecs2301(e,t,r,n){return(_applyDecs2301=applyDecs2301Factory())(e,t,r,n)}function _applyDecs2305(e,t,r,n,i,o){function s(e,t,r){return function(n,i){return r&&r(n),e[t].call(n,i)}}function a(e,t){for(var r=0;r<e.length;r++)e[r].call(t);return t}function c(e,t,r,n){if("function"!=typeof e&&(n||void 0!==e))throw new TypeError(t+" must "+(r||"be")+" a function"+(n?"":" or undefined"));return e}function l(e,t,r,n,i,o,a,l,u,d,h,f,p){function m(e){if(!p(e))throw new TypeError("Attempted to access private element on non-instance")}var v,g=t[0],_=t[3],y=!l;if(!y){r||Array.isArray(g)||(g=[g]);var b={},w=[],k=3===i?"get":4===i||f?"set":"value";d?(h||f?b={get:_setFunctionName((function(){return _(this)}),n,"get"),set:function(e){t[4](this,e)}}:b[k]=_,h||_setFunctionName(b[k],n,2===i?"":k)):h||(b=Object.getOwnPropertyDescriptor(e,n))}for(var S=e,E=g.length-1;E>=0;E-=r?2:1){var C=g[E],T=r?g[E-1]:void 0,P={},A={kind:["field","accessor","method","getter","setter","class"][i],name:n,metadata:o,addInitializer:function(e,t){if(e.v)throw new Error("attempted to call addInitializer after decoration was finished");c(t,"An initializer","be",!0),a.push(t)}.bind(null,P)};try{if(y)(v=c(C.call(T,S,A),"class decorators","return"))&&(S=v);else{var x,B;A.static=u,A.private=d,d?2===i?x=function(e){return m(e),b.value}:(i<4&&(x=s(b,"get",m)),3!==i&&(B=s(b,"set",m))):(x=function(e){return e[n]},(i<2||4===i)&&(B=function(e,t){e[n]=t}));var I=A.access={has:d?p.bind():function(e){return n in e}};if(x&&(I.get=x),B&&(I.set=B),S=C.call(T,f?{get:b.get,set:b.set}:b[k],A),f){if("object"==typeof S&&S)(v=c(S.get,"accessor.get"))&&(b.get=v),(v=c(S.set,"accessor.set"))&&(b.set=v),(v=c(S.init,"accessor.init"))&&w.push(v);else if(void 0!==S)throw new TypeError("accessor decorators must return an object with get, set, or init properties or void 0")}else c(S,(h?"field":"method")+" decorators","return")&&(h?w.push(S):b[k]=S)}}finally{P.v=!0}}return(h||f)&&l.push((function(e,t){for(var r=w.length-1;r>=0;r--)t=w[r].call(e,t);return t})),h||y||(d?f?l.push(s(b,"get"),s(b,"set")):l.push(2===i?b[k]:s.call.bind(b[k])):Object.defineProperty(e,n,b)),S}function u(e,t){return Object.defineProperty(e,Symbol.metadata||Symbol.for("Symbol.metadata"),{configurable:!0,enumerable:!0,value:t})}if(arguments.length>=6)var d=o[Symbol.metadata||Symbol.for("Symbol.metadata")];var h=Object.create(null==d?null:d),f=function(e,t,r,n){var i,o,s=[],c=function(t){return _checkInRHS(t)===e},u=new Map;function d(e){e&&s.push(a.bind(null,e))}for(var h=0;h<t.length;h++){var f=t[h];if(Array.isArray(f)){var p=f[1],m=f[2],v=f.length>3,g=16&p,_=!!(8&p),y=0==(p&=7),b=m+"/"+_;if(!y&&!v){var w=u.get(b);if(!0===w||3===w&&4!==p||4===w&&3!==p)throw new Error("Attempted to decorate a public method/accessor that has the same name as a previously decorated public method/accessor. This is not currently supported by the decorators plugin. Property name was: "+m);u.set(b,!(p>2)||p)}l(_?e:e.prototype,f,g,v?"#"+m:_toPropertyKey(m),p,n,_?o=o||[]:i=i||[],s,_,v,y,1===p,_&&v?c:r)}}return d(i),d(o),s}(e,t,i,h);return r.length||u(e,h),{e:f,get c(){var t=[];return r.length&&[u(l(e,[r],n,e.name,5,h,t),h),a.bind(null,t,e)]}}}function _asyncGeneratorDelegate(e){var t={},r=!1;function n(t,n){return r=!0,n=new Promise((function(r){r(e[t](n))})),{done:!1,value:new _OverloadYield(n,1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return r?(r=!1,e):n("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(r)throw r=!1,e;return n("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return r?(r=!1,e):n("return",e)}),t}function _asyncIterator(e){var t,r,n,i=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);i--;){if(r&&null!=(t=e[r]))return t.call(e);if(n&&null!=(t=e[n]))return new AsyncFromSyncIterator(t.call(e));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function AsyncFromSyncIterator(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return AsyncFromSyncIterator=function(e){this.s=e,this.n=e.next},AsyncFromSyncIterator.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var r=this.s.return;return void 0===r?Promise.resolve({value:e,done:!0}):t(r.apply(this.s,arguments))},throw:function(e){var r=this.s.return;return void 0===r?Promise.reject(e):t(r.apply(this.s,arguments))}},new AsyncFromSyncIterator(e)}function _awaitAsyncGenerator(e){return new _OverloadYield(e,0)}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _checkInRHS(e){if(Object(e)!==e)throw TypeError("right-hand side of 'in' should be an object, got "+(null!==e?typeof e:"null"));return e}function _construct(e,t,r){if(_isNativeReflectConstruct())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var i=new(e.bind.apply(e,n));return r&&_setPrototypeOf(i,r.prototype),i}function _defineAccessor(e,t,r,n){var i={configurable:!0,enumerable:!0};return i[e]=n,Object.defineProperty(t,r,i)}function dispose_SuppressedError(e,t){return"undefined"!=typeof SuppressedError?dispose_SuppressedError=SuppressedError:(dispose_SuppressedError=function(e,t){this.suppressed=t,this.error=e,this.stack=(new Error).stack},dispose_SuppressedError.prototype=Object.create(Error.prototype,{constructor:{value:dispose_SuppressedError,writable:!0,configurable:!0}})),new dispose_SuppressedError(e,t)}function _dispose$1(e,t,r){function n(){for(;e.length>0;)try{var o=e.pop(),s=o.d.call(o.v);if(o.a)return Promise.resolve(s).then(n,i)}catch(e){return i(e)}if(r)throw t}function i(e){return t=r?new dispose_SuppressedError(t,e):e,r=!0,n()}return n()}function _importDeferProxy(e){var t=null,r=function(e){return function(){return e}},n=function(r){return function(n,i,o){return null===t&&(t=e()),r(t,i,o)}};return new Proxy({},{defineProperty:r(!1),deleteProperty:r(!1),get:n(Reflect.get),getOwnPropertyDescriptor:n(Reflect.getOwnPropertyDescriptor),getPrototypeOf:r(null),isExtensible:r(!1),has:n(Reflect.has),ownKeys:n(Reflect.ownKeys),preventExtensions:r(!0),set:r(!1),setPrototypeOf:r(!1)})}function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,s,a=[],c=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(l)throw i}}return a}}function _iterableToArrayLimitLoose(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,i=[];for(r=r.call(e);e.length<t&&!(n=r.next()).done;)i.push(n.value);return i}}function _jsx(e,t,r,n){REACT_ELEMENT_TYPE||(REACT_ELEMENT_TYPE="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=n;else if(o>1){for(var s=new Array(o),a=0;a<o;a++)s[a]=arguments[a+3];t.children=s}if(t&&i)for(var c in i)void 0===t[c]&&(t[c]=i[c]);else t||(t=i||{});return{$$typeof:REACT_ELEMENT_TYPE,type:e,key:void 0===r?null:""+r,ref:null,props:t,_owner:null}}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _regeneratorRuntime(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,s=Object.create(o.prototype),a=new B(n||[]);return i(s,"_invoke",{value:T(e,r,a)}),s}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var h="suspendedStart",f="suspendedYield",p="executing",m="completed",v={};function g(){}function _(){}function y(){}var b={};l(b,s,(function(){return this}));var w=Object.getPrototypeOf,k=w&&w(w(I([])));k&&k!==r&&n.call(k,s)&&(b=k);var S=y.prototype=g.prototype=Object.create(b);function E(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(i,o,s,a){var c=d(e[i],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==typeof u&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,s,a)}),(function(e){r("throw",e,s,a)})):t.resolve(u).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,a)}))}a(c.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=h;return function(o,s){if(i===p)throw new Error("Generator is already running");if(i===m){if("throw"===o)throw s;return{value:e,done:!0}}for(n.method=o,n.arg=s;;){var a=n.delegate;if(a){var c=P(a,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===h)throw i=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=d(t,r,n);if("normal"===l.type){if(i=n.done?m:f,l.arg===v)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=m,n.method="throw",n.arg=l.arg)}}}function P(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,P(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var o=d(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,v;var s=o.arg;return s?s.done?(r[t.resultName]=s.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function B(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function I(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(typeof t+" is not iterable")}return _.prototype=y,i(S,"constructor",{value:y,configurable:!0}),i(y,"constructor",{value:_,configurable:!0}),_.displayName=l(y,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l(e,c,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},E(C.prototype),l(C.prototype,a,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var s=new C(u(e,r,n,i),o);return t.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},E(S),l(S,c,"Generator"),l(S,s,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=I,B.prototype={constructor:B,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(x),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return a.type="throw",a.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=n.call(s,"catchLoc"),l=n.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),x(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;x(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:I(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}function _setFunctionName(e,t,r){"symbol"==typeof t&&(t=(t=t.description)?"["+t+"]":"");try{Object.defineProperty(e,"name",{configurable:!0,value:r?r+" "+t:t})}catch(e){}return e}function _toPrimitive(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _using(e,t,r){if(null==t)return t;if(Object(t)!==t)throw new TypeError("using declarations can only be used with objects, functions, null, or undefined.");if(r)var n=t[Symbol.asyncDispose||Symbol.for("Symbol.asyncDispose")];if(null==n&&(n=t[Symbol.dispose||Symbol.for("Symbol.dispose")]),"function"!=typeof n)throw new TypeError("Property [Symbol.dispose] is not a function.");return e.push({v:t,d:n,a:r}),t}function _usingCtx(){var e="function"==typeof SuppressedError?SuppressedError:function(e,t){var r=new Error;return r.name="SuppressedError",r.suppressed=t,r.error=e,r},t={},r=[];function n(e,t){if(null!=t){if(Object(t)!==t)throw new TypeError("using declarations can only be used with objects, functions, null, or undefined.");if(e)var n=t[Symbol.asyncDispose||Symbol.for("Symbol.asyncDispose")];if(null==n&&(n=t[Symbol.dispose||Symbol.for("Symbol.dispose")]),"function"!=typeof n)throw new TypeError("Property [Symbol.dispose] is not a function.");r.push({v:t,d:n,a:e})}return t}return{e:t,u:n.bind(null,!1),a:n.bind(null,!0),d:function(){var n=this.e;function i(){for(;e=r.pop();)try{var e,s=e.d.call(e.v);if(e.a)return Promise.resolve(s).then(i,o)}catch(e){return o(e)}if(n!==t)throw n}function o(r){return n=n!==t?new e(n,r):r,i()}return i()}}}function _wrapRegExp(){_wrapRegExp=function(e,t){return new r(e,void 0,t)};var e=RegExp.prototype,t=new WeakMap;function r(e,n,i){var o=new RegExp(e,n);return t.set(o,i||t.get(e)),_setPrototypeOf(o,r.prototype)}function n(e,r){var n=t.get(r);return Object.keys(n).reduce((function(t,r){var i=n[r];if("number"==typeof i)t[r]=e[i];else{for(var o=0;void 0===e[i[o]]&&o+1<i.length;)o++;t[r]=e[i[o]]}return t}),Object.create(null))}return _inherits(r,RegExp),r.prototype.exec=function(t){var r=e.exec.call(this,t);if(r){r.groups=n(r,this);var i=r.indices;i&&(i.groups=n(i,this))}return r},r.prototype[Symbol.replace]=function(r,i){if("string"==typeof i){var o=t.get(this);return e[Symbol.replace].call(this,r,i.replace(/\$<([^>]+)>/g,(function(e,t){var r=o[t];return"$"+(Array.isArray(r)?r.join("$"):r)})))}if("function"==typeof i){var s=this;return e[Symbol.replace].call(this,r,(function(){var e=arguments;return"object"!=typeof e[e.length-1]&&(e=[].slice.call(e)).push(n(e,s)),i.apply(this,e)}))}return e[Symbol.replace].call(this,r,i)},_wrapRegExp.apply(this,arguments)}function _AwaitValue(e){this.wrapped=e}function _wrapAsyncGenerator(e){return function(){return new _AsyncGenerator(e.apply(this,arguments))}}function asyncGeneratorStep(e,t,r,n,i,o,s){try{var a=e[o](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,i)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function s(e){asyncGeneratorStep(o,n,i,s,a,"next",e)}function a(e){asyncGeneratorStep(o,n,i,s,a,"throw",e)}s(void 0)}))}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineEnumerableProperties(e,t){for(var r in t){(o=t[r]).configurable=o.enumerable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,r,o)}if(Object.getOwnPropertySymbols)for(var n=Object.getOwnPropertySymbols(t),i=0;i<n.length;i++){var o,s=n[i];(o=t[s]).configurable=o.enumerable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,s,o)}return e}function _defaults(e,t){for(var r=Object.getOwnPropertyNames(t),n=0;n<r.length;n++){var i=r[n],o=Object.getOwnPropertyDescriptor(t,i);o&&o.configurable&&void 0===e[i]&&Object.defineProperty(e,i,o)}return e}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_extends.apply(this,arguments)}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach((function(t){_defineProperty(e,t,r[t])}))}return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}function _isNativeFunction(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}function _wrapNativeSuper(e){var t="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(r,e)},_wrapNativeSuper(e)}function _instanceof(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _newArrowCheck(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}function _objectDestructuringEmpty(e){if(null==e)throw new TypeError("Cannot destructure "+e)}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}function _objectWithoutProperties(e,t){if(null==e)return{};var r,n,i=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _possibleConstructorReturn(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},_get.apply(this,arguments)}function set(e,t,r,n){return set="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,t,r,n){var i,o=_superPropBase(e,t);if(o){if((i=Object.getOwnPropertyDescriptor(o,t)).set)return i.set.call(n,r),!0;if(!i.writable)return!1}if(i=Object.getOwnPropertyDescriptor(n,t)){if(!i.writable)return!1;i.value=r,Object.defineProperty(n,t,i)}else _defineProperty(n,t,r);return!0},set(e,t,r,n)}function _set(e,t,r,n,i){if(!set(e,t,r,n||e)&&i)throw new TypeError("failed to set property");return r}function _taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _taggedTemplateLiteralLoose(e,t){return t||(t=e.slice(0)),e.raw=t,e}function _readOnlyError(e){throw new TypeError('"'+e+'" is read-only')}function _writeOnlyError(e){throw new TypeError('"'+e+'" is write-only')}function _classNameTDZError(e){throw new ReferenceError('Class "'+e+'" cannot be referenced in computed property keys.')}function _temporalUndefined(){}function _tdz(e){throw new ReferenceError(e+" is not defined - temporal dead zone")}function _temporalRef(e,t){return e===_temporalUndefined?_tdz(t):e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _slicedToArrayLoose(e,t){return _arrayWithHoles(e)||_iterableToArrayLimitLoose(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _toArray(e){return _arrayWithHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableRest()}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _maybeArrayLike(e,t,r){if(t&&!Array.isArray(t)&&"number"==typeof t.length){var n=t.length;return _arrayLikeToArray(t,void 0!==r&&r<n?r:n)}return e(t,r)}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function _createForOfIteratorHelperLoose(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _skipFirstGeneratorNext(e){return function(){var t=e.apply(this,arguments);return t.next(),t}}function _initializerWarningHelper(e,t){throw new Error("Decorating class property failed. Please ensure that transform-class-properties is enabled and runs after the decorators transform.")}function _initializerDefineProperty(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function _applyDecoratedDescriptor(e,t,r,n,i){var o={};return Object.keys(n).forEach((function(e){o[e]=n[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}_AsyncGenerator.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},_AsyncGenerator.prototype.next=function(e){return this._invoke("next",e)},_AsyncGenerator.prototype.throw=function(e){return this._invoke("throw",e)},_AsyncGenerator.prototype.return=function(e){return this._invoke("return",e)};var id=0;function _classPrivateFieldLooseKey(e){return"__private_"+id+++"_"+e}function _classPrivateFieldLooseBase(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}function _classPrivateFieldGet(e,t){return _classApplyDescriptorGet(e,_classExtractFieldDescriptor(e,t,"get"))}function _classPrivateFieldSet(e,t,r){return _classApplyDescriptorSet(e,_classExtractFieldDescriptor(e,t,"set"),r),r}function _classPrivateFieldDestructureSet(e,t){return _classApplyDescriptorDestructureSet(e,_classExtractFieldDescriptor(e,t,"set"))}function _classExtractFieldDescriptor(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function _classStaticPrivateFieldSpecGet(e,t,r){return _classCheckPrivateStaticAccess(e,t),_classCheckPrivateStaticFieldDescriptor(r,"get"),_classApplyDescriptorGet(e,r)}function _classStaticPrivateFieldSpecSet(e,t,r,n){return _classCheckPrivateStaticAccess(e,t),_classCheckPrivateStaticFieldDescriptor(r,"set"),_classApplyDescriptorSet(e,r,n),n}function _classStaticPrivateMethodGet(e,t,r){return _classCheckPrivateStaticAccess(e,t),r}function _classStaticPrivateMethodSet(){throw new TypeError("attempted to set read only static private field")}function _classApplyDescriptorGet(e,t){return t.get?t.get.call(e):t.value}function _classApplyDescriptorSet(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function _classApplyDescriptorDestructureSet(e,t){if(t.set)return"__destrObj"in t||(t.__destrObj={set value(r){t.set.call(e,r)}}),t.__destrObj;if(!t.writable)throw new TypeError("attempted to set read only private field");return t}function _classStaticPrivateFieldDestructureSet(e,t,r){return _classCheckPrivateStaticAccess(e,t),_classCheckPrivateStaticFieldDescriptor(r,"set"),_classApplyDescriptorDestructureSet(e,r)}function _classCheckPrivateStaticAccess(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}function _classCheckPrivateStaticFieldDescriptor(e,t){if(void 0===e)throw new TypeError("attempted to "+t+" private static field before its declaration")}function _decorate(e,t,r,n){var i=_getDecoratorsApi();if(n)for(var o=0;o<n.length;o++)i=n[o](i);var s=t((function(e){i.initializeInstanceElements(e,a.elements)}),r),a=i.decorateClass(_coalesceClassElements(s.d.map(_createElementDescriptor)),e);return i.initializeClassElements(s.F,a.elements),i.runClassFinishers(s.F,a.finishers)}function _getDecoratorsApi(){_getDecoratorsApi=function(){return e};var e={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(e,t){["method","field"].forEach((function(r){t.forEach((function(t){t.kind===r&&"own"===t.placement&&this.defineClassElement(e,t)}),this)}),this)},initializeClassElements:function(e,t){var r=e.prototype;["method","field"].forEach((function(n){t.forEach((function(t){var i=t.placement;if(t.kind===n&&("static"===i||"prototype"===i)){var o="static"===i?e:r;this.defineClassElement(o,t)}}),this)}),this)},defineClassElement:function(e,t){var r=t.descriptor;if("field"===t.kind){var n=t.initializer;r={enumerable:r.enumerable,writable:r.writable,configurable:r.configurable,value:void 0===n?void 0:n.call(e)}}Object.defineProperty(e,t.key,r)},decorateClass:function(e,t){var r=[],n=[],i={static:[],prototype:[],own:[]};if(e.forEach((function(e){this.addElementPlacement(e,i)}),this),e.forEach((function(e){if(!_hasDecorators(e))return r.push(e);var t=this.decorateElement(e,i);r.push(t.element),r.push.apply(r,t.extras),n.push.apply(n,t.finishers)}),this),!t)return{elements:r,finishers:n};var o=this.decorateConstructor(r,t);return n.push.apply(n,o.finishers),o.finishers=n,o},addElementPlacement:function(e,t,r){var n=t[e.placement];if(!r&&-1!==n.indexOf(e.key))throw new TypeError("Duplicated element ("+e.key+")");n.push(e.key)},decorateElement:function(e,t){for(var r=[],n=[],i=e.decorators,o=i.length-1;o>=0;o--){var s=t[e.placement];s.splice(s.indexOf(e.key),1);var a=this.fromElementDescriptor(e),c=this.toElementFinisherExtras((0,i[o])(a)||a);e=c.element,this.addElementPlacement(e,t),c.finisher&&n.push(c.finisher);var l=c.extras;if(l){for(var u=0;u<l.length;u++)this.addElementPlacement(l[u],t);r.push.apply(r,l)}}return{element:e,finishers:n,extras:r}},decorateConstructor:function(e,t){for(var r=[],n=t.length-1;n>=0;n--){var i=this.fromClassDescriptor(e),o=this.toClassDescriptor((0,t[n])(i)||i);if(void 0!==o.finisher&&r.push(o.finisher),void 0!==o.elements){e=o.elements;for(var s=0;s<e.length-1;s++)for(var a=s+1;a<e.length;a++)if(e[s].key===e[a].key&&e[s].placement===e[a].placement)throw new TypeError("Duplicated element ("+e[s].key+")")}}return{elements:e,finishers:r}},fromElementDescriptor:function(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return Object.defineProperty(t,Symbol.toStringTag,{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t},toElementDescriptors:function(e){if(void 0!==e)return _toArray(e).map((function(e){var t=this.toElementDescriptor(e);return this.disallowProperty(e,"finisher","An element descriptor"),this.disallowProperty(e,"extras","An element descriptor"),t}),this)},toElementDescriptor:function(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var r=_toPropertyKey(e.key),n=String(e.placement);if("static"!==n&&"prototype"!==n&&"own"!==n)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+n+'"');var i=e.descriptor;this.disallowProperty(e,"elements","An element descriptor");var o={kind:t,key:r,placement:n,descriptor:Object.assign({},i)};return"field"!==t?this.disallowProperty(e,"initializer","A method descriptor"):(this.disallowProperty(i,"get","The property descriptor of a field descriptor"),this.disallowProperty(i,"set","The property descriptor of a field descriptor"),this.disallowProperty(i,"value","The property descriptor of a field descriptor"),o.initializer=e.initializer),o},toElementFinisherExtras:function(e){return{element:this.toElementDescriptor(e),finisher:_optionalCallableProperty(e,"finisher"),extras:this.toElementDescriptors(e.extras)}},fromClassDescriptor:function(e){var t={kind:"class",elements:e.map(this.fromElementDescriptor,this)};return Object.defineProperty(t,Symbol.toStringTag,{value:"Descriptor",configurable:!0}),t},toClassDescriptor:function(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');this.disallowProperty(e,"key","A class descriptor"),this.disallowProperty(e,"placement","A class descriptor"),this.disallowProperty(e,"descriptor","A class descriptor"),this.disallowProperty(e,"initializer","A class descriptor"),this.disallowProperty(e,"extras","A class descriptor");var r=_optionalCallableProperty(e,"finisher");return{elements:this.toElementDescriptors(e.elements),finisher:r}},runClassFinishers:function(e,t){for(var r=0;r<t.length;r++){var n=(0,t[r])(e);if(void 0!==n){if("function"!=typeof n)throw new TypeError("Finishers must return a constructor.");e=n}}return e},disallowProperty:function(e,t,r){if(void 0!==e[t])throw new TypeError(r+" can't have a ."+t+" property.")}};return e}function _createElementDescriptor(e){var t,r=_toPropertyKey(e.key);"method"===e.kind?t={value:e.value,writable:!0,configurable:!0,enumerable:!1}:"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var n={kind:"field"===e.kind?"field":"method",key:r,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(n.decorators=e.decorators),"field"===e.kind&&(n.initializer=e.value),n}function _coalesceGetterSetter(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function _coalesceClassElements(e){for(var t=[],r=function(e){return"method"===e.kind&&e.key===o.key&&e.placement===o.placement},n=0;n<e.length;n++){var i,o=e[n];if("method"===o.kind&&(i=t.find(r)))if(_isDataDescriptor(o.descriptor)||_isDataDescriptor(i.descriptor)){if(_hasDecorators(o)||_hasDecorators(i))throw new ReferenceError("Duplicated methods ("+o.key+") can't be decorated.");i.descriptor=o.descriptor}else{if(_hasDecorators(o)){if(_hasDecorators(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+o.key+").");i.decorators=o.decorators}_coalesceGetterSetter(o,i)}else t.push(o)}return t}function _hasDecorators(e){return e.decorators&&e.decorators.length}function _isDataDescriptor(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function _optionalCallableProperty(e,t){var r=e[t];if(void 0!==r&&"function"!=typeof r)throw new TypeError("Expected '"+t+"' to be a function");return r}function _classPrivateMethodGet(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function _checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldInitSpec(e,t,r){_checkPrivateRedeclaration(e,t),t.set(e,r)}function _classPrivateMethodInitSpec(e,t){_checkPrivateRedeclaration(e,t),t.add(e)}function _classPrivateMethodSet(){throw new TypeError("attempted to reassign private method")}function _identity(e){return e}function _nullishReceiverError(e){throw new TypeError("Cannot set property of null or undefined.")}var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},extendStatics(e,t)};function __extends$h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var __assign=function(){return __assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__assign.apply(this,arguments)};function __rest(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function __decorate(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s}function __param(e,t){return function(r,n){t(r,n,e)}}function __esDecorate(e,t,r,n,i,o){function s(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,c=n.kind,l="getter"===c?"get":"setter"===c?"set":"value",u=!t&&e?n.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),h=!1,f=r.length-1;f>=0;f--){var p={};for(var m in n)p[m]="access"===m?{}:n[m];for(var m in n.access)p.access[m]=n.access[m];p.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");o.push(s(e||null))};var v=(0,r[f])("accessor"===c?{get:d.get,set:d.set}:d[l],p);if("accessor"===c){if(void 0===v)continue;if(null===v||"object"!=typeof v)throw new TypeError("Object expected");(a=s(v.get))&&(d.get=a),(a=s(v.set))&&(d.set=a),(a=s(v.init))&&i.unshift(a)}else(a=s(v))&&("field"===c?i.unshift(a):d[l]=a)}u&&Object.defineProperty(u,n.name,d),h=!0}function __runInitializers(e,t,r){for(var n=arguments.length>2,i=0;i<t.length;i++)r=n?t[i].call(e,r):t[i].call(e);return n?r:void 0}function __propKey(e){return"symbol"==typeof e?e:"".concat(e)}function __setFunctionName(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function __metadata(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function __awaiter(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function __generator$7(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var __createBinding$2=Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function __exportStar(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||__createBinding$2(t,e,r)}function __values$4(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read$4(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function __spread(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read$4(arguments[t]));return e}function __spreadArrays(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n}function __spreadArray$3(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function __await(e){return this instanceof __await?(this.v=e,this):new __await(e)}function __asyncGenerator(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){o.push([e,t,r,n])>1||a(e,t)}))})}function a(e,t){try{!function(e){e.value instanceof __await?Promise.resolve(e.value.v).then(c,l):u(o[0][2],e)}(i[e](t))}catch(e){u(o[0][3],e)}}function c(e){a("next",e)}function l(e){a("throw",e)}function u(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function __asyncDelegator(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:__await(e[n](t)),done:!1}:i?i(t):t}:i}}function __asyncValues(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values$4?__values$4(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,i,(t=e[r](t)).done,t.value)}))}}}function __makeTemplateObject(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var __setModuleDefault$2=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function __importStar$2(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding$2(t,e,r);return __setModuleDefault$2(t,e),t}function __importDefault$6(e){return e&&e.__esModule?e:{default:e}}function __classPrivateFieldGet(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function __classPrivateFieldSet(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r}function __classPrivateFieldIn(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function __addDisposableResource(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if("function"!=typeof n)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var _SuppressedError="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function __disposeResources(e){function t(t){e.error=e.hasError?new _SuppressedError(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var n=e.stack.pop();try{var i=n.dispose&&n.dispose.call(n.value);if(n.async)return Promise.resolve(i).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}var _tslib={__extends:__extends$h,__assign:__assign,__rest:__rest,__decorate:__decorate,__param:__param,__metadata:__metadata,__awaiter:__awaiter,__generator:__generator$7,__createBinding:__createBinding$2,__exportStar:__exportStar,__values:__values$4,__read:__read$4,__spread:__spread,__spreadArrays:__spreadArrays,__spreadArray:__spreadArray$3,__await:__await,__asyncGenerator:__asyncGenerator,__asyncDelegator:__asyncDelegator,__asyncValues:__asyncValues,__makeTemplateObject:__makeTemplateObject,__importStar:__importStar$2,__importDefault:__importDefault$6,__classPrivateFieldGet:__classPrivateFieldGet,__classPrivateFieldSet:__classPrivateFieldSet,__classPrivateFieldIn:__classPrivateFieldIn,__addDisposableResource:__addDisposableResource,__disposeResources:__disposeResources},commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getDefaultExportFromNamespaceIfPresent(e){return e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getDefaultExportFromNamespaceIfNotNamed(e){return e&&Object.prototype.hasOwnProperty.call(e,"default")&&1===Object.keys(e).length?e.default:e}function getAugmentedNamespace(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var r=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})})),r}var fontfaceobserver_standalone$1={exports:{}},fontfaceobserver_standalone=fontfaceobserver_standalone$1.exports;!function(e){!function(){function t(e,t){document.addEventListener?e.addEventListener("scroll",t,!1):e.attachEvent("scroll",t)}function r(e){this.g=document.createElement("div"),this.g.setAttribute("aria-hidden","true"),this.g.appendChild(document.createTextNode(e)),this.h=document.createElement("span"),this.i=document.createElement("span"),this.m=document.createElement("span"),this.j=document.createElement("span"),this.l=-1,this.h.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.i.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.j.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.m.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.h.appendChild(this.m),this.i.appendChild(this.j),this.g.appendChild(this.h),this.g.appendChild(this.i)}function n(e,t){e.g.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+t+";"}function i(e){var t=e.g.offsetWidth,r=t+100;return e.j.style.width=r+"px",e.i.scrollLeft=r,e.h.scrollLeft=e.h.scrollWidth+100,e.l!==t&&(e.l=t,!0)}function o(e,r){function n(){var e=o;i(e)&&null!==e.g.parentNode&&r(e.l)}var o=e;t(e.h,n),t(e.i,n),i(e)}function s(e,t,r){t=t||{},r=r||window,this.family=e,this.style=t.style||"normal",this.weight=t.weight||"normal",this.stretch=t.stretch||"normal",this.context=r}var a=null,c=null,l=null,u=null;function d(e){return null===u&&(u=!!e.document.fonts),u}function h(e,t){var r=e.style,n=e.weight;if(null===l){var i=document.createElement("div");try{i.style.font="condensed 100px sans-serif"}catch(e){}l=""!==i.style.font}return[r,n,l?e.stretch:"","100px",t].join(" ")}s.prototype.load=function(e,t){var i=this,s=e||"BESbswy",l=0,u=t||3e3,f=(new Date).getTime();return new Promise((function(e,t){if(d(i.context)&&!function(e){return null===c&&(d(e)&&/Apple/.test(window.navigator.vendor)?(e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent),c=!!e&&603>parseInt(e[1],10)):c=!1),c}(i.context)){var p=new Promise((function(e,t){!function r(){(new Date).getTime()-f>=u?t(Error(u+"ms timeout exceeded")):i.context.document.fonts.load(h(i,'"'+i.family+'"'),s).then((function(t){1<=t.length?e():setTimeout(r,25)}),t)}()})),m=new Promise((function(e,t){l=setTimeout((function(){t(Error(u+"ms timeout exceeded"))}),u)}));Promise.race([m,p]).then((function(){clearTimeout(l),e(i)}),t)}else!function(e){document.body?e():document.addEventListener?document.addEventListener("DOMContentLoaded",(function t(){document.removeEventListener("DOMContentLoaded",t),e()})):document.attachEvent("onreadystatechange",(function t(){"interactive"!=document.readyState&&"complete"!=document.readyState||(document.detachEvent("onreadystatechange",t),e())}))}((function(){function c(){var t;(t=-1!=v&&-1!=g||-1!=v&&-1!=_||-1!=g&&-1!=_)&&((t=v!=g&&v!=_&&g!=_)||(null===a&&(t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),a=!!t&&(536>parseInt(t[1],10)||536===parseInt(t[1],10)&&11>=parseInt(t[2],10))),t=a&&(v==y&&g==y&&_==y||v==b&&g==b&&_==b||v==w&&g==w&&_==w)),t=!t),t&&(null!==k.parentNode&&k.parentNode.removeChild(k),clearTimeout(l),e(i))}var d=new r(s),p=new r(s),m=new r(s),v=-1,g=-1,_=-1,y=-1,b=-1,w=-1,k=document.createElement("div");k.dir="ltr",n(d,h(i,"sans-serif")),n(p,h(i,"serif")),n(m,h(i,"monospace")),k.appendChild(d.g),k.appendChild(p.g),k.appendChild(m.g),i.context.document.body.appendChild(k),y=d.g.offsetWidth,b=p.g.offsetWidth,w=m.g.offsetWidth,function e(){if((new Date).getTime()-f>=u)null!==k.parentNode&&k.parentNode.removeChild(k),t(Error(u+"ms timeout exceeded"));else{var r=i.context.document.hidden;!0!==r&&void 0!==r||(v=d.g.offsetWidth,g=p.g.offsetWidth,_=m.g.offsetWidth,c()),l=setTimeout(e,50)}}(),o(d,(function(e){v=e,c()})),n(d,h(i,'"'+i.family+'",sans-serif')),o(p,(function(e){g=e,c()})),n(p,h(i,'"'+i.family+'",serif')),o(m,(function(e){_=e,c()})),n(m,h(i,'"'+i.family+'",monospace'))}))}))},e.exports=s}()}(fontfaceobserver_standalone$1);var fontfaceobserver_standaloneExports=fontfaceobserver_standalone$1.exports,FontFaceObserver=getDefaultExportFromCjs(fontfaceobserver_standaloneExports),build$1={},mqtt$3={},client={},mqtt$2={},bl$3={exports:{}},global$1="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}var cachedSetTimeout=defaultSetTimout,cachedClearTimeout=defaultClearTimeout;function runTimeout(e){if(cachedSetTimeout===setTimeout)return setTimeout(e,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(e,0);try{return cachedSetTimeout(e,0)}catch(t){try{return cachedSetTimeout.call(null,e,0)}catch(t){return cachedSetTimeout.call(this,e,0)}}}function runClearTimeout(e){if(cachedClearTimeout===clearTimeout)return clearTimeout(e);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(e);try{return cachedClearTimeout(e)}catch(t){try{return cachedClearTimeout.call(null,e)}catch(t){return cachedClearTimeout.call(this,e)}}}"function"==typeof global$1.setTimeout&&(cachedSetTimeout=setTimeout),"function"==typeof global$1.clearTimeout&&(cachedClearTimeout=clearTimeout);var queue=[],draining=!1,currentQueue,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var e=runTimeout(cleanUpNextTick);draining=!0;for(var t=queue.length;t;){for(currentQueue=queue,queue=[];++queueIndex<t;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,t=queue.length}currentQueue=null,draining=!1,runClearTimeout(e)}}function nextTick$3(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];queue.push(new Item(e,t)),1!==queue.length||draining||runTimeout(drainQueue)}function Item(e,t){this.fun=e,this.array=t}Item.prototype.run=function(){this.fun.apply(null,this.array)};var title="browser",platform$1="browser",browser$3=!0,env={},argv=[],version$3="",versions={},release$1={},config={};function noop(){}var on$1=noop,addListener=noop,once=noop,off=noop,removeListener=noop,removeAllListeners=noop,emit=noop;function binding$1(e){throw new Error("process.binding is not supported")}function cwd(){return"/"}function chdir(e){throw new Error("process.chdir is not supported")}function umask(){return 0}var performance$1=global$1.performance||{},performanceNow=performance$1.now||performance$1.mozNow||performance$1.msNow||performance$1.oNow||performance$1.webkitNow||function(){return(new Date).getTime()};function hrtime(e){var t=.001*performanceNow.call(performance$1),r=Math.floor(t),n=Math.floor(t%1*1e9);return e&&(r-=e[0],(n-=e[1])<0&&(r--,n+=1e9)),[r,n]}var startTime=new Date;function uptime$1(){return(new Date-startTime)/1e3}var browser$1$1={nextTick:nextTick$3,title:title,browser:browser$3,env:env,argv:argv,version:version$3,versions:versions,on:on$1,addListener:addListener,once:once,off:off,removeListener:removeListener,removeAllListeners:removeAllListeners,emit:emit,binding:binding$1,cwd:cwd,chdir:chdir,umask:umask,hrtime:hrtime,platform:platform$1,release:release$1,config:config,uptime:uptime$1},_polyfillNode_process=Object.freeze({__proto__:null,addListener:addListener,argv:argv,binding:binding$1,browser:browser$3,chdir:chdir,config:config,cwd:cwd,default:browser$1$1,emit:emit,env:env,hrtime:hrtime,nextTick:nextTick$3,off:off,on:on$1,once:once,platform:platform$1,release:release$1,removeAllListeners:removeAllListeners,removeListener:removeListener,title:title,umask:umask,uptime:uptime$1,version:version$3,versions:versions}),ours$1={exports:{}},domain;function EventHandlers(){}function EventEmitter$2(){EventEmitter$2.init.call(this)}function $getMaxListeners(e){return void 0===e._maxListeners?EventEmitter$2.defaultMaxListeners:e._maxListeners}function emitNone(e,t,r){if(t)e.call(r);else for(var n=e.length,i=arrayClone(e,n),o=0;o<n;++o)i[o].call(r)}function emitOne(e,t,r,n){if(t)e.call(r,n);else for(var i=e.length,o=arrayClone(e,i),s=0;s<i;++s)o[s].call(r,n)}function emitTwo(e,t,r,n,i){if(t)e.call(r,n,i);else for(var o=e.length,s=arrayClone(e,o),a=0;a<o;++a)s[a].call(r,n,i)}function emitThree(e,t,r,n,i,o){if(t)e.call(r,n,i,o);else for(var s=e.length,a=arrayClone(e,s),c=0;c<s;++c)a[c].call(r,n,i,o)}function emitMany(e,t,r,n){if(t)e.apply(r,n);else for(var i=e.length,o=arrayClone(e,i),s=0;s<i;++s)o[s].apply(r,n)}function _addListener(e,t,r,n){var i,o,s;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]):(o=e._events=new EventHandlers,e._eventsCount=0),s){if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(i=$getMaxListeners(e))&&i>0&&s.length>i){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=s.length,emitWarning$1(a)}}else s=o[t]=r,++e._eventsCount;return e}function emitWarning$1(e){"function"==typeof console.warn?console.warn(e):console.log(e)}function _onceWrap(e,t,r){var n=!1;function i(){e.removeListener(t,i),n||(n=!0,r.apply(e,arguments))}return i.listener=r,i}function listenerCount$1(e){var t=this._events;if(t){var r=t[e];if("function"==typeof r)return 1;if(r)return r.length}return 0}function spliceOne(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}function arrayClone(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function unwrapListeners(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}EventHandlers.prototype=Object.create(null),EventEmitter$2.EventEmitter=EventEmitter$2,EventEmitter$2.usingDomains=!1,EventEmitter$2.prototype.domain=void 0,EventEmitter$2.prototype._events=void 0,EventEmitter$2.prototype._maxListeners=void 0,EventEmitter$2.defaultMaxListeners=10,EventEmitter$2.init=function(){this.domain=null,EventEmitter$2.usingDomains&&(!domain.active||this instanceof domain.Domain||(this.domain=domain.active)),this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new EventHandlers,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},EventEmitter$2.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},EventEmitter$2.prototype.getMaxListeners=function(){return $getMaxListeners(this)},EventEmitter$2.prototype.emit=function(e){var t,r,n,i,o,s,a,c="error"===e;if(s=this._events)c=c&&null==s.error;else if(!c)return!1;if(a=this.domain,c){if(t=arguments[1],!a){if(t instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=a,t.domainThrown=!1,a.emit("error",t),!1}if(!(r=s[e]))return!1;var u="function"==typeof r;switch(n=arguments.length){case 1:emitNone(r,u,this);break;case 2:emitOne(r,u,this,arguments[1]);break;case 3:emitTwo(r,u,this,arguments[1],arguments[2]);break;case 4:emitThree(r,u,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(n-1),o=1;o<n;o++)i[o-1]=arguments[o];emitMany(r,u,this,i)}return!0},EventEmitter$2.prototype.addListener=function(e,t){return _addListener(this,e,t,!1)},EventEmitter$2.prototype.on=EventEmitter$2.prototype.addListener,EventEmitter$2.prototype.prependListener=function(e,t){return _addListener(this,e,t,!0)},EventEmitter$2.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,_onceWrap(this,e,t)),this},EventEmitter$2.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,_onceWrap(this,e,t)),this},EventEmitter$2.prototype.removeListener=function(e,t){var r,n,i,o,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(n=this._events))return this;if(!(r=n[e]))return this;if(r===t||r.listener&&r.listener===t)0==--this._eventsCount?this._events=new EventHandlers:(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length;o-- >0;)if(r[o]===t||r[o].listener&&r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;if(1===r.length){if(r[0]=void 0,0==--this._eventsCount)return this._events=new EventHandlers,this;delete n[e]}else spliceOne(r,i);n.removeListener&&this.emit("removeListener",e,s||t)}return this},EventEmitter$2.prototype.off=function(e,t){return this.removeListener(e,t)},EventEmitter$2.prototype.removeAllListeners=function(e){var t,r;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=new EventHandlers,this._eventsCount=0):r[e]&&(0==--this._eventsCount?this._events=new EventHandlers:delete r[e]),this;if(0===arguments.length){for(var n,i=Object.keys(r),o=0;o<i.length;++o)"removeListener"!==(n=i[o])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=new EventHandlers,this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},EventEmitter$2.prototype.listeners=function(e){var t,r=this._events;return r&&(t=r[e])?"function"==typeof t?[t.listener||t]:unwrapListeners(t):[]},EventEmitter$2.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):listenerCount$1.call(e,t)},EventEmitter$2.prototype.listenerCount=listenerCount$1,EventEmitter$2.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var _polyfillNode_events=Object.freeze({__proto__:null,default:EventEmitter$2,EventEmitter:EventEmitter$2}),lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,inited=!1;function init(){inited=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0;t<64;++t)lookup[t]=e[t],revLookup[e.charCodeAt(t)]=t;revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63}function toByteArray(e){var t,r,n,i,o,s;inited||init();var a=e.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o="="===e[a-2]?2:"="===e[a-1]?1:0,s=new Arr(3*a/4-o),n=o>0?a-4:a;var c=0;for(t=0,r=0;t<n;t+=4,r+=3)i=revLookup[e.charCodeAt(t)]<<18|revLookup[e.charCodeAt(t+1)]<<12|revLookup[e.charCodeAt(t+2)]<<6|revLookup[e.charCodeAt(t+3)],s[c++]=i>>16&255,s[c++]=i>>8&255,s[c++]=255&i;return 2===o?(i=revLookup[e.charCodeAt(t)]<<2|revLookup[e.charCodeAt(t+1)]>>4,s[c++]=255&i):1===o&&(i=revLookup[e.charCodeAt(t)]<<10|revLookup[e.charCodeAt(t+1)]<<4|revLookup[e.charCodeAt(t+2)]>>2,s[c++]=i>>8&255,s[c++]=255&i),s}function tripletToBase64(e){return lookup[e>>18&63]+lookup[e>>12&63]+lookup[e>>6&63]+lookup[63&e]}function encodeChunk(e,t,r){for(var n,i=[],o=t;o<r;o+=3)n=(e[o]<<16)+(e[o+1]<<8)+e[o+2],i.push(tripletToBase64(n));return i.join("")}function fromByteArray(e){var t;inited||init();for(var r=e.length,n=r%3,i="",o=[],s=16383,a=0,c=r-n;a<c;a+=s)o.push(encodeChunk(e,a,a+s>c?c:a+s));return 1===n?(t=e[r-1],i+=lookup[t>>2],i+=lookup[t<<4&63],i+="=="):2===n&&(t=(e[r-2]<<8)+e[r-1],i+=lookup[t>>10],i+=lookup[t>>4&63],i+=lookup[t<<2&63],i+="="),o.push(i),o.join("")}function read(e,t,r,n,i){var o,s,a=8*i-n-1,c=(1<<a)-1,l=c>>1,u=-7,d=r?i-1:0,h=r?-1:1,f=e[t+d];for(d+=h,o=f&(1<<-u)-1,f>>=-u,u+=a;u>0;o=256*o+e[t+d],d+=h,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=n;u>0;s=256*s+e[t+d],d+=h,u-=8);if(0===o)o=1-l;else{if(o===c)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),o-=l}return(f?-1:1)*s*Math.pow(2,o-n)}function write(e,t,r,n,i,o){var s,a,c,l=8*o-i-1,u=(1<<l)-1,d=u>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,p=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+d>=1?h/c:h*Math.pow(2,1-d))*c>=2&&(s++,c/=2),s+d>=u?(a=0,s=u):s+d>=1?(a=(t*c-1)*Math.pow(2,i),s+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;e[r+f]=255&a,f+=p,a/=256,i-=8);for(s=s<<i|a,l+=i;l>0;e[r+f]=255&s,f+=p,s/=256,l-=8);e[r+f-p]|=128*m}var toString={}.toString,isArray$2=Array.isArray||function(e){return"[object Array]"==toString.call(e)},INSPECT_MAX_BYTES=50;Buffer$4.TYPED_ARRAY_SUPPORT=void 0===global$1.TYPED_ARRAY_SUPPORT||global$1.TYPED_ARRAY_SUPPORT;var _kMaxLength=kMaxLength();function kMaxLength(){return Buffer$4.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(e,t){if(kMaxLength()<t)throw new RangeError("Invalid typed array length");return Buffer$4.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=Buffer$4.prototype:(null===e&&(e=new Buffer$4(t)),e.length=t),e}function Buffer$4(e,t,r){if(!(Buffer$4.TYPED_ARRAY_SUPPORT||this instanceof Buffer$4))return new Buffer$4(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,e)}return from(this,e,t,r)}function from(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?fromArrayBuffer(e,t,r,n):"string"==typeof t?fromString(e,t,r):fromObject(e,t)}function assertSize(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function alloc(e,t,r,n){return assertSize(t),t<=0?createBuffer(e,t):void 0!==r?"string"==typeof n?createBuffer(e,t).fill(r,n):createBuffer(e,t).fill(r):createBuffer(e,t)}function allocUnsafe(e,t){if(assertSize(t),e=createBuffer(e,t<0?0:0|checked(t)),!Buffer$4.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function fromString(e,t,r){if("string"==typeof r&&""!==r||(r="utf8"),!Buffer$4.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|byteLength$1(t,r),i=(e=createBuffer(e,n)).write(t,r);return i!==n&&(e=e.slice(0,i)),e}function fromArrayLike(e,t){var r=t.length<0?0:0|checked(t.length);e=createBuffer(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function fromArrayBuffer(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");return t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n),Buffer$4.TYPED_ARRAY_SUPPORT?(e=t).__proto__=Buffer$4.prototype:e=fromArrayLike(e,t),e}function fromObject(e,t){if(internalIsBuffer(t)){var r=0|checked(t.length);return 0===(e=createBuffer(e,r)).length||t.copy(e,0,0,r),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||isnan(t.length)?createBuffer(e,0):fromArrayLike(e,t);if("Buffer"===t.type&&isArray$2(t.data))return fromArrayLike(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(e){if(e>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|e}function SlowBuffer(e){return+e!=e&&(e=0),Buffer$4.alloc(+e)}function internalIsBuffer(e){return!(null==e||!e._isBuffer)}function byteLength$1(e,t){if(internalIsBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return utf8ToBytes(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return base64ToBytes(e).length;default:if(n)return utf8ToBytes(e).length;t=(""+t).toLowerCase(),n=!0}}function slowToString(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return hexSlice(this,t,r);case"utf8":case"utf-8":return utf8Slice(this,t,r);case"ascii":return asciiSlice(this,t,r);case"latin1":case"binary":return latin1Slice(this,t,r);case"base64":return base64Slice(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function swap(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function bidirectionalIndexOf(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=Buffer$4.from(t,n)),internalIsBuffer(t))return 0===t.length?-1:arrayIndexOf(e,t,r,n,i);if("number"==typeof t)return t&=255,Buffer$4.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):arrayIndexOf(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(e,t,r,n,i){var o,s=1,a=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,r/=2}function l(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var u=-1;for(o=r;o<a;o++)if(l(e,o)===l(t,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===c)return u*s}else-1!==u&&(o-=o-u),u=-1}else for(r+c>a&&(r=a-c),o=r;o>=0;o--){for(var d=!0,h=0;h<c;h++)if(l(e,o+h)!==l(t,h)){d=!1;break}if(d)return o}return-1}function hexWrite(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[r+s]=a}return s}function utf8Write(e,t,r,n){return blitBuffer(utf8ToBytes(t,e.length-r),e,r,n)}function asciiWrite(e,t,r,n){return blitBuffer(asciiToBytes(t),e,r,n)}function latin1Write(e,t,r,n){return asciiWrite(e,t,r,n)}function base64Write(e,t,r,n){return blitBuffer(base64ToBytes(t),e,r,n)}function ucs2Write(e,t,r,n){return blitBuffer(utf16leToBytes(t,e.length-r),e,r,n)}function base64Slice(e,t,r){return 0===t&&r===e.length?fromByteArray(e):fromByteArray(e.slice(t,r))}function utf8Slice(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,s,a,c,l=e[i],u=null,d=l>239?4:l>223?3:l>191?2:1;if(i+d<=r)switch(d){case 1:l<128&&(u=l);break;case 2:128==(192&(o=e[i+1]))&&(c=(31&l)<<6|63&o)>127&&(u=c);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(c=(15&l)<<12|(63&o)<<6|63&s)>2047&&(c<55296||c>57343)&&(u=c);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(c=(15&l)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(u=c)}null===u?(u=65533,d=1):u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),i+=d}return decodeCodePointsArray(n)}Buffer$4.poolSize=8192,Buffer$4._augment=function(e){return e.__proto__=Buffer$4.prototype,e},Buffer$4.from=function(e,t,r){return from(null,e,t,r)},Buffer$4.TYPED_ARRAY_SUPPORT&&(Buffer$4.prototype.__proto__=Uint8Array.prototype,Buffer$4.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&Buffer$4[Symbol.species]),Buffer$4.alloc=function(e,t,r){return alloc(null,e,t,r)},Buffer$4.allocUnsafe=function(e){return allocUnsafe(null,e)},Buffer$4.allocUnsafeSlow=function(e){return allocUnsafe(null,e)},Buffer$4.isBuffer=isBuffer$1,Buffer$4.compare=function(e,t){if(!internalIsBuffer(e)||!internalIsBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},Buffer$4.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer$4.concat=function(e,t){if(!isArray$2(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return Buffer$4.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=Buffer$4.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var o=e[r];if(!internalIsBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},Buffer$4.byteLength=byteLength$1,Buffer$4.prototype._isBuffer=!0,Buffer$4.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)swap(this,t,t+1);return this},Buffer$4.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)swap(this,t,t+3),swap(this,t+1,t+2);return this},Buffer$4.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)swap(this,t,t+7),swap(this,t+1,t+6),swap(this,t+2,t+5),swap(this,t+3,t+4);return this},Buffer$4.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?utf8Slice(this,0,e):slowToString.apply(this,arguments)},Buffer$4.prototype.equals=function(e){if(!internalIsBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===Buffer$4.compare(this,e)},Buffer$4.prototype.inspect=function(){var e="",t=INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},Buffer$4.prototype.compare=function(e,t,r,n,i){if(!internalIsBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0),a=Math.min(o,s),c=this.slice(n,i),l=e.slice(t,r),u=0;u<a;++u)if(c[u]!==l[u]){o=c[u],s=l[u];break}return o<s?-1:s<o?1:0},Buffer$4.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},Buffer$4.prototype.indexOf=function(e,t,r){return bidirectionalIndexOf(this,e,t,r,!0)},Buffer$4.prototype.lastIndexOf=function(e,t,r){return bidirectionalIndexOf(this,e,t,r,!1)},Buffer$4.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return hexWrite(this,e,t,r);case"utf8":case"utf-8":return utf8Write(this,e,t,r);case"ascii":return asciiWrite(this,e,t,r);case"latin1":case"binary":return latin1Write(this,e,t,r);case"base64":return base64Write(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},Buffer$4.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(e){var t=e.length;if(t<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=MAX_ARGUMENTS_LENGTH));return r}function asciiSlice(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function latin1Slice(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function hexSlice(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=toHex(e[o]);return i}function utf16leSlice(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function checkOffset(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function checkInt(e,t,r,n,i,o){if(!internalIsBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function objectWriteUInt16(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function objectWriteUInt32(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function checkIEEE754(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function writeFloat(e,t,r,n,i){return i||checkIEEE754(e,t,r,4),write(e,t,r,n,23,4),r+4}function writeDouble(e,t,r,n,i){return i||checkIEEE754(e,t,r,8),write(e,t,r,n,52,8),r+8}Buffer$4.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),Buffer$4.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=Buffer$4.prototype;else{var i=t-e;r=new Buffer$4(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+e]}return r},Buffer$4.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||checkOffset(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},Buffer$4.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||checkOffset(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},Buffer$4.prototype.readUInt8=function(e,t){return t||checkOffset(e,1,this.length),this[e]},Buffer$4.prototype.readUInt16LE=function(e,t){return t||checkOffset(e,2,this.length),this[e]|this[e+1]<<8},Buffer$4.prototype.readUInt16BE=function(e,t){return t||checkOffset(e,2,this.length),this[e]<<8|this[e+1]},Buffer$4.prototype.readUInt32LE=function(e,t){return t||checkOffset(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Buffer$4.prototype.readUInt32BE=function(e,t){return t||checkOffset(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Buffer$4.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||checkOffset(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},Buffer$4.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||checkOffset(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},Buffer$4.prototype.readInt8=function(e,t){return t||checkOffset(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},Buffer$4.prototype.readInt16LE=function(e,t){t||checkOffset(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},Buffer$4.prototype.readInt16BE=function(e,t){t||checkOffset(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},Buffer$4.prototype.readInt32LE=function(e,t){return t||checkOffset(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Buffer$4.prototype.readInt32BE=function(e,t){return t||checkOffset(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Buffer$4.prototype.readFloatLE=function(e,t){return t||checkOffset(e,4,this.length),read(this,e,!0,23,4)},Buffer$4.prototype.readFloatBE=function(e,t){return t||checkOffset(e,4,this.length),read(this,e,!1,23,4)},Buffer$4.prototype.readDoubleLE=function(e,t){return t||checkOffset(e,8,this.length),read(this,e,!0,52,8)},Buffer$4.prototype.readDoubleBE=function(e,t){return t||checkOffset(e,8,this.length),read(this,e,!1,52,8)},Buffer$4.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||checkInt(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},Buffer$4.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||checkInt(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},Buffer$4.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,1,255,0),Buffer$4.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},Buffer$4.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,2,65535,0),Buffer$4.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):objectWriteUInt16(this,e,t,!0),t+2},Buffer$4.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,2,65535,0),Buffer$4.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):objectWriteUInt16(this,e,t,!1),t+2},Buffer$4.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,4,4294967295,0),Buffer$4.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):objectWriteUInt32(this,e,t,!0),t+4},Buffer$4.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,4,4294967295,0),Buffer$4.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):objectWriteUInt32(this,e,t,!1),t+4},Buffer$4.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);checkInt(this,e,t,r,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<r&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},Buffer$4.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);checkInt(this,e,t,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},Buffer$4.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,1,127,-128),Buffer$4.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},Buffer$4.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,2,32767,-32768),Buffer$4.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):objectWriteUInt16(this,e,t,!0),t+2},Buffer$4.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,2,32767,-32768),Buffer$4.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):objectWriteUInt16(this,e,t,!1),t+2},Buffer$4.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,4,2147483647,-2147483648),Buffer$4.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):objectWriteUInt32(this,e,t,!0),t+4},Buffer$4.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),Buffer$4.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):objectWriteUInt32(this,e,t,!1),t+4},Buffer$4.prototype.writeFloatLE=function(e,t,r){return writeFloat(this,e,t,!0,r)},Buffer$4.prototype.writeFloatBE=function(e,t,r){return writeFloat(this,e,t,!1,r)},Buffer$4.prototype.writeDoubleLE=function(e,t,r){return writeDouble(this,e,t,!0,r)},Buffer$4.prototype.writeDoubleBE=function(e,t,r){return writeDouble(this,e,t,!1,r)},Buffer$4.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;i>=0;--i)e[i+t]=this[i+r];else if(o<1e3||!Buffer$4.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},Buffer$4.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!Buffer$4.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var s=internalIsBuffer(e)?e:utf8ToBytes(new Buffer$4(e,n).toString()),a=s.length;for(o=0;o<r-t;++o)this[o+t]=s[o%a]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g;function base64clean(e){if((e=stringtrim(e).replace(INVALID_BASE64_RE,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function stringtrim(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function toHex(e){return e<16?"0"+e.toString(16):e.toString(16)}function utf8ToBytes(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function asciiToBytes(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function utf16leToBytes(e,t){for(var r,n,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)n=(r=e.charCodeAt(s))>>8,i=r%256,o.push(i),o.push(n);return o}function base64ToBytes(e){return toByteArray(base64clean(e))}function blitBuffer(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function isnan(e){return e!=e}function isBuffer$1(e){return null!=e&&(!!e._isBuffer||isFastBuffer(e)||isSlowBuffer(e))}function isFastBuffer(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function isSlowBuffer(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&isFastBuffer(e.slice(0,0))}var _polyfillNode_buffer=Object.freeze({__proto__:null,Buffer:Buffer$4,INSPECT_MAX_BYTES:INSPECT_MAX_BYTES,SlowBuffer:SlowBuffer,isBuffer:isBuffer$1,kMaxLength:_kMaxLength}),inherits$3;inherits$3="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e};var inherits$4=inherits$3,getOwnPropertyDescriptors=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},formatRegExp=/%[sdj%]/g;function format$1(e){if(!isString(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(inspect$2(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,i=n.length,o=String(e).replace(formatRegExp,(function(e){if("%%"===e)return"%";if(r>=i)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}})),s=n[r];r<i;s=n[++r])isNull(s)||!isObject$1(s)?o+=" "+s:o+=" "+inspect$2(s);return o}function deprecate(e,t){if(isUndefined(global$1.process))return function(){return deprecate(e,t).apply(this,arguments)};if(!0===browser$1$1.noDeprecation)return e;var r=!1;return function(){if(!r){if(browser$1$1.throwDeprecation)throw new Error(t);browser$1$1.traceDeprecation?console.trace(t):console.error(t),r=!0}return e.apply(this,arguments)}}var debugs={},debugEnviron;function debuglog(e){if(isUndefined(debugEnviron)&&(debugEnviron=browser$1$1.env.NODE_DEBUG||""),e=e.toUpperCase(),!debugs[e])if(new RegExp("\\b"+e+"\\b","i").test(debugEnviron)){debugs[e]=function(){var t=format$1.apply(null,arguments);console.error("%s %d: %s",e,0,t)}}else debugs[e]=function(){};return debugs[e]}function inspect$2(e,t){var r={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),isBoolean(t)?r.showHidden=t:t&&_extend(r,t),isUndefined(r.showHidden)&&(r.showHidden=!1),isUndefined(r.depth)&&(r.depth=2),isUndefined(r.colors)&&(r.colors=!1),isUndefined(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=stylizeWithColor),formatValue(r,e,r.depth)}function stylizeWithColor(e,t){var r=inspect$2.styles[t];return r?"["+inspect$2.colors[r][0]+"m"+e+"["+inspect$2.colors[r][1]+"m":e}function stylizeNoColor(e,t){return e}function arrayToHash(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}function formatValue(e,t,r){if(e.customInspect&&t&&isFunction$1(t.inspect)&&t.inspect!==inspect$2&&(!t.constructor||t.constructor.prototype!==t)){var n=t.inspect(r,e);return isString(n)||(n=formatValue(e,n,r)),n}var i=formatPrimitive(e,t);if(i)return i;var o=Object.keys(t),s=arrayToHash(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(t)),isError(t)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return formatError(t);if(0===o.length){if(isFunction$1(t)){var a=t.name?": "+t.name:"";return e.stylize("[Function"+a+"]","special")}if(isRegExp(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(isDate(t))return e.stylize(Date.prototype.toString.call(t),"date");if(isError(t))return formatError(t)}var c,l="",u=!1,d=["{","}"];(isArray$1(t)&&(u=!0,d=["[","]"]),isFunction$1(t))&&(l=" [Function"+(t.name?": "+t.name:"")+"]");return isRegExp(t)&&(l=" "+RegExp.prototype.toString.call(t)),isDate(t)&&(l=" "+Date.prototype.toUTCString.call(t)),isError(t)&&(l=" "+formatError(t)),0!==o.length||u&&0!=t.length?r<0?isRegExp(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),c=u?formatArray(e,t,r,s,o):o.map((function(n){return formatProperty(e,t,r,s,n,u)})),e.seen.pop(),reduceToSingleString(c,l,d)):d[0]+l+d[1]}function formatPrimitive(e,t){if(isUndefined(t))return e.stylize("undefined","undefined");if(isString(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return isNumber(t)?e.stylize(""+t,"number"):isBoolean(t)?e.stylize(""+t,"boolean"):isNull(t)?e.stylize("null","null"):void 0}function formatError(e){return"["+Error.prototype.toString.call(e)+"]"}function formatArray(e,t,r,n,i){for(var o=[],s=0,a=t.length;s<a;++s)hasOwnProperty$1(t,String(s))?o.push(formatProperty(e,t,r,n,String(s),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(formatProperty(e,t,r,n,i,!0))})),o}function formatProperty(e,t,r,n,i,o){var s,a,c;if((c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),hasOwnProperty$1(n,i)||(s="["+i+"]"),a||(e.seen.indexOf(c.value)<0?(a=isNull(r)?formatValue(e,c.value,null):formatValue(e,c.value,r-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),isUndefined(s)){if(o&&i.match(/^\d+$/))return a;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function reduceToSingleString(e,t,r){return e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}function isArray$1(e){return Array.isArray(e)}function isBoolean(e){return"boolean"==typeof e}function isNull(e){return null===e}function isNullOrUndefined(e){return null==e}function isNumber(e){return"number"==typeof e}function isString(e){return"string"==typeof e}function isSymbol(e){return"symbol"==typeof e}function isUndefined(e){return void 0===e}function isRegExp(e){return isObject$1(e)&&"[object RegExp]"===objectToString(e)}function isObject$1(e){return"object"==typeof e&&null!==e}function isDate(e){return isObject$1(e)&&"[object Date]"===objectToString(e)}function isError(e){return isObject$1(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction$1(e){return"function"==typeof e}function isPrimitive(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function isBuffer(e){return Buffer$4.isBuffer(e)}function objectToString(e){return Object.prototype.toString.call(e)}function pad(e){return e<10?"0"+e.toString(10):e.toString(10)}inspect$2.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect$2.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){var e=new Date,t=[pad(e.getHours()),pad(e.getMinutes()),pad(e.getSeconds())].join(":");return[e.getDate(),months[e.getMonth()],t].join(" ")}function log(){console.log("%s - %s",timestamp(),format$1.apply(null,arguments))}function _extend(e,t){if(!t||!isObject$1(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}function hasOwnProperty$1(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var kCustomPromisifiedSymbol="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function promisify(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(kCustomPromisifiedSymbol&&e[kCustomPromisifiedSymbol]){var t;if("function"!=typeof(t=e[kCustomPromisifiedSymbol]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,kCustomPromisifiedSymbol,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise((function(e,n){t=e,r=n})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(e,n){e?r(e):t(n)}));try{e.apply(this,i)}catch(e){r(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),kCustomPromisifiedSymbol&&Object.defineProperty(t,kCustomPromisifiedSymbol,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,getOwnPropertyDescriptors(e))}function callbackifyOnRejected(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}function callbackify(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],r=0;r<arguments.length;r++)t.push(arguments[r]);var n=t.pop();if("function"!=typeof n)throw new TypeError("The last argument must be of type Function");var i=this,o=function(){return n.apply(i,arguments)};e.apply(this,t).then((function(e){browser$1$1.nextTick(o.bind(null,null,e))}),(function(e){browser$1$1.nextTick(callbackifyOnRejected.bind(null,e,o))}))}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,getOwnPropertyDescriptors(e)),t}promisify.custom=kCustomPromisifiedSymbol;var _polyfillNode_util={inherits:inherits$4,_extend:_extend,log:log,isBuffer:isBuffer,isPrimitive:isPrimitive,isFunction:isFunction$1,isError:isError,isDate:isDate,isObject:isObject$1,isRegExp:isRegExp,isUndefined:isUndefined,isSymbol:isSymbol,isString:isString,isNumber:isNumber,isNullOrUndefined:isNullOrUndefined,isNull:isNull,isBoolean:isBoolean,isArray:isArray$1,inspect:inspect$2,deprecate:deprecate,format:format$1,debuglog:debuglog,promisify:promisify,callbackify:callbackify},_polyfillNode_util$1=Object.freeze({__proto__:null,format:format$1,deprecate:deprecate,debuglog:debuglog,inspect:inspect$2,isArray:isArray$1,isBoolean:isBoolean,isNull:isNull,isNullOrUndefined:isNullOrUndefined,isNumber:isNumber,isString:isString,isSymbol:isSymbol,isUndefined:isUndefined,isRegExp:isRegExp,isObject:isObject$1,isDate:isDate,isError:isError,isFunction:isFunction$1,isPrimitive:isPrimitive,isBuffer:isBuffer,log:log,inherits:inherits$4,_extend:_extend,promisify:promisify,callbackify:callbackify,default:_polyfillNode_util});function BufferList$3(){this.head=null,this.tail=null,this.length=0}BufferList$3.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},BufferList$3.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},BufferList$3.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},BufferList$3.prototype.clear=function(){this.head=this.tail=null,this.length=0},BufferList$3.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},BufferList$3.prototype.concat=function(e){if(0===this.length)return Buffer$4.alloc(0);if(1===this.length)return this.head.data;for(var t=Buffer$4.allocUnsafe(e>>>0),r=this.head,n=0;r;)r.data.copy(t,n),n+=r.data.length,r=r.next;return t};var isBufferEncoding=Buffer$4.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function assertEncoding(e){if(e&&!isBufferEncoding(e))throw new Error("Unknown encoding: "+e)}function StringDecoder(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),assertEncoding(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=utf16DetectIncompleteChar;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=base64DetectIncompleteChar;break;default:return void(this.write=passThroughWrite)}this.charBuffer=new Buffer$4(6),this.charReceived=0,this.charLength=0}function passThroughWrite(e){return e.toString(this.encoding)}function utf16DetectIncompleteChar(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function base64DetectIncompleteChar(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}StringDecoder.prototype.write=function(e){for(var t="";this.charLength;){var r=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";if(e=e.slice(r,e.length),!((i=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var n=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,n),n-=this.charReceived);var i;n=(t+=e.toString(this.encoding,0,n)).length-1;if((i=t.charCodeAt(n))>=55296&&i<=56319){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),e.copy(this.charBuffer,0,0,o),t.substring(0,n)}return t},StringDecoder.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var r=e[e.length-t];if(1==t&&r>>5==6){this.charLength=2;break}if(t<=2&&r>>4==14){this.charLength=3;break}if(t<=3&&r>>3==30){this.charLength=4;break}}this.charReceived=t},StringDecoder.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var r=this.charReceived,n=this.charBuffer,i=this.encoding;t+=n.slice(0,r).toString(i)}return t};var _polyfillNode_string_decoder=Object.freeze({__proto__:null,StringDecoder:StringDecoder});Readable.ReadableState=ReadableState;var debug$3=debuglog("stream");function prependListener(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}function listenerCount(e,t){return e.listeners(t).length}function ReadableState(e,t){e=e||{},this.objectMode=!!e.objectMode,t instanceof Duplex&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var r=e.highWaterMark,n=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.highWaterMark=~~this.highWaterMark,this.buffer=new BufferList$3,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(this.decoder=new StringDecoder(e.encoding),this.encoding=e.encoding)}function Readable(e){if(!(this instanceof Readable))return new Readable(e);this._readableState=new ReadableState(e,this),this.readable=!0,e&&"function"==typeof e.read&&(this._read=e.read),EventEmitter$2.call(this)}function readableAddChunk(e,t,r,n,i){var o=chunkInvalid(t,r);if(o)e.emit("error",o);else if(null===r)t.reading=!1,onEofChunk(e,t);else if(t.objectMode||r&&r.length>0)if(t.ended&&!i){var s=new Error("stream.push() after EOF");e.emit("error",s)}else if(t.endEmitted&&i){var a=new Error("stream.unshift() after end event");e.emit("error",a)}else{var c;!t.decoder||i||n||(r=t.decoder.write(r),c=!t.objectMode&&0===r.length),i||(t.reading=!1),c||(t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,i?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&emitReadable(e))),maybeReadMore(e,t)}else i||(t.reading=!1);return needMoreData(t)}function needMoreData(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}inherits$4(Readable,EventEmitter$2),Readable.prototype.push=function(e,t){var r=this._readableState;return r.objectMode||"string"!=typeof e||(t=t||r.defaultEncoding)!==r.encoding&&(e=Buffer$4.from(e,t),t=""),readableAddChunk(this,r,e,t,!1)},Readable.prototype.unshift=function(e){return readableAddChunk(this,this._readableState,e,"",!0)},Readable.prototype.isPaused=function(){return!1===this._readableState.flowing},Readable.prototype.setEncoding=function(e){return this._readableState.decoder=new StringDecoder(e),this._readableState.encoding=e,this};var MAX_HWM=8388608;function computeNewHighWaterMark(e){return e>=MAX_HWM?e=MAX_HWM:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function howMuchToRead(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=computeNewHighWaterMark(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function chunkInvalid(e,t){var r=null;return Buffer$4.isBuffer(t)||"string"==typeof t||null==t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r}function onEofChunk(e,t){if(!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,emitReadable(e)}}function emitReadable(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(debug$3("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?nextTick$3(emitReadable_,e):emitReadable_(e))}function emitReadable_(e){debug$3("emit readable"),e.emit("readable"),flow(e)}function maybeReadMore(e,t){t.readingMore||(t.readingMore=!0,nextTick$3(maybeReadMore_,e,t))}function maybeReadMore_(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(debug$3("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function pipeOnDrain(e){return function(){var t=e._readableState;debug$3("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&e.listeners("data").length&&(t.flowing=!0,flow(e))}}function nReadingNextTick(e){debug$3("readable nexttick read 0"),e.read(0)}function resume(e,t){t.resumeScheduled||(t.resumeScheduled=!0,nextTick$3(resume_,e,t))}function resume_(e,t){t.reading||(debug$3("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),flow(e),t.flowing&&!t.reading&&e.read(0)}function flow(e){var t=e._readableState;for(debug$3("flow",t.flowing);t.flowing&&null!==e.read(););}function fromList(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=fromListPartial(e,t.buffer,t.decoder),r);var r}function fromListPartial(e,t,r){var n;return e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?copyFromBufferString(e,t):copyFromBuffer(e,t),n}function copyFromBufferString(e,t){var r=t.head,n=1,i=r.data;for(e-=i.length;r=r.next;){var o=r.data,s=e>o.length?o.length:e;if(s===o.length?i+=o:i+=o.slice(0,e),0===(e-=s)){s===o.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(s));break}++n}return t.length-=n,i}function copyFromBuffer(e,t){var r=Buffer$4.allocUnsafe(e),n=t.head,i=1;for(n.data.copy(r),e-=n.data.length;n=n.next;){var o=n.data,s=e>o.length?o.length:e;if(o.copy(r,r.length-e,0,s),0===(e-=s)){s===o.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(s));break}++i}return t.length-=i,r}function endReadable(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,nextTick$3(endReadableNT,t,e))}function endReadableNT(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function forEach(e,t){for(var r=0,n=e.length;r<n;r++)t(e[r],r)}function indexOf(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function nop(){}function WriteReq(e,t,r){this.chunk=e,this.encoding=t,this.callback=r,this.next=null}function WritableState(e,t){Object.defineProperty(this,"buffer",{get:deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),e=e||{},this.objectMode=!!e.objectMode,t instanceof Duplex&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var r=e.highWaterMark,n=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var i=!1===e.decodeStrings;this.decodeStrings=!i,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){onwrite(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new CorkedRequest(this)}function Writable(e){if(!(this instanceof Writable||this instanceof Duplex))return new Writable(e);this._writableState=new WritableState(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev)),EventEmitter$2.call(this)}function writeAfterEnd(e,t){var r=new Error("write after end");e.emit("error",r),nextTick$3(t,r)}function validChunk(e,t,r,n){var i=!0,o=!1;return null===r?o=new TypeError("May not write null values to stream"):Buffer$4.isBuffer(r)||"string"==typeof r||void 0===r||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),nextTick$3(n,o),i=!1),i}function decodeChunk(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=Buffer$4.from(t,r)),t}function writeOrBuffer(e,t,r,n,i){r=decodeChunk(t,r,n),Buffer$4.isBuffer(r)&&(n="buffer");var o=t.objectMode?1:r.length;t.length+=o;var s=t.length<t.highWaterMark;if(s||(t.needDrain=!0),t.writing||t.corked){var a=t.lastBufferedRequest;t.lastBufferedRequest=new WriteReq(r,n,i),a?a.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else doWrite(e,t,!1,o,r,n,i);return s}function doWrite(e,t,r,n,i,o,s){t.writelen=n,t.writecb=s,t.writing=!0,t.sync=!0,r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function onwriteError(e,t,r,n,i){--t.pendingcb,r?nextTick$3(i,n):i(n),e._writableState.errorEmitted=!0,e.emit("error",n)}function onwriteStateUpdate(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function onwrite(e,t){var r=e._writableState,n=r.sync,i=r.writecb;if(onwriteStateUpdate(r),t)onwriteError(e,r,n,t,i);else{var o=needFinish(r);o||r.corked||r.bufferProcessing||!r.bufferedRequest||clearBuffer(e,r),n?nextTick$3(afterWrite,e,r,o,i):afterWrite(e,r,o,i)}}function afterWrite(e,t,r,n){r||onwriteDrain(e,t),t.pendingcb--,n(),finishMaybe(e,t)}function onwriteDrain(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function clearBuffer(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,i=new Array(n),o=t.corkedRequestsFree;o.entry=r;for(var s=0;r;)i[s]=r,r=r.next,s+=1;doWrite(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new CorkedRequest(t)}else{for(;r;){var a=r.chunk,c=r.encoding,l=r.callback;if(doWrite(e,t,!1,t.objectMode?1:a.length,a,c,l),r=r.next,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=r,t.bufferProcessing=!1}function needFinish(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function prefinish(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function finishMaybe(e,t){var r=needFinish(t);return r&&(0===t.pendingcb?(prefinish(e,t),t.finished=!0,e.emit("finish")):prefinish(e,t)),r}function endWritable(e,t,r){t.ending=!0,finishMaybe(e,t),r&&(t.finished?nextTick$3(r):e.once("finish",r)),t.ended=!0,e.writable=!1}function CorkedRequest(e){var t=this;this.next=null,this.entry=null,this.finish=function(r){var n=t.entry;for(t.entry=null;n;){var i=n.callback;e.pendingcb--,i(r),n=n.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}Readable.prototype.read=function(e){debug$3("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return debug$3("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?endReadable(this):emitReadable(this),null;if(0===(e=howMuchToRead(e,t))&&t.ended)return 0===t.length&&endReadable(this),null;var n,i=t.needReadable;return debug$3("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&debug$3("length less than watermark",i=!0),t.ended||t.reading?debug$3("reading or ended",i=!1):i&&(debug$3("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=howMuchToRead(r,t))),null===(n=e>0?fromList(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&endReadable(this)),null!==n&&this.emit("data",n),n},Readable.prototype._read=function(e){this.emit("error",new Error("not implemented"))},Readable.prototype.pipe=function(e,t){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e)}n.pipesCount+=1,debug$3("pipe count=%d opts=%j",n.pipesCount,t);var i=!t||!1!==t.end?s:l;function o(e){debug$3("onunpipe"),e===r&&l()}function s(){debug$3("onend"),e.end()}n.endEmitted?nextTick$3(i):r.once("end",i),e.on("unpipe",o);var a=pipeOnDrain(r);e.on("drain",a);var c=!1;function l(){debug$3("cleanup"),e.removeListener("close",f),e.removeListener("finish",p),e.removeListener("drain",a),e.removeListener("error",h),e.removeListener("unpipe",o),r.removeListener("end",s),r.removeListener("end",l),r.removeListener("data",d),c=!0,!n.awaitDrain||e._writableState&&!e._writableState.needDrain||a()}var u=!1;function d(t){debug$3("ondata"),u=!1,!1!==e.write(t)||u||((1===n.pipesCount&&n.pipes===e||n.pipesCount>1&&-1!==indexOf(n.pipes,e))&&!c&&(debug$3("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++,u=!0),r.pause())}function h(t){debug$3("onerror",t),m(),e.removeListener("error",h),0===listenerCount(e,"error")&&e.emit("error",t)}function f(){e.removeListener("finish",p),m()}function p(){debug$3("onfinish"),e.removeListener("close",f),m()}function m(){debug$3("unpipe"),r.unpipe(e)}return r.on("data",d),prependListener(e,"error",h),e.once("close",f),e.once("finish",p),e.emit("pipe",r),n.flowing||(debug$3("pipe resume"),r.resume()),e},Readable.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this)),this;if(!e){var r=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<n;i++)r[i].emit("unpipe",this);return this}var o=indexOf(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this)),this},Readable.prototype.on=function(e,t){var r=EventEmitter$2.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&emitReadable(this,n):nextTick$3(nReadingNextTick,this))}return r},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){var e=this._readableState;return e.flowing||(debug$3("resume"),e.flowing=!0,resume(this,e)),this},Readable.prototype.pause=function(){return debug$3("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug$3("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Readable.prototype.wrap=function(e){var t=this._readableState,r=!1,n=this;for(var i in e.on("end",(function(){if(debug$3("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&n.push(e)}n.push(null)})),e.on("data",(function(i){(debug$3("wrapped data"),t.decoder&&(i=t.decoder.write(i)),t.objectMode&&null==i)||(t.objectMode||i&&i.length)&&(n.push(i)||(r=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));return forEach(["error","close","destroy","pause","resume"],(function(t){e.on(t,n.emit.bind(n,t))})),n._read=function(t){debug$3("wrapped _read",t),r&&(r=!1,e.resume())},n},Readable._fromList=fromList,Writable.WritableState=WritableState,inherits$4(Writable,EventEmitter$2),WritableState.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Writable.prototype.write=function(e,t,r){var n=this._writableState,i=!1;return"function"==typeof t&&(r=t,t=null),Buffer$4.isBuffer(e)?t="buffer":t||(t=n.defaultEncoding),"function"!=typeof r&&(r=nop),n.ended?writeAfterEnd(this,r):validChunk(this,n,e,r)&&(n.pendingcb++,i=writeOrBuffer(this,n,e,t,r)),i},Writable.prototype.cork=function(){this._writableState.corked++},Writable.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||clearBuffer(this,e))},Writable.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Writable.prototype._write=function(e,t,r){r(new Error("not implemented"))},Writable.prototype._writev=null,Writable.prototype.end=function(e,t,r){var n=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||endWritable(this,n,r)},inherits$4(Duplex,Readable);for(var keys=Object.keys(Writable.prototype),v$1=0;v$1<keys.length;v$1++){var method=keys[v$1];Duplex.prototype[method]||(Duplex.prototype[method]=Writable.prototype[method])}function Duplex(e){if(!(this instanceof Duplex))return new Duplex(e);Readable.call(this,e),Writable.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",onend)}function onend(){this.allowHalfOpen||this._writableState.ended||nextTick$3(onEndNT,this)}function onEndNT(e){e.end()}function TransformState(e){this.afterTransform=function(t,r){return afterTransform(e,t,r)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function afterTransform(e,t,r){var n=e._transformState;n.transforming=!1;var i=n.writecb;if(!i)return e.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,n.writecb=null,null!=r&&e.push(r),i(t);var o=e._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&e._read(o.highWaterMark)}function Transform(e){if(!(this instanceof Transform))return new Transform(e);Duplex.call(this,e),this._transformState=new TransformState(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",(function(){"function"==typeof this._flush?this._flush((function(e){done(t,e)})):done(t)}))}function done(e,t){if(t)return e.emit("error",t);var r=e._writableState,n=e._transformState;if(r.length)throw new Error("Calling transform done when ws.length != 0");if(n.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}function PassThrough(e){if(!(this instanceof PassThrough))return new PassThrough(e);Transform.call(this,e)}function Stream(){EventEmitter$2.call(this)}inherits$4(Transform,Duplex),Transform.prototype.push=function(e,t){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,e,t)},Transform.prototype._transform=function(e,t,r){throw new Error("Not implemented")},Transform.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Transform.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},inherits$4(PassThrough,Transform),PassThrough.prototype._transform=function(e,t,r){r(null,e)},inherits$4(Stream,EventEmitter$2),Stream.Readable=Readable,Stream.Writable=Writable,Stream.Duplex=Duplex,Stream.Transform=Transform,Stream.PassThrough=PassThrough,Stream.Stream=Stream,Stream.prototype.pipe=function(e,t){var r=this;function n(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function i(){r.readable&&r.resume&&r.resume()}r.on("data",n),e.on("drain",i),e._isStdio||t&&!1===t.end||(r.on("end",s),r.on("close",a));var o=!1;function s(){o||(o=!0,e.end())}function a(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function c(e){if(l(),0===EventEmitter$2.listenerCount(this,"error"))throw e}function l(){r.removeListener("data",n),e.removeListener("drain",i),r.removeListener("end",s),r.removeListener("close",a),r.removeListener("error",c),e.removeListener("error",c),r.removeListener("end",l),r.removeListener("close",l),e.removeListener("close",l)}return r.on("error",c),e.on("error",c),r.on("end",l),r.on("close",l),e.on("close",l),e.emit("pipe",r),e};var _polyfillNode_stream=Object.freeze({__proto__:null,default:Stream,Readable:Readable,Writable:Writable,Duplex:Duplex,Transform:Transform,PassThrough:PassThrough,Stream:Stream}),require$$1$5=getAugmentedNamespace(_polyfillNode_stream),stream$2={exports:{}},require$$0$a=getAugmentedNamespace(_polyfillNode_buffer),primordials,hasRequiredPrimordials;function requirePrimordials(){if(hasRequiredPrimordials)return primordials;hasRequiredPrimordials=1;var e=function(e){function t(e){var r;if(_classCallCheck(this,t),!Array.isArray(e))throw new TypeError("Expected input to be an Array, got ".concat(_typeof(e)));for(var n="",i=0;i<e.length;i++)n+="    ".concat(e[i].stack,"\n");return(r=_callSuper(this,t,[n])).name="AggregateError",r.errors=e,r}return _inherits(t,e),_createClass(t)}(_wrapNativeSuper(Error));return primordials={AggregateError:e,ArrayIsArray:function(e){return Array.isArray(e)},ArrayPrototypeIncludes:function(e,t){return e.includes(t)},ArrayPrototypeIndexOf:function(e,t){return e.indexOf(t)},ArrayPrototypeJoin:function(e,t){return e.join(t)},ArrayPrototypeMap:function(e,t){return e.map(t)},ArrayPrototypePop:function(e,t){return e.pop(t)},ArrayPrototypePush:function(e,t){return e.push(t)},ArrayPrototypeSlice:function(e,t,r){return e.slice(t,r)},Error:Error,FunctionPrototypeCall:function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return e.call.apply(e,[t].concat(n))},FunctionPrototypeSymbolHasInstance:function(e,t){return Function.prototype[Symbol.hasInstance].call(e,t)},MathFloor:Math.floor,Number:Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties:function(e,t){return Object.defineProperties(e,t)},ObjectDefineProperty:function(e,t,r){return Object.defineProperty(e,t,r)},ObjectGetOwnPropertyDescriptor:function(e,t){return Object.getOwnPropertyDescriptor(e,t)},ObjectKeys:function(e){return Object.keys(e)},ObjectSetPrototypeOf:function(e,t){return Object.setPrototypeOf(e,t)},Promise:Promise,PromisePrototypeCatch:function(e,t){return e.catch(t)},PromisePrototypeThen:function(e,t,r){return e.then(t,r)},PromiseReject:function(e){return Promise.reject(e)},PromiseResolve:function(e){return Promise.resolve(e)},ReflectApply:Reflect.apply,RegExpPrototypeTest:function(e,t){return e.test(t)},SafeSet:Set,String:String,StringPrototypeSlice:function(e,t,r){return e.slice(t,r)},StringPrototypeToLowerCase:function(e){return e.toLowerCase()},StringPrototypeToUpperCase:function(e){return e.toUpperCase()},StringPrototypeTrim:function(e){return e.trim()},Symbol:Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet:function(e,t,r){return e.set(t,r)},Boolean:Boolean,Uint8Array:Uint8Array},primordials}var util$2={exports:{}},inspect$1,hasRequiredInspect,errors$1,hasRequiredErrors;function requireInspect(){return hasRequiredInspect||(hasRequiredInspect=1,inspect$1={format:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.replace(/%([sdifj])/g,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0];var i=t[1],o=r.shift();if("f"===i)return o.toFixed(6);if("j"===i)return JSON.stringify(o);if("s"===i&&"object"===_typeof(o)){var s=o.constructor!==Object?o.constructor.name:"";return"".concat(s," {}").trim()}return o.toString()}))},inspect:function(e){switch(_typeof(e)){case"string":if(e.includes("'")){if(!e.includes('"'))return'"'.concat(e,'"');if(!e.includes("`")&&!e.includes("${"))return"`".concat(e,"`")}return"'".concat(e,"'");case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return"".concat(String(e),"n");case"boolean":case"undefined":return String(e);case"object":return"{}"}}}),inspect$1}function requireErrors(){if(hasRequiredErrors)return errors$1;hasRequiredErrors=1;var e=requireInspect(),t=e.format,r=e.inspect,n=requirePrimordials().AggregateError,i=globalThis.AggregateError||n,o=Symbol("kIsNodeError"),s=["string","function","number","object","Function","Object","boolean","bigint","symbol"],a=/^([A-Z][a-z0-9]*)+$/,c={};function l(e,t){if(!e)throw new c.ERR_INTERNAL_ASSERTION(t)}function u(e){for(var t="",r=e.length,n="-"===e[0]?1:0;r>=n+4;r-=3)t="_".concat(e.slice(r-3,r)).concat(t);return"".concat(e.slice(0,r)).concat(t)}function d(e,r,n){if("function"==typeof r)return l(r.length<=n.length,"Code: ".concat(e,"; The provided arguments length (").concat(n.length,") does not match the required ones (").concat(r.length,").")),r.apply(void 0,_toConsumableArray(n));var i=(r.match(/%[dfijoOs]/g)||[]).length;return l(i===n.length,"Code: ".concat(e,"; The provided arguments length (").concat(n.length,") does not match the required ones (").concat(i,").")),0===n.length?r:t.apply(void 0,[r].concat(_toConsumableArray(n)))}function h(e,t,r){r||(r=Error);var n=function(r){function n(){_classCallCheck(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _callSuper(this,n,[d(e,t,i)])}return _inherits(n,r),_createClass(n,[{key:"toString",value:function(){return"".concat(this.name," [").concat(e,"]: ").concat(this.message)}}]),n}(r);Object.defineProperties(n.prototype,{name:{value:r.name,writable:!0,enumerable:!1,configurable:!0},toString:{value:function(){return"".concat(this.name," [").concat(e,"]: ").concat(this.message)},writable:!0,enumerable:!1,configurable:!0}}),n.prototype.code=e,n.prototype[o]=!0,c[e]=n}function f(e){var t="__node_internal_"+e.name;return Object.defineProperty(e,"name",{value:t}),e}var p=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The operation was aborted",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(_classCallCheck(this,t),void 0!==n&&"object"!==_typeof(n))throw new c.ERR_INVALID_ARG_TYPE("options","Object",n);return(e=_callSuper(this,t,[r,n])).code="ABORT_ERR",e.name="AbortError",e}return _inherits(t,e),_createClass(t)}(_wrapNativeSuper(Error));return h("ERR_ASSERTION","%s",Error),h("ERR_INVALID_ARG_TYPE",(function(e,t,n){l("string"==typeof e,"'name' must be a string"),Array.isArray(t)||(t=[t]);var i="The ";e.endsWith(" argument")?i+="".concat(e," "):i+='"'.concat(e,'" ').concat(e.includes(".")?"property":"argument"," "),i+="must be ";var o,c=[],u=[],d=[],h=_createForOfIteratorHelper(t);try{for(h.s();!(o=h.n()).done;){var f=o.value;l("string"==typeof f,"All expected entries have to be of type string"),s.includes(f)?c.push(f.toLowerCase()):a.test(f)?u.push(f):(l("object"!==f,'The value "object" should be written as "Object"'),d.push(f))}}catch(e){h.e(e)}finally{h.f()}if(u.length>0){var p=c.indexOf("object");-1!==p&&(c.splice(c,p,1),u.push("Object"))}if(c.length>0){switch(c.length){case 1:i+="of type ".concat(c[0]);break;case 2:i+="one of type ".concat(c[0]," or ").concat(c[1]);break;default:var m=c.pop();i+="one of type ".concat(c.join(", "),", or ").concat(m)}(u.length>0||d.length>0)&&(i+=" or ")}if(u.length>0){switch(u.length){case 1:i+="an instance of ".concat(u[0]);break;case 2:i+="an instance of ".concat(u[0]," or ").concat(u[1]);break;default:var v=u.pop();i+="an instance of ".concat(u.join(", "),", or ").concat(v)}d.length>0&&(i+=" or ")}switch(d.length){case 0:break;case 1:d[0].toLowerCase()!==d[0]&&(i+="an "),i+="".concat(d[0]);break;case 2:i+="one of ".concat(d[0]," or ").concat(d[1]);break;default:var g=d.pop();i+="one of ".concat(d.join(", "),", or ").concat(g)}if(null==n)i+=". Received ".concat(n);else if("function"==typeof n&&n.name)i+=". Received function ".concat(n.name);else if("object"===_typeof(n)){var _;if(null!==(_=n.constructor)&&void 0!==_&&_.name)i+=". Received an instance of ".concat(n.constructor.name);else{var y=r(n,{depth:-1});i+=". Received ".concat(y)}}else{var b=r(n,{colors:!1});b.length>25&&(b="".concat(b.slice(0,25),"...")),i+=". Received type ".concat(_typeof(n)," (").concat(b,")")}return i}),TypeError),h("ERR_INVALID_ARG_VALUE",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"is invalid",i=r(t);i.length>128&&(i=i.slice(0,128)+"...");var o=e.includes(".")?"property":"argument";return"The ".concat(o," '").concat(e,"' ").concat(n,". Received ").concat(i)}),TypeError),h("ERR_INVALID_RETURN_VALUE",(function(e,t,r){var n,i=null!=r&&null!==(n=r.constructor)&&void 0!==n&&n.name?"instance of ".concat(r.constructor.name):"type ".concat(_typeof(r));return"Expected ".concat(e,' to be returned from the "').concat(t,'"')+" function but got ".concat(i,".")}),TypeError),h("ERR_MISSING_ARGS",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n;l(t.length>0,"At least one arg needs to be specified");var i=t.length;switch(t=(Array.isArray(t)?t:[t]).map((function(e){return'"'.concat(e,'"')})).join(" or "),i){case 1:n+="The ".concat(t[0]," argument");break;case 2:n+="The ".concat(t[0]," and ").concat(t[1]," arguments");break;default:var o=t.pop();n+="The ".concat(t.join(", "),", and ").concat(o," arguments")}return"".concat(n," must be specified")}),TypeError),h("ERR_OUT_OF_RANGE",(function(e,t,n){var i;if(l(t,'Missing "range" argument'),Number.isInteger(n)&&Math.abs(n)>Math.pow(2,32))i=u(String(n));else if("bigint"==typeof n){i=String(n);var o=Math.pow(BigInt(2),BigInt(32));(n>o||n<-o)&&(i=u(i)),i+="n"}else i=r(n);return'The value of "'.concat(e,'" is out of range. It must be ').concat(t,". Received ").concat(i)}),RangeError),h("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),h("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),h("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),h("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),h("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),h("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),h("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),h("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),h("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),h("ERR_STREAM_WRITE_AFTER_END","write after end",Error),h("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),errors$1={AbortError:p,aggregateTwoErrors:f((function(e,t){if(e&&t&&e!==t){if(Array.isArray(t.errors))return t.errors.push(e),t;var r=new i([t,e],t.message);return r.code=t.code,r}return e||t})),hideStackFrames:f,codes:c},errors$1}
/**
   * @author Toru Nagashima <https://github.com/mysticatea>
   * @copyright 2015 Toru Nagashima. All rights reserved.
   * See LICENSE file in root directory for full license.
   */const privateData=new WeakMap,wrappers=new WeakMap;function pd(e){const t=privateData.get(e);return console.assert(null!=t,"'this' is expected an Event object, but got",e),t}function setCancelFlag(e){null==e.passiveListener?e.event.cancelable&&(e.canceled=!0,"function"==typeof e.event.preventDefault&&e.event.preventDefault()):"undefined"!=typeof console&&"function"==typeof console.error&&console.error("Unable to preventDefault inside passive event listener invocation.",e.passiveListener)}function Event(e,t){privateData.set(this,{eventTarget:e,event:t,eventPhase:2,currentTarget:e,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:t.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});const r=Object.keys(t);for(let e=0;e<r.length;++e){const t=r[e];t in this||Object.defineProperty(this,t,defineRedirectDescriptor(t))}}function defineRedirectDescriptor(e){return{get(){return pd(this).event[e]},set(t){pd(this).event[e]=t},configurable:!0,enumerable:!0}}function defineCallDescriptor(e){return{value(){const t=pd(this).event;return t[e].apply(t,arguments)},configurable:!0,enumerable:!0}}function defineWrapper(e,t){const r=Object.keys(t);if(0===r.length)return e;function n(t,r){e.call(this,t,r)}n.prototype=Object.create(e.prototype,{constructor:{value:n,configurable:!0,writable:!0}});for(let i=0;i<r.length;++i){const o=r[i];if(!(o in e.prototype)){const e="function"==typeof Object.getOwnPropertyDescriptor(t,o).value;Object.defineProperty(n.prototype,o,e?defineCallDescriptor(o):defineRedirectDescriptor(o))}}return n}function getWrapper(e){if(null==e||e===Object.prototype)return Event;let t=wrappers.get(e);return null==t&&(t=defineWrapper(getWrapper(Object.getPrototypeOf(e)),e),wrappers.set(e,t)),t}function wrapEvent(e,t){return new(getWrapper(Object.getPrototypeOf(t)))(e,t)}function isStopped(e){return pd(e).immediateStopped}function setEventPhase(e,t){pd(e).eventPhase=t}function setCurrentTarget(e,t){pd(e).currentTarget=t}function setPassiveListener(e,t){pd(e).passiveListener=t}Event.prototype={get type(){return pd(this).event.type},get target(){return pd(this).eventTarget},get currentTarget(){return pd(this).currentTarget},composedPath(){const e=pd(this).currentTarget;return null==e?[]:[e]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return pd(this).eventPhase},stopPropagation(){const e=pd(this);e.stopped=!0,"function"==typeof e.event.stopPropagation&&e.event.stopPropagation()},stopImmediatePropagation(){const e=pd(this);e.stopped=!0,e.immediateStopped=!0,"function"==typeof e.event.stopImmediatePropagation&&e.event.stopImmediatePropagation()},get bubbles(){return Boolean(pd(this).event.bubbles)},get cancelable(){return Boolean(pd(this).event.cancelable)},preventDefault(){setCancelFlag(pd(this))},get defaultPrevented(){return pd(this).canceled},get composed(){return Boolean(pd(this).event.composed)},get timeStamp(){return pd(this).timeStamp},get srcElement(){return pd(this).eventTarget},get cancelBubble(){return pd(this).stopped},set cancelBubble(e){if(!e)return;const t=pd(this);t.stopped=!0,"boolean"==typeof t.event.cancelBubble&&(t.event.cancelBubble=!0)},get returnValue(){return!pd(this).canceled},set returnValue(e){e||setCancelFlag(pd(this))},initEvent(){}},Object.defineProperty(Event.prototype,"constructor",{value:Event,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.Event&&(Object.setPrototypeOf(Event.prototype,window.Event.prototype),wrappers.set(window.Event.prototype,Event));const listenersMap=new WeakMap,CAPTURE=1,BUBBLE=2,ATTRIBUTE=3;function isObject(e){return null!==e&&"object"==typeof e}function getListeners(e){const t=listenersMap.get(e);if(null==t)throw new TypeError("'this' is expected an EventTarget object, but got another value.");return t}function defineEventAttributeDescriptor(e){return{get(){let t=getListeners(this).get(e);for(;null!=t;){if(t.listenerType===ATTRIBUTE)return t.listener;t=t.next}return null},set(t){"function"==typeof t||isObject(t)||(t=null);const r=getListeners(this);let n=null,i=r.get(e);for(;null!=i;)i.listenerType===ATTRIBUTE?null!==n?n.next=i.next:null!==i.next?r.set(e,i.next):r.delete(e):n=i,i=i.next;if(null!==t){const i={listener:t,listenerType:ATTRIBUTE,passive:!1,once:!1,next:null};null===n?r.set(e,i):n.next=i}},configurable:!0,enumerable:!0}}function defineEventAttribute(e,t){Object.defineProperty(e,`on${t}`,defineEventAttributeDescriptor(t))}function defineCustomEventTarget(e){function t(){EventTarget.call(this)}t.prototype=Object.create(EventTarget.prototype,{constructor:{value:t,configurable:!0,writable:!0}});for(let r=0;r<e.length;++r)defineEventAttribute(t.prototype,e[r]);return t}function EventTarget(){if(!(this instanceof EventTarget)){if(1===arguments.length&&Array.isArray(arguments[0]))return defineCustomEventTarget(arguments[0]);if(arguments.length>0){const e=new Array(arguments.length);for(let t=0;t<arguments.length;++t)e[t]=arguments[t];return defineCustomEventTarget(e)}throw new TypeError("Cannot call a class as a function")}listenersMap.set(this,new Map)}EventTarget.prototype={addEventListener(e,t,r){if(null==t)return;if("function"!=typeof t&&!isObject(t))throw new TypeError("'listener' should be a function or an object.");const n=getListeners(this),i=isObject(r),o=(i?Boolean(r.capture):Boolean(r))?CAPTURE:BUBBLE,s={listener:t,listenerType:o,passive:i&&Boolean(r.passive),once:i&&Boolean(r.once),next:null};let a=n.get(e);if(void 0===a)return void n.set(e,s);let c=null;for(;null!=a;){if(a.listener===t&&a.listenerType===o)return;c=a,a=a.next}c.next=s},removeEventListener(e,t,r){if(null==t)return;const n=getListeners(this),i=(isObject(r)?Boolean(r.capture):Boolean(r))?CAPTURE:BUBBLE;let o=null,s=n.get(e);for(;null!=s;){if(s.listener===t&&s.listenerType===i)return void(null!==o?o.next=s.next:null!==s.next?n.set(e,s.next):n.delete(e));o=s,s=s.next}},dispatchEvent(e){if(null==e||"string"!=typeof e.type)throw new TypeError('"event.type" should be a string.');const t=getListeners(this),r=e.type;let n=t.get(r);if(null==n)return!0;const i=wrapEvent(this,e);let o=null;for(;null!=n;){if(n.once?null!==o?o.next=n.next:null!==n.next?t.set(r,n.next):t.delete(r):o=n,setPassiveListener(i,n.passive?n.listener:null),"function"==typeof n.listener)try{n.listener.call(this,i)}catch(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e)}else n.listenerType!==ATTRIBUTE&&"function"==typeof n.listener.handleEvent&&n.listener.handleEvent(i);if(isStopped(i))break;n=n.next}return setPassiveListener(i,null),setEventPhase(i,0),setCurrentTarget(i,null),!i.defaultPrevented}},Object.defineProperty(EventTarget.prototype,"constructor",{value:EventTarget,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.EventTarget&&Object.setPrototypeOf(EventTarget.prototype,window.EventTarget.prototype);class AbortSignal extends EventTarget{constructor(){throw super(),new TypeError("AbortSignal cannot be constructed directly")}get aborted(){const e=abortedFlags.get(this);if("boolean"!=typeof e)throw new TypeError("Expected 'this' to be an 'AbortSignal' object, but got "+(null===this?"null":typeof this));return e}}function createAbortSignal(){const e=Object.create(AbortSignal.prototype);return EventTarget.call(e),abortedFlags.set(e,!1),e}function abortSignal(e){!1===abortedFlags.get(e)&&(abortedFlags.set(e,!0),e.dispatchEvent({type:"abort"}))}defineEventAttribute(AbortSignal.prototype,"abort");const abortedFlags=new WeakMap;Object.defineProperties(AbortSignal.prototype,{aborted:{enumerable:!0}}),"function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(AbortSignal.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortSignal"});class AbortController{constructor(){signals.set(this,createAbortSignal())}get signal(){return getSignal(this)}abort(){abortSignal(getSignal(this))}}const signals=new WeakMap;function getSignal(e){const t=signals.get(e);if(null==t)throw new TypeError("Expected 'this' to be an 'AbortController' object, but got "+(null===e?"null":typeof e));return t}Object.defineProperties(AbortController.prototype,{signal:{enumerable:!0},abort:{enumerable:!0}}),"function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(AbortController.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortController"});var abortController=Object.freeze({__proto__:null,default:AbortController,AbortController:AbortController,AbortSignal:AbortSignal}),require$$0$9=getAugmentedNamespace(abortController),require$$0$8=getAugmentedNamespace(_polyfillNode_events),util$1=util$2.exports,hasRequiredUtil$1;function requireUtil$1(){return hasRequiredUtil$1||(hasRequiredUtil$1=1,function(e){var t=require$$0$a,r=requireInspect(),n=r.format,i=r.inspect,o=requireErrors().codes.ERR_INVALID_ARG_TYPE,s=requirePrimordials(),a=s.kResistStopPropagation,c=s.AggregateError,l=s.SymbolDispose,u=globalThis.AbortSignal||require$$0$9.AbortSignal,d=globalThis.AbortController||require$$0$9.AbortController,h=Object.getPrototypeOf(_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))).constructor,f=globalThis.Blob||t.Blob,p=void 0!==f?function(e){return e instanceof f}:function(e){return!1},m=function(e,t){if(void 0!==e&&(null===e||"object"!==_typeof(e)||!("aborted"in e)))throw new o(t,"AbortSignal",e)};e.exports={AggregateError:c,kEmptyObject:Object.freeze({}),once:function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}},createDeferredPromise:function(){var e,t;return{promise:new Promise((function(r,n){e=r,t=n})),resolve:e,reject:t}},promisify:function(e){return new Promise((function(t,r){e((function(e){if(e)return r(e);for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return t.apply(void 0,i)}))}))},debuglog:function(){return function(){}},format:n,inspect:i,types:{isAsyncFunction:function(e){return e instanceof h},isArrayBufferView:function(e){return ArrayBuffer.isView(e)}},isBlob:p,deprecate:function(e,t){return e},addAbortListener:require$$0$8.addAbortListener||function(e,t){if(void 0===e)throw new o("signal","AbortSignal",e);var r;return m(e,"signal"),function(e,t){if("function"!=typeof e)throw new o(t,"Function",e)}(t,"listener"),e.aborted?queueMicrotask((function(){return t()})):(e.addEventListener("abort",t,_defineProperty({__proto__:null,once:!0},a,!0)),r=function(){e.removeEventListener("abort",t)}),_defineProperty({__proto__:null},l,(function(){var e;null===(e=r)||void 0===e||e()}))},AbortSignalAny:u.any||function(e){if(1===e.length)return e[0];var t=new d,r=function(){return t.abort()};return e.forEach((function(e){m(e,"signals"),e.addEventListener("abort",r,{once:!0})})),t.signal.addEventListener("abort",(function(){e.forEach((function(e){return e.removeEventListener("abort",r)}))}),{once:!0}),t.signal}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")}(util$2)),util$2.exports}var operators={},validators,hasRequiredValidators;function requireValidators(){if(hasRequiredValidators)return validators;hasRequiredValidators=1;var e=requirePrimordials(),t=e.ArrayIsArray,r=e.ArrayPrototypeIncludes,n=e.ArrayPrototypeJoin,i=e.ArrayPrototypeMap,o=e.NumberIsInteger,s=e.NumberIsNaN,a=e.NumberMAX_SAFE_INTEGER,c=e.NumberMIN_SAFE_INTEGER,l=e.NumberParseInt,u=e.ObjectPrototypeHasOwnProperty,d=e.RegExpPrototypeExec,h=e.String,f=e.StringPrototypeToUpperCase,p=e.StringPrototypeTrim,m=requireErrors(),v=m.hideStackFrames,g=m.codes,_=g.ERR_SOCKET_BAD_PORT,y=g.ERR_INVALID_ARG_TYPE,b=g.ERR_INVALID_ARG_VALUE,w=g.ERR_OUT_OF_RANGE,k=g.ERR_UNKNOWN_SIGNAL,S=requireUtil$1().normalizeEncoding,E=requireUtil$1().types,C=E.isAsyncFunction,T=E.isArrayBufferView,P={};var A=/^[0-7]+$/;var x=v((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a;if("number"!=typeof e)throw new y(t,"number",e);if(!o(e))throw new w(t,"an integer",e);if(e<r||e>n)throw new w(t,">= ".concat(r," && <= ").concat(n),e)})),B=v((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-2147483648,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2147483647;if("number"!=typeof e)throw new y(t,"number",e);if(!o(e))throw new w(t,"an integer",e);if(e<r||e>n)throw new w(t,">= ".concat(r," && <= ").concat(n),e)})),I=v((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("number"!=typeof e)throw new y(t,"number",e);if(!o(e))throw new w(t,"an integer",e);var n=r?1:0,i=4294967295;if(e<n||e>i)throw new w(t,">= ".concat(n," && <= ").concat(i),e)}));function R(e,t){if("string"!=typeof e)throw new y(t,"string",e)}var O=v((function(e,t,o){if(!r(o,e)){var s=n(i(o,(function(e){return"string"==typeof e?"'".concat(e,"'"):h(e)})),", ");throw new b(t,e,"must be one of: "+s)}}));function M(e,t){if("boolean"!=typeof e)throw new y(t,"boolean",e)}function L(e,t,r){return null!=e&&u(e,t)?e[t]:r}var D=v((function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=L(n,"allowArray",!1),o=L(n,"allowFunction",!1);if(!L(n,"nullable",!1)&&null===e||!i&&t(e)||"object"!==_typeof(e)&&(!o||"function"!=typeof e))throw new y(r,"Object",e)})),N=v((function(e,t){if(null!=e&&"object"!==_typeof(e)&&"function"!=typeof e)throw new y(t,"a dictionary",e)})),F=v((function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!t(e))throw new y(r,"Array",e);if(e.length<n){var i="must be longer than ".concat(n);throw new b(r,e,i)}}));var $=v((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"buffer";if(!T(e))throw new y(t,["Buffer","TypedArray","DataView"],e)}));var U=v((function(e,t){if(void 0!==e&&(null===e||"object"!==_typeof(e)||!("aborted"in e)))throw new y(t,"AbortSignal",e)})),j=v((function(e,t){if("function"!=typeof e)throw new y(t,"Function",e)})),q=v((function(e,t){if("function"!=typeof e||C(e))throw new y(t,"Function",e)})),G=v((function(e,t){if(void 0!==e)throw new y(t,"undefined",e)}));var V=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function z(e,t){if(void 0===e||!d(V,e))throw new b(t,e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}return validators={isInt32:function(e){return e===(0|e)},isUint32:function(e){return e===e>>>0},parseFileMode:function(e,t,r){if(void 0===e&&(e=r),"string"==typeof e){if(null===d(A,e))throw new b(t,e,"must be a 32-bit unsigned integer or an octal string");e=l(e,8)}return I(e,t),e},validateArray:F,validateStringArray:function(e,t){F(e,t);for(var r=0;r<e.length;r++)R(e[r],"".concat(t,"[").concat(r,"]"))},validateBooleanArray:function(e,t){F(e,t);for(var r=0;r<e.length;r++)M(e[r],"".concat(t,"[").concat(r,"]"))},validateAbortSignalArray:function(e,t){F(e,t);for(var r=0;r<e.length;r++){var n=e[r],i="".concat(t,"[").concat(r,"]");if(null==n)throw new y(i,"AbortSignal",n);U(n,i)}},validateBoolean:M,validateBuffer:$,validateDictionary:N,validateEncoding:function(e,t){var r=S(t),n=e.length;if("hex"===r&&n%2!=0)throw new b("encoding",t,"is invalid for data of length ".concat(n))},validateFunction:j,validateInt32:B,validateInteger:x,validateNumber:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if("number"!=typeof e)throw new y(t,"number",e);if(null!=r&&e<r||null!=n&&e>n||(null!=r||null!=n)&&s(e))throw new w(t,"".concat(null!=r?">= ".concat(r):"").concat(null!=r&&null!=n?" && ":"").concat(null!=n?"<= ".concat(n):""),e)},validateObject:D,validateOneOf:O,validatePlainFunction:q,validatePort:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Port",r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if("number"!=typeof e&&"string"!=typeof e||"string"==typeof e&&0===p(e).length||+e!=+e>>>0||e>65535||0===e&&!r)throw new _(t,e,r);return 0|e},validateSignalName:function(e){if(R(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"signal"),void 0===P[e]){if(void 0!==P[f(e)])throw new k(e+" (signals must use all capital letters)");throw new k(e)}},validateString:R,validateUint32:I,validateUndefined:G,validateUnion:function(e,t,i){if(!r(i,e))throw new y(t,"('".concat(n(i,"|"),"')"),e)},validateAbortSignal:U,validateLinkHeaderValue:function(e){if("string"==typeof e)return z(e,"hints"),e;if(t(e)){var r=e.length,n="";if(0===r)return n;for(var i=0;i<r;i++){var o=e[i];z(o,"hints"),n+=o,i!==r-1&&(n+=", ")}return n}throw new b("hints",e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}},validators}var endOfStream$1={exports:{}},require$$0$7=getAugmentedNamespace(_polyfillNode_process),utils$1,hasRequiredUtils$1;function requireUtils$1(){if(hasRequiredUtils$1)return utils$1;hasRequiredUtils$1=1;var e=requirePrimordials(),t=e.SymbolAsyncIterator,r=e.SymbolIterator,n=e.SymbolFor,i=n("nodejs.stream.destroyed"),o=n("nodejs.stream.errored"),s=n("nodejs.stream.readable"),a=n("nodejs.stream.writable"),c=n("nodejs.stream.disturbed"),l=n("nodejs.webstream.isClosedPromise"),u=n("nodejs.webstream.controllerErrorFunction");function d(e){var t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!(!e||"function"!=typeof e.pipe||"function"!=typeof e.on||r&&("function"!=typeof e.pause||"function"!=typeof e.resume)||e._writableState&&!1===(null===(t=e._readableState)||void 0===t?void 0:t.readable)||e._writableState&&!e._readableState)}function h(e){var t;return!(!e||"function"!=typeof e.write||"function"!=typeof e.on||e._readableState&&!1===(null===(t=e._writableState)||void 0===t?void 0:t.writable))}function f(e){return e&&(e._readableState||e._writableState||"function"==typeof e.write&&"function"==typeof e.on||"function"==typeof e.pipe&&"function"==typeof e.on)}function p(e){return!(!e||f(e)||"function"!=typeof e.pipeThrough||"function"!=typeof e.getReader||"function"!=typeof e.cancel)}function m(e){return!(!e||f(e)||"function"!=typeof e.getWriter||"function"!=typeof e.abort)}function v(e){return!(!e||f(e)||"object"!==_typeof(e.readable)||"object"!==_typeof(e.writable))}function g(e){if(!f(e))return null;var t=e._writableState,r=e._readableState,n=t||r;return!!(e.destroyed||e[i]||null!=n&&n.destroyed)}function _(e){if(!h(e))return null;if(!0===e.writableEnded)return!0;var t=e._writableState;return(null==t||!t.errored)&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)}function y(e,t){if(!d(e))return null;var r=e._readableState;return(null==r||!r.errored)&&("boolean"!=typeof(null==r?void 0:r.endEmitted)?null:!!(r.endEmitted||!1===t&&!0===r.ended&&0===r.length))}function b(e){return e&&null!=e[s]?e[s]:"boolean"!=typeof(null==e?void 0:e.readable)?null:!g(e)&&(d(e)&&e.readable&&!y(e))}function w(e){return e&&null!=e[a]?e[a]:"boolean"!=typeof(null==e?void 0:e.writable)?null:!g(e)&&(h(e)&&e.writable&&!_(e))}function k(e){return"boolean"==typeof e._closed&&"boolean"==typeof e._defaultKeepAlive&&"boolean"==typeof e._removedConnection&&"boolean"==typeof e._removedContLen}function S(e){return"boolean"==typeof e._sent100&&k(e)}return utils$1={isDestroyed:g,kIsDestroyed:i,isDisturbed:function(e){var t;return!(!e||!(null!==(t=e[c])&&void 0!==t?t:e.readableDidRead||e.readableAborted))},kIsDisturbed:c,isErrored:function(e){var t,r,n,i,s,a,c,l,u,d;return!(!e||!(null!==(t=null!==(r=null!==(n=null!==(i=null!==(s=null!==(a=e[o])&&void 0!==a?a:e.readableErrored)&&void 0!==s?s:e.writableErrored)&&void 0!==i?i:null===(c=e._readableState)||void 0===c?void 0:c.errorEmitted)&&void 0!==n?n:null===(l=e._writableState)||void 0===l?void 0:l.errorEmitted)&&void 0!==r?r:null===(u=e._readableState)||void 0===u?void 0:u.errored)&&void 0!==t?t:null===(d=e._writableState)||void 0===d?void 0:d.errored))},kIsErrored:o,isReadable:b,kIsReadable:s,kIsClosedPromise:l,kControllerErrorFunction:u,kIsWritable:a,isClosed:function(e){if(!f(e))return null;if("boolean"==typeof e.closed)return e.closed;var t=e._writableState,r=e._readableState;return"boolean"==typeof(null==t?void 0:t.closed)||"boolean"==typeof(null==r?void 0:r.closed)?(null==t?void 0:t.closed)||(null==r?void 0:r.closed):"boolean"==typeof e._closed&&k(e)?e._closed:null},isDuplexNodeStream:function(e){return!(!e||"function"!=typeof e.pipe||!e._readableState||"function"!=typeof e.on||"function"!=typeof e.write)},isFinished:function(e,t){return f(e)?!!g(e)||(!1===(null==t?void 0:t.readable)||!b(e))&&(!1===(null==t?void 0:t.writable)||!w(e)):null},isIterable:function(e,n){return null!=e&&(!0===n?"function"==typeof e[t]:!1===n?"function"==typeof e[r]:"function"==typeof e[t]||"function"==typeof e[r])},isReadableNodeStream:d,isReadableStream:p,isReadableEnded:function(e){if(!d(e))return null;if(!0===e.readableEnded)return!0;var t=e._readableState;return!(!t||t.errored)&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)},isReadableFinished:y,isReadableErrored:function(e){var t,r;return f(e)?e.readableErrored?e.readableErrored:null!==(t=null===(r=e._readableState)||void 0===r?void 0:r.errored)&&void 0!==t?t:null:null},isNodeStream:f,isWebStream:function(e){return p(e)||m(e)||v(e)},isWritable:w,isWritableNodeStream:h,isWritableStream:m,isWritableEnded:_,isWritableFinished:function(e,t){if(!h(e))return null;if(!0===e.writableFinished)return!0;var r=e._writableState;return(null==r||!r.errored)&&("boolean"!=typeof(null==r?void 0:r.finished)?null:!!(r.finished||!1===t&&!0===r.ended&&0===r.length))},isWritableErrored:function(e){var t,r;return f(e)?e.writableErrored?e.writableErrored:null!==(t=null===(r=e._writableState)||void 0===r?void 0:r.errored)&&void 0!==t?t:null:null},isServerRequest:function(e){var t;return"boolean"==typeof e._consuming&&"boolean"==typeof e._dumped&&void 0===(null===(t=e.req)||void 0===t?void 0:t.upgradeOrConnect)},isServerResponse:S,willEmitClose:function(e){if(!f(e))return null;var t=e._writableState,r=e._readableState,n=t||r;return!n&&S(e)||!!(n&&n.autoDestroy&&n.emitClose&&!1===n.closed)},isTransformStream:v},utils$1}var endOfStream=endOfStream$1.exports,hasRequiredEndOfStream,destroy_1,hasRequiredDestroy,legacy,hasRequiredLegacy;function requireEndOfStream(){if(hasRequiredEndOfStream)return endOfStream$1.exports;hasRequiredEndOfStream=1;var e,t=require$$0$7,r=requireErrors(),n=r.AbortError,i=r.codes,o=i.ERR_INVALID_ARG_TYPE,s=i.ERR_STREAM_PREMATURE_CLOSE,a=requireUtil$1(),c=a.kEmptyObject,l=a.once,u=requireValidators(),d=u.validateAbortSignal,h=u.validateFunction,f=u.validateObject,p=u.validateBoolean,m=requirePrimordials(),v=m.Promise,g=m.PromisePrototypeThen,_=m.SymbolDispose,y=requireUtils$1(),b=y.isClosed,w=y.isReadable,k=y.isReadableNodeStream,S=y.isReadableStream,E=y.isReadableFinished,C=y.isReadableErrored,T=y.isWritable,P=y.isWritableNodeStream,A=y.isWritableStream,x=y.isWritableFinished,B=y.isWritableErrored,I=y.isNodeStream,R=y.willEmitClose,O=y.kIsClosedPromise;var M=function(){};function L(r,i,a){var u,p;if(2===arguments.length?(a=i,i=c):null==i?i=c:f(i,"options"),h(a,"callback"),d(i.signal,"options.signal"),a=l(a),S(r)||A(r))return function(r,i,o){var s=!1,a=M;if(i.signal)if(a=function(){s=!0,o.call(r,new n(void 0,{cause:i.signal.reason}))},i.signal.aborted)t.nextTick(a);else{var c=(e=e||requireUtil$1().addAbortListener)(i.signal,a),u=o;o=l((function(){c[_]();for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];u.apply(r,t)}))}var d=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];s||t.nextTick((function(){return o.apply(r,n)}))};return g(r[O].promise,d,d),M}(r,i,a);if(!I(r))throw new o("stream",["ReadableStream","WritableStream","Stream"],r);var m=null!==(u=i.readable)&&void 0!==u?u:k(r),v=null!==(p=i.writable)&&void 0!==p?p:P(r),y=r._writableState,L=r._readableState,D=function(){r.writable||$()},N=R(r)&&k(r)===m&&P(r)===v,F=x(r,!1),$=function(){F=!0,r.destroyed&&(N=!1),(!N||r.readable&&!m)&&(m&&!U||a.call(r))},U=E(r,!1),j=function(){U=!0,r.destroyed&&(N=!1),(!N||r.writable&&!v)&&(v&&!F||a.call(r))},q=function(e){a.call(r,e)},G=b(r),V=function(){G=!0;var e=B(r)||C(r);return e&&"boolean"!=typeof e?a.call(r,e):m&&!U&&k(r,!0)&&!E(r,!1)?a.call(r,new s):!v||F||x(r,!1)?void a.call(r):a.call(r,new s)},z=function(){G=!0;var e=B(r)||C(r);if(e&&"boolean"!=typeof e)return a.call(r,e);a.call(r)},H=function(){r.req.on("finish",$)};!function(e){return e.setHeader&&"function"==typeof e.abort}(r)?v&&!y&&(r.on("end",D),r.on("close",D)):(r.on("complete",$),N||r.on("abort",V),r.req?H():r.on("request",H)),N||"boolean"!=typeof r.aborted||r.on("aborted",V),r.on("end",j),r.on("finish",$),!1!==i.error&&r.on("error",q),r.on("close",V),G?t.nextTick(V):null!=y&&y.errorEmitted||null!=L&&L.errorEmitted?N||t.nextTick(z):(m||N&&!w(r)||!F&&!1!==T(r))&&(v||N&&!T(r)||!U&&!1!==w(r))?L&&r.req&&r.aborted&&t.nextTick(z):t.nextTick(z);var W=function(){a=M,r.removeListener("aborted",V),r.removeListener("complete",$),r.removeListener("abort",V),r.removeListener("request",H),r.req&&r.req.removeListener("finish",$),r.removeListener("end",D),r.removeListener("close",D),r.removeListener("finish",$),r.removeListener("end",j),r.removeListener("error",q),r.removeListener("close",V)};if(i.signal&&!G){var K=function(){var e=a;W(),e.call(r,new n(void 0,{cause:i.signal.reason}))};if(i.signal.aborted)t.nextTick(K);else{var Z=(e=e||requireUtil$1().addAbortListener)(i.signal,K),Y=a;a=l((function(){Z[_]();for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Y.apply(r,t)}))}}return W}return endOfStream$1.exports=L,endOfStream$1.exports.finished=function(e,t){var r,n=!1;return null===t&&(t=c),null!==(r=t)&&void 0!==r&&r.cleanup&&(p(t.cleanup,"cleanup"),n=t.cleanup),new v((function(r,i){var o=L(e,t,(function(e){n&&o(),e?i(e):r()}))}))},endOfStream$1.exports}function requireDestroy(){if(hasRequiredDestroy)return destroy_1;hasRequiredDestroy=1;var e=require$$0$7,t=requireErrors(),r=t.aggregateTwoErrors,n=t.codes.ERR_MULTIPLE_CALLBACK,i=t.AbortError,o=requirePrimordials().Symbol,s=requireUtils$1(),a=s.kIsDestroyed,c=s.isDestroyed,l=s.isFinished,u=s.isServerRequest,d=o("kDestroy"),h=o("kConstruct");function f(e,t,r){e&&(e.stack,t&&!t.errored&&(t.errored=e),r&&!r.errored&&(r.errored=e))}function p(t,r,n){var i=!1;function o(r){if(!i){i=!0;var o=t._readableState,s=t._writableState;f(r,s,o),s&&(s.closed=!0),o&&(o.closed=!0),"function"==typeof n&&n(r),r?e.nextTick(m,t,r):e.nextTick(v,t)}}try{t._destroy(r||null,o)}catch(r){o(r)}}function m(e,t){g(e,t),v(e)}function v(e){var t=e._readableState,r=e._writableState;r&&(r.closeEmitted=!0),t&&(t.closeEmitted=!0),(null!=r&&r.emitClose||null!=t&&t.emitClose)&&e.emit("close")}function g(e,t){var r=e._readableState,n=e._writableState;null!=n&&n.errorEmitted||null!=r&&r.errorEmitted||(n&&(n.errorEmitted=!0),r&&(r.errorEmitted=!0),e.emit("error",t))}function _(t,r,n){var i=t._readableState,o=t._writableState;if(null!=o&&o.destroyed||null!=i&&i.destroyed)return this;null!=i&&i.autoDestroy||null!=o&&o.autoDestroy?t.destroy(r):r&&(r.stack,o&&!o.errored&&(o.errored=r),i&&!i.errored&&(i.errored=r),n?e.nextTick(g,t,r):g(t,r))}function y(t){var r=!1;function i(i){if(r)_(t,null!=i?i:new n);else{r=!0;var o=t._readableState,s=t._writableState,a=s||o;o&&(o.constructed=!0),s&&(s.constructed=!0),a.destroyed?t.emit(d,i):i?_(t,i,!0):e.nextTick(b,t)}}try{t._construct((function(t){e.nextTick(i,t)}))}catch(t){e.nextTick(i,t)}}function b(e){e.emit(h)}function w(e){return(null==e?void 0:e.setHeader)&&"function"==typeof e.abort}function k(e){e.emit("close")}function S(t,r){t.emit("error",r),e.nextTick(k,t)}return destroy_1={construct:function(t,r){if("function"==typeof t._construct){var n=t._readableState,i=t._writableState;n&&(n.constructed=!1),i&&(i.constructed=!1),t.once(h,r),t.listenerCount(h)>1||e.nextTick(y,t)}},destroyer:function(t,r){t&&!c(t)&&(r||l(t)||(r=new i),u(t)?(t.socket=null,t.destroy(r)):w(t)?t.abort():w(t.req)?t.req.abort():"function"==typeof t.destroy?t.destroy(r):"function"==typeof t.close?t.close():r?e.nextTick(S,t,r):e.nextTick(k,t),t.destroyed||(t[a]=!0))},destroy:function(e,t){var n=this._readableState,i=this._writableState,o=i||n;return null!=i&&i.destroyed||null!=n&&n.destroyed?("function"==typeof t&&t(),this):(f(e,i,n),i&&(i.destroyed=!0),n&&(n.destroyed=!0),o.constructed?p(this,e,t):this.once(d,(function(n){p(this,r(n,e),t)})),this)},undestroy:function(){var e=this._readableState,t=this._writableState;e&&(e.constructed=!0,e.closed=!1,e.closeEmitted=!1,e.destroyed=!1,e.errored=null,e.errorEmitted=!1,e.reading=!1,e.ended=!1===e.readable,e.endEmitted=!1===e.readable),t&&(t.constructed=!0,t.destroyed=!1,t.closed=!1,t.closeEmitted=!1,t.errored=null,t.errorEmitted=!1,t.finalCalled=!1,t.prefinished=!1,t.ended=!1===t.writable,t.ending=!1===t.writable,t.finished=!1===t.writable)},errorOrDestroy:_},destroy_1}function requireLegacy(){if(hasRequiredLegacy)return legacy;hasRequiredLegacy=1;var e=requirePrimordials(),t=e.ArrayIsArray,r=e.ObjectSetPrototypeOf,n=require$$0$8.EventEmitter;function i(e){n.call(this,e)}function o(e,r,n){if("function"==typeof e.prependListener)return e.prependListener(r,n);e._events&&e._events[r]?t(e._events[r])?e._events[r].unshift(n):e._events[r]=[n,e._events[r]]:e.on(r,n)}return r(i.prototype,n.prototype),r(i,n),i.prototype.pipe=function(e,t){var r=this;function i(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function s(){r.readable&&r.resume&&r.resume()}r.on("data",i),e.on("drain",s),e._isStdio||t&&!1===t.end||(r.on("end",c),r.on("close",l));var a=!1;function c(){a||(a=!0,e.end())}function l(){a||(a=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){d(),0===n.listenerCount(this,"error")&&this.emit("error",e)}function d(){r.removeListener("data",i),e.removeListener("drain",s),r.removeListener("end",c),r.removeListener("close",l),r.removeListener("error",u),e.removeListener("error",u),r.removeListener("end",d),r.removeListener("close",d),e.removeListener("close",d)}return o(r,"error",u),o(e,"error",u),r.on("end",d),r.on("close",d),e.on("close",d),e.emit("pipe",r),e},legacy={Stream:i,prependListener:o}}var addAbortSignal$1={exports:{}},addAbortSignal=addAbortSignal$1.exports,hasRequiredAddAbortSignal,buffer_list,hasRequiredBuffer_list,state,hasRequiredState;function requireAddAbortSignal(){return hasRequiredAddAbortSignal||(hasRequiredAddAbortSignal=1,function(e){var t,r=requirePrimordials().SymbolDispose,n=requireErrors(),i=n.AbortError,o=n.codes,s=requireUtils$1(),a=s.isNodeStream,c=s.isWebStream,l=s.kControllerErrorFunction,u=requireEndOfStream(),d=o.ERR_INVALID_ARG_TYPE;e.exports.addAbortSignal=function(t,r){if(function(e,t){if("object"!==_typeof(e)||!("aborted"in e))throw new d(t,"AbortSignal",e)}(t,"signal"),!a(r)&&!c(r))throw new d("stream",["ReadableStream","WritableStream","Stream"],r);return e.exports.addAbortSignalNoValidate(t,r)},e.exports.addAbortSignalNoValidate=function(e,n){if("object"!==_typeof(e)||!("aborted"in e))return n;var o=a(n)?function(){n.destroy(new i(void 0,{cause:e.reason}))}:function(){n[l](new i(void 0,{cause:e.reason}))};if(e.aborted)o();else{var s=(t=t||requireUtil$1().addAbortListener)(e,o);u(n,s[r])}return n}}(addAbortSignal$1)),addAbortSignal$1.exports}function requireBuffer_list(){if(hasRequiredBuffer_list)return buffer_list;hasRequiredBuffer_list=1;var e=requirePrimordials(),t=e.StringPrototypeSlice,r=e.SymbolIterator,n=e.TypedArrayPrototypeSet,i=e.Uint8Array,o=require$$0$a.Buffer,s=requireUtil$1().inspect;return buffer_list=function(e){function a(){_classCallCheck(this,a),this.head=null,this.tail=null,this.length=0}return _createClass(a,[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;null!==(t=t.next);)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return o.alloc(0);for(var t=o.allocUnsafe(e>>>0),r=this.head,i=0;r;)n(t,r.data,i),i+=r.data.length,r=r.next;return t}},{key:"consume",value:function(e,t){var r=this.head.data;if(e<r.length){var n=r.slice(0,e);return this.head.data=r.slice(e),n}return e===r.length?this.shift():t?this._getString(e):this._getBuffer(e)}},{key:"first",value:function(){return this.head.data}},{key:r,value:_regeneratorRuntime().mark((function e(){var t;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.head;case 1:if(!t){e.next=7;break}return e.next=4,t.data;case 4:t=t.next,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))},{key:"_getString",value:function(e){var r="",n=this.head,i=0;do{var o=n.data;if(!(e>o.length)){e===o.length?(r+=o,++i,n.next?this.head=n.next:this.head=this.tail=null):(r+=t(o,0,e),this.head=n,n.data=t(o,e));break}r+=o,e-=o.length,++i}while(null!==(n=n.next));return this.length-=i,r}},{key:"_getBuffer",value:function(e){var t=o.allocUnsafe(e),r=e,s=this.head,a=0;do{var c=s.data;if(!(e>c.length)){e===c.length?(n(t,c,r-e),++a,s.next?this.head=s.next:this.head=this.tail=null):(n(t,new i(c.buffer,c.byteOffset,e),r-e),this.head=s,s.data=c.slice(e));break}n(t,c,r-e),e-=c.length,++a}while(null!==(s=s.next));return this.length-=a,t}},{key:e,value:function(e,t){return s(this,_objectSpread2(_objectSpread2({},t),{},{depth:0,customInspect:!1}))}}]),a}(Symbol.for("nodejs.util.inspect.custom")),buffer_list}function requireState(){if(hasRequiredState)return state;hasRequiredState=1;var e=requirePrimordials(),t=e.MathFloor,r=e.NumberIsInteger,n=requireValidators().validateInteger,i=requireErrors().codes.ERR_INVALID_ARG_VALUE,o=16384,s=16;function a(e){return e?s:o}return state={getHighWaterMark:function(e,n,o,s){var c=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(n,s,o);if(null!=c){if(!r(c)||c<0){var l=s?"options.".concat(o):"options.highWaterMark";throw new i(l,c)}return t(c)}return a(e.objectMode)},getDefaultHighWaterMark:a,setDefaultHighWaterMark:function(e,t){n(t,"value",0),e?s=t:o=t}},state}var require$$13=getAugmentedNamespace(_polyfillNode_string_decoder),from_1,hasRequiredFrom,readable,hasRequiredReadable,writable,hasRequiredWritable,duplexify,hasRequiredDuplexify,duplex,hasRequiredDuplex,transform,hasRequiredTransform,passthrough,hasRequiredPassthrough,pipeline_1,hasRequiredPipeline,compose,hasRequiredCompose,hasRequiredOperators,promises,hasRequiredPromises;function requireFrom(){if(hasRequiredFrom)return from_1;hasRequiredFrom=1;var e=require$$0$7,t=requirePrimordials(),r=t.PromisePrototypeThen,n=t.SymbolAsyncIterator,i=t.SymbolIterator,o=require$$0$a.Buffer,s=requireErrors().codes,a=s.ERR_INVALID_ARG_TYPE,c=s.ERR_STREAM_NULL_VALUES;return from_1=function(t,s,l){var u,d;if("string"==typeof s||s instanceof o)return new t(_objectSpread2(_objectSpread2({objectMode:!0},l),{},{read:function(){this.push(s),this.push(null)}}));if(s&&s[n])d=!0,u=s[n]();else{if(!s||!s[i])throw new a("iterable",["Iterable"],s);d=!1,u=s[i]()}var h=new t(_objectSpread2({objectMode:!0,highWaterMark:1},l)),f=!1;function p(){return p=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var r,n,i,o,s,a,c;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null!=t,n="function"==typeof u.throw,!r||!n){e.next=12;break}return e.next=5,u.throw(t);case 5:return i=e.sent,o=i.value,s=i.done,e.next=10,o;case 10:if(!s){e.next=12;break}return e.abrupt("return");case 12:if("function"!=typeof u.return){e.next=19;break}return e.next=15,u.return();case 15:return a=e.sent,c=a.value,e.next=19,c;case 19:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}function m(){return(m=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,r,n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!d){e.next=7;break}return e.next=4,u.next();case 4:e.t0=e.sent,e.next=8;break;case 7:e.t0=u.next();case 8:if(t=e.t0,r=t.value,!t.done){e.next=15;break}h.push(null),e.next=33;break;case 15:if(!r||"function"!=typeof r.then){e.next=21;break}return e.next=18,r;case 18:e.t1=e.sent,e.next=22;break;case 21:e.t1=r;case 22:if(null!==(n=e.t1)){e.next=28;break}throw f=!1,new c;case 28:if(!h.push(n)){e.next=32;break}return e.abrupt("continue",39);case 32:f=!1;case 33:e.next=38;break;case 35:e.prev=35,e.t2=e.catch(0),h.destroy(e.t2);case 38:return e.abrupt("break",41);case 39:e.next=0;break;case 41:case"end":return e.stop()}}),e,null,[[0,35]])})))).apply(this,arguments)}return h._read=function(){f||(f=!0,function(){m.apply(this,arguments)}())},h._destroy=function(t,n){r(function(e){return p.apply(this,arguments)}(t),(function(){return e.nextTick(n,t)}),(function(r){return e.nextTick(n,r||t)}))},h},from_1}function requireReadable(){if(hasRequiredReadable)return readable;hasRequiredReadable=1;var e=require$$0$7,t=requirePrimordials(),r=t.ArrayPrototypeIndexOf,n=t.NumberIsInteger,i=t.NumberIsNaN,o=t.NumberParseInt,s=t.ObjectDefineProperties,a=t.ObjectKeys,c=t.ObjectSetPrototypeOf,l=t.Promise,u=t.SafeSet,d=t.SymbolAsyncDispose,h=t.SymbolAsyncIterator,f=t.Symbol;readable=X,X.ReadableState=Y;var p=require$$0$8.EventEmitter,m=requireLegacy(),v=m.Stream,g=m.prependListener,_=require$$0$a.Buffer,y=requireAddAbortSignal().addAbortSignal,b=requireEndOfStream(),w=requireUtil$1().debuglog("stream",(function(e){w=e})),k=requireBuffer_list(),S=requireDestroy(),E=requireState(),C=E.getHighWaterMark,T=E.getDefaultHighWaterMark,P=requireErrors(),A=P.aggregateTwoErrors,x=P.codes,B=x.ERR_INVALID_ARG_TYPE,I=x.ERR_METHOD_NOT_IMPLEMENTED,R=x.ERR_OUT_OF_RANGE,O=x.ERR_STREAM_PUSH_AFTER_EOF,M=x.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,L=P.AbortError,D=requireValidators().validateObject,N=f("kPaused"),F=require$$13.StringDecoder,$=requireFrom();c(X.prototype,v.prototype),c(X,v);var U=function(){},j=S.errorOrDestroy,q=1,G=16,V=32,z=64,H=2048,W=4096,K=65536;function Z(e){return{enumerable:!1,get:function(){return 0!=(this.state&e)},set:function(t){t?this.state|=e:this.state&=~e}}}function Y(e,t,r){"boolean"!=typeof r&&(r=t instanceof requireDuplex()),this.state=H|W|G|V,e&&e.objectMode&&(this.state|=q),r&&e&&e.readableObjectMode&&(this.state|=q),this.highWaterMark=e?C(this,e,"readableHighWaterMark",r):T(!1),this.buffer=new k,this.length=0,this.pipes=[],this.flowing=null,this[N]=null,e&&!1===e.emitClose&&(this.state&=~H),e&&!1===e.autoDestroy&&(this.state&=~W),this.errored=null,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,e&&e.encoding&&(this.decoder=new F(e.encoding),this.encoding=e.encoding)}function X(e){var t=this;if(!(this instanceof X))return new X(e);var r=this instanceof requireDuplex();this._readableState=new Y(e,this,r),e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&!r&&y(e.signal,this)),v.call(this,e),S.construct(this,(function(){t._readableState.needReadable&&ie(t,t._readableState)}))}function Q(e,t,r,n){w("readableAddChunk",t);var i,o=e._readableState;if(0==(o.state&q)&&("string"==typeof t?(r=r||o.defaultEncoding,o.encoding!==r&&(n&&o.encoding?t=_.from(t,r).toString(o.encoding):(t=_.from(t,r),r=""))):t instanceof _?r="":v._isUint8Array(t)?(t=v._uint8ArrayToBuffer(t),r=""):null!=t&&(i=new B("chunk",["string","Buffer","Uint8Array"],t))),i)j(e,i);else if(null===t)o.state&=-9,function(e,t){if(w("onEofChunk"),t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?re(e):(t.needReadable=!1,t.emittedReadable=!0,ne(e))}(e,o);else if(0!=(o.state&q)||t&&t.length>0)if(n)if(0!=(4&o.state))j(e,new M);else{if(o.destroyed||o.errored)return!1;J(e,o,t,!0)}else if(o.ended)j(e,new O);else{if(o.destroyed||o.errored)return!1;o.state&=-9,o.decoder&&!r?(t=o.decoder.write(t),o.objectMode||0!==t.length?J(e,o,t,!1):ie(e,o)):J(e,o,t,!1)}else n||(o.state&=-9,ie(e,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function J(e,t,r,n){t.flowing&&0===t.length&&!t.sync&&e.listenerCount("data")>0?(0!=(t.state&K)?t.awaitDrainWriters.clear():t.awaitDrainWriters=null,t.dataEmitted=!0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),0!=(t.state&z)&&re(e)),ie(e,t)}s(Y.prototype,{objectMode:Z(q),ended:Z(2),endEmitted:Z(4),reading:Z(8),constructed:Z(G),sync:Z(V),needReadable:Z(z),emittedReadable:Z(128),readableListening:Z(256),resumeScheduled:Z(512),errorEmitted:Z(1024),emitClose:Z(H),autoDestroy:Z(W),destroyed:Z(8192),closed:Z(16384),closeEmitted:Z(32768),multiAwaitDrain:Z(K),readingMore:Z(1<<17),dataEmitted:Z(1<<18)}),X.prototype.destroy=S.destroy,X.prototype._undestroy=S.undestroy,X.prototype._destroy=function(e,t){t(e)},X.prototype[p.captureRejectionSymbol]=function(e){this.destroy(e)},X.prototype[d]=function(){var e,t=this;return this.destroyed||(e=this.readableEnded?null:new L,this.destroy(e)),new l((function(r,n){return b(t,(function(t){return t&&t!==e?n(t):r(null)}))}))},X.prototype.push=function(e,t){return Q(this,e,t,!1)},X.prototype.unshift=function(e,t){return Q(this,e,t,!0)},X.prototype.isPaused=function(){var e=this._readableState;return!0===e[N]||!1===e.flowing},X.prototype.setEncoding=function(e){var t=new F(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;var r,n=this._readableState.buffer,i="",o=_createForOfIteratorHelper(n);try{for(o.s();!(r=o.n()).done;){var s=r.value;i+=t.write(s)}}catch(e){o.e(e)}finally{o.f()}return n.clear(),""!==i&&n.push(i),this._readableState.length=i.length,this};var ee;function te(e,t){return e<=0||0===t.length&&t.ended?0:0!=(t.state&q)?1:i(e)?t.flowing&&t.length?t.buffer.first().length:t.length:e<=t.length?e:t.ended?t.length:0}function re(t){var r=t._readableState;w("emitReadable",r.needReadable,r.emittedReadable),r.needReadable=!1,r.emittedReadable||(w("emitReadable",r.flowing),r.emittedReadable=!0,e.nextTick(ne,t))}function ne(e){var t=e._readableState;w("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||t.errored||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,le(e)}function ie(t,r){!r.readingMore&&r.constructed&&(r.readingMore=!0,e.nextTick(oe,t,r))}function oe(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(w("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function se(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!1===t[N]?t.flowing=!0:e.listenerCount("data")>0?e.resume():t.readableListening||(t.flowing=null)}function ae(e){w("readable nexttick read 0"),e.read(0)}function ce(e,t){w("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),le(e),t.flowing&&!t.reading&&e.read(0)}function le(e){var t=e._readableState;for(w("flow",t.flowing);t.flowing&&null!==e.read(););}function ue(e,t){"function"!=typeof e.read&&(e=X.wrap(e,{objectMode:!0}));var r=function(e,t){return de.apply(this,arguments)}(e,t);return r.stream=e,r}function de(){return de=_wrapAsyncGenerator(_regeneratorRuntime().mark((function e(t,r){var n,i,o,s,a;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=function(e){this===t?(n(),n=U):n=e},n=U,t.on("readable",i),s=b(t,{writable:!1},(function(e){o=e?A(o,e):null,n(),n=U})),e.prev=4;case 5:if(null===(a=t.destroyed?null:t.read())){e.next=12;break}return e.next=10,a;case 10:e.next=22;break;case 12:if(!o){e.next=16;break}throw o;case 16:if(null!==o){e.next=20;break}return e.abrupt("return");case 20:return e.next=22,_awaitAsyncGenerator(new l(i));case 22:e.next=5;break;case 24:e.next=30;break;case 26:throw e.prev=26,e.t0=e.catch(4),o=A(o,e.t0);case 30:return e.prev=30,!o&&!1===(null==r?void 0:r.destroyOnReturn)||void 0!==o&&!t._readableState.autoDestroy?(t.off("readable",i),s()):S.destroyer(t,null),e.finish(30);case 33:case"end":return e.stop()}}),e,null,[[4,26,30,33]])}))),de.apply(this,arguments)}function he(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function fe(t){var r=t._readableState;w("endReadable",r.endEmitted),r.endEmitted||(r.ended=!0,e.nextTick(pe,r,t))}function pe(t,r){if(w("endReadableNT",t.endEmitted,t.length),!t.errored&&!t.closeEmitted&&!t.endEmitted&&0===t.length)if(t.endEmitted=!0,r.emit("end"),r.writable&&!1===r.allowHalfOpen)e.nextTick(me,r);else if(t.autoDestroy){var n=r._writableState;(!n||n.autoDestroy&&(n.finished||!1===n.writable))&&r.destroy()}}function me(e){e.writable&&!e.writableEnded&&!e.destroyed&&e.end()}function ve(){return void 0===ee&&(ee={}),ee}return X.prototype.read=function(e){w("read",e),void 0===e?e=NaN:n(e)||(e=o(e,10));var t=this._readableState,r=e;if(e>t.highWaterMark&&(t.highWaterMark=function(e){if(e>1073741824)throw new R("size","<= 1GiB",e);return e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,++e}(e)),0!==e&&(t.state&=-129),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return w("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?fe(this):re(this),null;if(0===(e=te(e,t))&&t.ended)return 0===t.length&&fe(this),null;var i,s=0!=(t.state&z);if(w("need readable",s),(0===t.length||t.length-e<t.highWaterMark)&&w("length less than watermark",s=!0),t.ended||t.reading||t.destroyed||t.errored||!t.constructed)w("reading, ended or constructing",s=!1);else if(s){w("do read"),t.state|=8|V,0===t.length&&(t.state|=z);try{this._read(t.highWaterMark)}catch(e){j(this,e)}t.state&=~V,t.reading||(e=te(r,t))}return null===(i=e>0?he(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.multiAwaitDrain?t.awaitDrainWriters.clear():t.awaitDrainWriters=null),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&fe(this)),null===i||t.errorEmitted||t.closeEmitted||(t.dataEmitted=!0,this.emit("data",i)),i},X.prototype._read=function(e){throw new I("_read()")},X.prototype.pipe=function(t,r){var n=this,i=this._readableState;1===i.pipes.length&&(i.multiAwaitDrain||(i.multiAwaitDrain=!0,i.awaitDrainWriters=new u(i.awaitDrainWriters?[i.awaitDrainWriters]:[]))),i.pipes.push(t),w("pipe count=%d opts=%j",i.pipes.length,r);var o,s=(!r||!1!==r.end)&&t!==e.stdout&&t!==e.stderr?c:v;function a(e,r){w("onunpipe"),e===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,function(){w("cleanup"),t.removeListener("close",p),t.removeListener("finish",m),o&&t.removeListener("drain",o);t.removeListener("error",f),t.removeListener("unpipe",a),n.removeListener("end",c),n.removeListener("end",v),n.removeListener("data",h),l=!0,o&&i.awaitDrainWriters&&(!t._writableState||t._writableState.needDrain)&&o()}())}function c(){w("onend"),t.end()}i.endEmitted?e.nextTick(s):n.once("end",s),t.on("unpipe",a);var l=!1;function d(){l||(1===i.pipes.length&&i.pipes[0]===t?(w("false write response, pause",0),i.awaitDrainWriters=t,i.multiAwaitDrain=!1):i.pipes.length>1&&i.pipes.includes(t)&&(w("false write response, pause",i.awaitDrainWriters.size),i.awaitDrainWriters.add(t)),n.pause()),o||(o=function(e,t){return function(){var r=e._readableState;r.awaitDrainWriters===t?(w("pipeOnDrain",1),r.awaitDrainWriters=null):r.multiAwaitDrain&&(w("pipeOnDrain",r.awaitDrainWriters.size),r.awaitDrainWriters.delete(t)),r.awaitDrainWriters&&0!==r.awaitDrainWriters.size||!e.listenerCount("data")||e.resume()}}(n,t),t.on("drain",o))}function h(e){w("ondata");var r=t.write(e);w("dest.write",r),!1===r&&d()}function f(e){if(w("onerror",e),v(),t.removeListener("error",f),0===t.listenerCount("error")){var r=t._writableState||t._readableState;r&&!r.errorEmitted?j(t,e):t.emit("error",e)}}function p(){t.removeListener("finish",m),v()}function m(){w("onfinish"),t.removeListener("close",p),v()}function v(){w("unpipe"),n.unpipe(t)}return n.on("data",h),g(t,"error",f),t.once("close",p),t.once("finish",m),t.emit("pipe",n),!0===t.writableNeedDrain?d():i.flowing||(w("pipe resume"),n.resume()),t},X.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipes.length)return this;if(!e){var n=t.pipes;t.pipes=[],this.pause();for(var i=0;i<n.length;i++)n[i].emit("unpipe",this,{hasUnpiped:!1});return this}var o=r(t.pipes,e);return-1===o||(t.pipes.splice(o,1),0===t.pipes.length&&this.pause(),e.emit("unpipe",this,{hasUnpiped:!1})),this},X.prototype.on=function(t,r){var n=v.prototype.on.call(this,t,r),i=this._readableState;return"data"===t?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===t&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,w("on readable",i.length,i.reading),i.length?re(this):i.reading||e.nextTick(ae,this))),n},X.prototype.addListener=X.prototype.on,X.prototype.removeListener=function(t,r){var n=v.prototype.removeListener.call(this,t,r);return"readable"===t&&e.nextTick(se,this),n},X.prototype.off=X.prototype.removeListener,X.prototype.removeAllListeners=function(t){var r=v.prototype.removeAllListeners.apply(this,arguments);return"readable"!==t&&void 0!==t||e.nextTick(se,this),r},X.prototype.resume=function(){var t=this._readableState;return t.flowing||(w("resume"),t.flowing=!t.readableListening,function(t,r){r.resumeScheduled||(r.resumeScheduled=!0,e.nextTick(ce,t,r))}(this,t)),t[N]=!1,this},X.prototype.pause=function(){return w("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(w("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[N]=!0,this},X.prototype.wrap=function(e){var t=this,r=!1;e.on("data",(function(n){!t.push(n)&&e.pause&&(r=!0,e.pause())})),e.on("end",(function(){t.push(null)})),e.on("error",(function(e){j(t,e)})),e.on("close",(function(){t.destroy()})),e.on("destroy",(function(){t.destroy()})),this._read=function(){r&&e.resume&&(r=!1,e.resume())};for(var n=a(e),i=1;i<n.length;i++){var o=n[i];void 0===this[o]&&"function"==typeof e[o]&&(this[o]=e[o].bind(e))}return this},X.prototype[h]=function(){return ue(this)},X.prototype.iterator=function(e){return void 0!==e&&D(e,"options"),ue(this,e)},s(X.prototype,{readable:{__proto__:null,get:function(){var e=this._readableState;return!(!e||!1===e.readable||e.destroyed||e.errorEmitted||e.endEmitted)},set:function(e){this._readableState&&(this._readableState.readable=!!e)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!(!1===this._readableState.readable||!this._readableState.destroyed&&!this._readableState.errored||this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}},readableLength:{__proto__:null,enumerable:!1,get:function(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get:function(){return!!this._readableState&&this._readableState.objectMode}},readableEncoding:{__proto__:null,enumerable:!1,get:function(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get:function(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get:function(){return!!this._readableState&&this._readableState.closed}},destroyed:{__proto__:null,enumerable:!1,get:function(){return!!this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}},readableEnded:{__proto__:null,enumerable:!1,get:function(){return!!this._readableState&&this._readableState.endEmitted}}}),s(Y.prototype,{pipesCount:{__proto__:null,get:function(){return this.pipes.length}},paused:{__proto__:null,get:function(){return!1!==this[N]},set:function(e){this[N]=!!e}}}),X._fromList=he,X.from=function(e,t){return $(X,e,t)},X.fromWeb=function(e,t){return ve().newStreamReadableFromReadableStream(e,t)},X.toWeb=function(e,t){return ve().newReadableStreamFromStreamReadable(e,t)},X.wrap=function(e,t){var r,n;return new X(_objectSpread2(_objectSpread2({objectMode:null===(r=null!==(n=e.readableObjectMode)&&void 0!==n?n:e.objectMode)||void 0===r||r},t),{},{destroy:function(t,r){S.destroyer(e,t),r(t)}})).wrap(e)},readable}function requireWritable(){if(hasRequiredWritable)return writable;hasRequiredWritable=1;var e=require$$0$7,t=requirePrimordials(),r=t.ArrayPrototypeSlice,n=t.Error,i=t.FunctionPrototypeSymbolHasInstance,o=t.ObjectDefineProperty,s=t.ObjectDefineProperties,a=t.ObjectSetPrototypeOf,c=t.StringPrototypeToLowerCase,l=t.Symbol,u=t.SymbolHasInstance;writable=M,M.WritableState=R;var d=require$$0$8.EventEmitter,h=requireLegacy().Stream,f=require$$0$a.Buffer,p=requireDestroy(),m=requireAddAbortSignal().addAbortSignal,v=requireState(),g=v.getHighWaterMark,_=v.getDefaultHighWaterMark,y=requireErrors().codes,b=y.ERR_INVALID_ARG_TYPE,w=y.ERR_METHOD_NOT_IMPLEMENTED,k=y.ERR_MULTIPLE_CALLBACK,S=y.ERR_STREAM_CANNOT_PIPE,E=y.ERR_STREAM_DESTROYED,C=y.ERR_STREAM_ALREADY_FINISHED,T=y.ERR_STREAM_NULL_VALUES,P=y.ERR_STREAM_WRITE_AFTER_END,A=y.ERR_UNKNOWN_ENCODING,x=p.errorOrDestroy;function B(){}a(M.prototype,h.prototype),a(M,h);var I=l("kOnFinished");function R(e,t,r){"boolean"!=typeof r&&(r=t instanceof requireDuplex()),this.objectMode=!(!e||!e.objectMode),r&&(this.objectMode=this.objectMode||!(!e||!e.writableObjectMode)),this.highWaterMark=e?g(this,e,"writableHighWaterMark",r):_(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var n=!(!e||!1!==e.decodeStrings);this.decodeStrings=!n,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=F.bind(void 0,t),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,O(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!e||!1!==e.emitClose,this.autoDestroy=!e||!1!==e.autoDestroy,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[I]=[]}function O(e){e.buffered=[],e.bufferedIndex=0,e.allBuffers=!0,e.allNoop=!0}function M(e){var t=this,r=this instanceof requireDuplex();if(!r&&!i(M,this))return new M(e);this._writableState=new R(e,this,r),e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&m(e.signal,this)),h.call(this,e),p.construct(this,(function(){var e=t._writableState;e.writing||q(t,e),z(t,e)}))}function L(t,r,n,i){var o,s=t._writableState;if("function"==typeof n)i=n,n=s.defaultEncoding;else{if(n){if("buffer"!==n&&!f.isEncoding(n))throw new A(n)}else n=s.defaultEncoding;"function"!=typeof i&&(i=B)}if(null===r)throw new T;if(!s.objectMode)if("string"==typeof r)!1!==s.decodeStrings&&(r=f.from(r,n),n="buffer");else if(r instanceof f)n="buffer";else{if(!h._isUint8Array(r))throw new b("chunk",["string","Buffer","Uint8Array"],r);r=h._uint8ArrayToBuffer(r),n="buffer"}return s.ending?o=new P:s.destroyed&&(o=new E("write")),o?(e.nextTick(i,o),x(t,o,!0),o):(s.pendingcb++,function(e,t,r,n,i){var o=t.objectMode?1:r.length;t.length+=o;var s=t.length<t.highWaterMark;s||(t.needDrain=!0);t.writing||t.corked||t.errored||!t.constructed?(t.buffered.push({chunk:r,encoding:n,callback:i}),t.allBuffers&&"buffer"!==n&&(t.allBuffers=!1),t.allNoop&&i!==B&&(t.allNoop=!1)):(t.writelen=o,t.writecb=i,t.writing=!0,t.sync=!0,e._write(r,n,t.onwrite),t.sync=!1);return s&&!t.errored&&!t.destroyed}(t,s,r,n,i))}function D(e,t,r,n,i,o,s){t.writelen=n,t.writecb=s,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new E("write")):r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function N(e,t,r,n){--t.pendingcb,n(r),j(t),x(e,r)}function F(t,r){var n=t._writableState,i=n.sync,o=n.writecb;"function"==typeof o?(n.writing=!1,n.writecb=null,n.length-=n.writelen,n.writelen=0,r?(r.stack,n.errored||(n.errored=r),t._readableState&&!t._readableState.errored&&(t._readableState.errored=r),i?e.nextTick(N,t,n,r,o):N(t,n,r,o)):(n.buffered.length>n.bufferedIndex&&q(t,n),i?null!==n.afterWriteTickInfo&&n.afterWriteTickInfo.cb===o?n.afterWriteTickInfo.count++:(n.afterWriteTickInfo={count:1,cb:o,stream:t,state:n},e.nextTick($,n.afterWriteTickInfo)):U(t,n,1,o))):x(t,new k)}function $(e){var t=e.stream,r=e.state,n=e.count,i=e.cb;return r.afterWriteTickInfo=null,U(t,r,n,i)}function U(e,t,r,n){for(!t.ending&&!e.destroyed&&0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"));r-- >0;)t.pendingcb--,n();t.destroyed&&j(t),z(e,t)}function j(e){if(!e.writing){for(var t=e.bufferedIndex;t<e.buffered.length;++t){var r,n=e.buffered[t],i=n.chunk,o=n.callback,s=e.objectMode?1:i.length;e.length-=s,o(null!==(r=e.errored)&&void 0!==r?r:new E("write"))}for(var a=e[I].splice(0),c=0;c<a.length;c++){var l;a[c](null!==(l=e.errored)&&void 0!==l?l:new E("end"))}O(e)}}function q(e,t){if(!(t.corked||t.bufferProcessing||t.destroyed)&&t.constructed){var n=t.buffered,i=t.bufferedIndex,o=t.objectMode,s=n.length-i;if(s){var a=i;if(t.bufferProcessing=!0,s>1&&e._writev){t.pendingcb-=s-1;var c=t.allNoop?B:function(e){for(var t=a;t<n.length;++t)n[t].callback(e)},l=t.allNoop&&0===a?n:r(n,a);l.allBuffers=t.allBuffers,D(e,t,!0,t.length,l,"",c),O(t)}else{do{var u=n[a],d=u.chunk,h=u.encoding,f=u.callback;n[a++]=null,D(e,t,!1,o?1:d.length,d,h,f)}while(a<n.length&&!t.writing);a===n.length?O(t):a>256?(n.splice(0,a),t.bufferedIndex=0):t.bufferedIndex=a}t.bufferProcessing=!1}}}function G(e){return e.ending&&!e.destroyed&&e.constructed&&0===e.length&&!e.errored&&0===e.buffered.length&&!e.finished&&!e.writing&&!e.errorEmitted&&!e.closeEmitted}function V(t,r){r.prefinished||r.finalCalled||("function"!=typeof t._final||r.destroyed?(r.prefinished=!0,t.emit("prefinish")):(r.finalCalled=!0,function(t,r){var n=!1;function i(i){if(n)x(t,null!=i?i:k());else if(n=!0,r.pendingcb--,i){for(var o=r[I].splice(0),s=0;s<o.length;s++)o[s](i);x(t,i,r.sync)}else G(r)&&(r.prefinished=!0,t.emit("prefinish"),r.pendingcb++,e.nextTick(H,t,r))}r.sync=!0,r.pendingcb++;try{t._final(i)}catch(e){i(e)}r.sync=!1}(t,r)))}function z(t,r,n){G(r)&&(V(t,r),0===r.pendingcb&&(n?(r.pendingcb++,e.nextTick((function(e,t){G(t)?H(e,t):t.pendingcb--}),t,r)):G(r)&&(r.pendingcb++,H(t,r))))}function H(e,t){t.pendingcb--,t.finished=!0;for(var r=t[I].splice(0),n=0;n<r.length;n++)r[n]();if(e.emit("finish"),t.autoDestroy){var i=e._readableState;(!i||i.autoDestroy&&(i.endEmitted||!1===i.readable))&&e.destroy()}}R.prototype.getBuffer=function(){return r(this.buffered,this.bufferedIndex)},o(R.prototype,"bufferedRequestCount",{__proto__:null,get:function(){return this.buffered.length-this.bufferedIndex}}),o(M,u,{__proto__:null,value:function(e){return!!i(this,e)||this===M&&(e&&e._writableState instanceof R)}}),M.prototype.pipe=function(){x(this,new S)},M.prototype.write=function(e,t,r){return!0===L(this,e,t,r)},M.prototype.cork=function(){this._writableState.corked++},M.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||q(this,e))},M.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=c(e)),!f.isEncoding(e))throw new A(e);return this._writableState.defaultEncoding=e,this},M.prototype._write=function(e,t,r){if(!this._writev)throw new w("_write()");this._writev([{chunk:e,encoding:t}],r)},M.prototype._writev=null,M.prototype.end=function(t,r,i){var o,s=this._writableState;if("function"==typeof t?(i=t,t=null,r=null):"function"==typeof r&&(i=r,r=null),null!=t){var a=L(this,t,r);a instanceof n&&(o=a)}return s.corked&&(s.corked=1,this.uncork()),o||(s.errored||s.ending?s.finished?o=new C("end"):s.destroyed&&(o=new E("end")):(s.ending=!0,z(this,s,!0),s.ended=!0)),"function"==typeof i&&(o||s.finished?e.nextTick(i,o):s[I].push(i)),this},s(M.prototype,{closed:{__proto__:null,get:function(){return!!this._writableState&&this._writableState.closed}},destroyed:{__proto__:null,get:function(){return!!this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}},writable:{__proto__:null,get:function(){var e=this._writableState;return!(!e||!1===e.writable||e.destroyed||e.errored||e.ending||e.ended)},set:function(e){this._writableState&&(this._writableState.writable=!!e)}},writableFinished:{__proto__:null,get:function(){return!!this._writableState&&this._writableState.finished}},writableObjectMode:{__proto__:null,get:function(){return!!this._writableState&&this._writableState.objectMode}},writableBuffer:{__proto__:null,get:function(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get:function(){return!!this._writableState&&this._writableState.ending}},writableNeedDrain:{__proto__:null,get:function(){var e=this._writableState;return!!e&&(!e.destroyed&&!e.ending&&e.needDrain)}},writableHighWaterMark:{__proto__:null,get:function(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get:function(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get:function(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get:function(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!(!1===this._writableState.writable||!this._writableState.destroyed&&!this._writableState.errored||this._writableState.finished)}}});var W,K=p.destroy;function Z(){return void 0===W&&(W={}),W}return M.prototype.destroy=function(t,r){var n=this._writableState;return!n.destroyed&&(n.bufferedIndex<n.buffered.length||n[I].length)&&e.nextTick(j,n),K.call(this,t,r),this},M.prototype._undestroy=p.undestroy,M.prototype._destroy=function(e,t){t(e)},M.prototype[d.captureRejectionSymbol]=function(e){this.destroy(e)},M.fromWeb=function(e,t){return Z().newStreamWritableFromWritableStream(e,t)},M.toWeb=function(e){return Z().newWritableStreamFromStreamWritable(e)},writable}function requireDuplexify(){if(hasRequiredDuplexify)return duplexify;hasRequiredDuplexify=1;var e=require$$0$7,t=require$$0$a,r=requireUtils$1(),n=r.isReadable,i=r.isWritable,o=r.isIterable,s=r.isNodeStream,a=r.isReadableNodeStream,c=r.isWritableNodeStream,l=r.isDuplexNodeStream,u=r.isReadableStream,d=r.isWritableStream,h=requireEndOfStream(),f=requireErrors(),p=f.AbortError,m=f.codes,v=m.ERR_INVALID_ARG_TYPE,g=m.ERR_INVALID_RETURN_VALUE,_=requireDestroy().destroyer,y=requireDuplex(),b=requireReadable(),w=requireWritable(),k=requireUtil$1().createDeferredPromise,S=requireFrom(),E=globalThis.Blob||t.Blob,C=void 0!==E?function(e){return e instanceof E}:function(e){return!1},T=globalThis.AbortController||require$$0$9.AbortController,P=requirePrimordials().FunctionPrototypeCall,A=function(e){function t(e){var r;return _classCallCheck(this,t),r=_callSuper(this,t,[e]),!1===(null==e?void 0:e.readable)&&(r._readableState.readable=!1,r._readableState.ended=!0,r._readableState.endEmitted=!0),!1===(null==e?void 0:e.writable)&&(r._writableState.writable=!1,r._writableState.ending=!0,r._writableState.ended=!0,r._writableState.finished=!0),r}return _inherits(t,e),_createClass(t)}(y);function x(e){var t,r,o,s,a,c=e.readable&&"function"!=typeof e.readable.read?b.wrap(e.readable):e.readable,l=e.writable,u=!!n(c),d=!!i(l);function f(e){var t=s;s=null,t?t(e):e&&a.destroy(e)}return a=new A({readableObjectMode:!(null==c||!c.readableObjectMode),writableObjectMode:!(null==l||!l.writableObjectMode),readable:u,writable:d}),d&&(h(l,(function(e){d=!1,e&&_(c,e),f(e)})),a._write=function(e,r,n){l.write(e,r)?n():t=n},a._final=function(e){l.end(),r=e},l.on("drain",(function(){if(t){var e=t;t=null,e()}})),l.on("finish",(function(){if(r){var e=r;r=null,e()}}))),u&&(h(c,(function(e){u=!1,e&&_(c,e),f(e)})),c.on("readable",(function(){if(o){var e=o;o=null,e()}})),c.on("end",(function(){a.push(null)})),a._read=function(){for(;;){var e=c.read();if(null===e)return void(o=a._read);if(!a.push(e))return}}),a._destroy=function(e,n){e||null===s||(e=new p),o=null,t=null,r=null,null===s?n(e):(s=n,_(l,e),_(c,e))},a}return duplexify=function t(r,n){if(l(r))return r;if(a(r))return x({readable:r});if(c(r))return x({writable:r});if(s(r))return x({writable:!1,readable:!1});if(u(r))return x({readable:b.fromWeb(r)});if(d(r))return x({writable:w.fromWeb(r)});if("function"==typeof r){var i=function(t){var r=k(),n=r.promise,i=r.resolve,o=new T,s=o.signal,a=t(_wrapAsyncGenerator(_regeneratorRuntime().mark((function t(){var r,o,a,c,l,u;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n,n=null,t.next=5,_awaitAsyncGenerator(r);case 5:if(o=t.sent,a=o.chunk,c=o.done,l=o.cb,e.nextTick(l),!c){t.next=12;break}return t.abrupt("return");case 12:if(!s.aborted){t.next=14;break}throw new p(void 0,{cause:s.reason});case 14:return u=k(),n=u.promise,i=u.resolve,t.next=19,a;case 19:t.next=0;break;case 21:case"end":return t.stop()}}),t)})))(),{signal:s});return{value:a,write:function(e,t,r){var n=i;i=null,n({chunk:e,done:!1,cb:r})},final:function(e){var t=i;i=null,t({done:!0,cb:e})},destroy:function(e,t){o.abort(),t(e)}}}(r),h=i.value,f=i.write,m=i.final,y=i.destroy;if(o(h))return S(A,h,{objectMode:!0,write:f,final:m,destroy:y});var E=null==h?void 0:h.then;if("function"==typeof E){var B,I=P(E,h,(function(e){if(null!=e)throw new g("nully","body",e)}),(function(e){_(B,e)}));return B=new A({objectMode:!0,readable:!1,write:f,final:function(t){m(_asyncToGenerator(_regeneratorRuntime().mark((function r(){return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,I;case 3:e.nextTick(t,null),r.next=9;break;case 6:r.prev=6,r.t0=r.catch(0),e.nextTick(t,r.t0);case 9:case"end":return r.stop()}}),r,null,[[0,6]])}))))},destroy:y})}throw new g("Iterable, AsyncIterable or AsyncFunction",n,h)}if(C(r))return t(r.arrayBuffer());if(o(r))return S(A,r,{objectMode:!0,writable:!1});if(u(null==r?void 0:r.readable)&&d(null==r?void 0:r.writable))return A.fromWeb(r);if("object"===_typeof(null==r?void 0:r.writable)||"object"===_typeof(null==r?void 0:r.readable))return x({readable:null!=r&&r.readable?a(null==r?void 0:r.readable)?null==r?void 0:r.readable:t(r.readable):void 0,writable:null!=r&&r.writable?c(null==r?void 0:r.writable)?null==r?void 0:r.writable:t(r.writable):void 0});var R,O=null==r?void 0:r.then;if("function"==typeof O)return P(O,r,(function(e){null!=e&&R.push(e),R.push(null)}),(function(e){_(R,e)})),R=new A({objectMode:!0,writable:!1,read:function(){}});throw new v(n,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],r)},duplexify}function requireDuplex(){if(hasRequiredDuplex)return duplex;hasRequiredDuplex=1;var e=requirePrimordials(),t=e.ObjectDefineProperties,r=e.ObjectGetOwnPropertyDescriptor,n=e.ObjectKeys,i=e.ObjectSetPrototypeOf;duplex=h;var o,s,a=requireReadable(),c=requireWritable();i(h.prototype,a.prototype),i(h,a);for(var l=n(c.prototype),u=0;u<l.length;u++){var d=l[u];h.prototype[d]||(h.prototype[d]=c.prototype[d])}function h(e){if(!(this instanceof h))return new h(e);a.call(this,e),c.call(this,e),e?(this.allowHalfOpen=!1!==e.allowHalfOpen,!1===e.readable&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===e.writable&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}function f(){return void 0===o&&(o={}),o}return t(h.prototype,{writable:_objectSpread2({__proto__:null},r(c.prototype,"writable")),writableHighWaterMark:_objectSpread2({__proto__:null},r(c.prototype,"writableHighWaterMark")),writableObjectMode:_objectSpread2({__proto__:null},r(c.prototype,"writableObjectMode")),writableBuffer:_objectSpread2({__proto__:null},r(c.prototype,"writableBuffer")),writableLength:_objectSpread2({__proto__:null},r(c.prototype,"writableLength")),writableFinished:_objectSpread2({__proto__:null},r(c.prototype,"writableFinished")),writableCorked:_objectSpread2({__proto__:null},r(c.prototype,"writableCorked")),writableEnded:_objectSpread2({__proto__:null},r(c.prototype,"writableEnded")),writableNeedDrain:_objectSpread2({__proto__:null},r(c.prototype,"writableNeedDrain")),destroyed:{__proto__:null,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){this._readableState&&this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}}),h.fromWeb=function(e,t){return f().newStreamDuplexFromReadableWritablePair(e,t)},h.toWeb=function(e){return f().newReadableWritablePairFromDuplex(e)},h.from=function(e){return s||(s=requireDuplexify()),s(e,"body")},duplex}function requireTransform(){if(hasRequiredTransform)return transform;hasRequiredTransform=1;var e=requirePrimordials(),t=e.ObjectSetPrototypeOf,r=e.Symbol;transform=a;var n=requireErrors().codes.ERR_METHOD_NOT_IMPLEMENTED,i=requireDuplex(),o=requireState().getHighWaterMark;t(a.prototype,i.prototype),t(a,i);var s=r("kCallback");function a(e){if(!(this instanceof a))return new a(e);var t=e?o(this,e,"readableHighWaterMark",!0):null;0===t&&(e=_objectSpread2(_objectSpread2({},e),{},{highWaterMark:null,readableHighWaterMark:t,writableHighWaterMark:e.writableHighWaterMark||0})),i.call(this,e),this._readableState.sync=!1,this[s]=null,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",l)}function c(e){var t=this;"function"!=typeof this._flush||this.destroyed?(this.push(null),e&&e()):this._flush((function(r,n){r?e?e(r):t.destroy(r):(null!=n&&t.push(n),t.push(null),e&&e())}))}function l(){this._final!==c&&c.call(this)}return a.prototype._final=c,a.prototype._transform=function(e,t,r){throw new n("_transform()")},a.prototype._write=function(e,t,r){var n=this,i=this._readableState,o=this._writableState,a=i.length;this._transform(e,t,(function(e,t){e?r(e):(null!=t&&n.push(t),o.ended||a===i.length||i.length<i.highWaterMark?r():n[s]=r)}))},a.prototype._read=function(){if(this[s]){var e=this[s];this[s]=null,e()}},transform}function requirePassthrough(){if(hasRequiredPassthrough)return passthrough;hasRequiredPassthrough=1;var e=requirePrimordials().ObjectSetPrototypeOf;passthrough=r;var t=requireTransform();function r(e){if(!(this instanceof r))return new r(e);t.call(this,e)}return e(r.prototype,t.prototype),e(r,t),r.prototype._transform=function(e,t,r){r(null,e)},passthrough}function requirePipeline(){if(hasRequiredPipeline)return pipeline_1;hasRequiredPipeline=1;var e,t,r,n=require$$0$7,i=requirePrimordials(),o=i.ArrayIsArray,s=i.Promise,a=i.SymbolAsyncIterator,c=i.SymbolDispose,l=requireEndOfStream(),u=requireUtil$1().once,d=requireDestroy(),h=requireDuplex(),f=requireErrors(),p=f.aggregateTwoErrors,m=f.codes,v=m.ERR_INVALID_ARG_TYPE,g=m.ERR_INVALID_RETURN_VALUE,_=m.ERR_MISSING_ARGS,y=m.ERR_STREAM_DESTROYED,b=m.ERR_STREAM_PREMATURE_CLOSE,w=f.AbortError,k=requireValidators(),S=k.validateFunction,E=k.validateAbortSignal,C=requireUtils$1(),T=C.isIterable,P=C.isReadable,A=C.isReadableNodeStream,x=C.isNodeStream,B=C.isTransformStream,I=C.isWebStream,R=C.isReadableStream,O=C.isReadableFinished,M=globalThis.AbortController||require$$0$9.AbortController;function L(e,t,r){var n=!1;e.on("close",(function(){n=!0}));var i=l(e,{readable:t,writable:r},(function(e){n=!e}));return{destroy:function(t){n||(n=!0,d.destroyer(e,t||new y("pipe")))},cleanup:i}}function D(e){if(T(e))return e;if(A(e))return function(e){return N.apply(this,arguments)}(e);throw new v("val",["Readable","Iterable","AsyncIterable"],e)}function N(){return(N=_wrapAsyncGenerator(_regeneratorRuntime().mark((function e(r){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t||(t=requireReadable()),e.delegateYield(_asyncGeneratorDelegate(_asyncIterator(t.prototype[a].call(r)),_awaitAsyncGenerator),"t0",2);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e,t,r,n){return $.apply(this,arguments)}function $(){return $=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,r,n,i){var o,a,c,u,d,h,f,m,v,g,_,y;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=i.end,c=null,u=function(e){if(e&&(a=e),c){var t=c;c=null,t()}},d=function(){return new s((function(e,t){a?t(a):c=function(){a?t(a):e()}}))},r.on("drain",u),h=l(r,{readable:!1},u),e.prev=6,!r.writableNeedDrain){e.next=10;break}return e.next=10,d();case 10:f=!1,m=!1,e.prev=12,g=_asyncIterator(t);case 14:return e.next=16,g.next();case 16:if(!(f=!(_=e.sent).done)){e.next=24;break}if(y=_.value,r.write(y)){e.next=21;break}return e.next=21,d();case 21:f=!1,e.next=14;break;case 24:e.next=30;break;case 26:e.prev=26,e.t0=e.catch(12),m=!0,v=e.t0;case 30:if(e.prev=30,e.prev=31,!f||null==g.return){e.next=35;break}return e.next=35,g.return();case 35:if(e.prev=35,!m){e.next=38;break}throw v;case 38:return e.finish(35);case 39:return e.finish(30);case 40:if(!o){e.next=44;break}return r.end(),e.next=44,d();case 44:n(),e.next=50;break;case 47:e.prev=47,e.t1=e.catch(6),n(a!==e.t1?p(a,e.t1):e.t1);case 50:return e.prev=50,h(),r.off("drain",u),e.finish(50);case 54:case"end":return e.stop()}}),e,null,[[6,47,50,54],[12,26,30,40],[31,,35,39]])}))),$.apply(this,arguments)}function U(e,t,r,n){return j.apply(this,arguments)}function j(){return j=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,r,n,i){var o,s,a,c,l,u,d,h;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=i.end,B(r)&&(r=r.writable),s=r.getWriter(),e.prev=3,a=!1,c=!1,e.prev=6,u=_asyncIterator(t);case 8:return e.next=10,u.next();case 10:if(!(a=!(d=e.sent).done)){e.next=18;break}return h=d.value,e.next=14,s.ready;case 14:s.write(h).catch((function(){}));case 15:a=!1,e.next=8;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(6),c=!0,l=e.t0;case 24:if(e.prev=24,e.prev=25,!a||null==u.return){e.next=29;break}return e.next=29,u.return();case 29:if(e.prev=29,!c){e.next=32;break}throw l;case 32:return e.finish(29);case 33:return e.finish(24);case 34:return e.next=36,s.ready;case 36:if(!o){e.next=39;break}return e.next=39,s.close();case 39:n(),e.next=53;break;case 42:return e.prev=42,e.t1=e.catch(3),e.prev=44,e.next=47,s.abort(e.t1);case 47:n(e.t1),e.next=53;break;case 50:e.prev=50,e.t2=e.catch(44),n(e.t2);case 53:case"end":return e.stop()}}),e,null,[[3,42],[6,20,24,34],[25,,29,33],[44,50]])}))),j.apply(this,arguments)}function q(t,i,s){if(1===t.length&&o(t[0])&&(t=t[0]),t.length<2)throw new _("streams");var a,u,d,f=new M,p=f.signal,m=null==s?void 0:s.signal,y=[];function k(){j(new w)}E(m,"options.signal"),r=r||requireUtil$1().addAbortListener,m&&(a=r(m,k));var S,C=[],N=0;function $(e){j(e,0==--N)}function j(e,t){var r;if(!e||u&&"ERR_STREAM_PREMATURE_CLOSE"!==u.code||(u=e),u||t){for(;C.length;)C.shift()(u);null===(r=a)||void 0===r||r[c](),f.abort(),t&&(u||y.forEach((function(e){return e()})),n.nextTick(i,u,d))}}for(var q,G,V=function(){var r=t[z],i=z<t.length-1,o=z>0,a=i||!1!==(null==s?void 0:s.end),c=z===t.length-1;if(x(r)){var u=function(e){e&&"AbortError"!==e.name&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code&&$(e)};if(a){var f=L(r,i,o),m=f.destroy,_=f.cleanup;C.push(m),P(r)&&c&&y.push(_)}r.on("error",u),P(r)&&c&&y.push((function(){r.removeListener("error",u)}))}if(0===z)if("function"==typeof r){if(S=r({signal:p}),!T(S))throw new g("Iterable, AsyncIterable or Stream","source",S)}else S=T(r)||A(r)||B(r)?r:h.from(r);else if("function"==typeof r)if(S=B(S)?D(null===(q=S)||void 0===q?void 0:q.readable):D(S),S=r(S,{signal:p}),i){if(!T(S,!0))throw new g("AsyncIterable","transform[".concat(z-1,"]"),S)}else{e||(e=requirePassthrough());var w=new e({objectMode:!0}),k=null===(G=S)||void 0===G?void 0:G.then;if("function"==typeof k)N++,k.call(S,(function(e){d=e,null!=e&&w.write(e),a&&w.end(),n.nextTick($)}),(function(e){w.destroy(e),n.nextTick($,e)}));else if(T(S,!0))N++,F(S,w,$,{end:a});else{if(!R(S)&&!B(S))throw new g("AsyncIterable or Promise","destination",S);var E=S.readable||S;N++,F(E,w,$,{end:a})}var M=L(S=w,!1,!0),j=M.destroy,V=M.cleanup;C.push(j),c&&y.push(V)}else if(x(r)){if(A(S)){N+=2;var H=function(e,t,r,i){var o=i.end,s=!1;if(t.on("close",(function(){s||r(new b)})),e.pipe(t,{end:!1}),o){var a=function(){s=!0,t.end()};O(e)?n.nextTick(a):e.once("end",a)}else r();return l(e,{readable:!0,writable:!1},(function(t){var n=e._readableState;t&&"ERR_STREAM_PREMATURE_CLOSE"===t.code&&n&&n.ended&&!n.errored&&!n.errorEmitted?e.once("end",r).once("error",r):r(t)})),l(t,{readable:!1,writable:!0},r)}(S,r,$,{end:a});P(r)&&c&&y.push(H)}else if(B(S)||R(S)){var W=S.readable||S;N++,F(W,r,$,{end:a})}else{if(!T(S))throw new v("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],S);N++,F(S,r,$,{end:a})}S=r}else if(I(r)){if(A(S))N++,U(D(S),r,$,{end:a});else if(R(S)||T(S))N++,U(S,r,$,{end:a});else{if(!B(S))throw new v("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],S);N++,U(S.readable,r,$,{end:a})}S=r}else S=h.from(r)},z=0;z<t.length;z++)V();return(null!=p&&p.aborted||null!=m&&m.aborted)&&n.nextTick(k),S}return pipeline_1={pipelineImpl:q,pipeline:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return q(t,u(function(e){return S(e[e.length-1],"streams[stream.length - 1]"),e.pop()}(t)))}},pipeline_1}function requireCompose(){if(hasRequiredCompose)return compose;hasRequiredCompose=1;var e=requirePipeline().pipeline,t=requireDuplex(),r=requireDestroy().destroyer,n=requireUtils$1(),i=n.isNodeStream,o=n.isReadable,s=n.isWritable,a=n.isWebStream,c=n.isTransformStream,l=n.isWritableStream,u=n.isReadableStream,d=requireErrors(),h=d.AbortError,f=d.codes,p=f.ERR_INVALID_ARG_VALUE,m=f.ERR_MISSING_ARGS,v=requireEndOfStream();return compose=function(){for(var n=arguments.length,d=new Array(n),f=0;f<n;f++)d[f]=arguments[f];if(0===d.length)throw new m("streams");if(1===d.length)return t.from(d[0]);var g,_,y,b,w,k=[].concat(d);if("function"==typeof d[0]&&(d[0]=t.from(d[0])),"function"==typeof d[d.length-1]){var S=d.length-1;d[S]=t.from(d[S])}for(var E=0;E<d.length;++E)if(i(d[E])||a(d[E])){if(E<d.length-1&&!(o(d[E])||u(d[E])||c(d[E])))throw new p("streams[".concat(E,"]"),k[E],"must be readable");if(E>0&&!(s(d[E])||l(d[E])||c(d[E])))throw new p("streams[".concat(E,"]"),k[E],"must be writable")}var C=d[0],T=e(d,(function(e){var t=b;b=null,t?t(e):e?w.destroy(e):A||P||w.destroy()})),P=!!(s(C)||l(C)||c(C)),A=!!(o(T)||u(T)||c(T));if(w=new t({writableObjectMode:!(null==C||!C.writableObjectMode),readableObjectMode:!(null==T||!T.readableObjectMode),writable:P,readable:A}),P){if(i(C))w._write=function(e,t,r){C.write(e,t)?r():g=r},w._final=function(e){C.end(),_=e},C.on("drain",(function(){if(g){var e=g;g=null,e()}}));else if(a(C)){var x=(c(C)?C.writable:C).getWriter();w._write=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,r,n){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.ready;case 3:x.write(t).catch((function(){})),n(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),n(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r,n){return e.apply(this,arguments)}}(),w._final=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.ready;case 3:x.close().catch((function(){})),_=t,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()}var B=c(T)?T.readable:T;v(B,(function(){if(_){var e=_;_=null,e()}}))}if(A)if(i(T))T.on("readable",(function(){if(y){var e=y;y=null,e()}})),T.on("end",(function(){w.push(null)})),w._read=function(){for(;;){var e=T.read();if(null===e)return void(y=w._read);if(!w.push(e))return}};else if(a(T)){var I=(c(T)?T.readable:T).getReader();w._read=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,r,n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,I.read();case 4:if(t=e.sent,r=t.value,n=t.done,w.push(r)){e.next=9;break}return e.abrupt("return");case 9:if(!n){e.next=12;break}return w.push(null),e.abrupt("return");case 12:e.next=17;break;case 14:return e.prev=14,e.t0=e.catch(1),e.abrupt("return");case 17:e.next=0;break;case 19:case"end":return e.stop()}}),e,null,[[1,14]])})))}return w._destroy=function(e,t){e||null===b||(e=new h),y=null,g=null,_=null,null===b?t(e):(b=t,i(T)&&r(T,e))},w},compose}function requireOperators(){if(hasRequiredOperators)return operators;hasRequiredOperators=1;var e=globalThis.AbortController||require$$0$9.AbortController,t=requireErrors(),r=t.codes,n=r.ERR_INVALID_ARG_VALUE,i=r.ERR_INVALID_ARG_TYPE,o=r.ERR_MISSING_ARGS,s=r.ERR_OUT_OF_RANGE,a=t.AbortError,c=requireValidators(),l=c.validateAbortSignal,u=c.validateInteger,d=c.validateObject,h=requirePrimordials().Symbol("kWeak"),f=requirePrimordials().Symbol("kResistStopPropagation"),p=requireEndOfStream().finished,m=requireCompose(),v=requireAddAbortSignal().addAbortSignalNoValidate,g=requireUtils$1(),_=g.isWritable,y=g.isNodeStream,b=requireUtil$1().deprecate,w=requirePrimordials(),k=w.ArrayPrototypePush,S=w.Boolean,E=w.MathFloor,C=w.Number,T=w.NumberIsNaN,P=w.Promise,A=w.PromiseReject,x=w.PromiseResolve,B=w.PromisePrototypeThen,I=w.Symbol,R=I("kEmpty"),O=I("kEof");function M(e,t){if("function"!=typeof e)throw new i("fn",["Function","AsyncFunction"],e);null!=t&&d(t,"options"),null!=(null==t?void 0:t.signal)&&l(t.signal,"options.signal");var r=1;null!=(null==t?void 0:t.concurrency)&&(r=E(t.concurrency));var n=r-1;return null!=(null==t?void 0:t.highWaterMark)&&(n=E(t.highWaterMark)),u(r,"options.concurrency",1),u(n,"options.highWaterMark",0),n+=r,function(){var i=_wrapAsyncGenerator(_regeneratorRuntime().mark((function i(){var o,s,c,l,u,d,h,f,p,m,v,g,_,y;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:_=function(){return(_=_asyncToGenerator(_regeneratorRuntime().mark((function t(){var i,v,g,_,y,b,w;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,i=!1,v=!1,t.prev=3,_=_asyncIterator(s);case 5:return t.next=7,_.next();case 7:if(!(i=!(y=t.sent).done)){t.next=33;break}if(b=y.value,!h){t.next=11;break}return t.abrupt("return");case 11:if(!o.aborted){t.next=13;break}throw new a;case 13:if(t.prev=13,(b=e(b,l))!==R){t.next=17;break}return t.abrupt("continue",30);case 17:b=x(b),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(13),b=A(t.t0);case 23:if(f+=1,B(b,m,p),c.push(b),u&&(u(),u=null),h||!(c.length>=n||f>=r)){t.next=30;break}return t.next=30,new P((function(e){d=e}));case 30:i=!1,t.next=5;break;case 33:t.next=39;break;case 35:t.prev=35,t.t1=t.catch(3),v=!0,g=t.t1;case 39:if(t.prev=39,t.prev=40,!i||null==_.return){t.next=44;break}return t.next=44,_.return();case 44:if(t.prev=44,!v){t.next=47;break}throw g;case 47:return t.finish(44);case 48:return t.finish(39);case 49:c.push(O),t.next=57;break;case 52:t.prev=52,t.t2=t.catch(0),w=A(t.t2),B(w,m,p),c.push(w);case 57:return t.prev=57,h=!0,u&&(u(),u=null),t.finish(57);case 61:case"end":return t.stop()}}),t,null,[[0,52,57,61],[3,35,39,49],[13,20],[40,,44,48]])})))).apply(this,arguments)},g=function(){return _.apply(this,arguments)},v=function(){d&&!h&&f<r&&c.length<n&&(d(),d=null)},m=function(){f-=1,v()},p=function(){h=!0,m()},o=requireUtil$1().AbortSignalAny([null==t?void 0:t.signal].filter(S)),s=this,c=[],l={signal:o},h=!1,f=0,g(),i.prev=12;case 13:0;case 14:if(!(c.length>0)){i.next=29;break}return i.next=17,_awaitAsyncGenerator(c[0]);case 17:if((y=i.sent)!==O){i.next=20;break}return i.abrupt("return");case 20:if(!o.aborted){i.next=22;break}throw new a;case 22:if(y===R){i.next=25;break}return i.next=25,y;case 25:c.shift(),v(),i.next=14;break;case 29:return i.next=31,_awaitAsyncGenerator(new P((function(e){u=e})));case 31:i.next=13;break;case 33:return i.prev=33,h=!0,d&&(d(),d=null),i.finish(33);case 37:case"end":return i.stop()}}),i,this,[[12,,33,37]])})));return function(){return i.apply(this,arguments)}}().call(this)}function L(e){return D.apply(this,arguments)}function D(){return D=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var r,n,i,o,s,a,c=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=c.length>1&&void 0!==c[1]?c[1]:void 0,n=!1,i=!1,e.prev=3,s=_asyncIterator(U.call(this,t,r));case 5:return e.next=7,s.next();case 7:if(!(n=!(a=e.sent).done)){e.next=13;break}return a.value,e.abrupt("return",!0);case 10:n=!1,e.next=5;break;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(3),i=!0,o=e.t0;case 19:if(e.prev=19,e.prev=20,!n||null==s.return){e.next=24;break}return e.next=24,s.return();case 24:if(e.prev=24,!i){e.next=27;break}throw o;case 27:return e.finish(24);case 28:return e.finish(19);case 29:return e.abrupt("return",!1);case 30:case"end":return e.stop()}}),e,this,[[3,15,19,29],[20,,24,28]])}))),D.apply(this,arguments)}function N(){return N=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var r,n=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.length>1&&void 0!==n[1]?n[1]:void 0,"function"==typeof t){e.next=3;break}throw new i("fn",["Function","AsyncFunction"],t);case 3:return e.next=5,L.call(this,_asyncToGenerator(_regeneratorRuntime().mark((function e(){var r=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.apply(void 0,r);case 2:return e.abrupt("return",!e.sent);case 3:case"end":return e.stop()}}),e)}))),r);case 5:return e.abrupt("return",!e.sent);case 6:case"end":return e.stop()}}),e,this)}))),N.apply(this,arguments)}function F(){return F=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,r){var n,i,o,s,a,c;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!1,i=!1,e.prev=2,s=_asyncIterator(U.call(this,t,r));case 4:return e.next=6,s.next();case 6:if(!(n=!(a=e.sent).done)){e.next=12;break}return c=a.value,e.abrupt("return",c);case 9:n=!1,e.next=4;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(2),i=!0,o=e.t0;case 18:if(e.prev=18,e.prev=19,!n||null==s.return){e.next=23;break}return e.next=23,s.return();case 23:if(e.prev=23,!i){e.next=26;break}throw o;case 26:return e.finish(23);case 27:return e.finish(18);case 28:return e.abrupt("return",void 0);case 29:case"end":return e.stop()}}),e,this,[[2,14,18,28],[19,,23,27]])}))),F.apply(this,arguments)}function $(){return $=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,r){var n,o,s,a,c,l,u;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=function(){return o=_asyncToGenerator(_regeneratorRuntime().mark((function e(r,n){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(r,n);case 2:return e.abrupt("return",R);case 3:case"end":return e.stop()}}),e)}))),o.apply(this,arguments)},n=function(e,t){return o.apply(this,arguments)},"function"==typeof t){e.next=4;break}throw new i("fn",["Function","AsyncFunction"],t);case 4:s=!1,a=!1,e.prev=6,l=_asyncIterator(M.call(this,n,r));case 8:return e.next=10,l.next();case 10:if(!(s=!(u=e.sent).done)){e.next=16;break}u.value;case 13:s=!1,e.next=8;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(6),a=!0,c=e.t0;case 22:if(e.prev=22,e.prev=23,!s||null==l.return){e.next=27;break}return e.next=27,l.return();case 27:if(e.prev=27,!a){e.next=30;break}throw c;case 30:return e.finish(27);case 31:return e.finish(22);case 32:case"end":return e.stop()}}),e,this,[[6,18,22,32],[23,,27,31]])}))),$.apply(this,arguments)}function U(e,t){if("function"!=typeof e)throw new i("fn",["Function","AsyncFunction"],e);function r(){return r=_asyncToGenerator(_regeneratorRuntime().mark((function t(r,n){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e(r,n);case 2:if(!t.sent){t.next=4;break}return t.abrupt("return",r);case 4:return t.abrupt("return",R);case 5:case"end":return t.stop()}}),t)}))),r.apply(this,arguments)}return M.call(this,(function(e,t){return r.apply(this,arguments)}),t)}var j=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,["reduce"])).message="Reduce of an empty stream requires an initial value",e}return _inherits(t,e),_createClass(t)}(o);function q(){return q=_asyncToGenerator(_regeneratorRuntime().mark((function t(r,n,o){var s,c,u,m,v,g,_,y,b,w,k,S,E,C,T=arguments;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("function"==typeof r){t.next=2;break}throw new i("reducer",["Function","AsyncFunction"],r);case 2:if(null!=o&&d(o,"options"),null!=(null==o?void 0:o.signal)&&l(o.signal,"options.signal"),c=T.length>1,null==o||null===(s=o.signal)||void 0===s||!s.aborted){t.next=11;break}return u=new a(void 0,{cause:o.signal.reason}),this.once("error",(function(){})),t.next=10,p(this.destroy(u));case 10:throw u;case 11:m=new e,v=m.signal,null!=o&&o.signal&&(g=_defineProperty(_defineProperty({once:!0},h,this),f,!0),o.signal.addEventListener("abort",(function(){return m.abort()}),g)),_=!1,t.prev=15,y=!1,b=!1,t.prev=18,k=_asyncIterator(this);case 20:return t.next=22,k.next();case 22:if(!(y=!(S=t.sent).done)){t.next=38;break}if(E=S.value,_=!0,null==o||null===(C=o.signal)||void 0===C||!C.aborted){t.next=27;break}throw new a;case 27:if(c){t.next=32;break}n=E,c=!0,t.next=35;break;case 32:return t.next=34,r(n,E,{signal:v});case 34:n=t.sent;case 35:y=!1,t.next=20;break;case 38:t.next=44;break;case 40:t.prev=40,t.t0=t.catch(18),b=!0,w=t.t0;case 44:if(t.prev=44,t.prev=45,!y||null==k.return){t.next=49;break}return t.next=49,k.return();case 49:if(t.prev=49,!b){t.next=52;break}throw w;case 52:return t.finish(49);case 53:return t.finish(44);case 54:if(_||c){t.next=56;break}throw new j;case 56:return t.prev=56,m.abort(),t.finish(56);case 59:return t.abrupt("return",n);case 60:case"end":return t.stop()}}),t,this,[[15,,56,59],[18,40,44,54],[45,,49,53]])}))),q.apply(this,arguments)}function G(){return(G=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var r,n,i,o,s,c,u,h;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null!=t&&d(t,"options"),null!=(null==t?void 0:t.signal)&&l(t.signal,"options.signal"),r=[],n=!1,i=!1,e.prev=5,s=_asyncIterator(this);case 7:return e.next=9,s.next();case 9:if(!(n=!(c=e.sent).done)){e.next=17;break}if(u=c.value,null==t||null===(h=t.signal)||void 0===h||!h.aborted){e.next=13;break}throw new a(void 0,{cause:t.signal.reason});case 13:k(r,u);case 14:n=!1,e.next=7;break;case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(5),i=!0,o=e.t0;case 23:if(e.prev=23,e.prev=24,!n||null==s.return){e.next=28;break}return e.next=28,s.return();case 28:if(e.prev=28,!i){e.next=31;break}throw o;case 31:return e.finish(28);case 32:return e.finish(23);case 33:return e.abrupt("return",r);case 34:case"end":return e.stop()}}),e,this,[[5,19,23,33],[24,,28,32]])})))).apply(this,arguments)}function V(e){if(e=C(e),T(e))return 0;if(e<0)throw new s("number",">= 0",e);return e}return operators.streamReturningOperators={asIndexedPairs:b((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return null!=e&&d(e,"options"),null!=(null==e?void 0:e.signal)&&l(e.signal,"options.signal"),function(){var t=_wrapAsyncGenerator(_regeneratorRuntime().mark((function t(){var r,n,i,o,s,c,l,u;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=0,n=!1,i=!1,t.prev=3,s=_asyncIterator(this);case 5:return t.next=7,_awaitAsyncGenerator(s.next());case 7:if(!(n=!(c=t.sent).done)){t.next=16;break}if(l=c.value,null==e||null===(u=e.signal)||void 0===u||!u.aborted){t.next=11;break}throw new a({cause:e.signal.reason});case 11:return t.next=13,[r++,l];case 13:n=!1,t.next=5;break;case 16:t.next=22;break;case 18:t.prev=18,t.t0=t.catch(3),i=!0,o=t.t0;case 22:if(t.prev=22,t.prev=23,!n||null==s.return){t.next=27;break}return t.next=27,_awaitAsyncGenerator(s.return());case 27:if(t.prev=27,!i){t.next=30;break}throw o;case 30:return t.finish(27);case 31:return t.finish(22);case 32:case"end":return t.stop()}}),t,this,[[3,18,22,32],[23,,27,31]])})));return function(){return t.apply(this,arguments)}}().call(this)}),"readable.asIndexedPairs will be removed in a future version."),drop:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return null!=t&&d(t,"options"),null!=(null==t?void 0:t.signal)&&l(t.signal,"options.signal"),e=V(e),function(){var r=_wrapAsyncGenerator(_regeneratorRuntime().mark((function r(){var n,i,o,s,c,l,u,d;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null==t||null===(n=t.signal)||void 0===n||!n.aborted){r.next=2;break}throw new a;case 2:i=!1,o=!1,r.prev=4,c=_asyncIterator(this);case 6:return r.next=8,_awaitAsyncGenerator(c.next());case 8:if(!(i=!(l=r.sent).done)){r.next=18;break}if(u=l.value,null==t||null===(d=t.signal)||void 0===d||!d.aborted){r.next=12;break}throw new a;case 12:if(!(e--<=0)){r.next=15;break}return r.next=15,u;case 15:i=!1,r.next=6;break;case 18:r.next=24;break;case 20:r.prev=20,r.t0=r.catch(4),o=!0,s=r.t0;case 24:if(r.prev=24,r.prev=25,!i||null==c.return){r.next=29;break}return r.next=29,_awaitAsyncGenerator(c.return());case 29:if(r.prev=29,!o){r.next=32;break}throw s;case 32:return r.finish(29);case 33:return r.finish(24);case 34:case"end":return r.stop()}}),r,this,[[4,20,24,34],[25,,29,33]])})));return function(){return r.apply(this,arguments)}}().call(this)},filter:U,flatMap:function(e,t){var r=M.call(this,e,t);return function(){var e=_wrapAsyncGenerator(_regeneratorRuntime().mark((function e(){var t,n,i,o,s,a;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!1,n=!1,e.prev=2,o=_asyncIterator(r);case 4:return e.next=6,_awaitAsyncGenerator(o.next());case 6:if(!(t=!(s=e.sent).done)){e.next=12;break}return a=s.value,e.delegateYield(_asyncGeneratorDelegate(_asyncIterator(a),_awaitAsyncGenerator),"t0",9);case 9:t=!1,e.next=4;break;case 12:e.next=18;break;case 14:e.prev=14,e.t1=e.catch(2),n=!0,i=e.t1;case 18:if(e.prev=18,e.prev=19,!t||null==o.return){e.next=23;break}return e.next=23,_awaitAsyncGenerator(o.return());case 23:if(e.prev=23,!n){e.next=26;break}throw i;case 26:return e.finish(23);case 27:return e.finish(18);case 28:case"end":return e.stop()}}),e,null,[[2,14,18,28],[19,,23,27]])})));return function(){return e.apply(this,arguments)}}().call(this)},map:M,take:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return null!=t&&d(t,"options"),null!=(null==t?void 0:t.signal)&&l(t.signal,"options.signal"),e=V(e),function(){var r=_wrapAsyncGenerator(_regeneratorRuntime().mark((function r(){var n,i,o,s,c,l,u,d;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null==t||null===(n=t.signal)||void 0===n||!n.aborted){r.next=2;break}throw new a;case 2:i=!1,o=!1,r.prev=4,c=_asyncIterator(this);case 6:return r.next=8,_awaitAsyncGenerator(c.next());case 8:if(!(i=!(l=r.sent).done)){r.next=20;break}if(u=l.value,null==t||null===(d=t.signal)||void 0===d||!d.aborted){r.next=12;break}throw new a;case 12:if(!(e-- >0)){r.next=15;break}return r.next=15,u;case 15:if(!(e<=0)){r.next=17;break}return r.abrupt("return");case 17:i=!1,r.next=6;break;case 20:r.next=26;break;case 22:r.prev=22,r.t0=r.catch(4),o=!0,s=r.t0;case 26:if(r.prev=26,r.prev=27,!i||null==c.return){r.next=31;break}return r.next=31,_awaitAsyncGenerator(c.return());case 31:if(r.prev=31,!o){r.next=34;break}throw s;case 34:return r.finish(31);case 35:return r.finish(26);case 36:case"end":return r.stop()}}),r,this,[[4,22,26,36],[27,,31,35]])})));return function(){return r.apply(this,arguments)}}().call(this)},compose:function(e,t){if(null!=t&&d(t,"options"),null!=(null==t?void 0:t.signal)&&l(t.signal,"options.signal"),y(e)&&!_(e))throw new n("stream",e,"must be writable");var r=m(this,e);return null!=t&&t.signal&&v(t.signal,r),r}},operators.promiseReturningOperators={every:function(e){return N.apply(this,arguments)},forEach:function(e,t){return $.apply(this,arguments)},reduce:function(e,t,r){return q.apply(this,arguments)},toArray:function(e){return G.apply(this,arguments)},some:L,find:function(e,t){return F.apply(this,arguments)}},operators}function requirePromises(){if(hasRequiredPromises)return promises;hasRequiredPromises=1;var e=requirePrimordials(),t=e.ArrayPrototypePop,r=e.Promise,n=requireUtils$1(),i=n.isIterable,o=n.isNodeStream,s=n.isWebStream,a=requirePipeline().pipelineImpl,c=requireEndOfStream().finished;return requireStream$1(),promises={finished:c,pipeline:function(){for(var e=arguments.length,n=new Array(e),c=0;c<e;c++)n[c]=arguments[c];return new r((function(e,r){var c,l,u=n[n.length-1];if(u&&"object"===_typeof(u)&&!o(u)&&!i(u)&&!s(u)){var d=t(n);c=d.signal,l=d.end}a(n,(function(t,n){t?r(t):e(n)}),{signal:c,end:l})}))}},promises}var stream$1=stream$2.exports,hasRequiredStream$1;function requireStream$1(){if(hasRequiredStream$1)return stream$2.exports;hasRequiredStream$1=1;var e=require$$0$a.Buffer,t=requirePrimordials(),r=t.ObjectDefineProperty,n=t.ObjectKeys,i=t.ReflectApply,o=requireUtil$1().promisify.custom,s=requireOperators(),a=s.streamReturningOperators,c=s.promiseReturningOperators,l=requireErrors().codes.ERR_ILLEGAL_CONSTRUCTOR,u=requireCompose(),d=requireState(),h=d.setDefaultHighWaterMark,f=d.getDefaultHighWaterMark,p=requirePipeline().pipeline,m=requireDestroy().destroyer,v=requireEndOfStream(),g=requirePromises(),_=requireUtils$1(),y=stream$2.exports=requireLegacy().Stream;y.isDestroyed=_.isDestroyed,y.isDisturbed=_.isDisturbed,y.isErrored=_.isErrored,y.isReadable=_.isReadable,y.isWritable=_.isWritable,y.Readable=requireReadable();var b,w=_createForOfIteratorHelper(n(a));try{var k=function(){var e=b.value,t=a[e];function n(){if(this instanceof n?this.constructor:void 0)throw l();for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return y.Readable.from(i(t,this,r))}r(n,"name",{__proto__:null,value:t.name}),r(n,"length",{__proto__:null,value:t.length}),r(y.Readable.prototype,e,{__proto__:null,value:n,enumerable:!1,configurable:!0,writable:!0})};for(w.s();!(b=w.n()).done;)k()}catch(e){w.e(e)}finally{w.f()}var S,E=_createForOfIteratorHelper(n(c));try{var C=function(){var e=S.value,t=c[e];function n(){if(this instanceof n?this.constructor:void 0)throw l();for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return i(t,this,r)}r(n,"name",{__proto__:null,value:t.name}),r(n,"length",{__proto__:null,value:t.length}),r(y.Readable.prototype,e,{__proto__:null,value:n,enumerable:!1,configurable:!0,writable:!0})};for(E.s();!(S=E.n()).done;)C()}catch(e){E.e(e)}finally{E.f()}y.Writable=requireWritable(),y.Duplex=requireDuplex(),y.Transform=requireTransform(),y.PassThrough=requirePassthrough(),y.pipeline=p;var T=requireAddAbortSignal().addAbortSignal;return y.addAbortSignal=T,y.finished=v,y.destroy=m,y.compose=u,y.setDefaultHighWaterMark=h,y.getDefaultHighWaterMark=f,r(y,"promises",{__proto__:null,configurable:!0,enumerable:!0,get:function(){return g}}),r(p,o,{__proto__:null,enumerable:!0,get:function(){return g.pipeline}}),r(v,o,{__proto__:null,enumerable:!0,get:function(){return g.finished}}),y.Stream=y,y._isUint8Array=function(e){return e instanceof Uint8Array},y._uint8ArrayToBuffer=function(t){return e.from(t.buffer,t.byteOffset,t.byteLength)},stream$2.exports}var ours=ours$1.exports;!function(e){var t=require$$1$5;if(t&&"disable"===browser$1$1.env.READABLE_STREAM){var r=t.promises;e.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,e.exports._isUint8Array=t._isUint8Array,e.exports.isDisturbed=t.isDisturbed,e.exports.isErrored=t.isErrored,e.exports.isReadable=t.isReadable,e.exports.Readable=t.Readable,e.exports.Writable=t.Writable,e.exports.Duplex=t.Duplex,e.exports.Transform=t.Transform,e.exports.PassThrough=t.PassThrough,e.exports.addAbortSignal=t.addAbortSignal,e.exports.finished=t.finished,e.exports.destroy=t.destroy,e.exports.pipeline=t.pipeline,e.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get:function(){return r}}),e.exports.Stream=t.Stream}else{var n=requireStream$1(),i=requirePromises(),o=n.Readable.destroy;e.exports=n.Readable,e.exports._uint8ArrayToBuffer=n._uint8ArrayToBuffer,e.exports._isUint8Array=n._isUint8Array,e.exports.isDisturbed=n.isDisturbed,e.exports.isErrored=n.isErrored,e.exports.isReadable=n.isReadable,e.exports.Readable=n.Readable,e.exports.Writable=n.Writable,e.exports.Duplex=n.Duplex,e.exports.Transform=n.Transform,e.exports.PassThrough=n.PassThrough,e.exports.addAbortSignal=n.addAbortSignal,e.exports.finished=n.finished,e.exports.destroy=n.destroy,e.exports.destroy=o,e.exports.pipeline=n.pipeline,e.exports.compose=n.compose,Object.defineProperty(n,"promises",{configurable:!0,enumerable:!0,get:function(){return i}}),e.exports.Stream=n.Stream}e.exports.default=e.exports}(ours$1);var oursExports=ours$1.exports,index$3=getDefaultExportFromCjs(oursExports),inherits$1;inherits$1="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e};var inherits$2=inherits$1,_polyfillNode_inherits=Object.freeze({__proto__:null,default:inherits$2}),require$$1$4=getAugmentedNamespace(_polyfillNode_inherits),Buffer$3=require$$0$a.Buffer,symbol=Symbol.for("BufferList");function BufferList$1(e){if(!(this instanceof BufferList$1))return new BufferList$1(e);BufferList$1._init.call(this,e)}BufferList$1._init=function(e){Object.defineProperty(this,symbol,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)},BufferList$1.prototype._new=function(e){return new BufferList$1(e)},BufferList$1.prototype._offset=function(e){if(0===e)return[0,0];for(var t=0,r=0;r<this._bufs.length;r++){var n=t+this._bufs[r].length;if(e<n||r===this._bufs.length-1)return[r,e-t];t=n}},BufferList$1.prototype._reverseOffset=function(e){for(var t=e[0],r=e[1],n=0;n<t;n++)r+=this._bufs[n].length;return r},BufferList$1.prototype.getBuffers=function(){return this._bufs},BufferList$1.prototype.get=function(e){if(!(e>this.length||e<0)){var t=this._offset(e);return this._bufs[t[0]][t[1]]}},BufferList$1.prototype.slice=function(e,t){return"number"==typeof e&&e<0&&(e+=this.length),"number"==typeof t&&t<0&&(t+=this.length),this.copy(null,0,e,t)},BufferList$1.prototype.copy=function(e,t,r,n){if(("number"!=typeof r||r<0)&&(r=0),("number"!=typeof n||n>this.length)&&(n=this.length),r>=this.length)return e||Buffer$3.alloc(0);if(n<=0)return e||Buffer$3.alloc(0);var i=!!e,o=this._offset(r),s=n-r,a=s,c=i&&t||0,l=o[1];if(0===r&&n===this.length){if(!i)return 1===this._bufs.length?this._bufs[0]:Buffer$3.concat(this._bufs,this.length);for(var u=0;u<this._bufs.length;u++)this._bufs[u].copy(e,c),c+=this._bufs[u].length;return e}if(a<=this._bufs[o[0]].length-l)return i?this._bufs[o[0]].copy(e,t,l,l+a):this._bufs[o[0]].slice(l,l+a);i||(e=Buffer$3.allocUnsafe(s));for(var d=o[0];d<this._bufs.length;d++){var h=this._bufs[d].length-l;if(!(a>h)){this._bufs[d].copy(e,c,l,l+a),c+=h;break}this._bufs[d].copy(e,c,l),c+=h,a-=h,l&&(l=0)}return e.length>c?e.slice(0,c):e},BufferList$1.prototype.shallowSlice=function(e,t){if(e=e||0,t="number"!=typeof t?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return this._new();var r=this._offset(e),n=this._offset(t),i=this._bufs.slice(r[0],n[0]+1);return 0===n[1]?i.pop():i[i.length-1]=i[i.length-1].slice(0,n[1]),0!==r[1]&&(i[0]=i[0].slice(r[1])),this._new(i)},BufferList$1.prototype.toString=function(e,t,r){return this.slice(t,r).toString(e)},BufferList$1.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;){if(!(e>=this._bufs[0].length)){this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift()}return this},BufferList$1.prototype.duplicate=function(){for(var e=this._new(),t=0;t<this._bufs.length;t++)e.append(this._bufs[t]);return e},BufferList$1.prototype.append=function(e){return this._attach(e,BufferList$1.prototype._appendBuffer)},BufferList$1.prototype.prepend=function(e){return this._attach(e,BufferList$1.prototype._prependBuffer,!0)},BufferList$1.prototype._attach=function(e,t,r){if(null==e)return this;if(e.buffer)t.call(this,Buffer$3.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(var n=_slicedToArray(r?[e.length-1,-1]:[0,1],2),i=n[0],o=n[1],s=i;s>=0&&s<e.length;s+=o)this._attach(e[s],t,r);else if(this._isBufferList(e))for(var a=_slicedToArray(r?[e._bufs.length-1,-1]:[0,1],2),c=a[0],l=a[1],u=c;u>=0&&u<e._bufs.length;u+=l)this._attach(e._bufs[u],t,r);else"number"==typeof e&&(e=e.toString()),t.call(this,Buffer$3.from(e));return this},BufferList$1.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length},BufferList$1.prototype._prependBuffer=function(e){this._bufs.unshift(e),this.length+=e.length},BufferList$1.prototype.indexOf=function(e,t,r){if(void 0===r&&"string"==typeof t&&(r=t,t=void 0),"function"==typeof e||Array.isArray(e))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if("number"==typeof e?e=Buffer$3.from([e]):"string"==typeof e?e=Buffer$3.from(e,r):this._isBufferList(e)?e=e.slice():Array.isArray(e.buffer)?e=Buffer$3.from(e.buffer,e.byteOffset,e.byteLength):Buffer$3.isBuffer(e)||(e=Buffer$3.from(e)),t=Number(t||0),isNaN(t)&&(t=0),t<0&&(t=this.length+t),t<0&&(t=0),0===e.length)return t>this.length?this.length:t;for(var n=this._offset(t),i=n[0],o=n[1];i<this._bufs.length;i++){for(var s=this._bufs[i];o<s.length;){if(s.length-o>=e.length){var a=s.indexOf(e,o);if(-1!==a)return this._reverseOffset([i,a]);o=s.length-e.length+1}else{var c=this._reverseOffset([i,o]);if(this._match(c,e))return c;o++}}o=0}return-1},BufferList$1.prototype._match=function(e,t){if(this.length-e<t.length)return!1;for(var r=0;r<t.length;r++)if(this.get(e+r)!==t[r])return!1;return!0},function(){var e={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readBigInt64BE:8,readBigInt64LE:8,readBigUInt64BE:8,readBigUInt64LE:8,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(var t in e)!function(t){BufferList$1.prototype[t]=null===e[t]?function(e,r){return this.slice(e,e+r)[t](0,r)}:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.slice(r,r+e[t])[t](0)}}(t)}(),BufferList$1.prototype._isBufferList=function(e){return e instanceof BufferList$1||BufferList$1.isBufferList(e)},BufferList$1.isBufferList=function(e){return null!=e&&e[symbol]};var BufferList_1$1=BufferList$1,BufferList$2=getDefaultExportFromCjs(BufferList_1$1),bl$1=bl$3.exports,DuplexStream=oursExports.Duplex,inherits=require$$1$4,BufferList=BufferList_1$1;function BufferListStream(e){if(!(this instanceof BufferListStream))return new BufferListStream(e);if("function"==typeof e){this._callback=e;var t=function(e){this._callback&&(this._callback(e),this._callback=null)}.bind(this);this.on("pipe",(function(e){e.on("error",t)})),this.on("unpipe",(function(e){e.removeListener("error",t)})),e=null}BufferList._init.call(this,e),DuplexStream.call(this)}inherits(BufferListStream,DuplexStream),Object.assign(BufferListStream.prototype,BufferList.prototype),BufferListStream.prototype._new=function(e){return new BufferListStream(e)},BufferListStream.prototype._write=function(e,t,r){this._appendBuffer(e),"function"==typeof r&&r()},BufferListStream.prototype._read=function(e){if(!this.length)return this.push(null);e=Math.min(e,this.length),this.push(this.slice(0,e)),this.consume(e)},BufferListStream.prototype.end=function(e){DuplexStream.prototype.end.call(this,e),this._callback&&(this._callback(null,this.slice()),this._callback=null)},BufferListStream.prototype._destroy=function(e,t){this._bufs.length=0,this.length=0,t(e)},BufferListStream.prototype._isBufferList=function(e){return e instanceof BufferListStream||e instanceof BufferList||BufferListStream.isBufferList(e)},BufferListStream.isBufferList=BufferList.isBufferList,bl$3.exports=BufferListStream;var BufferListStream_1=bl$3.exports.BufferListStream=BufferListStream,BufferList_1=bl$3.exports.BufferList=BufferList,blExports=bl$3.exports,bl$2=getDefaultExportFromCjs(blExports),Packet$1=_createClass((function e(){_classCallCheck(this,e),this.cmd=null,this.retain=!1,this.qos=0,this.dup=!1,this.length=-1,this.topic=null,this.payload=null})),packet=Packet$1,packet$1=getDefaultExportFromCjs(packet),constants$7={exports:{}},constants$5=constants$7.exports;!function(e){var t=e.exports,r=require$$0$a.Buffer;for(var n in t.types={0:"reserved",1:"connect",2:"connack",3:"publish",4:"puback",5:"pubrec",6:"pubrel",7:"pubcomp",8:"subscribe",9:"suback",10:"unsubscribe",11:"unsuback",12:"pingreq",13:"pingresp",14:"disconnect",15:"auth"},t.requiredHeaderFlags={1:0,2:0,4:0,5:0,6:2,7:0,8:2,9:0,10:2,11:0,12:0,13:0,14:0,15:0},t.requiredHeaderFlagsErrors={},t.requiredHeaderFlags){var i=t.requiredHeaderFlags[n];t.requiredHeaderFlagsErrors[n]="Invalid header flag bits, must be 0x"+i.toString(16)+" for "+t.types[n]+" packet"}for(var o in t.codes={},t.types){var s=t.types[o];t.codes[s]=o}for(var a in t.CMD_SHIFT=4,t.CMD_MASK=240,t.DUP_MASK=8,t.QOS_MASK=3,t.QOS_SHIFT=1,t.RETAIN_MASK=1,t.VARBYTEINT_MASK=127,t.VARBYTEINT_FIN_MASK=128,t.VARBYTEINT_MAX=268435455,t.SESSIONPRESENT_MASK=1,t.SESSIONPRESENT_HEADER=r.from([t.SESSIONPRESENT_MASK]),t.CONNACK_HEADER=r.from([t.codes.connack<<t.CMD_SHIFT]),t.USERNAME_MASK=128,t.PASSWORD_MASK=64,t.WILL_RETAIN_MASK=32,t.WILL_QOS_MASK=24,t.WILL_QOS_SHIFT=3,t.WILL_FLAG_MASK=4,t.CLEAN_SESSION_MASK=2,t.CONNECT_HEADER=r.from([t.codes.connect<<t.CMD_SHIFT]),t.properties={sessionExpiryInterval:17,willDelayInterval:24,receiveMaximum:33,maximumPacketSize:39,topicAliasMaximum:34,requestResponseInformation:25,requestProblemInformation:23,userProperties:38,authenticationMethod:21,authenticationData:22,payloadFormatIndicator:1,messageExpiryInterval:2,contentType:3,responseTopic:8,correlationData:9,maximumQoS:36,retainAvailable:37,assignedClientIdentifier:18,reasonString:31,wildcardSubscriptionAvailable:40,subscriptionIdentifiersAvailable:41,sharedSubscriptionAvailable:42,serverKeepAlive:19,responseInformation:26,serverReference:28,topicAlias:35,subscriptionIdentifier:11},t.propertiesCodes={},t.properties){var c=t.properties[a];t.propertiesCodes[c]=a}function l(e){return[0,1,2].map((function(n){return[0,1].map((function(i){return[0,1].map((function(o){var s=r.alloc(1);return s.writeUInt8(t.codes[e]<<t.CMD_SHIFT|(i?t.DUP_MASK:0)|n<<t.QOS_SHIFT|o,0,!0),s}))}))}))}t.propertiesTypes={sessionExpiryInterval:"int32",willDelayInterval:"int32",receiveMaximum:"int16",maximumPacketSize:"int32",topicAliasMaximum:"int16",requestResponseInformation:"byte",requestProblemInformation:"byte",userProperties:"pair",authenticationMethod:"string",authenticationData:"binary",payloadFormatIndicator:"byte",messageExpiryInterval:"int32",contentType:"string",responseTopic:"string",correlationData:"binary",maximumQoS:"int8",retainAvailable:"byte",assignedClientIdentifier:"string",reasonString:"string",wildcardSubscriptionAvailable:"byte",subscriptionIdentifiersAvailable:"byte",sharedSubscriptionAvailable:"byte",serverKeepAlive:"int16",responseInformation:"string",serverReference:"string",topicAlias:"int16",subscriptionIdentifier:"var"},t.PUBLISH_HEADER=l("publish"),t.SUBSCRIBE_HEADER=l("subscribe"),t.SUBSCRIBE_OPTIONS_QOS_MASK=3,t.SUBSCRIBE_OPTIONS_NL_MASK=1,t.SUBSCRIBE_OPTIONS_NL_SHIFT=2,t.SUBSCRIBE_OPTIONS_RAP_MASK=1,t.SUBSCRIBE_OPTIONS_RAP_SHIFT=3,t.SUBSCRIBE_OPTIONS_RH_MASK=3,t.SUBSCRIBE_OPTIONS_RH_SHIFT=4,t.SUBSCRIBE_OPTIONS_RH=[0,16,32],t.SUBSCRIBE_OPTIONS_NL=4,t.SUBSCRIBE_OPTIONS_RAP=8,t.SUBSCRIBE_OPTIONS_QOS=[0,1,2],t.UNSUBSCRIBE_HEADER=l("unsubscribe"),t.ACKS={unsuback:l("unsuback"),puback:l("puback"),pubcomp:l("pubcomp"),pubrel:l("pubrel"),pubrec:l("pubrec")},t.SUBACK_HEADER=r.from([t.codes.suback<<t.CMD_SHIFT]),t.VERSION3=r.from([3]),t.VERSION4=r.from([4]),t.VERSION5=r.from([5]),t.VERSION131=r.from([131]),t.VERSION132=r.from([132]),t.QOS=[0,1,2].map((function(e){return r.from([e])})),t.EMPTY={pingreq:r.from([t.codes.pingreq<<4,0]),pingresp:r.from([t.codes.pingresp<<4,0]),disconnect:r.from([t.codes.disconnect<<4,0])},t.MQTT5_PUBACK_PUBREC_CODES={0:"Success",16:"No matching subscribers",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",144:"Topic Name invalid",145:"Packet identifier in use",151:"Quota exceeded",153:"Payload format invalid"},t.MQTT5_PUBREL_PUBCOMP_CODES={0:"Success",146:"Packet Identifier not found"},t.MQTT5_SUBACK_CODES={0:"Granted QoS 0",1:"Granted QoS 1",2:"Granted QoS 2",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",143:"Topic Filter invalid",145:"Packet Identifier in use",151:"Quota exceeded",158:"Shared Subscriptions not supported",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"},t.MQTT5_UNSUBACK_CODES={0:"Success",17:"No subscription existed",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",143:"Topic Filter invalid",145:"Packet Identifier in use"},t.MQTT5_DISCONNECT_CODES={0:"Normal disconnection",4:"Disconnect with Will Message",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",135:"Not authorized",137:"Server busy",139:"Server shutting down",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"},t.MQTT5_AUTH_CODES={0:"Success",24:"Continue authentication",25:"Re-authenticate"}}(constants$7);var constantsExports=constants$7.exports,constants$6=getDefaultExportFromCjs(constantsExports),src$1={exports:{}},browser$2={exports:{}},ms$1,hasRequiredMs,common$1,hasRequiredCommon$1;function requireMs(){if(hasRequiredMs)return ms$1;hasRequiredMs=1;var e=1e3,t=60*e,r=60*t,n=24*r,i=7*n,o=365.25*n;function s(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}return ms$1=function(a,c){c=c||{};var l=_typeof(a);if("string"===l&&a.length>0)return function(s){if((s=String(s)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(s);if(!a)return;var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*o;case"weeks":case"week":case"w":return c*i;case"days":case"day":case"d":return c*n;case"hours":case"hour":case"hrs":case"hr":case"h":return c*r;case"minutes":case"minute":case"mins":case"min":case"m":return c*t;case"seconds":case"second":case"secs":case"sec":case"s":return c*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(a);if("number"===l&&isFinite(a))return c.long?function(i){var o=Math.abs(i);if(o>=n)return s(i,o,n,"day");if(o>=r)return s(i,o,r,"hour");if(o>=t)return s(i,o,t,"minute");if(o>=e)return s(i,o,e,"second");return i+" ms"}(a):function(i){var o=Math.abs(i);if(o>=n)return Math.round(i/n)+"d";if(o>=r)return Math.round(i/r)+"h";if(o>=t)return Math.round(i/t)+"m";if(o>=e)return Math.round(i/e)+"s";return i+"ms"}(a);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(a))},ms$1}function requireCommon$1(){if(hasRequiredCommon$1)return common$1;return hasRequiredCommon$1=1,common$1=function(e){function t(e){var n,i,o,s=null;function a(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];if(a.enabled){var o=a,s=Number(new Date),c=s-(n||s);o.diff=c,o.prev=n,o.curr=s,n=s,r[0]=t.coerce(r[0]),"string"!=typeof r[0]&&r.unshift("%O");var l=0;r[0]=r[0].replace(/%([a-zA-Z%])/g,(function(e,n){if("%%"===e)return"%";l++;var i=t.formatters[n];if("function"==typeof i){var s=r[l];e=i.call(o,s),r.splice(l,1),l--}return e})),t.formatArgs.call(o,r),(o.log||t.log).apply(o,r)}}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=r,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==s?s:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o)},set:function(e){s=e}}),"function"==typeof t.init&&t.init(a),a}function r(e,r){var n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function n(e,t){for(var r=0,n=0,i=-1,o=0;r<e.length;)if(n<t.length&&(t[n]===e[r]||"*"===t[n]))"*"===t[n]?(i=n,o=r,n++):(r++,n++);else{if(-1===i)return!1;n=i+1,r=++o}for(;n<t.length&&"*"===t[n];)n++;return n===t.length}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){var e=[].concat(_toConsumableArray(t.names),_toConsumableArray(t.skips.map((function(e){return"-"+e})))).join(",");return t.enable(""),e},t.enable=function(e){t.save(e),t.namespaces=e,t.names=[],t.skips=[];var r,n=_createForOfIteratorHelper(("string"==typeof e?e:"").trim().replace(/\s+/g,",").split(",").filter(Boolean));try{for(n.s();!(r=n.n()).done;){var i=r.value;"-"===i[0]?t.skips.push(i.slice(1)):t.names.push(i)}}catch(e){n.e(e)}finally{n.f()}},t.enabled=function(e){var r,i=_createForOfIteratorHelper(t.skips);try{for(i.s();!(r=i.n()).done;){if(n(e,r.value))return!1}}catch(e){i.e(e)}finally{i.f()}var o,s=_createForOfIteratorHelper(t.names);try{for(s.s();!(o=s.n()).done;){if(n(e,o.value))return!0}}catch(e){s.e(e)}finally{s.f()}return!1},t.humanize=requireMs(),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((function(r){t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){for(var r=0,n=0;n<e.length;n++)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t},common$1}var browser$1=browser$2.exports,hasRequiredBrowser;function requireBrowser(){return hasRequiredBrowser||(hasRequiredBrowser=1,function(e,t){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(n++,"%c"===e&&(i=n))})),t.splice(i,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){var e;try{e=t.storage.getItem("debug")||t.storage.getItem("DEBUG")}catch(e){}!e&&void 0!==browser$1$1&&"env"in browser$1$1&&(e=browser$1$1.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;var e;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=function(){var e=!1;return function(){e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||function(){},e.exports=requireCommon$1()(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}(browser$2,browser$2.exports)),browser$2.exports}var node$1={exports:{}};function isatty(){return!1}function ReadStream(){throw new Error("tty.ReadStream is not implemented")}function WriteStream(){throw new Error("tty.ReadStream is not implemented")}var _polyfillNode_tty={isatty:isatty,ReadStream:ReadStream,WriteStream:WriteStream},_polyfillNode_tty$1=Object.freeze({__proto__:null,isatty:isatty,ReadStream:ReadStream,WriteStream:WriteStream,default:_polyfillNode_tty}),require$$0$6=getAugmentedNamespace(_polyfillNode_tty$1),require$$4=getAugmentedNamespace(_polyfillNode_util$1),_endianness;function endianness(){if(void 0===_endianness){var e=new ArrayBuffer(2),t=new Uint8Array(e),r=new Uint16Array(e);if(t[0]=1,t[1]=2,258===r[0])_endianness="BE";else{if(513!==r[0])throw new Error("unable to figure out endianess");_endianness="LE"}}return _endianness}function hostname(){return void 0!==global$1.location?global$1.location.hostname:""}function loadavg(){return[]}function uptime(){return 0}function freemem(){return Number.MAX_VALUE}function totalmem(){return Number.MAX_VALUE}function cpus(){return[]}function type(){return"Browser"}function release(){return void 0!==global$1.navigator?global$1.navigator.appVersion:""}function networkInterfaces(){return{}}function getNetworkInterfaces(){return{}}function arch(){return"javascript"}function platform(){return"browser"}function tmpDir(){return"/tmp"}var tmpdir=tmpDir,EOL="\n";function homedir(){return"$HOME"}var _polyfillNode_os={homedir:homedir,EOL:EOL,arch:arch,platform:platform,tmpdir:tmpdir,tmpDir:tmpDir,networkInterfaces:networkInterfaces,getNetworkInterfaces:getNetworkInterfaces,release:release,type:type,cpus:cpus,totalmem:totalmem,freemem:freemem,uptime:uptime,loadavg:loadavg,hostname:hostname,endianness:endianness},_polyfillNode_os$1=Object.freeze({__proto__:null,endianness:endianness,hostname:hostname,loadavg:loadavg,uptime:uptime,freemem:freemem,totalmem:totalmem,cpus:cpus,type:type,release:release,networkInterfaces:networkInterfaces,getNetworkInterfaces:getNetworkInterfaces,arch:arch,platform:platform,tmpDir:tmpDir,tmpdir:tmpdir,EOL:EOL,homedir:homedir,default:_polyfillNode_os}),require$$0$5=getAugmentedNamespace(_polyfillNode_os$1),hasFlag,hasRequiredHasFlag,supportsColor_1,hasRequiredSupportsColor;function requireHasFlag(){return hasRequiredHasFlag||(hasRequiredHasFlag=1,hasFlag=function(e,t){t=t||browser$1$1.argv;var r=e.startsWith("-")?"":1===e.length?"-":"--",n=t.indexOf(r+e),i=t.indexOf("--");return-1!==n&&(-1===i||n<i)}),hasFlag}function requireSupportsColor(){if(hasRequiredSupportsColor)return supportsColor_1;hasRequiredSupportsColor=1;var e,t=require$$0$5,r=requireHasFlag(),n=browser$1$1.env;function i(i){var o=function(i){if(!1===e)return 0;if(r("color=16m")||r("color=full")||r("color=truecolor"))return 3;if(r("color=256"))return 2;if(i&&!i.isTTY&&!0!==e)return 0;var o=e?1:0;if("win32"===browser$1$1.platform){var s=t.release().split(".");return Number(browser$1$1.versions.node.split(".")[0])>=8&&Number(s[0])>=10&&Number(s[2])>=10586?Number(s[2])>=14931?3:2:1}if("CI"in n)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some((function(e){return e in n}))||"codeship"===n.CI_NAME?1:o;if("TEAMCITY_VERSION"in n)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(n.TEAMCITY_VERSION)?1:0;if("truecolor"===n.COLORTERM)return 3;if("TERM_PROGRAM"in n){var a=parseInt((n.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(n.TERM_PROGRAM){case"iTerm.app":return a>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(n.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(n.TERM)||"COLORTERM"in n?1:(n.TERM,o)}(i);return function(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}(o)}return r("no-color")||r("no-colors")||r("color=false")?e=!1:(r("color")||r("colors")||r("color=true")||r("color=always"))&&(e=!0),"FORCE_COLOR"in n&&(e=0===n.FORCE_COLOR.length||0!==parseInt(n.FORCE_COLOR,10)),supportsColor_1={supportsColor:i,stdout:i(browser$1$1.stdout),stderr:i(browser$1$1.stderr)}}var node=node$1.exports,hasRequiredNode;function requireNode(){return hasRequiredNode||(hasRequiredNode=1,function(e,t){var r=require$$0$6,n=require$$4;t.init=function(e){e.inspectOpts={};for(var r=Object.keys(t.inspectOpts),n=0;n<r.length;n++)e.inspectOpts[r[n]]=t.inspectOpts[r[n]]},t.log=function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return browser$1$1.stderr.write(n.formatWithOptions.apply(n,[t.inspectOpts].concat(r))+"\n")},t.formatArgs=function(r){var n=this.namespace,i=this.useColors;if(i){var o=this.color,s="[3"+(o<8?o:"8;5;"+o),a="  ".concat(s,";1m").concat(n," [0m");r[0]=a+r[0].split("\n").join("\n"+a),r.push(s+"m+"+e.exports.humanize(this.diff)+"[0m")}else r[0]=function(){if(t.inspectOpts.hideDate)return"";return(new Date).toISOString()+" "}()+n+" "+r[0]},t.save=function(e){e?browser$1$1.env.DEBUG=e:delete browser$1$1.env.DEBUG},t.load=function(){return browser$1$1.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):r.isatty(browser$1$1.stderr.fd)},t.destroy=n.deprecate((function(){}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{var i=requireSupportsColor();i&&(i.stderr||i).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(browser$1$1.env).filter((function(e){return/^debug_/i.test(e)})).reduce((function(e,t){var r=t.substring(6).toLowerCase().replace(/_([a-z])/g,(function(e,t){return t.toUpperCase()})),n=browser$1$1.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e}),{}),e.exports=requireCommon$1()(t);var o=e.exports.formatters;o.o=function(e){return this.inspectOpts.colors=this.useColors,n.inspect(e,this.inspectOpts).split("\n").map((function(e){return e.trim()})).join(" ")},o.O=function(e){return this.inspectOpts.colors=this.useColors,n.inspect(e,this.inspectOpts)}}(node$1,node$1.exports)),node$1.exports}var src=src$1.exports;void 0===browser$1$1||"renderer"===browser$1$1.type||!0===browser$1$1.browser||browser$1$1.__nwjs?src$1.exports=requireBrowser():src$1.exports=requireNode();var srcExports=src$1.exports,index$2=getDefaultExportFromCjs(srcExports),bl=blExports,EventEmitter$1=require$$0$8.EventEmitter,Packet=packet,constants$4=constantsExports,debug$2=srcExports("mqtt-packet:parser"),Parser=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t)).parser=e.constructor.parser,e}return _inherits(t,e),_createClass(t,[{key:"_resetState",value:function(){debug$2("_resetState: resetting packet, error, _list, and _stateCounter"),this.packet=new Packet,this.error=null,this._list=bl(),this._stateCounter=0}},{key:"parse",value:function(e){for(this.error&&this._resetState(),this._list.append(e),debug$2("parse: current state: %s",this._states[this._stateCounter]);(-1!==this.packet.length||this._list.length>0)&&this[this._states[this._stateCounter]]()&&!this.error;)this._stateCounter++,debug$2("parse: state complete. _stateCounter is now: %d",this._stateCounter),debug$2("parse: packet.length: %d, buffer list length: %d",this.packet.length,this._list.length),this._stateCounter>=this._states.length&&(this._stateCounter=0);return debug$2("parse: exited while loop. packet: %d, buffer list length: %d",this.packet.length,this._list.length),this._list.length}},{key:"_parseHeader",value:function(){var e=this._list.readUInt8(0),t=e>>constants$4.CMD_SHIFT;this.packet.cmd=constants$4.types[t];var r=15&e,n=constants$4.requiredHeaderFlags[t];return null!=n&&r!==n?this._emitError(new Error(constants$4.requiredHeaderFlagsErrors[t])):(this.packet.retain=0!=(e&constants$4.RETAIN_MASK),this.packet.qos=e>>constants$4.QOS_SHIFT&constants$4.QOS_MASK,this.packet.qos>2?this._emitError(new Error("Packet must not have both QoS bits set to 1")):(this.packet.dup=0!=(e&constants$4.DUP_MASK),debug$2("_parseHeader: packet: %o",this.packet),this._list.consume(1),!0))}},{key:"_parseLength",value:function(){var e=this._parseVarByteNum(!0);return e&&(this.packet.length=e.value,this._list.consume(e.bytes)),debug$2("_parseLength %d",e.value),!!e}},{key:"_parsePayload",value:function(){debug$2("_parsePayload: payload %O",this._list);var e=!1;if(0===this.packet.length||this._list.length>=this.packet.length){switch(this._pos=0,this.packet.cmd){case"connect":this._parseConnect();break;case"connack":this._parseConnack();break;case"publish":this._parsePublish();break;case"puback":case"pubrec":case"pubrel":case"pubcomp":this._parseConfirmation();break;case"subscribe":this._parseSubscribe();break;case"suback":this._parseSuback();break;case"unsubscribe":this._parseUnsubscribe();break;case"unsuback":this._parseUnsuback();break;case"pingreq":case"pingresp":break;case"disconnect":this._parseDisconnect();break;case"auth":this._parseAuth();break;default:this._emitError(new Error("Not supported"))}e=!0}return debug$2("_parsePayload complete result: %s",e),e}},{key:"_parseConnect",value:function(){var e,t,r,n;debug$2("_parseConnect");var i={},o=this.packet,s=this._parseString();if(null===s)return this._emitError(new Error("Cannot parse protocolId"));if("MQTT"!==s&&"MQIsdp"!==s)return this._emitError(new Error("Invalid protocolId"));if(o.protocolId=s,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(o.protocolVersion=this._list.readUInt8(this._pos),o.protocolVersion>=128&&(o.bridgeMode=!0,o.protocolVersion=o.protocolVersion-128),3!==o.protocolVersion&&4!==o.protocolVersion&&5!==o.protocolVersion)return this._emitError(new Error("Invalid protocol version"));if(this._pos++,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(1&this._list.readUInt8(this._pos))return this._emitError(new Error("Connect flag bit 0 must be 0, but got 1"));i.username=this._list.readUInt8(this._pos)&constants$4.USERNAME_MASK,i.password=this._list.readUInt8(this._pos)&constants$4.PASSWORD_MASK,i.will=this._list.readUInt8(this._pos)&constants$4.WILL_FLAG_MASK;var a=!!(this._list.readUInt8(this._pos)&constants$4.WILL_RETAIN_MASK),c=(this._list.readUInt8(this._pos)&constants$4.WILL_QOS_MASK)>>constants$4.WILL_QOS_SHIFT;if(i.will)o.will={},o.will.retain=a,o.will.qos=c;else{if(a)return this._emitError(new Error("Will Retain Flag must be set to zero when Will Flag is set to 0"));if(c)return this._emitError(new Error("Will QoS must be set to zero when Will Flag is set to 0"))}if(o.clean=0!=(this._list.readUInt8(this._pos)&constants$4.CLEAN_SESSION_MASK),this._pos++,o.keepalive=this._parseNum(),-1===o.keepalive)return this._emitError(new Error("Packet too short"));if(5===o.protocolVersion){var l=this._parseProperties();Object.getOwnPropertyNames(l).length&&(o.properties=l)}var u=this._parseString();if(null===u)return this._emitError(new Error("Packet too short"));if(o.clientId=u,debug$2("_parseConnect: packet.clientId: %s",o.clientId),i.will){if(5===o.protocolVersion){var d=this._parseProperties();Object.getOwnPropertyNames(d).length&&(o.will.properties=d)}if(null===(e=this._parseString()))return this._emitError(new Error("Cannot parse will topic"));if(o.will.topic=e,debug$2("_parseConnect: packet.will.topic: %s",o.will.topic),null===(t=this._parseBuffer()))return this._emitError(new Error("Cannot parse will payload"));o.will.payload=t,debug$2("_parseConnect: packet.will.paylaod: %s",o.will.payload)}if(i.username){if(null===(n=this._parseString()))return this._emitError(new Error("Cannot parse username"));o.username=n,debug$2("_parseConnect: packet.username: %s",o.username)}if(i.password){if(null===(r=this._parseBuffer()))return this._emitError(new Error("Cannot parse password"));o.password=r}return this.settings=o,debug$2("_parseConnect: complete"),o}},{key:"_parseConnack",value:function(){debug$2("_parseConnack");var e=this.packet;if(this._list.length<1)return null;var t=this._list.readUInt8(this._pos++);if(t>1)return this._emitError(new Error("Invalid connack flags, bits 7-1 must be set to 0"));if(e.sessionPresent=!!(t&constants$4.SESSIONPRESENT_MASK),5===this.settings.protocolVersion)this._list.length>=2?e.reasonCode=this._list.readUInt8(this._pos++):e.reasonCode=0;else{if(this._list.length<2)return null;e.returnCode=this._list.readUInt8(this._pos++)}if(-1===e.returnCode||-1===e.reasonCode)return this._emitError(new Error("Cannot parse return code"));if(5===this.settings.protocolVersion){var r=this._parseProperties();Object.getOwnPropertyNames(r).length&&(e.properties=r)}debug$2("_parseConnack: complete")}},{key:"_parsePublish",value:function(){debug$2("_parsePublish");var e=this.packet;if(e.topic=this._parseString(),null===e.topic)return this._emitError(new Error("Cannot parse topic"));if(!(e.qos>0)||this._parseMessageId()){if(5===this.settings.protocolVersion){var t=this._parseProperties();Object.getOwnPropertyNames(t).length&&(e.properties=t)}e.payload=this._list.slice(this._pos,e.length),debug$2("_parsePublish: payload from buffer list: %o",e.payload)}}},{key:"_parseSubscribe",value:function(){debug$2("_parseSubscribe");var e,t,r,n,i,o,s,a=this.packet;if(a.subscriptions=[],this._parseMessageId()){if(5===this.settings.protocolVersion){var c=this._parseProperties();Object.getOwnPropertyNames(c).length&&(a.properties=c)}if(a.length<=0)return this._emitError(new Error("Malformed subscribe, no payload specified"));for(;this._pos<a.length;){if(null===(e=this._parseString()))return this._emitError(new Error("Cannot parse topic"));if(this._pos>=a.length)return this._emitError(new Error("Malformed Subscribe Payload"));if(t=this._parseByte(),5===this.settings.protocolVersion){if(192&t)return this._emitError(new Error("Invalid subscribe topic flag bits, bits 7-6 must be 0"))}else if(252&t)return this._emitError(new Error("Invalid subscribe topic flag bits, bits 7-2 must be 0"));if((r=t&constants$4.SUBSCRIBE_OPTIONS_QOS_MASK)>2)return this._emitError(new Error("Invalid subscribe QoS, must be <= 2"));if(o=0!=(t>>constants$4.SUBSCRIBE_OPTIONS_NL_SHIFT&constants$4.SUBSCRIBE_OPTIONS_NL_MASK),i=0!=(t>>constants$4.SUBSCRIBE_OPTIONS_RAP_SHIFT&constants$4.SUBSCRIBE_OPTIONS_RAP_MASK),(n=t>>constants$4.SUBSCRIBE_OPTIONS_RH_SHIFT&constants$4.SUBSCRIBE_OPTIONS_RH_MASK)>2)return this._emitError(new Error("Invalid retain handling, must be <= 2"));s={topic:e,qos:r},5===this.settings.protocolVersion?(s.nl=o,s.rap=i,s.rh=n):this.settings.bridgeMode&&(s.rh=0,s.rap=!0,s.nl=!0),debug$2("_parseSubscribe: push subscription `%s` to subscription",s),a.subscriptions.push(s)}}}},{key:"_parseSuback",value:function(){debug$2("_parseSuback");var e=this.packet;if(this.packet.granted=[],this._parseMessageId()){if(5===this.settings.protocolVersion){var t=this._parseProperties();Object.getOwnPropertyNames(t).length&&(e.properties=t)}if(e.length<=0)return this._emitError(new Error("Malformed suback, no payload specified"));for(;this._pos<this.packet.length;){var r=this._list.readUInt8(this._pos++);if(5===this.settings.protocolVersion){if(!constants$4.MQTT5_SUBACK_CODES[r])return this._emitError(new Error("Invalid suback code"))}else if(r>2&&128!==r)return this._emitError(new Error("Invalid suback QoS, must be 0, 1, 2 or 128"));this.packet.granted.push(r)}}}},{key:"_parseUnsubscribe",value:function(){debug$2("_parseUnsubscribe");var e=this.packet;if(e.unsubscriptions=[],this._parseMessageId()){if(5===this.settings.protocolVersion){var t=this._parseProperties();Object.getOwnPropertyNames(t).length&&(e.properties=t)}if(e.length<=0)return this._emitError(new Error("Malformed unsubscribe, no payload specified"));for(;this._pos<e.length;){var r=this._parseString();if(null===r)return this._emitError(new Error("Cannot parse topic"));debug$2("_parseUnsubscribe: push topic `%s` to unsubscriptions",r),e.unsubscriptions.push(r)}}}},{key:"_parseUnsuback",value:function(){debug$2("_parseUnsuback");var e=this.packet;if(!this._parseMessageId())return this._emitError(new Error("Cannot parse messageId"));if((3===this.settings.protocolVersion||4===this.settings.protocolVersion)&&2!==e.length)return this._emitError(new Error("Malformed unsuback, payload length must be 2"));if(e.length<=0)return this._emitError(new Error("Malformed unsuback, no payload specified"));if(5===this.settings.protocolVersion){var t=this._parseProperties();for(Object.getOwnPropertyNames(t).length&&(e.properties=t),e.granted=[];this._pos<this.packet.length;){var r=this._list.readUInt8(this._pos++);if(!constants$4.MQTT5_UNSUBACK_CODES[r])return this._emitError(new Error("Invalid unsuback code"));this.packet.granted.push(r)}}}},{key:"_parseConfirmation",value:function(){debug$2("_parseConfirmation: packet.cmd: `%s`",this.packet.cmd);var e=this.packet;if(this._parseMessageId(),5===this.settings.protocolVersion){if(e.length>2){switch(e.reasonCode=this._parseByte(),this.packet.cmd){case"puback":case"pubrec":if(!constants$4.MQTT5_PUBACK_PUBREC_CODES[e.reasonCode])return this._emitError(new Error("Invalid "+this.packet.cmd+" reason code"));break;case"pubrel":case"pubcomp":if(!constants$4.MQTT5_PUBREL_PUBCOMP_CODES[e.reasonCode])return this._emitError(new Error("Invalid "+this.packet.cmd+" reason code"))}debug$2("_parseConfirmation: packet.reasonCode `%d`",e.reasonCode)}else e.reasonCode=0;if(e.length>3){var t=this._parseProperties();Object.getOwnPropertyNames(t).length&&(e.properties=t)}}return!0}},{key:"_parseDisconnect",value:function(){var e=this.packet;if(debug$2("_parseDisconnect"),5===this.settings.protocolVersion){this._list.length>0?(e.reasonCode=this._parseByte(),constants$4.MQTT5_DISCONNECT_CODES[e.reasonCode]||this._emitError(new Error("Invalid disconnect reason code"))):e.reasonCode=0;var t=this._parseProperties();Object.getOwnPropertyNames(t).length&&(e.properties=t)}return debug$2("_parseDisconnect result: true"),!0}},{key:"_parseAuth",value:function(){debug$2("_parseAuth");var e=this.packet;if(5!==this.settings.protocolVersion)return this._emitError(new Error("Not supported auth packet for this version MQTT"));if(e.reasonCode=this._parseByte(),!constants$4.MQTT5_AUTH_CODES[e.reasonCode])return this._emitError(new Error("Invalid auth reason code"));var t=this._parseProperties();return Object.getOwnPropertyNames(t).length&&(e.properties=t),debug$2("_parseAuth: result: true"),!0}},{key:"_parseMessageId",value:function(){var e=this.packet;return e.messageId=this._parseNum(),null===e.messageId?(this._emitError(new Error("Cannot parse messageId")),!1):(debug$2("_parseMessageId: packet.messageId %d",e.messageId),!0)}},{key:"_parseString",value:function(e){var t=this._parseNum(),r=t+this._pos;if(-1===t||r>this._list.length||r>this.packet.length)return null;var n=this._list.toString("utf8",this._pos,r);return this._pos+=t,debug$2("_parseString: result: %s",n),n}},{key:"_parseStringPair",value:function(){return debug$2("_parseStringPair"),{name:this._parseString(),value:this._parseString()}}},{key:"_parseBuffer",value:function(){var e=this._parseNum(),t=e+this._pos;if(-1===e||t>this._list.length||t>this.packet.length)return null;var r=this._list.slice(this._pos,t);return this._pos+=e,debug$2("_parseBuffer: result: %o",r),r}},{key:"_parseNum",value:function(){if(this._list.length-this._pos<2)return-1;var e=this._list.readUInt16BE(this._pos);return this._pos+=2,debug$2("_parseNum: result: %s",e),e}},{key:"_parse4ByteNum",value:function(){if(this._list.length-this._pos<4)return-1;var e=this._list.readUInt32BE(this._pos);return this._pos+=4,debug$2("_parse4ByteNum: result: %s",e),e}},{key:"_parseVarByteNum",value:function(e){debug$2("_parseVarByteNum");for(var t,r=0,n=1,i=0,o=!1,s=this._pos?this._pos:0;r<4&&s+r<this._list.length;){if(i+=n*((t=this._list.readUInt8(s+r++))&constants$4.VARBYTEINT_MASK),n*=128,0==(t&constants$4.VARBYTEINT_FIN_MASK)){o=!0;break}if(this._list.length<=r)break}return!o&&4===r&&this._list.length>=r&&this._emitError(new Error("Invalid variable byte integer")),s&&(this._pos+=r),debug$2("_parseVarByteNum: result: %o",o=!!o&&(e?{bytes:r,value:i}:i)),o}},{key:"_parseByte",value:function(){var e;return this._pos<this._list.length&&(e=this._list.readUInt8(this._pos),this._pos++),debug$2("_parseByte: result: %o",e),e}},{key:"_parseByType",value:function(e){switch(debug$2("_parseByType: type: %s",e),e){case"byte":return 0!==this._parseByte();case"int8":return this._parseByte();case"int16":return this._parseNum();case"int32":return this._parse4ByteNum();case"var":return this._parseVarByteNum();case"string":return this._parseString();case"pair":return this._parseStringPair();case"binary":return this._parseBuffer()}}},{key:"_parseProperties",value:function(){debug$2("_parseProperties");for(var e=this._parseVarByteNum(),t=this._pos+e,r={};this._pos<t;){var n=this._parseByte();if(!n)return this._emitError(new Error("Cannot parse property code type")),!1;var i=constants$4.propertiesCodes[n];if(!i)return this._emitError(new Error("Unknown property")),!1;if("userProperties"!==i)r[i]?(Array.isArray(r[i])||(r[i]=[r[i]]),r[i].push(this._parseByType(constants$4.propertiesTypes[i]))):r[i]=this._parseByType(constants$4.propertiesTypes[i]);else{r[i]||(r[i]=Object.create(null));var o=this._parseByType(constants$4.propertiesTypes[i]);if(r[i][o.name])if(Array.isArray(r[i][o.name]))r[i][o.name].push(o.value);else{var s=r[i][o.name];r[i][o.name]=[s],r[i][o.name].push(o.value)}else r[i][o.name]=o.value}}return r}},{key:"_newPacket",value:function(){return debug$2("_newPacket"),this.packet&&(this._list.consume(this.packet.length),debug$2("_newPacket: parser emit packet: packet.cmd: %s, packet.payload: %s, packet.length: %d",this.packet.cmd,this.packet.payload,this.packet.length),this.emit("packet",this.packet)),debug$2("_newPacket: new packet"),this.packet=new Packet,this._pos=0,!0}},{key:"_emitError",value:function(e){debug$2("_emitError",e),this.error=e,this.emit("error",e)}}],[{key:"parser",value:function(e){return this instanceof t?(this.settings=e||{},this._states=["_parseHeader","_parseLength","_parsePayload","_newPacket"],this._resetState(),this):(new t).parser(e)}}]),t}(EventEmitter$1),parser$1=Parser,parser$2=getDefaultExportFromCjs(parser$1),Buffer$2=require$$0$a.Buffer,max$1=65536,cache$1={},SubOk=Buffer$2.isBuffer(Buffer$2.from([1,2]).subarray(0,1));function generateBuffer(e){var t=Buffer$2.allocUnsafe(2);return t.writeUInt8(e>>8,0),t.writeUInt8(255&e,1),t}function generateCache$1(){for(var e=0;e<max$1;e++)cache$1[e]=generateBuffer(e)}function genBufVariableByteInt$1(e){var t=0,r=0,n=Buffer$2.allocUnsafe(4);do{t=e%128|0,(e=e/128|0)>0&&(t|=128),n.writeUInt8(t,r++)}while(e>0&&r<4);return e>0&&(r=0),SubOk?n.subarray(0,r):n.slice(0,r)}function generate4ByteBuffer$1(e){var t=Buffer$2.allocUnsafe(4);return t.writeUInt32BE(e,0),t}var numbers$1={cache:cache$1,generateCache:generateCache$1,generateNumber:generateBuffer,genBufVariableByteInt:genBufVariableByteInt$1,generate4ByteBuffer:generate4ByteBuffer$1},numbers$2=getDefaultExportFromCjs(numbers$1),processNextickArgs$1={exports:{}},processNextickArgs=processNextickArgs$1.exports;function nextTick$2(e,t,r,n){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var i,o,s=arguments.length;switch(s){case 0:case 1:return browser$1$1.nextTick(e);case 2:return browser$1$1.nextTick((function(){e.call(null,t)}));case 3:return browser$1$1.nextTick((function(){e.call(null,t,r)}));case 4:return browser$1$1.nextTick((function(){e.call(null,t,r,n)}));default:for(i=new Array(s-1),o=0;o<i.length;)i[o++]=arguments[o];return browser$1$1.nextTick((function(){e.apply(null,i)}))}}void 0===browser$1$1||!browser$1$1.version||0===browser$1$1.version.indexOf("v0.")||0===browser$1$1.version.indexOf("v1.")&&0!==browser$1$1.version.indexOf("v1.8.")?processNextickArgs$1.exports={nextTick:nextTick$2}:processNextickArgs$1.exports=browser$1$1;var processNextickArgsExports=processNextickArgs$1.exports,index$1=getDefaultExportFromCjs(processNextickArgsExports),protocol=constantsExports,Buffer$1=require$$0$a.Buffer,empty=Buffer$1.allocUnsafe(0),zeroBuf=Buffer$1.from([0]),numbers=numbers$1,nextTick$1=processNextickArgsExports.nextTick,debug$1=srcExports("mqtt-packet:writeToStream"),numCache=numbers.cache,generateNumber=numbers.generateNumber,generateCache=numbers.generateCache,genBufVariableByteInt=numbers.genBufVariableByteInt,generate4ByteBuffer=numbers.generate4ByteBuffer,writeNumber=writeNumberCached,toGenerate=!0;function generate$3(e,t,r){switch(debug$1("generate called"),t.cork&&(t.cork(),nextTick$1(uncork,t)),toGenerate&&(toGenerate=!1,generateCache()),debug$1("generate: packet.cmd: %s",e.cmd),e.cmd){case"connect":return connect$2(e,t,r);case"connack":return connack$1(e,t,r);case"publish":return publish$1(e,t,r);case"puback":case"pubrec":case"pubrel":case"pubcomp":return confirmation(e,t,r);case"subscribe":return subscribe(e,t,r);case"suback":return suback(e,t,r);case"unsubscribe":return unsubscribe(e,t,r);case"unsuback":return unsuback(e,t,r);case"pingreq":case"pingresp":return emptyPacket(e,t,r);case"disconnect":return disconnect(e,t,r);case"auth":return auth$1(e,t,r);default:return t.destroy(new Error("Unknown command")),!1}}function uncork(e){e.uncork()}function connect$2(e,t,r){var n=e||{},i=n.protocolId||"MQTT",o=n.protocolVersion||4,s=n.will,a=n.clean,c=n.keepalive||0,l=n.clientId||"",u=n.username,d=n.password,h=n.properties;void 0===a&&(a=!0);var f,p,m=0;if(!i||"string"!=typeof i&&!Buffer$1.isBuffer(i))return t.destroy(new Error("Invalid protocolId")),!1;if(m+=i.length+2,3!==o&&4!==o&&5!==o)return t.destroy(new Error("Invalid protocol version")),!1;if(m+=1,("string"==typeof l||Buffer$1.isBuffer(l))&&(l||o>=4)&&(l||a))m+=Buffer$1.byteLength(l)+2;else{if(o<4)return t.destroy(new Error("clientId must be supplied before 3.1.1")),!1;if(1*a==0)return t.destroy(new Error("clientId must be given if cleanSession set to 0")),!1}if("number"!=typeof c||c<0||c>65535||c%1!=0)return t.destroy(new Error("Invalid keepalive")),!1;if(m+=2,m+=1,5===o){if(!(f=getProperties(t,h)))return!1;m+=f.length}if(s){if("object"!==_typeof(s))return t.destroy(new Error("Invalid will")),!1;if(!s.topic||"string"!=typeof s.topic)return t.destroy(new Error("Invalid will topic")),!1;if(m+=Buffer$1.byteLength(s.topic)+2,m+=2,s.payload){if(!(s.payload.length>=0))return t.destroy(new Error("Invalid will payload")),!1;"string"==typeof s.payload?m+=Buffer$1.byteLength(s.payload):m+=s.payload.length}if(p={},5===o){if(!(p=getProperties(t,s.properties)))return!1;m+=p.length}}var v=!1;if(null!=u){if(!isStringOrBuffer(u))return t.destroy(new Error("Invalid username")),!1;v=!0,m+=Buffer$1.byteLength(u)+2}if(null!=d){if(!v)return t.destroy(new Error("Username is required to use password")),!1;if(!isStringOrBuffer(d))return t.destroy(new Error("Invalid password")),!1;m+=byteLength(d)+2}t.write(protocol.CONNECT_HEADER),writeVarByteInt(t,m),writeStringOrBuffer(t,i),n.bridgeMode&&(o+=128),t.write(131===o?protocol.VERSION131:132===o?protocol.VERSION132:4===o?protocol.VERSION4:5===o?protocol.VERSION5:protocol.VERSION3);var g=0;return g|=null!=u?protocol.USERNAME_MASK:0,g|=null!=d?protocol.PASSWORD_MASK:0,g|=s&&s.retain?protocol.WILL_RETAIN_MASK:0,g|=s&&s.qos?s.qos<<protocol.WILL_QOS_SHIFT:0,g|=s?protocol.WILL_FLAG_MASK:0,g|=a?protocol.CLEAN_SESSION_MASK:0,t.write(Buffer$1.from([g])),writeNumber(t,c),5===o&&f.write(),writeStringOrBuffer(t,l),s&&(5===o&&p.write(),writeString(t,s.topic),writeStringOrBuffer(t,s.payload)),null!=u&&writeStringOrBuffer(t,u),null!=d&&writeStringOrBuffer(t,d),!0}function connack$1(e,t,r){var n=r?r.protocolVersion:4,i=e||{},o=5===n?i.reasonCode:i.returnCode,s=i.properties,a=2;if("number"!=typeof o)return t.destroy(new Error("Invalid return code")),!1;var c=null;if(5===n){if(!(c=getProperties(t,s)))return!1;a+=c.length}return t.write(protocol.CONNACK_HEADER),writeVarByteInt(t,a),t.write(i.sessionPresent?protocol.SESSIONPRESENT_HEADER:zeroBuf),t.write(Buffer$1.from([o])),null!=c&&c.write(),!0}function publish$1(e,t,r){debug$1("publish: packet: %o",e);var n=r?r.protocolVersion:4,i=e||{},o=i.qos||0,s=i.retain?protocol.RETAIN_MASK:0,a=i.topic,c=i.payload||empty,l=i.messageId,u=i.properties,d=0;if("string"==typeof a)d+=Buffer$1.byteLength(a)+2;else{if(!Buffer$1.isBuffer(a))return t.destroy(new Error("Invalid topic")),!1;d+=a.length+2}if(Buffer$1.isBuffer(c)?d+=c.length:d+=Buffer$1.byteLength(c),o&&"number"!=typeof l)return t.destroy(new Error("Invalid messageId")),!1;o&&(d+=2);var h=null;if(5===n){if(!(h=getProperties(t,u)))return!1;d+=h.length}return t.write(protocol.PUBLISH_HEADER[o][i.dup?1:0][s?1:0]),writeVarByteInt(t,d),writeNumber(t,byteLength(a)),t.write(a),o>0&&writeNumber(t,l),null!=h&&h.write(),debug$1("publish: payload: %o",c),t.write(c)}function confirmation(e,t,r){var n=r?r.protocolVersion:4,i=e||{},o=i.cmd||"puback",s=i.messageId,a=i.dup&&"pubrel"===o?protocol.DUP_MASK:0,c=0,l=i.reasonCode,u=i.properties,d=5===n?3:2;if("pubrel"===o&&(c=1),"number"!=typeof s)return t.destroy(new Error("Invalid messageId")),!1;var h=null;if(5===n&&"object"===_typeof(u)){if(!(h=getPropertiesByMaximumPacketSize(t,u,r,d)))return!1;d+=h.length}return t.write(protocol.ACKS[o][c][a][0]),3===d&&(d+=0!==l?1:-1),writeVarByteInt(t,d),writeNumber(t,s),5===n&&2!==d&&t.write(Buffer$1.from([l])),null!==h?h.write():4===d&&t.write(Buffer$1.from([0])),!0}function subscribe(e,t,r){debug$1("subscribe: packet: ");var n=r?r.protocolVersion:4,i=e||{},o=i.dup?protocol.DUP_MASK:0,s=i.messageId,a=i.subscriptions,c=i.properties,l=0;if("number"!=typeof s)return t.destroy(new Error("Invalid messageId")),!1;l+=2;var u=null;if(5===n){if(!(u=getProperties(t,c)))return!1;l+=u.length}if("object"!==_typeof(a)||!a.length)return t.destroy(new Error("Invalid subscriptions")),!1;for(var d=0;d<a.length;d+=1){var h=a[d].topic,f=a[d].qos;if("string"!=typeof h)return t.destroy(new Error("Invalid subscriptions - invalid topic")),!1;if("number"!=typeof f)return t.destroy(new Error("Invalid subscriptions - invalid qos")),!1;if(5===n){if("boolean"!=typeof(a[d].nl||!1))return t.destroy(new Error("Invalid subscriptions - invalid No Local")),!1;if("boolean"!=typeof(a[d].rap||!1))return t.destroy(new Error("Invalid subscriptions - invalid Retain as Published")),!1;var p=a[d].rh||0;if("number"!=typeof p||p>2)return t.destroy(new Error("Invalid subscriptions - invalid Retain Handling")),!1}l+=Buffer$1.byteLength(h)+2+1}debug$1("subscribe: writing to stream: %o",protocol.SUBSCRIBE_HEADER),t.write(protocol.SUBSCRIBE_HEADER[1][o?1:0][0]),writeVarByteInt(t,l),writeNumber(t,s),null!==u&&u.write();var m,v=!0,g=_createForOfIteratorHelper(a);try{for(g.s();!(m=g.n()).done;){var _=m.value,y=_.topic,b=_.qos,w=+_.nl,k=+_.rap,S=_.rh,E=void 0;writeString(t,y),E=protocol.SUBSCRIBE_OPTIONS_QOS[b],5===n&&(E|=w?protocol.SUBSCRIBE_OPTIONS_NL:0,E|=k?protocol.SUBSCRIBE_OPTIONS_RAP:0,E|=S?protocol.SUBSCRIBE_OPTIONS_RH[S]:0),v=t.write(Buffer$1.from([E]))}}catch(e){g.e(e)}finally{g.f()}return v}function suback(e,t,r){var n=r?r.protocolVersion:4,i=e||{},o=i.messageId,s=i.granted,a=i.properties,c=0;if("number"!=typeof o)return t.destroy(new Error("Invalid messageId")),!1;if(c+=2,"object"!==_typeof(s)||!s.length)return t.destroy(new Error("Invalid qos vector")),!1;for(var l=0;l<s.length;l+=1){if("number"!=typeof s[l])return t.destroy(new Error("Invalid qos vector")),!1;c+=1}var u=null;if(5===n){if(!(u=getPropertiesByMaximumPacketSize(t,a,r,c)))return!1;c+=u.length}return t.write(protocol.SUBACK_HEADER),writeVarByteInt(t,c),writeNumber(t,o),null!==u&&u.write(),t.write(Buffer$1.from(s))}function unsubscribe(e,t,r){var n=r?r.protocolVersion:4,i=e||{},o=i.messageId,s=i.dup?protocol.DUP_MASK:0,a=i.unsubscriptions,c=i.properties,l=0;if("number"!=typeof o)return t.destroy(new Error("Invalid messageId")),!1;if(l+=2,"object"!==_typeof(a)||!a.length)return t.destroy(new Error("Invalid unsubscriptions")),!1;for(var u=0;u<a.length;u+=1){if("string"!=typeof a[u])return t.destroy(new Error("Invalid unsubscriptions")),!1;l+=Buffer$1.byteLength(a[u])+2}var d=null;if(5===n){if(!(d=getProperties(t,c)))return!1;l+=d.length}t.write(protocol.UNSUBSCRIBE_HEADER[1][s?1:0][0]),writeVarByteInt(t,l),writeNumber(t,o),null!==d&&d.write();for(var h=!0,f=0;f<a.length;f++)h=writeString(t,a[f]);return h}function unsuback(e,t,r){var n=r?r.protocolVersion:4,i=e||{},o=i.messageId,s=i.dup?protocol.DUP_MASK:0,a=i.granted,c=i.properties,l=i.cmd,u=2;if("number"!=typeof o)return t.destroy(new Error("Invalid messageId")),!1;if(5===n){if("object"!==_typeof(a)||!a.length)return t.destroy(new Error("Invalid qos vector")),!1;for(var d=0;d<a.length;d+=1){if("number"!=typeof a[d])return t.destroy(new Error("Invalid qos vector")),!1;u+=1}}var h=null;if(5===n){if(!(h=getPropertiesByMaximumPacketSize(t,c,r,u)))return!1;u+=h.length}return t.write(protocol.ACKS[l][0][s][0]),writeVarByteInt(t,u),writeNumber(t,o),null!==h&&h.write(),5===n&&t.write(Buffer$1.from(a)),!0}function emptyPacket(e,t,r){return t.write(protocol.EMPTY[e.cmd])}function disconnect(e,t,r){var n=r?r.protocolVersion:4,i=e||{},o=i.reasonCode,s=i.properties,a=5===n?1:0,c=null;if(5===n){if(!(c=getPropertiesByMaximumPacketSize(t,s,r,a)))return!1;a+=c.length}return t.write(Buffer$1.from([protocol.codes.disconnect<<4])),writeVarByteInt(t,a),5===n&&t.write(Buffer$1.from([o])),null!==c&&c.write(),!0}function auth$1(e,t,r){var n=r?r.protocolVersion:4,i=e||{},o=i.reasonCode,s=i.properties,a=5===n?1:0;5!==n&&t.destroy(new Error("Invalid mqtt version for auth packet"));var c=getPropertiesByMaximumPacketSize(t,s,r,a);return!!c&&(a+=c.length,t.write(Buffer$1.from([protocol.codes.auth<<4])),writeVarByteInt(t,a),t.write(Buffer$1.from([o])),null!==c&&c.write(),!0)}Object.defineProperty(generate$3,"cacheNumbers",{get:function(){return writeNumber===writeNumberCached},set:function(e){e?(numCache&&0!==Object.keys(numCache).length||(toGenerate=!0),writeNumber=writeNumberCached):(toGenerate=!1,writeNumber=writeNumberGenerated)}});var varByteIntCache={};function writeVarByteInt(e,t){if(t>protocol.VARBYTEINT_MAX)return e.destroy(new Error("Invalid variable byte integer: ".concat(t))),!1;var r=varByteIntCache[t];return r||(r=genBufVariableByteInt(t),t<16384&&(varByteIntCache[t]=r)),debug$1("writeVarByteInt: writing to stream: %o",r),e.write(r)}function writeString(e,t){var r=Buffer$1.byteLength(t);return writeNumber(e,r),debug$1("writeString: %s",t),e.write(t,"utf8")}function writeStringPair(e,t,r){writeString(e,t),writeString(e,r)}function writeNumberCached(e,t){return debug$1("writeNumberCached: number: %d",t),debug$1("writeNumberCached: %o",numCache[t]),e.write(numCache[t])}function writeNumberGenerated(e,t){var r=generateNumber(t);return debug$1("writeNumberGenerated: %o",r),e.write(r)}function write4ByteNumber(e,t){var r=generate4ByteBuffer(t);return debug$1("write4ByteNumber: %o",r),e.write(r)}function writeStringOrBuffer(e,t){"string"==typeof t?writeString(e,t):t?(writeNumber(e,t.length),e.write(t)):writeNumber(e,0)}function getProperties(e,t){if("object"!==_typeof(t)||null!=t.length)return{length:1,write:function(){writeProperties(e,{},0)}};var r=0;function n(t,r){var n=0;switch(protocol.propertiesTypes[t]){case"byte":if("boolean"!=typeof r)return e.destroy(new Error("Invalid ".concat(t,": ").concat(r))),!1;n+=2;break;case"int8":if("number"!=typeof r||r<0||r>255)return e.destroy(new Error("Invalid ".concat(t,": ").concat(r))),!1;n+=2;break;case"binary":if(r&&null===r)return e.destroy(new Error("Invalid ".concat(t,": ").concat(r))),!1;n+=1+Buffer$1.byteLength(r)+2;break;case"int16":if("number"!=typeof r||r<0||r>65535)return e.destroy(new Error("Invalid ".concat(t,": ").concat(r))),!1;n+=3;break;case"int32":if("number"!=typeof r||r<0||r>4294967295)return e.destroy(new Error("Invalid ".concat(t,": ").concat(r))),!1;n+=5;break;case"var":if("number"!=typeof r||r<0||r>268435455)return e.destroy(new Error("Invalid ".concat(t,": ").concat(r))),!1;n+=1+Buffer$1.byteLength(genBufVariableByteInt(r));break;case"string":if("string"!=typeof r)return e.destroy(new Error("Invalid ".concat(t,": ").concat(r))),!1;n+=3+Buffer$1.byteLength(r.toString());break;case"pair":if("object"!==_typeof(r))return e.destroy(new Error("Invalid ".concat(t,": ").concat(r))),!1;n+=Object.getOwnPropertyNames(r).reduce((function(e,t){var n=r[t];return Array.isArray(n)?e+=n.reduce((function(e,r){return e+=3+Buffer$1.byteLength(t.toString())+2+Buffer$1.byteLength(r.toString())}),0):e+=3+Buffer$1.byteLength(t.toString())+2+Buffer$1.byteLength(r[t].toString()),e}),0);break;default:return e.destroy(new Error("Invalid property ".concat(t,": ").concat(r))),!1}return n}if(t)for(var i in t){var o=0,s=0,a=t[i];if(void 0!==a){if(Array.isArray(a))for(var c=0;c<a.length;c++){if(!(s=n(i,a[c])))return!1;o+=s}else{if(!(s=n(i,a)))return!1;o=s}if(!o)return!1;r+=o}}return{length:Buffer$1.byteLength(genBufVariableByteInt(r))+r,write:function(){writeProperties(e,t,r)}}}function getPropertiesByMaximumPacketSize(e,t,r,n){var i=["reasonString","userProperties"],o=r&&r.properties&&r.properties.maximumPacketSize?r.properties.maximumPacketSize:0,s=getProperties(e,t);if(o)for(;n+s.length>o;){var a=i.shift();if(!a||!t[a])return!1;delete t[a],s=getProperties(e,t)}return s}function writeProperty(e,t,r){switch(protocol.propertiesTypes[t]){case"byte":e.write(Buffer$1.from([protocol.properties[t]])),e.write(Buffer$1.from([+r]));break;case"int8":e.write(Buffer$1.from([protocol.properties[t]])),e.write(Buffer$1.from([r]));break;case"binary":e.write(Buffer$1.from([protocol.properties[t]])),writeStringOrBuffer(e,r);break;case"int16":e.write(Buffer$1.from([protocol.properties[t]])),writeNumber(e,r);break;case"int32":e.write(Buffer$1.from([protocol.properties[t]])),write4ByteNumber(e,r);break;case"var":e.write(Buffer$1.from([protocol.properties[t]])),writeVarByteInt(e,r);break;case"string":e.write(Buffer$1.from([protocol.properties[t]])),writeString(e,r);break;case"pair":Object.getOwnPropertyNames(r).forEach((function(n){var i=r[n];Array.isArray(i)?i.forEach((function(r){e.write(Buffer$1.from([protocol.properties[t]])),writeStringPair(e,n.toString(),r.toString())})):(e.write(Buffer$1.from([protocol.properties[t]])),writeStringPair(e,n.toString(),i.toString()))}));break;default:return e.destroy(new Error("Invalid property ".concat(t," value: ").concat(r))),!1}}function writeProperties(e,t,r){for(var n in writeVarByteInt(e,r),t)if(Object.prototype.hasOwnProperty.call(t,n)&&null!=t[n]){var i=t[n];if(Array.isArray(i))for(var o=0;o<i.length;o++)writeProperty(e,n,i[o]);else writeProperty(e,n,i)}}function byteLength(e){return e?e instanceof Buffer$1?e.length:Buffer$1.byteLength(e):0}function isStringOrBuffer(e){return"string"==typeof e||e instanceof Buffer$1}var writeToStream$2=generate$3,writeToStream$3=getDefaultExportFromCjs(writeToStream$2),writeToStream$1=writeToStream$2,EventEmitter=require$$0$8.EventEmitter,Buffer=require$$0$a.Buffer;function generate$1(e,t){var r=new Accumulator;return writeToStream$1(e,r,t),r.concat()}var Accumulator=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t))._array=new Array(20),e._i=0,e}return _inherits(t,e),_createClass(t,[{key:"write",value:function(e){return this._array[this._i++]=e,!0}},{key:"concat",value:function(){var e,t=0,r=new Array(this._array.length),n=this._array,i=0;for(e=0;e<n.length&&void 0!==n[e];e++)"string"!=typeof n[e]?r[e]=n[e].length:r[e]=Buffer.byteLength(n[e]),t+=r[e];var o=Buffer.allocUnsafe(t);for(e=0;e<n.length&&void 0!==n[e];e++)"string"!=typeof n[e]?(n[e].copy(o,i),i+=r[e]):(o.write(n[e],i),i+=r[e]);return o}},{key:"destroy",value:function(e){e&&this.emit("error",e)}}]),t}(EventEmitter),generate_1=generate$1,generate$2=getDefaultExportFromCjs(generate_1),parser=mqtt$2.parser=parser$1.parser,generate=mqtt$2.generate=generate_1,writeToStream=mqtt$2.writeToStream=writeToStream$2,rfdc_1=rfdc;function copyBuffer(e){return e instanceof Buffer$4?Buffer$4.from(e):new e.constructor(e.buffer.slice(),e.byteOffset,e.length)}function rfdc(e){if((e=e||{}).circles)return rfdcCircles(e);var t=new Map;if(t.set(Date,(function(e){return new Date(e)})),t.set(Map,(function(e,t){return new Map(s(Array.from(e),t))})),t.set(Set,(function(e,t){return new Set(s(Array.from(e),t))})),e.constructorHandlers){var r,n=_createForOfIteratorHelper(e.constructorHandlers);try{for(n.s();!(r=n.n()).done;){var i=r.value;t.set(i[0],i[1])}}catch(e){n.e(e)}finally{n.f()}}var o=null;return e.proto?function e(r){if("object"!==_typeof(r)||null===r)return r;if(Array.isArray(r))return s(r,e);if(r.constructor!==Object&&(o=t.get(r.constructor)))return o(r,e);var n={};for(var i in r){var a=r[i];"object"!==_typeof(a)||null===a?n[i]=a:a.constructor!==Object&&(o=t.get(a.constructor))?n[i]=o(a,e):ArrayBuffer.isView(a)?n[i]=copyBuffer(a):n[i]=e(a)}return n}:function e(r){if("object"!==_typeof(r)||null===r)return r;if(Array.isArray(r))return s(r,e);if(r.constructor!==Object&&(o=t.get(r.constructor)))return o(r,e);var n={};for(var i in r)if(!1!==Object.hasOwnProperty.call(r,i)){var a=r[i];"object"!==_typeof(a)||null===a?n[i]=a:a.constructor!==Object&&(o=t.get(a.constructor))?n[i]=o(a,e):ArrayBuffer.isView(a)?n[i]=copyBuffer(a):n[i]=e(a)}return n};function s(e,r){for(var n=Object.keys(e),i=new Array(n.length),s=0;s<n.length;s++){var a=n[s],c=e[a];"object"!==_typeof(c)||null===c?i[a]=c:c.constructor!==Object&&(o=t.get(c.constructor))?i[a]=o(c,r):ArrayBuffer.isView(c)?i[a]=copyBuffer(c):i[a]=r(c)}return i}}function rfdcCircles(e){var t=[],r=[],n=new Map;if(n.set(Date,(function(e){return new Date(e)})),n.set(Map,(function(e,t){return new Map(c(Array.from(e),t))})),n.set(Set,(function(e,t){return new Set(c(Array.from(e),t))})),e.constructorHandlers){var i,o=_createForOfIteratorHelper(e.constructorHandlers);try{for(o.s();!(i=o.n()).done;){var s=i.value;n.set(s[0],s[1])}}catch(e){o.e(e)}finally{o.f()}}var a=null;return e.proto?function e(i){if("object"!==_typeof(i)||null===i)return i;if(Array.isArray(i))return c(i,e);if(i.constructor!==Object&&(a=n.get(i.constructor)))return a(i,e);var o={};for(var s in t.push(i),r.push(o),i){var l=i[s];if("object"!==_typeof(l)||null===l)o[s]=l;else if(l.constructor!==Object&&(a=n.get(l.constructor)))o[s]=a(l,e);else if(ArrayBuffer.isView(l))o[s]=copyBuffer(l);else{var u=t.indexOf(l);o[s]=-1!==u?r[u]:e(l)}}return t.pop(),r.pop(),o}:function e(i){if("object"!==_typeof(i)||null===i)return i;if(Array.isArray(i))return c(i,e);if(i.constructor!==Object&&(a=n.get(i.constructor)))return a(i,e);var o={};for(var s in t.push(i),r.push(o),i)if(!1!==Object.hasOwnProperty.call(i,s)){var l=i[s];if("object"!==_typeof(l)||null===l)o[s]=l;else if(l.constructor!==Object&&(a=n.get(l.constructor)))o[s]=a(l,e);else if(ArrayBuffer.isView(l))o[s]=copyBuffer(l);else{var u=t.indexOf(l);o[s]=-1!==u?r[u]:e(l)}}return t.pop(),r.pop(),o};function c(e,i){for(var o=Object.keys(e),s=new Array(o.length),c=0;c<o.length;c++){var l=o[c],u=e[l];if("object"!==_typeof(u)||null===u)s[l]=u;else if(u.constructor!==Object&&(a=n.get(u.constructor)))s[l]=a(u,i);else if(ArrayBuffer.isView(u))s[l]=copyBuffer(u);else{var d=t.indexOf(u);s[l]=-1!==d?r[d]:i(u)}}return s}}var index=getDefaultExportFromCjs(rfdc_1),_default$f=rfdc_1(),_default$g=getDefaultExportFromCjs(_default$f),validations$1={};Object.defineProperty(validations$1,"__esModule",{value:!0});var validateTopic_1=validations$1.validateTopic=validateTopic,validateTopics_1=validations$1.validateTopics=validateTopics;function validateTopic(e){for(var t=e.split("/"),r=0;r<t.length;r++)if("+"!==t[r]){if("#"===t[r])return r===t.length-1;if(-1!==t[r].indexOf("+")||-1!==t[r].indexOf("#"))return!1}return!0}function validateTopics(e){if(0===e.length)return"empty_topic_list";for(var t=0;t<e.length;t++)if(!validateTopic(e[t]))return e[t];return null}var store={};Object.defineProperty(store,"__esModule",{value:!0});var readable_stream_1$1=oursExports,streamsOpts={objectMode:!0},defaultStoreOptions={clean:!0},Store=function(){function e(t){_classCallCheck(this,e),_defineProperty(this,"options",void 0),_defineProperty(this,"_inflights",void 0),this.options=t||{},this.options=_objectSpread2(_objectSpread2({},defaultStoreOptions),t),this._inflights=new Map}return _createClass(e,[{key:"put",value:function(e,t){return this._inflights.set(e.messageId,e),t&&t(),this}},{key:"createStream",value:function(){var e=new readable_stream_1$1.Readable(streamsOpts),t=[],r=!1,n=0;return this._inflights.forEach((function(e,r){t.push(e)})),e._read=function(){!r&&n<t.length?e.push(t[n++]):e.push(null)},e.destroy=function(t){if(!r)return r=!0,setTimeout((function(){e.emit("close")}),0),e},e}},{key:"del",value:function(e,t){var r=this._inflights.get(e.messageId);return r?(this._inflights.delete(e.messageId),t(null,r)):t&&t(new Error("missing packet")),this}},{key:"get",value:function(e,t){var r=this._inflights.get(e.messageId);return r?t(null,r):t&&t(new Error("missing packet")),this}},{key:"close",value:function(e){this.options.clean&&(this._inflights=null),e&&e()}}]),e}(),_default$e=store.default=Store,handlers={},publish={};Object.defineProperty(publish,"__esModule",{value:!0});var validReasonCodes=[0,16,128,131,135,144,145,151,153],handlePublish=function(e,t,r){e.log("handlePublish: packet %o",t),r=void 0!==r?r:e.noop;var n,i=t.topic.toString(),o=t.payload,s=t.qos,a=t.messageId,c=e.options;if(5===e.options.protocolVersion&&(t.properties&&(n=t.properties.topicAlias),void 0!==n))if(0===i.length){if(!(n>0&&n<=65535))return e.log("handlePublish :: topic alias out of range. alias: %d",n),void e.emit("error",new Error("Received Topic Alias is out of range"));var l=e.topicAliasRecv.getTopicByAlias(n);if(!l)return e.log("handlePublish :: unregistered topic alias. alias: %d",n),void e.emit("error",new Error("Received unregistered Topic Alias"));i=l,e.log("handlePublish :: topic complemented by alias. topic: %s - alias: %d",i,n)}else{if(!e.topicAliasRecv.put(i,n))return e.log("handlePublish :: topic alias out of range. alias: %d",n),void e.emit("error",new Error("Received Topic Alias is out of range"));e.log("handlePublish :: registered topic: %s - alias: %d",i,n)}switch(e.log("handlePublish: qos %d",s),s){case 2:c.customHandleAcks(i,o,t,(function(n,i){return"number"==typeof n&&(i=n,n=null),n?e.emit("error",n):-1===validReasonCodes.indexOf(i)?e.emit("error",new Error("Wrong reason code for pubrec")):void(i?e._sendPacket({cmd:"pubrec",messageId:a,reasonCode:i},r):e.incomingStore.put(t,(function(){e._sendPacket({cmd:"pubrec",messageId:a},r)})))}));break;case 1:c.customHandleAcks(i,o,t,(function(n,s){return"number"==typeof n&&(s=n,n=null),n?e.emit("error",n):-1===validReasonCodes.indexOf(s)?e.emit("error",new Error("Wrong reason code for puback")):(s||e.emit("message",i,o,t),void e.handleMessage(t,(function(t){if(t)return r&&r(t);e._sendPacket({cmd:"puback",messageId:a,reasonCode:s},r)})))}));break;case 0:e.emit("message",i,o,t),e.handleMessage(t,r);break;default:e.log("handlePublish: unknown QoS. Doing nothing.")}},_default$d=publish.default=handlePublish,auth={},shared={},_args=[["mqtt@5.13.3","/Users/nakul-etpl/Desktop/ennoventure/vyu-web-sdk"]],_from="mqtt@5.13.3",_id="mqtt@5.13.3",_inBundle=!1,_integrity="sha512-91x03kh1+vBBA51OMNbEw2fymXfaUjpHkC0NcMckg9Vf6ee/GrM/HXfE8XeeziHQpJL8adr+9ThTbN5v/WmrRA==",_location="/mqtt",_phantomChildren={},_requested={type:"version",registry:!0,raw:"mqtt@5.13.3",name:"mqtt",escapedName:"mqtt",rawSpec:"5.13.3",saveSpec:null,fetchSpec:"5.13.3"},_requiredBy=["/"],_resolved="https://registry.npmjs.org/mqtt/-/mqtt-5.13.3.tgz",_spec="5.13.3",_where="/Users/nakul-etpl/Desktop/ennoventure/vyu-web-sdk",bin={mqtt_pub:"build/bin/pub.js",mqtt_sub:"build/bin/sub.js",mqtt:"build/bin/mqtt.js"},browser={"./mqtt.js":"./dist/mqtt.js",fs:!1,tls:!1,net:!1},bugs={url:"https://github.com/mqttjs/MQTT.js/issues"},contributors=[{name:"Adam Rudd",email:"adamvrr@gmail.com"},{name:"Matteo Collina",email:"matteo.collina@gmail.com",url:"https://github.com/mcollina"},{name:"Siarhei Buntsevich",email:"scarry0506@gmail.com",url:"https://github.com/scarry1992"},{name:"Yoseph Maguire",email:"yomaguir@microsoft.com",url:"https://github.com/YoDaMa"},{name:"Daniel Lando",email:"daniel.sorridi@gmail.com",url:"https://github.com/robertsLando"}],dependencies={"@types/readable-stream":"^4.0.18","@types/ws":"^8.18.1",commist:"^3.2.0","concat-stream":"^2.0.0",debug:"^4.4.0","help-me":"^5.0.0","lru-cache":"^10.4.3",minimist:"^1.2.8","mqtt-packet":"^9.0.2","number-allocator":"^1.0.14","readable-stream":"^4.7.0",rfdc:"^1.4.1",socks:"^2.8.3",split2:"^4.2.0","worker-timers":"^7.1.8",ws:"^8.18.0"},description="A library for the MQTT protocol",devDependencies={"@esm-bundle/chai":"^4.3.4","@release-it/conventional-changelog":"^7.0.2","@tsconfig/node20":"^20.1.6","@types/chai":"^4.3.20","@types/node":"^20.17.16","@types/sinon":"^17.0.3","@types/tape":"^5.8.1","@typescript-eslint/eslint-plugin":"^6.21.0","@typescript-eslint/parser":"^6.21.0","@web/test-runner":"^0.19.0","@web/test-runner-playwright":"^0.11.0","aedes-cli":"^0.8.0",chai:"^4.5.0",chokidar:"^3.6.0","conventional-changelog-cli":"^4.1.0","end-of-stream":"^1.4.4",esbuild:"^0.25.0","esbuild-plugin-polyfill-node":"^0.3.0","esbuild-register":"^3.6.0",eslint:"^8.57.1","eslint-config-airbnb-base":"^15.0.0","eslint-config-airbnb-typescript":"^17.1.0","eslint-config-prettier":"^9.1.0","eslint-plugin-import":"^2.31.0","eslint-plugin-prettier":"^5.2.3",global:"^4.4.0","leaked-handles":"^5.2.0",mkdirp:"^3.0.1","mqtt-connection":"^4.1.0","mqtt-level-store":"^3.1.0",nyc:"^15.1.0","pre-commit":"^1.2.2",prettier:"^3.4.2","release-it":"^16.3.0",rimraf:"^5.0.10",should:"^13.2.3",sinon:"^17.0.2",snazzy:"^9.0.0",tape:"^5.9.0","ts-node":"^10.9.2",typescript:"^5.7.3"},engines={node:">=16.0.0"},exports$1={".":{"react-native":"./dist/mqtt.esm.js",browser:{import:"./dist/mqtt.esm.js",default:"./dist/mqtt.min.js"},default:"./build/index.js"},"./package.json":"./package.json","./*.map":"./build/*.js.map","./dist/*":"./dist/*.js","./*":"./build/*.js"},files=["dist/","CONTRIBUTING.md","LICENSE.md","help/","build/"],homepage="https://github.com/mqttjs/MQTT.js#readme",keywords=["mqtt","publish/subscribe","publish","subscribe"],license="MIT",main="./build/index.js",module$1="./dist/mqtt.esm.js",name="mqtt",publishConfig={provenance:!0},repository={type:"git",url:"git://github.com/mqttjs/MQTT.js.git"},scripts={build:"npm run build:ts && npm run build:browser","build:browser":"node esbuild.js","build:ts":"rimraf build/ && tsc -p tsconfig.build.json",changelog:"conventional-changelog -p angular -i CHANGELOG.md -s && git add CHANGELOG.md","changelog-init":"conventional-changelog -p angular -i CHANGELOG.md -s -r 0",lint:"eslint --ext .ts .","lint-fix":"eslint --fix --ext .ts .",prepare:"npm run build",release:"read -p 'GITHUB_TOKEN: ' GITHUB_TOKEN && export GITHUB_TOKEN=$GITHUB_TOKEN && release-it",test:"npm run test:node","test:browser":"npm run build && npm run unit-test:browser","test:node":"nyc npm run unit-test:node","unit-test:browser":"wtr","unit-test:node":"node -r esbuild-register --test-concurrency 4 --test-reporter=junit --test-reporter-destination=junit.xml --test-reporter=spec --test-reporter-destination=stdout --test test/node/*.ts "},types="build/index.d.ts",typesVersions={"*":{"*":["./build/index.d.ts"]}},version$2="5.13.3",require$$0$4={_args:_args,_from:_from,_id:_id,_inBundle:_inBundle,_integrity:_integrity,_location:_location,_phantomChildren:_phantomChildren,_requested:_requested,_requiredBy:_requiredBy,_resolved:_resolved,_spec:_spec,_where:_where,bin:bin,browser:browser,bugs:bugs,contributors:contributors,dependencies:dependencies,description:description,devDependencies:devDependencies,engines:engines,exports:exports$1,files:files,homepage:homepage,keywords:keywords,license:license,main:main,module:module$1,name:name,"pre-commit":["lint"],publishConfig:publishConfig,"release-it":{github:{release:!0},git:{tagName:"v${version}",commitMessage:"chore(release): ${version}"},hooks:{"before:init":["npm run test"]},npm:{publish:!0},plugins:{"@release-it/conventional-changelog":{preset:"angular",infile:"CHANGELOG.md"}}},repository:repository,scripts:scripts,types:types,typesVersions:typesVersions,version:version$2},_process$1;Object.defineProperty(shared,"__esModule",{value:!0});var MQTTJS_VERSION=shared.MQTTJS_VERSION=nextTick=shared.nextTick=ErrorWithSubackPacket_1=shared.ErrorWithSubackPacket=ErrorWithReasonCode_1=shared.ErrorWithReasonCode=void 0,applyMixin_1=shared.applyMixin=applyMixin,ErrorWithReasonCode=function(e){function t(e,r){var n;return _classCallCheck(this,t),_defineProperty(_assertThisInitialized(n=_callSuper(this,t,[e])),"code",void 0),n.code=r,Object.setPrototypeOf(_assertThisInitialized(n),t.prototype),Object.getPrototypeOf(_assertThisInitialized(n)).name="ErrorWithReasonCode",n}return _inherits(t,e),_createClass(t)}(_wrapNativeSuper(Error)),ErrorWithReasonCode_1=shared.ErrorWithReasonCode=ErrorWithReasonCode,ErrorWithSubackPacket=function(e){function t(e,r){var n;return _classCallCheck(this,t),_defineProperty(_assertThisInitialized(n=_callSuper(this,t,[e])),"packet",void 0),n.packet=r,Object.setPrototypeOf(_assertThisInitialized(n),t.prototype),Object.getPrototypeOf(_assertThisInitialized(n)).name="ErrorWithSubackPacket",n}return _inherits(t,e),_createClass(t)}(_wrapNativeSuper(Error)),ErrorWithSubackPacket_1=shared.ErrorWithSubackPacket=ErrorWithSubackPacket;function applyMixin(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[t];;){var i=n[0],o=Object.getPrototypeOf(i);if(null==o||!o.prototype)break;n.unshift(o)}for(var s=0,a=n;s<a.length;s++){var c,l=a[s],u=_createForOfIteratorHelper(Object.getOwnPropertyNames(l.prototype));try{for(u.s();!(c=u.n()).done;){var d,h=c.value;if(r||"constructor"!==h)Object.defineProperty(e.prototype,h,null!==(d=Object.getOwnPropertyDescriptor(l.prototype,h))&&void 0!==d?d:Object.create(null))}}catch(e){u.e(e)}finally{u.f()}}}var nextTick=shared.nextTick="function"==typeof(null===(_process$1=browser$1$1)||void 0===_process$1?void 0:_process$1.nextTick)?browser$1$1.nextTick:function(e){setTimeout(e,0)};MQTTJS_VERSION=shared.MQTTJS_VERSION=require$$0$4.version;var ack$1={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ReasonCodes=void 0;var t=shared;e.ReasonCodes={0:"",1:"Unacceptable protocol version",2:"Identifier rejected",3:"Server unavailable",4:"Bad username or password",5:"Not authorized",16:"No matching subscribers",17:"No subscription existed",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",132:"Unsupported Protocol Version",133:"Client Identifier not valid",134:"Bad User Name or Password",135:"Not authorized",136:"Server unavailable",137:"Server busy",138:"Banned",139:"Server shutting down",140:"Bad authentication method",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",145:"Packet identifier in use",146:"Packet Identifier not found",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"};e.default=function(r,n){var i=n.messageId,o=n.cmd,s=null,a=r.outgoing[i]?r.outgoing[i].cb:null,c=null;if(a){switch(r.log("_handleAck :: packet type",o),o){case"pubcomp":case"puback":var l=n.reasonCode;l&&l>0&&16!==l?(c=new t.ErrorWithReasonCode("Publish error: ".concat(e.ReasonCodes[l]),l),r._removeOutgoingAndStoreMessage(i,(function(){a(c,n)}))):r._removeOutgoingAndStoreMessage(i,a);break;case"pubrec":s={cmd:"pubrel",qos:2,messageId:i};var u=n.reasonCode;u&&u>0&&16!==u?(c=new t.ErrorWithReasonCode("Publish error: ".concat(e.ReasonCodes[u]),u),r._removeOutgoingAndStoreMessage(i,(function(){a(c,n)}))):r._sendPacket(s);break;case"suback":delete r.outgoing[i],r.messageIdProvider.deallocate(i);for(var d=n.granted,h=0;h<d.length;h++){var f=d[h];if(0!=(128&f)){(c=new Error("Subscribe error: ".concat(e.ReasonCodes[f]))).code=f;var p=r.messageIdToTopic[i];p&&p.forEach((function(e){delete r._resubscribeTopics[e]}))}}delete r.messageIdToTopic[i],r._invokeStoreProcessingQueue(),a(c,n);break;case"unsuback":delete r.outgoing[i],r.messageIdProvider.deallocate(i),r._invokeStoreProcessingQueue(),a(null,n);break;default:r.emit("error",new Error("unrecognized packet type"))}r.disconnecting&&0===Object.keys(r.outgoing).length&&r.emit("outgoingEmpty")}else r.log("_handleAck :: Server sent an ack in error. Ignoring.")}}(ack$1);var ack=getDefaultExportFromCjs(ack$1);Object.defineProperty(auth,"__esModule",{value:!0});var shared_1$3=shared,ack_1$2=ack$1,handleAuth=function(e,t){var r=e.options.protocolVersion,n=5===r?t.reasonCode:t.returnCode;if(5===r)e.handleAuth(t,(function(t,r){if(t)e.emit("error",t);else if(24===n)e.reconnecting=!1,e._sendPacket(r);else{var i=new shared_1$3.ErrorWithReasonCode("Connection refused: ".concat(ack_1$2.ReasonCodes[n]),n);e.emit("error",i)}}));else{var i=new shared_1$3.ErrorWithReasonCode("Protocol error: Auth packets are only supported in MQTT 5. Your version:".concat(r),n);e.emit("error",i)}},_default$c=auth.default=handleAuth,connack={},topicAliasSend={},commonjs={},_excluded$1=["context","forceRefresh"],_Symbol$iterator,_Symbol$toStringTag;Object.defineProperty(commonjs,"__esModule",{value:!0});var LRUCache_1=commonjs.LRUCache=void 0,perf="object"===("undefined"==typeof performance?"undefined":_typeof(performance))&&performance&&"function"==typeof performance.now?performance:Date,warned=new Set,PROCESS="object"===(void 0===browser$1$1?"undefined":_typeof(browser$1$1))&&browser$1$1?browser$1$1:{},emitWarning=function(e,t,r,n){"function"==typeof PROCESS.emitWarning?PROCESS.emitWarning(e,t,r,n):console.error("[".concat(r,"] ").concat(t,": ").concat(e))},AC=globalThis.AbortController,AS=globalThis.AbortSignal;if(void 0===AC){var _PROCESS$env;AS=function(){function e(){_classCallCheck(this,e),_defineProperty(this,"onabort",void 0),_defineProperty(this,"_onabort",[]),_defineProperty(this,"reason",void 0),_defineProperty(this,"aborted",!1)}return _createClass(e,[{key:"addEventListener",value:function(e,t){this._onabort.push(t)}}]),e}(),AC=function(){function e(){_classCallCheck(this,e),_defineProperty(this,"signal",new AS),warnACPolyfill()}return _createClass(e,[{key:"abort",value:function(e){var t,r;if(!this.signal.aborted){this.signal.reason=e,this.signal.aborted=!0;var n,i=_createForOfIteratorHelper(this.signal._onabort);try{for(i.s();!(n=i.n()).done;){(0,n.value)(e)}}catch(e){i.e(e)}finally{i.f()}null===(t=(r=this.signal).onabort)||void 0===t||t.call(r,e)}}}]),e}();var printACPolyfillWarning="1"!==(null===(_PROCESS$env=PROCESS.env)||void 0===_PROCESS$env?void 0:_PROCESS$env.LRU_CACHE_IGNORE_AC_WARNING),warnACPolyfill=function e(){printACPolyfillWarning&&(printACPolyfillWarning=!1,emitWarning("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}var shouldWarn=function(e){return!warned.has(e)},TYPE$2=Symbol("type"),isPosInt=function(e){return e&&e===Math.floor(e)&&e>0&&isFinite(e)},getUintArray=function(e){return isPosInt(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?ZeroArray:null:null},ZeroArray=function(e){function t(e){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e])).fill(0),r}return _inherits(t,e),_createClass(t)}(_wrapNativeSuper(Array)),Stack$1=function(){function e(t,r){if(_classCallCheck(this,e),_defineProperty(this,"heap",void 0),_defineProperty(this,"length",void 0),!_classStaticPrivateFieldSpecGet(e,e,_constructing))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new r(t),this.length=0}return _createClass(e,[{key:"push",value:function(e){this.heap[this.length++]=e}},{key:"pop",value:function(){return this.heap[--this.length]}}],[{key:"create",value:function(t){var r=getUintArray(t);if(!r)return[];_classStaticPrivateFieldSpecSet(e,e,_constructing,!0);var n=new e(t,r);return _classStaticPrivateFieldSpecSet(e,e,_constructing,!1),n}}]),e}(),_constructing={writable:!0,value:!1},_max=new WeakMap,_maxSize=new WeakMap,_dispose=new WeakMap,_disposeAfter=new WeakMap,_fetchMethod=new WeakMap,_memoMethod=new WeakMap,_size=new WeakMap,_calculatedSize=new WeakMap,_keyMap=new WeakMap,_keyList=new WeakMap,_valList=new WeakMap,_next=new WeakMap,_prev=new WeakMap,_head=new WeakMap,_tail=new WeakMap,_free=new WeakMap,_disposed=new WeakMap,_sizes=new WeakMap,_starts=new WeakMap,_ttls=new WeakMap,_hasDispose=new WeakMap,_hasFetchMethod=new WeakMap,_hasDisposeAfter=new WeakMap,_initializeTTLTracking=new WeakSet,_updateItemAge=new WeakMap,_statusTTL=new WeakMap,_setItemTTL=new WeakMap,_isStale=new WeakMap,_initializeSizeTracking=new WeakSet,_removeItemSize=new WeakMap,_addItemSize=new WeakMap,_requireSize=new WeakMap,_indexes=new WeakSet,_rindexes=new WeakSet,_isValidIndex=new WeakSet,_evict=new WeakSet,_backgroundFetch=new WeakSet,_isBackgroundFetch=new WeakSet,_connect=new WeakSet,_moveToTail=new WeakSet,_delete=new WeakSet,_clear=new WeakSet;_Symbol$iterator=Symbol.iterator,_Symbol$toStringTag=Symbol.toStringTag;var LRUCache=function(){function e(t){_classCallCheck(this,e),_classPrivateMethodInitSpec(this,_clear),_classPrivateMethodInitSpec(this,_delete),_classPrivateMethodInitSpec(this,_moveToTail),_classPrivateMethodInitSpec(this,_connect),_classPrivateMethodInitSpec(this,_isBackgroundFetch),_classPrivateMethodInitSpec(this,_backgroundFetch),_classPrivateMethodInitSpec(this,_evict),_classPrivateMethodInitSpec(this,_isValidIndex),_classPrivateMethodInitSpec(this,_rindexes),_classPrivateMethodInitSpec(this,_indexes),_classPrivateMethodInitSpec(this,_initializeSizeTracking),_classPrivateMethodInitSpec(this,_initializeTTLTracking),_classPrivateFieldInitSpec(this,_max,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_maxSize,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_dispose,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_disposeAfter,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_fetchMethod,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_memoMethod,{writable:!0,value:void 0}),_defineProperty(this,"ttl",void 0),_defineProperty(this,"ttlResolution",void 0),_defineProperty(this,"ttlAutopurge",void 0),_defineProperty(this,"updateAgeOnGet",void 0),_defineProperty(this,"updateAgeOnHas",void 0),_defineProperty(this,"allowStale",void 0),_defineProperty(this,"noDisposeOnSet",void 0),_defineProperty(this,"noUpdateTTL",void 0),_defineProperty(this,"maxEntrySize",void 0),_defineProperty(this,"sizeCalculation",void 0),_defineProperty(this,"noDeleteOnFetchRejection",void 0),_defineProperty(this,"noDeleteOnStaleGet",void 0),_defineProperty(this,"allowStaleOnFetchAbort",void 0),_defineProperty(this,"allowStaleOnFetchRejection",void 0),_defineProperty(this,"ignoreFetchAbort",void 0),_classPrivateFieldInitSpec(this,_size,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_calculatedSize,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_keyMap,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_keyList,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_valList,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_next,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_prev,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_head,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_tail,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_free,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_disposed,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_sizes,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_starts,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_ttls,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_hasDispose,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_hasFetchMethod,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_hasDisposeAfter,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_updateItemAge,{writable:!0,value:function(){}}),_classPrivateFieldInitSpec(this,_statusTTL,{writable:!0,value:function(){}}),_classPrivateFieldInitSpec(this,_setItemTTL,{writable:!0,value:function(){}}),_classPrivateFieldInitSpec(this,_isStale,{writable:!0,value:function(){return!1}}),_classPrivateFieldInitSpec(this,_removeItemSize,{writable:!0,value:function(e){}}),_classPrivateFieldInitSpec(this,_addItemSize,{writable:!0,value:function(e,t,r){}}),_classPrivateFieldInitSpec(this,_requireSize,{writable:!0,value:function(e,t,r,n){if(r||n)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0}}),_defineProperty(this,_Symbol$toStringTag,"LRUCache");var r=t.max,n=void 0===r?0:r,i=t.ttl,o=t.ttlResolution,s=void 0===o?1:o,a=t.ttlAutopurge,c=t.updateAgeOnGet,l=t.updateAgeOnHas,u=t.allowStale,d=t.dispose,h=t.disposeAfter,f=t.noDisposeOnSet,p=t.noUpdateTTL,m=t.maxSize,v=void 0===m?0:m,g=t.maxEntrySize,_=void 0===g?0:g,y=t.sizeCalculation,b=t.fetchMethod,w=t.memoMethod,k=t.noDeleteOnFetchRejection,S=t.noDeleteOnStaleGet,E=t.allowStaleOnFetchRejection,C=t.allowStaleOnFetchAbort,T=t.ignoreFetchAbort;if(0!==n&&!isPosInt(n))throw new TypeError("max option must be a nonnegative integer");var P=n?getUintArray(n):Array;if(!P)throw new Error("invalid max value: "+n);if(_classPrivateFieldSet(this,_max,n),_classPrivateFieldSet(this,_maxSize,v),this.maxEntrySize=_||_classPrivateFieldGet(this,_maxSize),this.sizeCalculation=y,this.sizeCalculation){if(!_classPrivateFieldGet(this,_maxSize)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if("function"!=typeof this.sizeCalculation)throw new TypeError("sizeCalculation set to non-function")}if(void 0!==w&&"function"!=typeof w)throw new TypeError("memoMethod must be a function if defined");if(_classPrivateFieldSet(this,_memoMethod,w),void 0!==b&&"function"!=typeof b)throw new TypeError("fetchMethod must be a function if specified");if(_classPrivateFieldSet(this,_fetchMethod,b),_classPrivateFieldSet(this,_hasFetchMethod,!!b),_classPrivateFieldSet(this,_keyMap,new Map),_classPrivateFieldSet(this,_keyList,new Array(n).fill(void 0)),_classPrivateFieldSet(this,_valList,new Array(n).fill(void 0)),_classPrivateFieldSet(this,_next,new P(n)),_classPrivateFieldSet(this,_prev,new P(n)),_classPrivateFieldSet(this,_head,0),_classPrivateFieldSet(this,_tail,0),_classPrivateFieldSet(this,_free,Stack$1.create(n)),_classPrivateFieldSet(this,_size,0),_classPrivateFieldSet(this,_calculatedSize,0),"function"==typeof d&&_classPrivateFieldSet(this,_dispose,d),"function"==typeof h?(_classPrivateFieldSet(this,_disposeAfter,h),_classPrivateFieldSet(this,_disposed,[])):(_classPrivateFieldSet(this,_disposeAfter,void 0),_classPrivateFieldSet(this,_disposed,void 0)),_classPrivateFieldSet(this,_hasDispose,!!_classPrivateFieldGet(this,_dispose)),_classPrivateFieldSet(this,_hasDisposeAfter,!!_classPrivateFieldGet(this,_disposeAfter)),this.noDisposeOnSet=!!f,this.noUpdateTTL=!!p,this.noDeleteOnFetchRejection=!!k,this.allowStaleOnFetchRejection=!!E,this.allowStaleOnFetchAbort=!!C,this.ignoreFetchAbort=!!T,0!==this.maxEntrySize){if(0!==_classPrivateFieldGet(this,_maxSize)&&!isPosInt(_classPrivateFieldGet(this,_maxSize)))throw new TypeError("maxSize must be a positive integer if specified");if(!isPosInt(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");_classPrivateMethodGet(this,_initializeSizeTracking,_initializeSizeTracking2).call(this)}if(this.allowStale=!!u,this.noDeleteOnStaleGet=!!S,this.updateAgeOnGet=!!c,this.updateAgeOnHas=!!l,this.ttlResolution=isPosInt(s)||0===s?s:1,this.ttlAutopurge=!!a,this.ttl=i||0,this.ttl){if(!isPosInt(this.ttl))throw new TypeError("ttl must be a positive integer if specified");_classPrivateMethodGet(this,_initializeTTLTracking,_initializeTTLTracking2).call(this)}if(0===_classPrivateFieldGet(this,_max)&&0===this.ttl&&0===_classPrivateFieldGet(this,_maxSize))throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!_classPrivateFieldGet(this,_max)&&!_classPrivateFieldGet(this,_maxSize)){var A="LRU_CACHE_UNBOUNDED";if(shouldWarn(A)){warned.add(A);emitWarning("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",A,e)}}}var t,r;return _createClass(e,[{key:"max",get:function(){return _classPrivateFieldGet(this,_max)}},{key:"maxSize",get:function(){return _classPrivateFieldGet(this,_maxSize)}},{key:"calculatedSize",get:function(){return _classPrivateFieldGet(this,_calculatedSize)}},{key:"size",get:function(){return _classPrivateFieldGet(this,_size)}},{key:"fetchMethod",get:function(){return _classPrivateFieldGet(this,_fetchMethod)}},{key:"memoMethod",get:function(){return _classPrivateFieldGet(this,_memoMethod)}},{key:"dispose",get:function(){return _classPrivateFieldGet(this,_dispose)}},{key:"disposeAfter",get:function(){return _classPrivateFieldGet(this,_disposeAfter)}},{key:"getRemainingTTL",value:function(e){return _classPrivateFieldGet(this,_keyMap).has(e)?1/0:0}},{key:"entries",value:_regeneratorRuntime().mark((function e(){var t,r,n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=_createForOfIteratorHelper(_classPrivateMethodGet(this,_indexes,_indexes2).call(this)),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=10;break}if(n=r.value,void 0===_classPrivateFieldGet(this,_valList)[n]||void 0===_classPrivateFieldGet(this,_keyList)[n]||_classPrivateMethodGet(this,_isBackgroundFetch,_isBackgroundFetch2).call(this,_classPrivateFieldGet(this,_valList)[n])){e.next=8;break}return e.next=8,[_classPrivateFieldGet(this,_keyList)[n],_classPrivateFieldGet(this,_valList)[n]];case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"rentries",value:_regeneratorRuntime().mark((function e(){var t,r,n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=_createForOfIteratorHelper(_classPrivateMethodGet(this,_rindexes,_rindexes2).call(this)),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=10;break}if(n=r.value,void 0===_classPrivateFieldGet(this,_valList)[n]||void 0===_classPrivateFieldGet(this,_keyList)[n]||_classPrivateMethodGet(this,_isBackgroundFetch,_isBackgroundFetch2).call(this,_classPrivateFieldGet(this,_valList)[n])){e.next=8;break}return e.next=8,[_classPrivateFieldGet(this,_keyList)[n],_classPrivateFieldGet(this,_valList)[n]];case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"keys",value:_regeneratorRuntime().mark((function e(){var t,r,n,i;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=_createForOfIteratorHelper(_classPrivateMethodGet(this,_indexes,_indexes2).call(this)),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=11;break}if(n=r.value,void 0===(i=_classPrivateFieldGet(this,_keyList)[n])||_classPrivateMethodGet(this,_isBackgroundFetch,_isBackgroundFetch2).call(this,_classPrivateFieldGet(this,_valList)[n])){e.next=9;break}return e.next=9,i;case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),t.e(e.t0);case 16:return e.prev=16,t.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[1,13,16,19]])}))},{key:"rkeys",value:_regeneratorRuntime().mark((function e(){var t,r,n,i;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=_createForOfIteratorHelper(_classPrivateMethodGet(this,_rindexes,_rindexes2).call(this)),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=11;break}if(n=r.value,void 0===(i=_classPrivateFieldGet(this,_keyList)[n])||_classPrivateMethodGet(this,_isBackgroundFetch,_isBackgroundFetch2).call(this,_classPrivateFieldGet(this,_valList)[n])){e.next=9;break}return e.next=9,i;case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),t.e(e.t0);case 16:return e.prev=16,t.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[1,13,16,19]])}))},{key:"values",value:_regeneratorRuntime().mark((function e(){var t,r,n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=_createForOfIteratorHelper(_classPrivateMethodGet(this,_indexes,_indexes2).call(this)),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=11;break}if(n=r.value,void 0===_classPrivateFieldGet(this,_valList)[n]||_classPrivateMethodGet(this,_isBackgroundFetch,_isBackgroundFetch2).call(this,_classPrivateFieldGet(this,_valList)[n])){e.next=9;break}return e.next=9,_classPrivateFieldGet(this,_valList)[n];case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),t.e(e.t0);case 16:return e.prev=16,t.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[1,13,16,19]])}))},{key:"rvalues",value:_regeneratorRuntime().mark((function e(){var t,r,n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=_createForOfIteratorHelper(_classPrivateMethodGet(this,_rindexes,_rindexes2).call(this)),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=11;break}if(n=r.value,void 0===_classPrivateFieldGet(this,_valList)[n]||_classPrivateMethodGet(this,_isBackgroundFetch,_isBackgroundFetch2).call(this,_classPrivateFieldGet(this,_valList)[n])){e.next=9;break}return e.next=9,_classPrivateFieldGet(this,_valList)[n];case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),t.e(e.t0);case 16:return e.prev=16,t.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[1,13,16,19]])}))},{key:_Symbol$iterator,value:function(){return this.entries()}},{key:"find",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=_createForOfIteratorHelper(_classPrivateMethodGet(this,_indexes,_indexes2).call(this));try{for(n.s();!(t=n.n()).done;){var i=t.value,o=_classPrivateFieldGet(this,_valList)[i],s=_classPrivateMethodGet(this,_isBackgroundFetch,_isBackgroundFetch2).call(this,o)?o.__staleWhileFetching:o;if(void 0!==s&&e(s,_classPrivateFieldGet(this,_keyList)[i],this))return this.get(_classPrivateFieldGet(this,_keyList)[i],r)}}catch(e){n.e(e)}finally{n.f()}}},{key:"forEach",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,n=_createForOfIteratorHelper(_classPrivateMethodGet(this,_indexes,_indexes2).call(this));try{for(n.s();!(t=n.n()).done;){var i=t.value,o=_classPrivateFieldGet(this,_valList)[i],s=_classPrivateMethodGet(this,_isBackgroundFetch,_isBackgroundFetch2).call(this,o)?o.__staleWhileFetching:o;void 0!==s&&e.call(r,s,_classPrivateFieldGet(this,_keyList)[i],this)}}catch(e){n.e(e)}finally{n.f()}}},{key:"rforEach",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,n=_createForOfIteratorHelper(_classPrivateMethodGet(this,_rindexes,_rindexes2).call(this));try{for(n.s();!(t=n.n()).done;){var i=t.value,o=_classPrivateFieldGet(this,_valList)[i],s=_classPrivateMethodGet(this,_isBackgroundFetch,_isBackgroundFetch2).call(this,o)?o.__staleWhileFetching:o;void 0!==s&&e.call(r,s,_classPrivateFieldGet(this,_keyList)[i],this)}}catch(e){n.e(e)}finally{n.f()}}},{key:"purgeStale",value:function(){var e,t=!1,r=_createForOfIteratorHelper(_classPrivateMethodGet(this,_rindexes,_rindexes2).call(this,{allowStale:!0}));try{for(r.s();!(e=r.n()).done;){var n=e.value;_classPrivateFieldGet(this,_isStale).call(this,n)&&(_classPrivateMethodGet(this,_delete,_delete2).call(this,_classPrivateFieldGet(this,_keyList)[n],"expire"),t=!0)}}catch(e){r.e(e)}finally{r.f()}return t}},{key:"info",value:function(e){var t=_classPrivateFieldGet(this,_keyMap).get(e);if(void 0!==t){var r=_classPrivateFieldGet(this,_valList)[t],n=_classPrivateMethodGet(this,_isBackgroundFetch,_isBackgroundFetch2).call(this,r)?r.__staleWhileFetching:r;if(void 0!==n){var i={value:n};if(_classPrivateFieldGet(this,_ttls)&&_classPrivateFieldGet(this,_starts)){var o=_classPrivateFieldGet(this,_ttls)[t],s=_classPrivateFieldGet(this,_starts)[t];if(o&&s){var a=o-(perf.now()-s);i.ttl=a,i.start=Date.now()}}return _classPrivateFieldGet(this,_sizes)&&(i.size=_classPrivateFieldGet(this,_sizes)[t]),i}}}},{key:"dump",value:function(){var e,t=[],r=_createForOfIteratorHelper(_classPrivateMethodGet(this,_indexes,_indexes2).call(this,{allowStale:!0}));try{for(r.s();!(e=r.n()).done;){var n=e.value,i=_classPrivateFieldGet(this,_keyList)[n],o=_classPrivateFieldGet(this,_valList)[n],s=_classPrivateMethodGet(this,_isBackgroundFetch,_isBackgroundFetch2).call(this,o)?o.__staleWhileFetching:o;if(void 0!==s&&void 0!==i){var a={value:s};if(_classPrivateFieldGet(this,_ttls)&&_classPrivateFieldGet(this,_starts)){a.ttl=_classPrivateFieldGet(this,_ttls)[n];var c=perf.now()-_classPrivateFieldGet(this,_starts)[n];a.start=Math.floor(Date.now()-c)}_classPrivateFieldGet(this,_sizes)&&(a.size=_classPrivateFieldGet(this,_sizes)[n]),t.unshift([i,a])}}}catch(e){r.e(e)}finally{r.f()}return t}},{key:"load",value:function(e){this.clear();var t,r=_createForOfIteratorHelper(e);try{for(r.s();!(t=r.n()).done;){var n=_slicedToArray(t.value,2),i=n[0],o=n[1];if(o.start){var s=Date.now()-o.start;o.start=perf.now()-s}this.set(i,o.value,o)}}catch(e){r.e(e)}finally{r.f()}}},{key:"set",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(void 0===t)return this.delete(e),this;var n=r.ttl,i=void 0===n?this.ttl:n,o=r.start,s=r.noDisposeOnSet,a=void 0===s?this.noDisposeOnSet:s,c=r.sizeCalculation,l=void 0===c?this.sizeCalculation:c,u=r.status,d=r.noUpdateTTL,h=void 0===d?this.noUpdateTTL:d,f=_classPrivateFieldGet(this,_requireSize).call(this,e,t,r.size||0,l);if(this.maxEntrySize&&f>this.maxEntrySize)return u&&(u.set="miss",u.maxEntrySizeExceeded=!0),_classPrivateMethodGet(this,_delete,_delete2).call(this,e,"set"),this;var p=0===_classPrivateFieldGet(this,_size)?void 0:_classPrivateFieldGet(this,_keyMap).get(e);if(void 0===p){var m;p=0===_classPrivateFieldGet(this,_size)?_classPrivateFieldGet(this,_tail):0!==_classPrivateFieldGet(this,_free).length?_classPrivateFieldGet(this,_free).pop():_classPrivateFieldGet(this,_size)===_classPrivateFieldGet(this,_max)?_classPrivateMethodGet(this,_evict,_evict2).call(this,!1):_classPrivateFieldGet(this,_size),_classPrivateFieldGet(this,_keyList)[p]=e,_classPrivateFieldGet(this,_valList)[p]=t,_classPrivateFieldGet(this,_keyMap).set(e,p),_classPrivateFieldGet(this,_next)[_classPrivateFieldGet(this,_tail)]=p,_classPrivateFieldGet(this,_prev)[p]=_classPrivateFieldGet(this,_tail),_classPrivateFieldSet(this,_tail,p),_classPrivateFieldSet(this,_size,(m=_classPrivateFieldGet(this,_size),m++,m)),_classPrivateFieldGet(this,_addItemSize).call(this,p,f,u),u&&(u.set="add"),h=!1}else{_classPrivateMethodGet(this,_moveToTail,_moveToTail2).call(this,p);var v=_classPrivateFieldGet(this,_valList)[p];if(t!==v){if(_classPrivateFieldGet(this,_hasFetchMethod)&&_classPrivateMethodGet(this,_isBackgroundFetch,_isBackgroundFetch2).call(this,v)){v.__abortController.abort(new Error("replaced"));var g=v.__staleWhileFetching;if(void 0!==g&&!a){var _,y;if(_classPrivateFieldGet(this,_hasDispose))null===(_=_classPrivateFieldGet(this,_dispose))||void 0===_||_.call(this,g,e,"set");if(_classPrivateFieldGet(this,_hasDisposeAfter))null===(y=_classPrivateFieldGet(this,_disposed))||void 0===y||y.push([g,e,"set"])}}else if(!a){var b,w;if(_classPrivateFieldGet(this,_hasDispose))null===(b=_classPrivateFieldGet(this,_dispose))||void 0===b||b.call(this,v,e,"set");if(_classPrivateFieldGet(this,_hasDisposeAfter))null===(w=_classPrivateFieldGet(this,_disposed))||void 0===w||w.push([v,e,"set"])}if(_classPrivateFieldGet(this,_removeItemSize).call(this,p),_classPrivateFieldGet(this,_addItemSize).call(this,p,f,u),_classPrivateFieldGet(this,_valList)[p]=t,u){u.set="replace";var k=v&&_classPrivateMethodGet(this,_isBackgroundFetch,_isBackgroundFetch2).call(this,v)?v.__staleWhileFetching:v;void 0!==k&&(u.oldValue=k)}}else u&&(u.set="update")}if(0===i||_classPrivateFieldGet(this,_ttls)||_classPrivateMethodGet(this,_initializeTTLTracking,_initializeTTLTracking2).call(this),_classPrivateFieldGet(this,_ttls)&&(h||_classPrivateFieldGet(this,_setItemTTL).call(this,p,i,o),u&&_classPrivateFieldGet(this,_statusTTL).call(this,u,p)),!a&&_classPrivateFieldGet(this,_hasDisposeAfter)&&_classPrivateFieldGet(this,_disposed))for(var S,E=_classPrivateFieldGet(this,_disposed);S=null==E?void 0:E.shift();){var C,T;null===(C=_classPrivateFieldGet(this,_disposeAfter))||void 0===C||(T=C).call.apply(T,[this].concat(_toConsumableArray(S)))}return this}},{key:"pop",value:function(){try{for(;_classPrivateFieldGet(this,_size);){var e=_classPrivateFieldGet(this,_valList)[_classPrivateFieldGet(this,_head)];if(_classPrivateMethodGet(this,_evict,_evict2).call(this,!0),_classPrivateMethodGet(this,_isBackgroundFetch,_isBackgroundFetch2).call(this,e)){if(e.__staleWhileFetching)return e.__staleWhileFetching}else if(void 0!==e)return e}}finally{if(_classPrivateFieldGet(this,_hasDisposeAfter)&&_classPrivateFieldGet(this,_disposed))for(var t,r=_classPrivateFieldGet(this,_disposed);t=null==r?void 0:r.shift();){var n,i;null===(n=_classPrivateFieldGet(this,_disposeAfter))||void 0===n||(i=n).call.apply(i,[this].concat(_toConsumableArray(t)))}}}},{key:"has",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.updateAgeOnHas,n=void 0===r?this.updateAgeOnHas:r,i=t.status,o=_classPrivateFieldGet(this,_keyMap).get(e);if(void 0!==o){var s=_classPrivateFieldGet(this,_valList)[o];if(_classPrivateMethodGet(this,_isBackgroundFetch,_isBackgroundFetch2).call(this,s)&&void 0===s.__staleWhileFetching)return!1;if(!_classPrivateFieldGet(this,_isStale).call(this,o))return n&&_classPrivateFieldGet(this,_updateItemAge).call(this,o),i&&(i.has="hit",_classPrivateFieldGet(this,_statusTTL).call(this,i,o)),!0;i&&(i.has="stale",_classPrivateFieldGet(this,_statusTTL).call(this,i,o))}else i&&(i.has="miss");return!1}},{key:"peek",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).allowStale,r=void 0===t?this.allowStale:t,n=_classPrivateFieldGet(this,_keyMap).get(e);if(void 0!==n&&(r||!_classPrivateFieldGet(this,_isStale).call(this,n))){var i=_classPrivateFieldGet(this,_valList)[n];return _classPrivateMethodGet(this,_isBackgroundFetch,_isBackgroundFetch2).call(this,i)?i.__staleWhileFetching:i}}},{key:"fetch",value:(r=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var r,n,i,o,s,a,c,l,u,d,h,f,p,m,v,g,_,y,b,w,k,S,E,C,T,P,A,x,B,I,R,O,M,L,D,N,F,$,U,j=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(r=j.length>1&&void 0!==j[1]?j[1]:{}).allowStale,i=void 0===n?this.allowStale:n,o=r.updateAgeOnGet,s=void 0===o?this.updateAgeOnGet:o,a=r.noDeleteOnStaleGet,c=void 0===a?this.noDeleteOnStaleGet:a,l=r.ttl,u=void 0===l?this.ttl:l,d=r.noDisposeOnSet,h=void 0===d?this.noDisposeOnSet:d,f=r.size,p=void 0===f?0:f,m=r.sizeCalculation,v=void 0===m?this.sizeCalculation:m,g=r.noUpdateTTL,_=void 0===g?this.noUpdateTTL:g,y=r.noDeleteOnFetchRejection,b=void 0===y?this.noDeleteOnFetchRejection:y,w=r.allowStaleOnFetchRejection,k=void 0===w?this.allowStaleOnFetchRejection:w,S=r.ignoreFetchAbort,E=void 0===S?this.ignoreFetchAbort:S,C=r.allowStaleOnFetchAbort,T=void 0===C?this.allowStaleOnFetchAbort:C,P=r.context,A=r.forceRefresh,x=void 0!==A&&A,B=r.status,I=r.signal,_classPrivateFieldGet(this,_hasFetchMethod)){e.next=5;break}return B&&(B.fetch="get"),e.abrupt("return",this.get(t,{allowStale:i,updateAgeOnGet:s,noDeleteOnStaleGet:c,status:B}));case 5:if(R={allowStale:i,updateAgeOnGet:s,noDeleteOnStaleGet:c,ttl:u,noDisposeOnSet:h,size:p,sizeCalculation:v,noUpdateTTL:_,noDeleteOnFetchRejection:b,allowStaleOnFetchRejection:k,allowStaleOnFetchAbort:T,ignoreFetchAbort:E,status:B,signal:I},void 0!==(O=_classPrivateFieldGet(this,_keyMap).get(t))){e.next=13;break}return B&&(B.fetch="miss"),M=_classPrivateMethodGet(this,_backgroundFetch,_backgroundFetch2).call(this,t,O,R,P),e.abrupt("return",M.__returned=M);case 13:if(L=_classPrivateFieldGet(this,_valList)[O],!_classPrivateMethodGet(this,_isBackgroundFetch,_isBackgroundFetch2).call(this,L)){e.next=18;break}return D=i&&void 0!==L.__staleWhileFetching,B&&(B.fetch="inflight",D&&(B.returnedStale=!0)),e.abrupt("return",D?L.__staleWhileFetching:L.__returned=L);case 18:if(N=_classPrivateFieldGet(this,_isStale).call(this,O),x||N){e.next=25;break}return B&&(B.fetch="hit"),_classPrivateMethodGet(this,_moveToTail,_moveToTail2).call(this,O),s&&_classPrivateFieldGet(this,_updateItemAge).call(this,O),B&&_classPrivateFieldGet(this,_statusTTL).call(this,B,O),e.abrupt("return",L);case 25:return F=_classPrivateMethodGet(this,_backgroundFetch,_backgroundFetch2).call(this,t,O,R,P),$=void 0!==F.__staleWhileFetching,U=$&&i,B&&(B.fetch=N?"stale":"refresh",U&&N&&(B.returnedStale=!0)),e.abrupt("return",U?F.__staleWhileFetching:F.__returned=F);case 30:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"forceFetch",value:(t=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var r,n,i=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{},e.next=3,this.fetch(t,r);case 3:if(void 0!==(n=e.sent)){e.next=6;break}throw new Error("fetch() returned undefined");case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"memo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=_classPrivateFieldGet(this,_memoMethod);if(!r)throw new Error("no memoMethod provided to constructor");var n=t.context,i=t.forceRefresh,o=_objectWithoutProperties(t,_excluded$1),s=this.get(e,o);if(!i&&void 0!==s)return s;var a=r(e,s,{options:o,context:n});return this.set(e,a,o),a}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.allowStale,n=void 0===r?this.allowStale:r,i=t.updateAgeOnGet,o=void 0===i?this.updateAgeOnGet:i,s=t.noDeleteOnStaleGet,a=void 0===s?this.noDeleteOnStaleGet:s,c=t.status,l=_classPrivateFieldGet(this,_keyMap).get(e);if(void 0!==l){var u=_classPrivateFieldGet(this,_valList)[l],d=_classPrivateMethodGet(this,_isBackgroundFetch,_isBackgroundFetch2).call(this,u);return c&&_classPrivateFieldGet(this,_statusTTL).call(this,c,l),_classPrivateFieldGet(this,_isStale).call(this,l)?(c&&(c.get="stale"),d?(c&&n&&void 0!==u.__staleWhileFetching&&(c.returnedStale=!0),n?u.__staleWhileFetching:void 0):(a||_classPrivateMethodGet(this,_delete,_delete2).call(this,e,"expire"),c&&n&&(c.returnedStale=!0),n?u:void 0)):(c&&(c.get="hit"),d?u.__staleWhileFetching:(_classPrivateMethodGet(this,_moveToTail,_moveToTail2).call(this,l),o&&_classPrivateFieldGet(this,_updateItemAge).call(this,l),u))}c&&(c.get="miss")}},{key:"delete",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return _classPrivateMethodGet(this,_delete,_delete2).call(this,e,"delete")}))},{key:"clear",value:function(){return _classPrivateMethodGet(this,_clear,_clear2).call(this,"delete")}}],[{key:"unsafeExposeInternals",value:function(e){return{starts:_classPrivateFieldGet(e,_starts),ttls:_classPrivateFieldGet(e,_ttls),sizes:_classPrivateFieldGet(e,_sizes),keyMap:_classPrivateFieldGet(e,_keyMap),keyList:_classPrivateFieldGet(e,_keyList),valList:_classPrivateFieldGet(e,_valList),next:_classPrivateFieldGet(e,_next),prev:_classPrivateFieldGet(e,_prev),get head(){return _classPrivateFieldGet(e,_head)},get tail(){return _classPrivateFieldGet(e,_tail)},free:_classPrivateFieldGet(e,_free),isBackgroundFetch:function(t){return _classPrivateMethodGet(e,_isBackgroundFetch,_isBackgroundFetch2).call(e,t)},backgroundFetch:function(t,r,n,i){return _classPrivateMethodGet(e,_backgroundFetch,_backgroundFetch2).call(e,t,r,n,i)},moveToTail:function(t){return _classPrivateMethodGet(e,_moveToTail,_moveToTail2).call(e,t)},indexes:function(t){return _classPrivateMethodGet(e,_indexes,_indexes2).call(e,t)},rindexes:function(t){return _classPrivateMethodGet(e,_rindexes,_rindexes2).call(e,t)},isStale:function(t){return _classPrivateFieldGet(e,_isStale).call(e,t)}}}}]),e}();function _initializeTTLTracking2(){var e=this,t=new ZeroArray(_classPrivateFieldGet(this,_max)),r=new ZeroArray(_classPrivateFieldGet(this,_max));_classPrivateFieldSet(this,_ttls,t),_classPrivateFieldSet(this,_starts,r),_classPrivateFieldSet(this,_setItemTTL,(function(n,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:perf.now();if(r[n]=0!==i?o:0,t[n]=i,0!==i&&e.ttlAutopurge){var s=setTimeout((function(){_classPrivateFieldGet(e,_isStale).call(e,n)&&_classPrivateMethodGet(e,_delete,_delete2).call(e,_classPrivateFieldGet(e,_keyList)[n],"expire")}),i+1);s.unref&&s.unref()}})),_classPrivateFieldSet(this,_updateItemAge,(function(e){r[e]=0!==t[e]?perf.now():0})),_classPrivateFieldSet(this,_statusTTL,(function(e,o){if(t[o]){var s=t[o],a=r[o];if(!s||!a)return;e.ttl=s,e.start=a,e.now=n||i();var c=e.now-a;e.remainingTTL=s-c}}));var n=0,i=function(){var t=perf.now();if(e.ttlResolution>0){n=t;var r=setTimeout((function(){return n=0}),e.ttlResolution);r.unref&&r.unref()}return t};this.getRemainingTTL=function(o){var s=_classPrivateFieldGet(e,_keyMap).get(o);if(void 0===s)return 0;var a=t[s],c=r[s];return a&&c?a-((n||i())-c):1/0},_classPrivateFieldSet(this,_isStale,(function(e){var o=r[e],s=t[e];return!!s&&!!o&&(n||i())-o>s}))}function _initializeSizeTracking2(){var e=this,t=new ZeroArray(_classPrivateFieldGet(this,_max));_classPrivateFieldSet(this,_calculatedSize,0),_classPrivateFieldSet(this,_sizes,t),_classPrivateFieldSet(this,_removeItemSize,(function(r){_classPrivateFieldSet(e,_calculatedSize,_classPrivateFieldGet(e,_calculatedSize)-t[r]),t[r]=0})),_classPrivateFieldSet(this,_requireSize,(function(t,r,n,i){if(_classPrivateMethodGet(e,_isBackgroundFetch,_isBackgroundFetch2).call(e,r))return 0;if(!isPosInt(n)){if(!i)throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");if("function"!=typeof i)throw new TypeError("sizeCalculation must be a function");if(n=i(r,t),!isPosInt(n))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}return n})),_classPrivateFieldSet(this,_addItemSize,(function(r,n,i){if(t[r]=n,_classPrivateFieldGet(e,_maxSize))for(var o=_classPrivateFieldGet(e,_maxSize)-t[r];_classPrivateFieldGet(e,_calculatedSize)>o;)_classPrivateMethodGet(e,_evict,_evict2).call(e,!0);_classPrivateFieldSet(e,_calculatedSize,_classPrivateFieldGet(e,_calculatedSize)+t[r]),i&&(i.entrySize=n,i.totalCalculatedSize=_classPrivateFieldGet(e,_calculatedSize))}))}function _indexes2(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).allowStale,r=void 0===t?this.allowStale:t;return _regeneratorRuntime().mark((function t(){var n;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!_classPrivateFieldGet(e,_size)){t.next=15;break}n=_classPrivateFieldGet(e,_tail);case 2:if(_classPrivateMethodGet(e,_isValidIndex,_isValidIndex2).call(e,n)){t.next=5;break}return t.abrupt("break",15);case 5:if(!r&&_classPrivateFieldGet(e,_isStale).call(e,n)){t.next=8;break}return t.next=8,n;case 8:if(n!==_classPrivateFieldGet(e,_head)){t.next=12;break}return t.abrupt("break",15);case 12:n=_classPrivateFieldGet(e,_prev)[n];case 13:t.next=2;break;case 15:case"end":return t.stop()}}),t)}))()}function _rindexes2(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).allowStale,r=void 0===t?this.allowStale:t;return _regeneratorRuntime().mark((function t(){var n;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!_classPrivateFieldGet(e,_size)){t.next=15;break}n=_classPrivateFieldGet(e,_head);case 2:if(_classPrivateMethodGet(e,_isValidIndex,_isValidIndex2).call(e,n)){t.next=5;break}return t.abrupt("break",15);case 5:if(!r&&_classPrivateFieldGet(e,_isStale).call(e,n)){t.next=8;break}return t.next=8,n;case 8:if(n!==_classPrivateFieldGet(e,_tail)){t.next=12;break}return t.abrupt("break",15);case 12:n=_classPrivateFieldGet(e,_next)[n];case 13:t.next=2;break;case 15:case"end":return t.stop()}}),t)}))()}function _isValidIndex2(e){return void 0!==e&&_classPrivateFieldGet(this,_keyMap).get(_classPrivateFieldGet(this,_keyList)[e])===e}function _evict2(e){var t,r=_classPrivateFieldGet(this,_head),n=_classPrivateFieldGet(this,_keyList)[r],i=_classPrivateFieldGet(this,_valList)[r];if(_classPrivateFieldGet(this,_hasFetchMethod)&&_classPrivateMethodGet(this,_isBackgroundFetch,_isBackgroundFetch2).call(this,i))i.__abortController.abort(new Error("evicted"));else if(_classPrivateFieldGet(this,_hasDispose)||_classPrivateFieldGet(this,_hasDisposeAfter)){var o,s;if(_classPrivateFieldGet(this,_hasDispose))null===(o=_classPrivateFieldGet(this,_dispose))||void 0===o||o.call(this,i,n,"evict");if(_classPrivateFieldGet(this,_hasDisposeAfter))null===(s=_classPrivateFieldGet(this,_disposed))||void 0===s||s.push([i,n,"evict"])}return _classPrivateFieldGet(this,_removeItemSize).call(this,r),e&&(_classPrivateFieldGet(this,_keyList)[r]=void 0,_classPrivateFieldGet(this,_valList)[r]=void 0,_classPrivateFieldGet(this,_free).push(r)),1===_classPrivateFieldGet(this,_size)?(_classPrivateFieldSet(this,_head,_classPrivateFieldSet(this,_tail,0)),_classPrivateFieldGet(this,_free).length=0):_classPrivateFieldSet(this,_head,_classPrivateFieldGet(this,_next)[r]),_classPrivateFieldGet(this,_keyMap).delete(n),_classPrivateFieldSet(this,_size,(t=_classPrivateFieldGet(this,_size),t--,t)),r}function _backgroundFetch2(e,t,r,n){var i=this,o=void 0===t?void 0:_classPrivateFieldGet(this,_valList)[t];if(_classPrivateMethodGet(this,_isBackgroundFetch,_isBackgroundFetch2).call(this,o))return o;var s=new AC,a=r.signal;null==a||a.addEventListener("abort",(function(){return s.abort(a.reason)}),{signal:s.signal});var c={signal:s.signal,options:r,context:n},l=function(n){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=s.signal.aborted,l=r.ignoreFetchAbort&&void 0!==n;if(r.status&&(a&&!o?(r.status.fetchAborted=!0,r.status.fetchError=s.signal.reason,l&&(r.status.fetchAbortIgnored=!0)):r.status.fetchResolved=!0),a&&!l&&!o)return u(s.signal.reason);var h=d;return _classPrivateFieldGet(i,_valList)[t]===d&&(void 0===n?h.__staleWhileFetching?_classPrivateFieldGet(i,_valList)[t]=h.__staleWhileFetching:_classPrivateMethodGet(i,_delete,_delete2).call(i,e,"fetch"):(r.status&&(r.status.fetchUpdated=!0),i.set(e,n,c.options))),n},u=function(n){var o=s.signal.aborted&&r.allowStaleOnFetchAbort,a=o||r.allowStaleOnFetchRejection,c=a||r.noDeleteOnFetchRejection,l=d;_classPrivateFieldGet(i,_valList)[t]===d&&(!c||void 0===l.__staleWhileFetching?_classPrivateMethodGet(i,_delete,_delete2).call(i,e,"fetch"):o||(_classPrivateFieldGet(i,_valList)[t]=l.__staleWhileFetching));if(a)return r.status&&void 0!==l.__staleWhileFetching&&(r.status.returnedStale=!0),l.__staleWhileFetching;if(l.__returned===l)throw n};r.status&&(r.status.fetchDispatched=!0);var d=new Promise((function(t,n){var a,u=null===(a=_classPrivateFieldGet(i,_fetchMethod))||void 0===a?void 0:a.call(i,e,o,c);u&&u instanceof Promise&&u.then((function(e){return t(void 0===e?void 0:e)}),n),s.signal.addEventListener("abort",(function(){r.ignoreFetchAbort&&!r.allowStaleOnFetchAbort||(t(void 0),r.allowStaleOnFetchAbort&&(t=function(e){return l(e,!0)}))}))})).then(l,(function(e){return r.status&&(r.status.fetchRejected=!0,r.status.fetchError=e),u(e)})),h=Object.assign(d,{__abortController:s,__staleWhileFetching:o,__returned:void 0});return void 0===t?(this.set(e,h,_objectSpread2(_objectSpread2({},c.options),{},{status:void 0})),t=_classPrivateFieldGet(this,_keyMap).get(e)):_classPrivateFieldGet(this,_valList)[t]=h,h}function _isBackgroundFetch2(e){if(!_classPrivateFieldGet(this,_hasFetchMethod))return!1;var t=e;return!!t&&t instanceof Promise&&t.hasOwnProperty("__staleWhileFetching")&&t.__abortController instanceof AC}function _connect2(e,t){_classPrivateFieldGet(this,_prev)[t]=e,_classPrivateFieldGet(this,_next)[e]=t}function _moveToTail2(e){e!==_classPrivateFieldGet(this,_tail)&&(e===_classPrivateFieldGet(this,_head)?_classPrivateFieldSet(this,_head,_classPrivateFieldGet(this,_next)[e]):_classPrivateMethodGet(this,_connect,_connect2).call(this,_classPrivateFieldGet(this,_prev)[e],_classPrivateFieldGet(this,_next)[e]),_classPrivateMethodGet(this,_connect,_connect2).call(this,_classPrivateFieldGet(this,_tail),e),_classPrivateFieldSet(this,_tail,e))}function _delete2(e,t){var r,n=!1;if(0!==_classPrivateFieldGet(this,_size)){var i=_classPrivateFieldGet(this,_keyMap).get(e);if(void 0!==i)if(n=!0,1===_classPrivateFieldGet(this,_size))_classPrivateMethodGet(this,_clear,_clear2).call(this,t);else{var o;_classPrivateFieldGet(this,_removeItemSize).call(this,i);var s=_classPrivateFieldGet(this,_valList)[i];if(_classPrivateMethodGet(this,_isBackgroundFetch,_isBackgroundFetch2).call(this,s))s.__abortController.abort(new Error("deleted"));else if(_classPrivateFieldGet(this,_hasDispose)||_classPrivateFieldGet(this,_hasDisposeAfter)){var a,c;if(_classPrivateFieldGet(this,_hasDispose))null===(a=_classPrivateFieldGet(this,_dispose))||void 0===a||a.call(this,s,e,t);if(_classPrivateFieldGet(this,_hasDisposeAfter))null===(c=_classPrivateFieldGet(this,_disposed))||void 0===c||c.push([s,e,t])}if(_classPrivateFieldGet(this,_keyMap).delete(e),_classPrivateFieldGet(this,_keyList)[i]=void 0,_classPrivateFieldGet(this,_valList)[i]=void 0,i===_classPrivateFieldGet(this,_tail))_classPrivateFieldSet(this,_tail,_classPrivateFieldGet(this,_prev)[i]);else if(i===_classPrivateFieldGet(this,_head))_classPrivateFieldSet(this,_head,_classPrivateFieldGet(this,_next)[i]);else{var l=_classPrivateFieldGet(this,_prev)[i];_classPrivateFieldGet(this,_next)[l]=_classPrivateFieldGet(this,_next)[i];var u=_classPrivateFieldGet(this,_next)[i];_classPrivateFieldGet(this,_prev)[u]=_classPrivateFieldGet(this,_prev)[i]}_classPrivateFieldSet(this,_size,(o=_classPrivateFieldGet(this,_size),o--,o)),_classPrivateFieldGet(this,_free).push(i)}}if(_classPrivateFieldGet(this,_hasDisposeAfter)&&null!==(r=_classPrivateFieldGet(this,_disposed))&&void 0!==r&&r.length)for(var d,h=_classPrivateFieldGet(this,_disposed);d=null==h?void 0:h.shift();){var f,p;null===(f=_classPrivateFieldGet(this,_disposeAfter))||void 0===f||(p=f).call.apply(p,[this].concat(_toConsumableArray(d)))}return n}function _clear2(e){var t,r=_createForOfIteratorHelper(_classPrivateMethodGet(this,_rindexes,_rindexes2).call(this,{allowStale:!0}));try{for(r.s();!(t=r.n()).done;){var n=t.value,i=_classPrivateFieldGet(this,_valList)[n];if(_classPrivateMethodGet(this,_isBackgroundFetch,_isBackgroundFetch2).call(this,i))i.__abortController.abort(new Error("deleted"));else{var o,s,a=_classPrivateFieldGet(this,_keyList)[n];if(_classPrivateFieldGet(this,_hasDispose))null===(o=_classPrivateFieldGet(this,_dispose))||void 0===o||o.call(this,i,a,e);if(_classPrivateFieldGet(this,_hasDisposeAfter))null===(s=_classPrivateFieldGet(this,_disposed))||void 0===s||s.push([i,a,e])}}}catch(e){r.e(e)}finally{r.f()}if(_classPrivateFieldGet(this,_keyMap).clear(),_classPrivateFieldGet(this,_valList).fill(void 0),_classPrivateFieldGet(this,_keyList).fill(void 0),_classPrivateFieldGet(this,_ttls)&&_classPrivateFieldGet(this,_starts)&&(_classPrivateFieldGet(this,_ttls).fill(0),_classPrivateFieldGet(this,_starts).fill(0)),_classPrivateFieldGet(this,_sizes)&&_classPrivateFieldGet(this,_sizes).fill(0),_classPrivateFieldSet(this,_head,0),_classPrivateFieldSet(this,_tail,0),_classPrivateFieldGet(this,_free).length=0,_classPrivateFieldSet(this,_calculatedSize,0),_classPrivateFieldSet(this,_size,0),_classPrivateFieldGet(this,_hasDisposeAfter)&&_classPrivateFieldGet(this,_disposed))for(var c,l=_classPrivateFieldGet(this,_disposed);c=null==l?void 0:l.shift();){var u,d;null===(u=_classPrivateFieldGet(this,_disposeAfter))||void 0===u||(d=u).call.apply(d,[this].concat(_toConsumableArray(c)))}}LRUCache_1=commonjs.LRUCache=LRUCache;var numberAllocator$2={},__extends$g=this&&this.t||(_extendStatics=function(e,t){return _extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},_extendStatics(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}_extendStatics(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),_extendStatics,ContainerIterator=function(){function e(e){void 0===e&&(e=0),this.iteratorType=e}return e.prototype.equals=function(e){return this.o===e.o},e}(),Base=function(){function e(){this.M=0}return Object.defineProperty(e.prototype,"length",{get:function(){return this.M},enumerable:!1,configurable:!0}),e.prototype.size=function(){return this.M},e.prototype.empty=function(){return 0===this.M},e}(),Container=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$g(t,e),t}(Base),__extends$f=this&&this.t||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Stack=function(e){function t(t){void 0===t&&(t=[]);var r=e.call(this)||this;r.nt=[];var n=r;return t.forEach((function(e){n.push(e)})),r}return __extends$f(t,e),t.prototype.clear=function(){this.M=0,this.nt=[]},t.prototype.push=function(e){return this.nt.push(e),this.M+=1,this.M},t.prototype.pop=function(){if(0!==this.M)return this.M-=1,this.nt.pop()},t.prototype.top=function(){return this.nt[this.M-1]},t}(Base),__extends$e=this&&this.t||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Queue=function(e){function t(t){void 0===t&&(t=[]);var r=e.call(this)||this;r.A=0,r.tt=[];var n=r;return t.forEach((function(e){n.push(e)})),r}return __extends$e(t,e),t.prototype.clear=function(){this.tt=[],this.M=this.A=0},t.prototype.push=function(e){var t=this.tt.length;if(this.A/t>.5&&this.A+this.M>=t&&t>4096){for(var r=this.M,n=0;n<r;++n)this.tt[n]=this.tt[this.A+n];this.A=0,this.tt[this.M]=e}else this.tt[this.A+this.M]=e;return++this.M},t.prototype.pop=function(){if(0!==this.M){var e=this.tt[this.A++];return this.M-=1,e}},t.prototype.front=function(){if(0!==this.M)return this.tt[this.A]},t}(Base),__extends$d=this&&this.t||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),__read$3=this&&this.q||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s},__spreadArray$2=this&&this.D||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},PriorityQueue=function(e){function t(t,r,n){void 0===t&&(t=[]),void 0===r&&(r=function(e,t){return e>t?-1:e<t?1:0}),void 0===n&&(n=!0);var i=e.call(this)||this;if(i.$=r,Array.isArray(t))i.ii=n?__spreadArray$2([],__read$3(t),!1):t;else{i.ii=[];var o=i;t.forEach((function(e){o.ii.push(e)}))}i.M=i.ii.length;for(var s=i.M>>1,a=i.M-1>>1;a>=0;--a)i.ri(a,s);return i}return __extends$d(t,e),t.prototype.ti=function(e){for(var t=this.ii[e];e>0;){var r=e-1>>1,n=this.ii[r];if(this.$(n,t)<=0)break;this.ii[e]=n,e=r}this.ii[e]=t},t.prototype.ri=function(e,t){for(var r=this.ii[e];e<t;){var n=e<<1|1,i=n+1,o=this.ii[n];if(i<this.M&&this.$(o,this.ii[i])>0&&(n=i,o=this.ii[i]),this.$(o,r)>=0)break;this.ii[e]=o,e=n}this.ii[e]=r},t.prototype.clear=function(){this.M=0,this.ii.length=0},t.prototype.push=function(e){this.ii.push(e),this.ti(this.M),this.M+=1},t.prototype.pop=function(){if(0!==this.M){var e=this.ii[0],t=this.ii.pop();return this.M-=1,this.M&&(this.ii[0]=t,this.ri(0,this.M>>1)),e}},t.prototype.top=function(){return this.ii[0]},t.prototype.find=function(e){return this.ii.indexOf(e)>=0},t.prototype.remove=function(e){var t=this.ii.indexOf(e);return!(t<0)&&(0===t?this.pop():t===this.M-1?(this.ii.pop(),this.M-=1):(this.ii.splice(t,1,this.ii.pop()),this.M-=1,this.ti(t),this.ri(t,this.M>>1)),!0)},t.prototype.updateItem=function(e){var t=this.ii.indexOf(e);return!(t<0)&&(this.ti(t),this.ri(t,this.M>>1),!0)},t.prototype.toArray=function(){return __spreadArray$2([],__read$3(this.ii),!1)},t}(Base),__extends$c=this&&this.t||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),SequentialContainer=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$c(t,e),t}(Container);function throwIteratorAccessError(){throw new RangeError("Iterator access denied!")}var __extends$b=this&&this.t||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),RandomIterator=function(e){function t(t,r){var n=e.call(this,r)||this;return n.o=t,0===n.iteratorType?(n.pre=function(){return 0===this.o&&throwIteratorAccessError(),this.o-=1,this},n.next=function(){return this.o===this.container.size()&&throwIteratorAccessError(),this.o+=1,this}):(n.pre=function(){return this.o===this.container.size()-1&&throwIteratorAccessError(),this.o+=1,this},n.next=function(){return-1===this.o&&throwIteratorAccessError(),this.o-=1,this}),n}return __extends$b(t,e),Object.defineProperty(t.prototype,"pointer",{get:function(){return this.container.getElementByPos(this.o)},set:function(e){this.container.setElementByPos(this.o,e)},enumerable:!1,configurable:!0}),t}(ContainerIterator),__extends$a=this&&this.t||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),__generator$6=this&&this.i||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(e){return function(t){return c([e,t])}}function c(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},__read$2=this&&this.q||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s},__spreadArray$1=this&&this.D||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},__values$3=this&&this.V||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},VectorIterator=function(e){function t(t,r,n){var i=e.call(this,t,n)||this;return i.container=r,i}return __extends$a(t,e),t.prototype.copy=function(){return new t(this.o,this.container,this.iteratorType)},t}(RandomIterator),Vector=function(e){function t(t,r){void 0===t&&(t=[]),void 0===r&&(r=!0);var n=e.call(this)||this;if(Array.isArray(t))n.J=r?__spreadArray$1([],__read$2(t),!1):t,n.M=t.length;else{n.J=[];var i=n;t.forEach((function(e){i.pushBack(e)}))}return n}return __extends$a(t,e),t.prototype.clear=function(){this.M=0,this.J.length=0},t.prototype.begin=function(){return new VectorIterator(0,this)},t.prototype.end=function(){return new VectorIterator(this.M,this)},t.prototype.rBegin=function(){return new VectorIterator(this.M-1,this,1)},t.prototype.rEnd=function(){return new VectorIterator(-1,this,1)},t.prototype.front=function(){return this.J[0]},t.prototype.back=function(){return this.J[this.M-1]},t.prototype.getElementByPos=function(e){if(e<0||e>this.M-1)throw new RangeError;return this.J[e]},t.prototype.eraseElementByPos=function(e){if(e<0||e>this.M-1)throw new RangeError;return this.J.splice(e,1),this.M-=1,this.M},t.prototype.eraseElementByValue=function(e){for(var t=0,r=0;r<this.M;++r)this.J[r]!==e&&(this.J[t++]=this.J[r]);return this.M=this.J.length=t,this.M},t.prototype.eraseElementByIterator=function(e){var t=e.o;return e=e.next(),this.eraseElementByPos(t),e},t.prototype.pushBack=function(e){return this.J.push(e),this.M+=1,this.M},t.prototype.popBack=function(){if(0!==this.M)return this.M-=1,this.J.pop()},t.prototype.setElementByPos=function(e,t){if(e<0||e>this.M-1)throw new RangeError;this.J[e]=t},t.prototype.insert=function(e,t,r){var n;if(void 0===r&&(r=1),e<0||e>this.M)throw new RangeError;return(n=this.J).splice.apply(n,__spreadArray$1([e,0],__read$2(new Array(r).fill(t)),!1)),this.M+=r,this.M},t.prototype.find=function(e){for(var t=0;t<this.M;++t)if(this.J[t]===e)return new VectorIterator(t,this);return this.end()},t.prototype.reverse=function(){this.J.reverse()},t.prototype.unique=function(){for(var e=1,t=1;t<this.M;++t)this.J[t]!==this.J[t-1]&&(this.J[e++]=this.J[t]);return this.M=this.J.length=e,this.M},t.prototype.sort=function(e){this.J.sort(e)},t.prototype.forEach=function(e){for(var t=0;t<this.M;++t)e(this.J[t],t,this)},t.prototype[Symbol.iterator]=function(){return function(){return __generator$6(this,(function(e){switch(e.label){case 0:return[5,__values$3(this.J)];case 1:return e.sent(),[2]}}))}.bind(this)()},t}(SequentialContainer),__extends$9=this&&this.t||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),__generator$5=this&&this.i||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(e){return function(t){return c([e,t])}}function c(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},LinkListIterator=function(e){function t(t,r,n,i){var o=e.call(this,i)||this;return o.o=t,o.h=r,o.container=n,0===o.iteratorType?(o.pre=function(){return this.o.L===this.h&&throwIteratorAccessError(),this.o=this.o.L,this},o.next=function(){return this.o===this.h&&throwIteratorAccessError(),this.o=this.o.m,this}):(o.pre=function(){return this.o.m===this.h&&throwIteratorAccessError(),this.o=this.o.m,this},o.next=function(){return this.o===this.h&&throwIteratorAccessError(),this.o=this.o.L,this}),o}return __extends$9(t,e),Object.defineProperty(t.prototype,"pointer",{get:function(){return this.o===this.h&&throwIteratorAccessError(),this.o.p},set:function(e){this.o===this.h&&throwIteratorAccessError(),this.o.p=e},enumerable:!1,configurable:!0}),t.prototype.copy=function(){return new t(this.o,this.h,this.container,this.iteratorType)},t}(ContainerIterator),LinkList=function(e){function t(t){void 0===t&&(t=[]);var r=e.call(this)||this;r.h={},r.H=r.l=r.h.L=r.h.m=r.h;var n=r;return t.forEach((function(e){n.pushBack(e)})),r}return __extends$9(t,e),t.prototype.G=function(e){var t=e.L,r=e.m;t.m=r,r.L=t,e===this.H&&(this.H=r),e===this.l&&(this.l=t),this.M-=1},t.prototype.F=function(e,t){var r=t.m,n={p:e,L:t,m:r};t.m=n,r.L=n,t===this.h&&(this.H=n),r===this.h&&(this.l=n),this.M+=1},t.prototype.clear=function(){this.M=0,this.H=this.l=this.h.L=this.h.m=this.h},t.prototype.begin=function(){return new LinkListIterator(this.H,this.h,this)},t.prototype.end=function(){return new LinkListIterator(this.h,this.h,this)},t.prototype.rBegin=function(){return new LinkListIterator(this.l,this.h,this,1)},t.prototype.rEnd=function(){return new LinkListIterator(this.h,this.h,this,1)},t.prototype.front=function(){return this.H.p},t.prototype.back=function(){return this.l.p},t.prototype.getElementByPos=function(e){if(e<0||e>this.M-1)throw new RangeError;for(var t=this.H;e--;)t=t.m;return t.p},t.prototype.eraseElementByPos=function(e){if(e<0||e>this.M-1)throw new RangeError;for(var t=this.H;e--;)t=t.m;return this.G(t),this.M},t.prototype.eraseElementByValue=function(e){for(var t=this.H;t!==this.h;)t.p===e&&this.G(t),t=t.m;return this.M},t.prototype.eraseElementByIterator=function(e){var t=e.o;return t===this.h&&throwIteratorAccessError(),e=e.next(),this.G(t),e},t.prototype.pushBack=function(e){return this.F(e,this.l),this.M},t.prototype.popBack=function(){if(0!==this.M){var e=this.l.p;return this.G(this.l),e}},t.prototype.pushFront=function(e){return this.F(e,this.h),this.M},t.prototype.popFront=function(){if(0!==this.M){var e=this.H.p;return this.G(this.H),e}},t.prototype.setElementByPos=function(e,t){if(e<0||e>this.M-1)throw new RangeError;for(var r=this.H;e--;)r=r.m;r.p=t},t.prototype.insert=function(e,t,r){if(void 0===r&&(r=1),e<0||e>this.M)throw new RangeError;if(r<=0)return this.M;if(0===e)for(;r--;)this.pushFront(t);else if(e===this.M)for(;r--;)this.pushBack(t);else{for(var n=this.H,i=1;i<e;++i)n=n.m;var o=n.m;for(this.M+=r;r--;)n.m={p:t,L:n},n.m.L=n,n=n.m;n.m=o,o.L=n}return this.M},t.prototype.find=function(e){for(var t=this.H;t!==this.h;){if(t.p===e)return new LinkListIterator(t,this.h,this);t=t.m}return this.end()},t.prototype.reverse=function(){if(!(this.M<=1))for(var e=this.H,t=this.l,r=0;r<<1<this.M;){var n=e.p;e.p=t.p,t.p=n,e=e.m,t=t.L,r+=1}},t.prototype.unique=function(){if(this.M<=1)return this.M;for(var e=this.H;e!==this.h;){for(var t=e;t.m!==this.h&&t.p===t.m.p;)t=t.m,this.M-=1;e.m=t.m,e.m.L=e,e=e.m}return this.M},t.prototype.sort=function(e){if(!(this.M<=1)){var t=[];this.forEach((function(e){t.push(e)})),t.sort(e);var r=this.H;t.forEach((function(e){r.p=e,r=r.m}))}},t.prototype.merge=function(e){var t=this;if(0===this.M)e.forEach((function(e){t.pushBack(e)}));else{var r=this.H;e.forEach((function(e){for(;r!==t.h&&r.p<=e;)r=r.m;t.F(e,r.L)}))}return this.M},t.prototype.forEach=function(e){for(var t=this.H,r=0;t!==this.h;)e(t.p,r++,this),t=t.m},t.prototype[Symbol.iterator]=function(){return function(){var e;return __generator$5(this,(function(t){switch(t.label){case 0:if(0===this.M)return[2];e=this.H,t.label=1;case 1:return e===this.h?[3,3]:[4,e.p];case 2:return t.sent(),e=e.m,[3,1];case 3:return[2]}}))}.bind(this)()},t}(SequentialContainer),__extends$8=this&&this.t||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),__generator$4=this&&this.i||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(e){return function(t){return c([e,t])}}function c(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},__read$1=this&&this.q||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s},__spreadArray=this&&this.D||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},DequeIterator=function(e){function t(t,r,n){var i=e.call(this,t,n)||this;return i.container=r,i}return __extends$8(t,e),t.prototype.copy=function(){return new t(this.o,this.container,this.iteratorType)},t}(RandomIterator),Deque=function(e){function t(t,r){void 0===t&&(t=[]),void 0===r&&(r=4096);var n=e.call(this)||this;n.A=0,n.S=0,n.R=0,n.k=0,n.C=0,n.j=[];var i=function(){if("number"==typeof t.length)return t.length;if("number"==typeof t.size)return t.size;if("function"==typeof t.size)return t.size();throw new TypeError("Cannot get the length or size of the container")}();n.B=r,n.C=Math.max(Math.ceil(i/n.B),1);for(var o=0;o<n.C;++o)n.j.push(new Array(n.B));var s=Math.ceil(i/n.B);n.A=n.R=(n.C>>1)-(s>>1),n.S=n.k=n.B-i%n.B>>1;var a=n;return t.forEach((function(e){a.pushBack(e)})),n}return __extends$8(t,e),t.prototype.O=function(){for(var e=[],t=Math.max(this.C>>1,1),r=0;r<t;++r)e[r]=new Array(this.B);for(r=this.A;r<this.C;++r)e[e.length]=this.j[r];for(r=0;r<this.R;++r)e[e.length]=this.j[r];e[e.length]=__spreadArray([],__read$1(this.j[this.R]),!1),this.A=t,this.R=e.length-1;for(r=0;r<t;++r)e[e.length]=new Array(this.B);this.j=e,this.C=e.length},t.prototype.T=function(e){var t=this.S+e+1,r=t%this.B,n=r-1,i=this.A+(t-r)/this.B;return 0===r&&(i-=1),i%=this.C,n<0&&(n+=this.B),{curNodeBucketIndex:i,curNodePointerIndex:n}},t.prototype.clear=function(){this.j=[new Array(this.B)],this.C=1,this.A=this.R=this.M=0,this.S=this.k=this.B>>1},t.prototype.begin=function(){return new DequeIterator(0,this)},t.prototype.end=function(){return new DequeIterator(this.M,this)},t.prototype.rBegin=function(){return new DequeIterator(this.M-1,this,1)},t.prototype.rEnd=function(){return new DequeIterator(-1,this,1)},t.prototype.front=function(){if(0!==this.M)return this.j[this.A][this.S]},t.prototype.back=function(){if(0!==this.M)return this.j[this.R][this.k]},t.prototype.pushBack=function(e){return this.M&&(this.k<this.B-1?this.k+=1:this.R<this.C-1?(this.R+=1,this.k=0):(this.R=0,this.k=0),this.R===this.A&&this.k===this.S&&this.O()),this.M+=1,this.j[this.R][this.k]=e,this.M},t.prototype.popBack=function(){if(0!==this.M){var e=this.j[this.R][this.k];return 1!==this.M&&(this.k>0?this.k-=1:this.R>0?(this.R-=1,this.k=this.B-1):(this.R=this.C-1,this.k=this.B-1)),this.M-=1,e}},t.prototype.pushFront=function(e){return this.M&&(this.S>0?this.S-=1:this.A>0?(this.A-=1,this.S=this.B-1):(this.A=this.C-1,this.S=this.B-1),this.A===this.R&&this.S===this.k&&this.O()),this.M+=1,this.j[this.A][this.S]=e,this.M},t.prototype.popFront=function(){if(0!==this.M){var e=this.j[this.A][this.S];return 1!==this.M&&(this.S<this.B-1?this.S+=1:this.A<this.C-1?(this.A+=1,this.S=0):(this.A=0,this.S=0)),this.M-=1,e}},t.prototype.getElementByPos=function(e){if(e<0||e>this.M-1)throw new RangeError;var t=this.T(e),r=t.curNodeBucketIndex,n=t.curNodePointerIndex;return this.j[r][n]},t.prototype.setElementByPos=function(e,t){if(e<0||e>this.M-1)throw new RangeError;var r=this.T(e),n=r.curNodeBucketIndex,i=r.curNodePointerIndex;this.j[n][i]=t},t.prototype.insert=function(e,t,r){if(void 0===r&&(r=1),e<0||e>this.M)throw new RangeError;if(0===e)for(;r--;)this.pushFront(t);else if(e===this.M)for(;r--;)this.pushBack(t);else{for(var n=[],i=e;i<this.M;++i)n.push(this.getElementByPos(i));this.cut(e-1);for(i=0;i<r;++i)this.pushBack(t);for(i=0;i<n.length;++i)this.pushBack(n[i])}return this.M},t.prototype.cut=function(e){if(e<0)return this.clear(),0;var t=this.T(e),r=t.curNodeBucketIndex,n=t.curNodePointerIndex;return this.R=r,this.k=n,this.M=e+1,this.M},t.prototype.eraseElementByPos=function(e){if(e<0||e>this.M-1)throw new RangeError;if(0===e)this.popFront();else if(e===this.M-1)this.popBack();else{for(var t=[],r=e+1;r<this.M;++r)t.push(this.getElementByPos(r));this.cut(e),this.popBack();var n=this;t.forEach((function(e){n.pushBack(e)}))}return this.M},t.prototype.eraseElementByValue=function(e){if(0===this.M)return 0;for(var t=[],r=0;r<this.M;++r){var n=this.getElementByPos(r);n!==e&&t.push(n)}var i=t.length;for(r=0;r<i;++r)this.setElementByPos(r,t[r]);return this.cut(i-1)},t.prototype.eraseElementByIterator=function(e){var t=e.o;return this.eraseElementByPos(t),e=e.next()},t.prototype.find=function(e){for(var t=0;t<this.M;++t)if(this.getElementByPos(t)===e)return new DequeIterator(t,this);return this.end()},t.prototype.reverse=function(){for(var e=0,t=this.M-1;e<t;){var r=this.getElementByPos(e);this.setElementByPos(e,this.getElementByPos(t)),this.setElementByPos(t,r),e+=1,t-=1}},t.prototype.unique=function(){if(this.M<=1)return this.M;for(var e=1,t=this.getElementByPos(0),r=1;r<this.M;++r){var n=this.getElementByPos(r);n!==t&&(t=n,this.setElementByPos(e++,n))}for(;this.M>e;)this.popBack();return this.M},t.prototype.sort=function(e){for(var t=[],r=0;r<this.M;++r)t.push(this.getElementByPos(r));t.sort(e);for(r=0;r<this.M;++r)this.setElementByPos(r,t[r])},t.prototype.shrinkToFit=function(){if(0!==this.M){var e=[];this.forEach((function(t){e.push(t)})),this.C=Math.max(Math.ceil(this.M/this.B),1),this.M=this.A=this.R=this.S=this.k=0,this.j=[];for(var t=0;t<this.C;++t)this.j.push(new Array(this.B));for(t=0;t<e.length;++t)this.pushBack(e[t])}},t.prototype.forEach=function(e){for(var t=0;t<this.M;++t)e(this.getElementByPos(t),t,this)},t.prototype[Symbol.iterator]=function(){return function(){var e;return __generator$4(this,(function(t){switch(t.label){case 0:e=0,t.label=1;case 1:return e<this.M?[4,this.getElementByPos(e)]:[3,4];case 2:t.sent(),t.label=3;case 3:return++e,[3,1];case 4:return[2]}}))}.bind(this)()},t}(SequentialContainer),__extends$7=this&&this.t||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),TreeNode=function(){function e(e,t){this.ee=1,this.u=void 0,this.p=void 0,this.K=void 0,this.N=void 0,this.rr=void 0,this.u=e,this.p=t}return e.prototype.L=function(){var e=this;if(1===e.ee&&e.rr.rr===e)e=e.N;else if(e.K)for(e=e.K;e.N;)e=e.N;else{for(var t=e.rr;t.K===e;)t=(e=t).rr;e=t}return e},e.prototype.m=function(){var e=this;if(e.N){for(e=e.N;e.K;)e=e.K;return e}for(var t=e.rr;t.N===e;)t=(e=t).rr;return e.N!==t?t:e},e.prototype.ne=function(){var e=this.rr,t=this.N,r=t.K;return e.rr===this?e.rr=t:e.K===this?e.K=t:e.N=t,t.rr=e,t.K=this,this.rr=t,this.N=r,r&&(r.rr=this),t},e.prototype.te=function(){var e=this.rr,t=this.K,r=t.N;return e.rr===this?e.rr=t:e.K===this?e.K=t:e.N=t,t.rr=e,t.N=this,this.rr=t,this.K=r,r&&(r.rr=this),t},e}(),TreeNodeEnableIndex=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tr=1,t}return __extends$7(t,e),t.prototype.ne=function(){var t=e.prototype.ne.call(this);return this.ie(),t.ie(),t},t.prototype.te=function(){var t=e.prototype.te.call(this);return this.ie(),t.ie(),t},t.prototype.ie=function(){this.tr=1,this.K&&(this.tr+=this.K.tr),this.N&&(this.tr+=this.N.tr)},t}(TreeNode),__extends$6=this&&this.t||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),__read=this&&this.q||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s},__values$2=this&&this.V||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},TreeContainer=function(e){function t(t,r){void 0===t&&(t=function(e,t){return e<t?-1:e>t?1:0}),void 0===r&&(r=!1);var n=e.call(this)||this;return n.W=void 0,n.$=t,r?(n.re=TreeNodeEnableIndex,n.v=function(e,t,r){var n=this.se(e,t,r);if(n){for(var i=n.rr;i!==this.h;)i.tr+=1,i=i.rr;var o=this.fe(n);if(o){var s=o,a=s.parentNode,c=s.grandParent,l=s.curNode;a.ie(),c.ie(),l.ie()}}return this.M},n.G=function(e){for(var t=this.he(e);t!==this.h;)t.tr-=1,t=t.rr}):(n.re=TreeNode,n.v=function(e,t,r){var n=this.se(e,t,r);return n&&this.fe(n),this.M},n.G=n.he),n.h=new n.re,n}return __extends$6(t,e),t.prototype.U=function(e,t){for(var r=this.h;e;){var n=this.$(e.u,t);if(n<0)e=e.N;else{if(!(n>0))return e;r=e,e=e.K}}return r},t.prototype.X=function(e,t){for(var r=this.h;e;){this.$(e.u,t)<=0?e=e.N:(r=e,e=e.K)}return r},t.prototype.Y=function(e,t){for(var r=this.h;e;){var n=this.$(e.u,t);if(n<0)r=e,e=e.N;else{if(!(n>0))return e;e=e.K}}return r},t.prototype.Z=function(e,t){for(var r=this.h;e;){this.$(e.u,t)<0?(r=e,e=e.N):e=e.K}return r},t.prototype.ue=function(e){for(;;){var t,r=e.rr;if(r===this.h)return;if(1===e.ee)return void(e.ee=0);if(e===r.K)if(1===(t=r.N).ee)t.ee=0,r.ee=1,r===this.W?this.W=r.ne():r.ne();else{if(t.N&&1===t.N.ee)return t.ee=r.ee,r.ee=0,t.N.ee=0,void(r===this.W?this.W=r.ne():r.ne());t.K&&1===t.K.ee?(t.ee=1,t.K.ee=0,t.te()):(t.ee=1,e=r)}else if(1===(t=r.K).ee)t.ee=0,r.ee=1,r===this.W?this.W=r.te():r.te();else{if(t.K&&1===t.K.ee)return t.ee=r.ee,r.ee=0,t.K.ee=0,void(r===this.W?this.W=r.te():r.te());t.N&&1===t.N.ee?(t.ee=1,t.N.ee=0,t.ne()):(t.ee=1,e=r)}}},t.prototype.he=function(e){var t,r;if(1===this.M)return this.clear(),this.h;for(var n=e;n.K||n.N;){if(n.N)for(n=n.N;n.K;)n=n.K;else n=n.K;t=__read([n.u,e.u],2),e.u=t[0],n.u=t[1],r=__read([n.p,e.p],2),e.p=r[0],n.p=r[1],e=n}this.h.K===n?this.h.K=n.rr:this.h.N===n&&(this.h.N=n.rr),this.ue(n);var i=n.rr;return n===i.K?i.K=void 0:i.N=void 0,this.M-=1,this.W.ee=0,i},t.prototype.ae=function(e,t){return void 0!==e&&(!!this.ae(e.K,t)||(!!t(e)||this.ae(e.N,t)))},t.prototype.fe=function(e){for(;;){var t=e.rr;if(0===t.ee)return;var r=t.rr;if(t===r.K){if((n=r.N)&&1===n.ee){if(n.ee=t.ee=0,r===this.W)return;r.ee=1,e=r;continue}if(e===t.N){if(e.ee=0,e.K&&(e.K.rr=t),e.N&&(e.N.rr=r),t.N=e.K,r.K=e.N,e.K=t,e.N=r,r===this.W)this.W=e,this.h.rr=e;else(i=r.rr).K===r?i.K=e:i.N=e;return e.rr=r.rr,t.rr=e,r.rr=e,r.ee=1,{parentNode:t,grandParent:r,curNode:e}}t.ee=0,r===this.W?this.W=r.te():r.te(),r.ee=1}else{var n;if((n=r.K)&&1===n.ee){if(n.ee=t.ee=0,r===this.W)return;r.ee=1,e=r;continue}if(e===t.K){var i;if(e.ee=0,e.K&&(e.K.rr=r),e.N&&(e.N.rr=t),r.N=e.K,t.K=e.N,e.K=r,e.N=t,r===this.W)this.W=e,this.h.rr=e;else(i=r.rr).K===r?i.K=e:i.N=e;return e.rr=r.rr,t.rr=e,r.rr=e,r.ee=1,{parentNode:t,grandParent:r,curNode:e}}t.ee=0,r===this.W?this.W=r.ne():r.ne(),r.ee=1}return}},t.prototype.se=function(e,t,r){if(void 0===this.W)return this.M+=1,this.W=new this.re(e,t),this.W.ee=0,this.W.rr=this.h,this.h.rr=this.W,this.h.K=this.W,void(this.h.N=this.W);var n,i=this.h.K,o=this.$(i.u,e);if(0!==o){if(o>0)i.K=new this.re(e,t),i.K.rr=i,n=i.K,this.h.K=n;else{var s=this.h.N,a=this.$(s.u,e);if(0===a)return void(s.p=t);if(a<0)s.N=new this.re(e,t),s.N.rr=s,n=s.N,this.h.N=n;else{if(void 0!==r){var c=r.o;if(c!==this.h){var l=this.$(c.u,e);if(0===l)return void(c.p=t);if(l>0){var u=c.L(),d=this.$(u.u,e);if(0===d)return void(u.p=t);d<0&&(n=new this.re(e,t),void 0===u.N?(u.N=n,n.rr=u):(c.K=n,n.rr=c))}}}if(void 0===n)for(n=this.W;;){var h=this.$(n.u,e);if(h>0){if(void 0===n.K){n.K=new this.re(e,t),n.K.rr=n,n=n.K;break}n=n.K}else{if(!(h<0))return void(n.p=t);if(void 0===n.N){n.N=new this.re(e,t),n.N.rr=n,n=n.N;break}n=n.N}}}}return this.M+=1,n}i.p=t},t.prototype.g=function(e,t){for(;e;){var r=this.$(e.u,t);if(r<0)e=e.N;else{if(!(r>0))return e;e=e.K}}return e||this.h},t.prototype.clear=function(){this.M=0,this.W=void 0,this.h.rr=void 0,this.h.K=this.h.N=void 0},t.prototype.updateKeyByIterator=function(e,t){var r=e.o;if(r===this.h&&throwIteratorAccessError(),1===this.M)return r.u=t,!0;if(r===this.h.K)return this.$(r.m().u,t)>0&&(r.u=t,!0);if(r===this.h.N)return this.$(r.L().u,t)<0&&(r.u=t,!0);var n=r.L().u;if(this.$(n,t)>=0)return!1;var i=r.m().u;return!(this.$(i,t)<=0)&&(r.u=t,!0)},t.prototype.eraseElementByPos=function(e){if(e<0||e>this.M-1)throw new RangeError;var t=0,r=this;return this.ae(this.W,(function(n){return e===t?(r.G(n),!0):(t+=1,!1)})),this.M},t.prototype.eraseElementByKey=function(e){if(0===this.M)return!1;var t=this.g(this.W,e);return t!==this.h&&(this.G(t),!0)},t.prototype.eraseElementByIterator=function(e){var t=e.o;t===this.h&&throwIteratorAccessError();var r=void 0===t.N;return 0===e.iteratorType?r&&e.next():r&&void 0!==t.K||e.next(),this.G(t),e},t.prototype.forEach=function(e){var t,r,n=0;try{for(var i=__values$2(this),o=i.next();!o.done;o=i.next()){e(o.value,n++,this)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},t.prototype.getElementByPos=function(e){var t,r,n;if(e<0||e>this.M-1)throw new RangeError;var i=0;try{for(var o=__values$2(this),s=o.next();!s.done;s=o.next()){var a=s.value;if(i===e){n=a;break}i+=1}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return n},t.prototype.getHeight=function(){if(0===this.M)return 0;return function e(t){return t?Math.max(e(t.K),e(t.N))+1:0}(this.W)},t}(Container),__extends$5=this&&this.t||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),TreeIterator=function(e){function t(t,r,n){var i=e.call(this,n)||this;return i.o=t,i.h=r,0===i.iteratorType?(i.pre=function(){return this.o===this.h.K&&throwIteratorAccessError(),this.o=this.o.L(),this},i.next=function(){return this.o===this.h&&throwIteratorAccessError(),this.o=this.o.m(),this}):(i.pre=function(){return this.o===this.h.N&&throwIteratorAccessError(),this.o=this.o.m(),this},i.next=function(){return this.o===this.h&&throwIteratorAccessError(),this.o=this.o.L(),this}),i}return __extends$5(t,e),Object.defineProperty(t.prototype,"index",{get:function(){var e=this.o,t=this.h.rr;if(e===this.h)return t?t.tr-1:0;var r=0;for(e.K&&(r+=e.K.tr);e!==t;){var n=e.rr;e===n.N&&(r+=1,n.K&&(r+=n.K.tr)),e=n}return r},enumerable:!1,configurable:!0}),t}(ContainerIterator),__extends$4=this&&this.t||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),__generator$3=this&&this.i||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(e){return function(t){return c([e,t])}}function c(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},__values$1=this&&this.V||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},OrderedSetIterator=function(e){function t(t,r,n,i){var o=e.call(this,t,r,i)||this;return o.container=n,o}return __extends$4(t,e),Object.defineProperty(t.prototype,"pointer",{get:function(){return this.o===this.h&&throwIteratorAccessError(),this.o.u},enumerable:!1,configurable:!0}),t.prototype.copy=function(){return new t(this.o,this.h,this.container,this.iteratorType)},t}(TreeIterator),OrderedSet=function(e){function t(t,r,n){void 0===t&&(t=[]);var i=e.call(this,r,n)||this,o=i;return t.forEach((function(e){o.insert(e)})),i}return __extends$4(t,e),t.prototype.P=function(e){return __generator$3(this,(function(t){switch(t.label){case 0:return void 0===e?[2]:[5,__values$1(this.P(e.K))];case 1:return t.sent(),[4,e.u];case 2:return t.sent(),[5,__values$1(this.P(e.N))];case 3:return t.sent(),[2]}}))},t.prototype.begin=function(){return new OrderedSetIterator(this.h.K||this.h,this.h,this)},t.prototype.end=function(){return new OrderedSetIterator(this.h,this.h,this)},t.prototype.rBegin=function(){return new OrderedSetIterator(this.h.N||this.h,this.h,this,1)},t.prototype.rEnd=function(){return new OrderedSetIterator(this.h,this.h,this,1)},t.prototype.front=function(){return this.h.K?this.h.K.u:void 0},t.prototype.back=function(){return this.h.N?this.h.N.u:void 0},t.prototype.insert=function(e,t){return this.v(e,void 0,t)},t.prototype.find=function(e){var t=this.g(this.W,e);return new OrderedSetIterator(t,this.h,this)},t.prototype.lowerBound=function(e){var t=this.U(this.W,e);return new OrderedSetIterator(t,this.h,this)},t.prototype.upperBound=function(e){var t=this.X(this.W,e);return new OrderedSetIterator(t,this.h,this)},t.prototype.reverseLowerBound=function(e){var t=this.Y(this.W,e);return new OrderedSetIterator(t,this.h,this)},t.prototype.reverseUpperBound=function(e){var t=this.Z(this.W,e);return new OrderedSetIterator(t,this.h,this)},t.prototype.union=function(e){var t=this;return e.forEach((function(e){t.insert(e)})),this.M},t.prototype[Symbol.iterator]=function(){return this.P(this.W)},t}(TreeContainer),__extends$3=this&&this.t||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),__generator$2=this&&this.i||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(e){return function(t){return c([e,t])}}function c(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},__values=this&&this.V||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},OrderedMapIterator=function(e){function t(t,r,n,i){var o=e.call(this,t,r,i)||this;return o.container=n,o}return __extends$3(t,e),Object.defineProperty(t.prototype,"pointer",{get:function(){this.o===this.h&&throwIteratorAccessError();var e=this;return new Proxy([],{get:function(t,r){return"0"===r?e.o.u:"1"===r?e.o.p:void 0},set:function(t,r,n){if("1"!==r)throw new TypeError("props must be 1");return e.o.p=n,!0}})},enumerable:!1,configurable:!0}),t.prototype.copy=function(){return new t(this.o,this.h,this.container,this.iteratorType)},t}(TreeIterator),OrderedMap=function(e){function t(t,r,n){void 0===t&&(t=[]);var i=e.call(this,r,n)||this,o=i;return t.forEach((function(e){o.setElement(e[0],e[1])})),i}return __extends$3(t,e),t.prototype.P=function(e){return __generator$2(this,(function(t){switch(t.label){case 0:return void 0===e?[2]:[5,__values(this.P(e.K))];case 1:return t.sent(),[4,[e.u,e.p]];case 2:return t.sent(),[5,__values(this.P(e.N))];case 3:return t.sent(),[2]}}))},t.prototype.begin=function(){return new OrderedMapIterator(this.h.K||this.h,this.h,this)},t.prototype.end=function(){return new OrderedMapIterator(this.h,this.h,this)},t.prototype.rBegin=function(){return new OrderedMapIterator(this.h.N||this.h,this.h,this,1)},t.prototype.rEnd=function(){return new OrderedMapIterator(this.h,this.h,this,1)},t.prototype.front=function(){if(0!==this.M){var e=this.h.K;return[e.u,e.p]}},t.prototype.back=function(){if(0!==this.M){var e=this.h.N;return[e.u,e.p]}},t.prototype.lowerBound=function(e){var t=this.U(this.W,e);return new OrderedMapIterator(t,this.h,this)},t.prototype.upperBound=function(e){var t=this.X(this.W,e);return new OrderedMapIterator(t,this.h,this)},t.prototype.reverseLowerBound=function(e){var t=this.Y(this.W,e);return new OrderedMapIterator(t,this.h,this)},t.prototype.reverseUpperBound=function(e){var t=this.Z(this.W,e);return new OrderedMapIterator(t,this.h,this)},t.prototype.setElement=function(e,t,r){return this.v(e,t,r)},t.prototype.find=function(e){var t=this.g(this.W,e);return new OrderedMapIterator(t,this.h,this)},t.prototype.getElementByKey=function(e){return this.g(this.W,e).p},t.prototype.union=function(e){var t=this;return e.forEach((function(e){t.setElement(e[0],e[1])})),this.M},t.prototype[Symbol.iterator]=function(){return this.P(this.W)},t}(TreeContainer);function checkObject(e){var t=_typeof(e);return"object"===t&&null!==e||"function"===t}var __extends$2=this&&this.t||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),HashContainerIterator=function(e){function t(t,r,n){var i=e.call(this,n)||this;return i.o=t,i.h=r,0===i.iteratorType?(i.pre=function(){return this.o.L===this.h&&throwIteratorAccessError(),this.o=this.o.L,this},i.next=function(){return this.o===this.h&&throwIteratorAccessError(),this.o=this.o.m,this}):(i.pre=function(){return this.o.m===this.h&&throwIteratorAccessError(),this.o=this.o.m,this},i.next=function(){return this.o===this.h&&throwIteratorAccessError(),this.o=this.o.L,this}),i}return __extends$2(t,e),t}(ContainerIterator),HashContainer=function(e){function t(){var t=e.call(this)||this;return t._=[],t.I={},t.HASH_TAG=Symbol("@@HASH_TAG"),Object.setPrototypeOf(t.I,null),t.h={},t.h.L=t.h.m=t.H=t.l=t.h,t}return __extends$2(t,e),t.prototype.G=function(e){var t=e.L,r=e.m;t.m=r,r.L=t,e===this.H&&(this.H=r),e===this.l&&(this.l=t),this.M-=1},t.prototype.v=function(e,t,r){var n;if(void 0===r&&(r=checkObject(e)),r){var i=e[this.HASH_TAG];if(void 0!==i)return this._[i].p=t,this.M;Object.defineProperty(e,this.HASH_TAG,{value:this._.length,configurable:!0}),n={u:e,p:t,L:this.l,m:this.h},this._.push(n)}else{var o=this.I[e];if(o)return o.p=t,this.M;n={u:e,p:t,L:this.l,m:this.h},this.I[e]=n}return 0===this.M?(this.H=n,this.h.m=n):this.l.m=n,this.l=n,this.h.L=n,++this.M},t.prototype.g=function(e,t){if(void 0===t&&(t=checkObject(e)),t){var r=e[this.HASH_TAG];return void 0===r?this.h:this._[r]}return this.I[e]||this.h},t.prototype.clear=function(){var e=this.HASH_TAG;this._.forEach((function(t){delete t.u[e]})),this._=[],this.I={},Object.setPrototypeOf(this.I,null),this.M=0,this.H=this.l=this.h.L=this.h.m=this.h},t.prototype.eraseElementByKey=function(e,t){var r;if(void 0===t&&(t=checkObject(e)),t){var n=e[this.HASH_TAG];if(void 0===n)return!1;delete e[this.HASH_TAG],r=this._[n],delete this._[n]}else{if(void 0===(r=this.I[e]))return!1;delete this.I[e]}return this.G(r),!0},t.prototype.eraseElementByIterator=function(e){var t=e.o;return t===this.h&&throwIteratorAccessError(),this.G(t),e.next()},t.prototype.eraseElementByPos=function(e){if(e<0||e>this.M-1)throw new RangeError;for(var t=this.H;e--;)t=t.m;return this.G(t),this.M},t}(Container),__extends$1=this&&this.t||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),__generator$1=this&&this.i||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(e){return function(t){return c([e,t])}}function c(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},HashSetIterator=function(e){function t(t,r,n,i){var o=e.call(this,t,r,i)||this;return o.container=n,o}return __extends$1(t,e),Object.defineProperty(t.prototype,"pointer",{get:function(){return this.o===this.h&&throwIteratorAccessError(),this.o.u},enumerable:!1,configurable:!0}),t.prototype.copy=function(){return new t(this.o,this.h,this.container,this.iteratorType)},t}(HashContainerIterator),HashSet=function(e){function t(t){void 0===t&&(t=[]);var r=e.call(this)||this,n=r;return t.forEach((function(e){n.insert(e)})),r}return __extends$1(t,e),t.prototype.begin=function(){return new HashSetIterator(this.H,this.h,this)},t.prototype.end=function(){return new HashSetIterator(this.h,this.h,this)},t.prototype.rBegin=function(){return new HashSetIterator(this.l,this.h,this,1)},t.prototype.rEnd=function(){return new HashSetIterator(this.h,this.h,this,1)},t.prototype.front=function(){return this.H.u},t.prototype.back=function(){return this.l.u},t.prototype.insert=function(e,t){return this.v(e,void 0,t)},t.prototype.getElementByPos=function(e){if(e<0||e>this.M-1)throw new RangeError;for(var t=this.H;e--;)t=t.m;return t.u},t.prototype.find=function(e,t){var r=this.g(e,t);return new HashSetIterator(r,this.h,this)},t.prototype.forEach=function(e){for(var t=0,r=this.H;r!==this.h;)e(r.u,t++,this),r=r.m},t.prototype[Symbol.iterator]=function(){return function(){var e;return __generator$1(this,(function(t){switch(t.label){case 0:e=this.H,t.label=1;case 1:return e===this.h?[3,3]:[4,e.u];case 2:return t.sent(),e=e.m,[3,1];case 3:return[2]}}))}.bind(this)()},t}(HashContainer),__extends=this&&this.t||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),__generator=this&&this.i||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(e){return function(t){return c([e,t])}}function c(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},HashMapIterator=function(e){function t(t,r,n,i){var o=e.call(this,t,r,i)||this;return o.container=n,o}return __extends(t,e),Object.defineProperty(t.prototype,"pointer",{get:function(){this.o===this.h&&throwIteratorAccessError();var e=this;return new Proxy([],{get:function(t,r){return"0"===r?e.o.u:"1"===r?e.o.p:void 0},set:function(t,r,n){if("1"!==r)throw new TypeError("props must be 1");return e.o.p=n,!0}})},enumerable:!1,configurable:!0}),t.prototype.copy=function(){return new t(this.o,this.h,this.container,this.iteratorType)},t}(HashContainerIterator),HashMap=function(e){function t(t){void 0===t&&(t=[]);var r=e.call(this)||this,n=r;return t.forEach((function(e){n.setElement(e[0],e[1])})),r}return __extends(t,e),t.prototype.begin=function(){return new HashMapIterator(this.H,this.h,this)},t.prototype.end=function(){return new HashMapIterator(this.h,this.h,this)},t.prototype.rBegin=function(){return new HashMapIterator(this.l,this.h,this,1)},t.prototype.rEnd=function(){return new HashMapIterator(this.h,this.h,this,1)},t.prototype.front=function(){if(0!==this.M)return[this.H.u,this.H.p]},t.prototype.back=function(){if(0!==this.M)return[this.l.u,this.l.p]},t.prototype.setElement=function(e,t,r){return this.v(e,t,r)},t.prototype.getElementByKey=function(e,t){if(void 0===t&&(t=checkObject(e)),t){var r=e[this.HASH_TAG];return void 0!==r?this._[r].p:void 0}var n=this.I[e];return n?n.p:void 0},t.prototype.getElementByPos=function(e){if(e<0||e>this.M-1)throw new RangeError;for(var t=this.H;e--;)t=t.m;return[t.u,t.p]},t.prototype.find=function(e,t){var r=this.g(e,t);return new HashMapIterator(r,this.h,this)},t.prototype.forEach=function(e){for(var t=0,r=this.H;r!==this.h;)e([r.u,r.p],t++,this),r=r.m},t.prototype[Symbol.iterator]=function(){return function(){var e;return __generator(this,(function(t){switch(t.label){case 0:e=this.H,t.label=1;case 1:return e===this.h?[3,3]:[4,[e.u,e.p]];case 2:return t.sent(),e=e.m,[3,1];case 3:return[2]}}))}.bind(this)()},t}(HashContainer),esm=Object.freeze({__proto__:null,Stack:Stack,Queue:Queue,PriorityQueue:PriorityQueue,Vector:Vector,LinkList:LinkList,Deque:Deque,OrderedSet:OrderedSet,OrderedMap:OrderedMap,HashSet:HashSet,HashMap:HashMap}),require$$0$3=getAugmentedNamespace(esm),SortedSet=require$$0$3.OrderedSet,debugTrace=srcExports("number-allocator:trace"),debugError=srcExports("number-allocator:error");function Interval(e,t){this.low=e,this.high=t}function NumberAllocator$1(e,t){if(!(this instanceof NumberAllocator$1))return new NumberAllocator$1(e,t);this.min=e,this.max=t,this.ss=new SortedSet([],(function(e,t){return e.compare(t)})),debugTrace("Create"),this.clear()}Interval.prototype.equals=function(e){return this.low===e.low&&this.high===e.high},Interval.prototype.compare=function(e){return this.low<e.low&&this.high<e.low?-1:e.low<this.low&&e.high<this.low?1:0},NumberAllocator$1.prototype.firstVacant=function(){return 0===this.ss.size()?null:this.ss.front().low},NumberAllocator$1.prototype.alloc=function(){if(0===this.ss.size())return debugTrace("alloc():empty"),null;var e=this.ss.begin(),t=e.pointer.low,r=e.pointer.high,n=t;return n+1<=r?this.ss.updateKeyByIterator(e,new Interval(t+1,r)):this.ss.eraseElementByPos(0),debugTrace("alloc():"+n),n},NumberAllocator$1.prototype.use=function(e){var t=new Interval(e,e),r=this.ss.lowerBound(t);if(!r.equals(this.ss.end())){var n=r.pointer.low,i=r.pointer.high;return r.pointer.equals(t)?(this.ss.eraseElementByIterator(r),debugTrace("use():"+e),!0):!(n>e)&&(n===e?(this.ss.updateKeyByIterator(r,new Interval(n+1,i)),debugTrace("use():"+e),!0):i===e?(this.ss.updateKeyByIterator(r,new Interval(n,i-1)),debugTrace("use():"+e),!0):(this.ss.updateKeyByIterator(r,new Interval(e+1,i)),this.ss.insert(new Interval(n,e-1)),debugTrace("use():"+e),!0))}return debugTrace("use():failed"),!1},NumberAllocator$1.prototype.free=function(e){if(e<this.min||e>this.max)debugError("free():"+e+" is out of range");else{var t=new Interval(e,e),r=this.ss.upperBound(t);if(r.equals(this.ss.end())){if(r.equals(this.ss.begin()))return void this.ss.insert(t);r.pre();var n=r.pointer.high;r.pointer.high+1===e?this.ss.updateKeyByIterator(r,new Interval(n,e)):this.ss.insert(t)}else if(r.equals(this.ss.begin()))if(e+1===r.pointer.low){var i=r.pointer.high;this.ss.updateKeyByIterator(r,new Interval(e,i))}else this.ss.insert(t);else{var o=r.pointer.low,s=r.pointer.high;r.pre();var a=r.pointer.low;r.pointer.high+1===e?e+1===o?(this.ss.eraseElementByIterator(r),this.ss.updateKeyByIterator(r,new Interval(a,s))):this.ss.updateKeyByIterator(r,new Interval(a,e)):e+1===o?(this.ss.eraseElementByIterator(r.next()),this.ss.insert(new Interval(e,s))):this.ss.insert(t)}debugTrace("free():"+e)}},NumberAllocator$1.prototype.clear=function(){debugTrace("clear()"),this.ss.clear(),this.ss.insert(new Interval(this.min,this.max))},NumberAllocator$1.prototype.intervalCount=function(){return this.ss.size()},NumberAllocator$1.prototype.dump=function(){console.log("length:"+this.ss.size());var e,t=_createForOfIteratorHelper(this.ss);try{for(t.s();!(e=t.n()).done;){var r=e.value;console.log(r)}}catch(e){t.e(e)}finally{t.f()}};var numberAllocator=NumberAllocator$1,numberAllocator$1=getDefaultExportFromCjs(numberAllocator),NumberAllocator=numberAllocator,NumberAllocator_1=numberAllocator$2.NumberAllocator=NumberAllocator;Object.defineProperty(topicAliasSend,"__esModule",{value:!0});var lru_cache_1=commonjs,number_allocator_1$1=numberAllocator$2,TopicAliasSend=function(){function e(t){_classCallCheck(this,e),_defineProperty(this,"aliasToTopic",void 0),_defineProperty(this,"topicToAlias",void 0),_defineProperty(this,"max",void 0),_defineProperty(this,"numberAllocator",void 0),_defineProperty(this,"length",void 0),t>0&&(this.aliasToTopic=new lru_cache_1.LRUCache({max:t}),this.topicToAlias={},this.numberAllocator=new number_allocator_1$1.NumberAllocator(1,t),this.max=t,this.length=0)}return _createClass(e,[{key:"put",value:function(e,t){if(0===t||t>this.max)return!1;var r=this.aliasToTopic.get(t);return r&&delete this.topicToAlias[r],this.aliasToTopic.set(t,e),this.topicToAlias[e]=t,this.numberAllocator.use(t),this.length=this.aliasToTopic.size,!0}},{key:"getTopicByAlias",value:function(e){return this.aliasToTopic.get(e)}},{key:"getAliasByTopic",value:function(e){var t=this.topicToAlias[e];return void 0!==t&&this.aliasToTopic.get(t),t}},{key:"clear",value:function(){this.aliasToTopic.clear(),this.topicToAlias={},this.numberAllocator.clear(),this.length=0}},{key:"getLruAlias",value:function(){var e=this.numberAllocator.firstVacant();return e||_toConsumableArray(this.aliasToTopic.keys())[this.aliasToTopic.size-1]}}]),e}(),_default$b=topicAliasSend.default=TopicAliasSend,__importDefault$5=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(connack,"__esModule",{value:!0});var ack_1$1=ack$1,topic_alias_send_1=__importDefault$5(topicAliasSend),shared_1$2=shared,handleConnack=function(e,t){e.log("_handleConnack");var r=e.options,n=5===r.protocolVersion?t.reasonCode:t.returnCode;if(clearTimeout(e.connackTimer),delete e.topicAliasSend,t.properties){if(t.properties.topicAliasMaximum){if(t.properties.topicAliasMaximum>65535)return void e.emit("error",new Error("topicAliasMaximum from broker is out of range"));t.properties.topicAliasMaximum>0&&(e.topicAliasSend=new topic_alias_send_1.default(t.properties.topicAliasMaximum))}t.properties.serverKeepAlive&&r.keepalive&&(r.keepalive=t.properties.serverKeepAlive),t.properties.maximumPacketSize&&(r.properties||(r.properties={}),r.properties.maximumPacketSize=t.properties.maximumPacketSize)}if(0===n)e.reconnecting=!1,e._onConnect(t);else if(n>0){var i=new shared_1$2.ErrorWithReasonCode("Connection refused: ".concat(ack_1$1.ReasonCodes[n]),n);e.emit("error",i),e.options.reconnectOnConnackError&&e._cleanUp(!0)}},_default$a=connack.default=handleConnack,pubrel={};Object.defineProperty(pubrel,"__esModule",{value:!0});var handlePubrel=function(e,t,r){e.log("handling pubrel packet");var n=void 0!==r?r:e.noop,i={cmd:"pubcomp",messageId:t.messageId};e.incomingStore.get(t,(function(t,r){t?e._sendPacket(i,n):(e.emit("message",r.topic,r.payload,r),e.handleMessage(r,(function(t){if(t)return n(t);e.incomingStore.del(r,e.noop),e._sendPacket(i,n)})))}))},_default$9=pubrel.default=handlePubrel,__importDefault$4=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(handlers,"__esModule",{value:!0});var publish_1=__importDefault$4(publish),auth_1=__importDefault$4(auth),connack_1=__importDefault$4(connack),ack_1=__importDefault$4(ack$1),pubrel_1=__importDefault$4(pubrel),handle=function(e,t,r){var n=e.options;if(5===n.protocolVersion&&n.properties&&n.properties.maximumPacketSize&&n.properties.maximumPacketSize<t.length)return e.emit("error",new Error("exceeding packets size ".concat(t.cmd))),e.end({reasonCode:149,properties:{reasonString:"Maximum packet size was exceeded"}}),e;switch(e.log("_handlePacket :: emitting packetreceive"),e.emit("packetreceive",t),t.cmd){case"publish":(0,publish_1.default)(e,t,r);break;case"puback":case"pubrec":case"pubcomp":case"suback":case"unsuback":e.reschedulePing(),(0,ack_1.default)(e,t),r();break;case"pubrel":e.reschedulePing(),(0,pubrel_1.default)(e,t,r);break;case"connack":(0,connack_1.default)(e,t),r();break;case"auth":e.reschedulePing(),(0,auth_1.default)(e,t),r();break;case"pingresp":e.log("_handlePacket :: received pingresp"),e.reschedulePing(!0),r();break;case"disconnect":e.emit("disconnect",t),r();break;default:e.log("_handlePacket :: unknown command"),r()}},_default$8=handlers.default=handle,defaultMessageIdProvider={};Object.defineProperty(defaultMessageIdProvider,"__esModule",{value:!0});var DefaultMessageIdProvider=function(){function e(){_classCallCheck(this,e),_defineProperty(this,"nextId",void 0),this.nextId=Math.max(1,Math.floor(65535*Math.random()))}return _createClass(e,[{key:"allocate",value:function(){var e=this.nextId++;return 65536===this.nextId&&(this.nextId=1),e}},{key:"getLastAllocated",value:function(){return 1===this.nextId?65535:this.nextId-1}},{key:"register",value:function(e){return!0}},{key:"deallocate",value:function(e){}},{key:"clear",value:function(){}}]),e}(),_default$7=defaultMessageIdProvider.default=DefaultMessageIdProvider,topicAliasRecv={};Object.defineProperty(topicAliasRecv,"__esModule",{value:!0});var TopicAliasRecv=function(){function e(t){_classCallCheck(this,e),_defineProperty(this,"aliasToTopic",void 0),_defineProperty(this,"max",void 0),_defineProperty(this,"length",void 0),this.aliasToTopic={},this.max=t}return _createClass(e,[{key:"put",value:function(e,t){return!(0===t||t>this.max)&&(this.aliasToTopic[t]=e,this.length=Object.keys(this.aliasToTopic).length,!0)}},{key:"getTopicByAlias",value:function(e){return this.aliasToTopic[e]}},{key:"clear",value:function(){this.aliasToTopic={}}}]),e}(),_default$6=topicAliasRecv.default=TopicAliasRecv,TypedEmitter={},__importDefault$3=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(TypedEmitter,"__esModule",{value:!0});var TypedEventEmitter_1=TypedEmitter.TypedEventEmitter=void 0,events_1=__importDefault$3(require$$0$8),shared_1$1=shared,TypedEventEmitter=_createClass((function e(){_classCallCheck(this,e)}));TypedEventEmitter_1=TypedEmitter.TypedEventEmitter=TypedEventEmitter,(0,shared_1$1.applyMixin)(TypedEventEmitter,events_1.default);var KeepaliveManager$1={},getTimer$1={},createAddUniqueNumber=function(e){return function(t){var r=e(t);return t.add(r),r}},createCache=function(e){return function(t,r){return e.set(t,r),r}},MAX_SAFE_INTEGER=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,TWO_TO_THE_POWER_OF_TWENTY_NINE=536870912,TWO_TO_THE_POWER_OF_THIRTY=2*TWO_TO_THE_POWER_OF_TWENTY_NINE,createGenerateUniqueNumber=function(e,t){return function(r){var n=t.get(r),i=void 0===n?r.size:n<TWO_TO_THE_POWER_OF_THIRTY?n+1:0;if(!r.has(i))return e(r,i);if(r.size<TWO_TO_THE_POWER_OF_TWENTY_NINE){for(;r.has(i);)i=Math.floor(Math.random()*TWO_TO_THE_POWER_OF_THIRTY);return e(r,i)}if(r.size>MAX_SAFE_INTEGER)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;r.has(i);)i=Math.floor(Math.random()*MAX_SAFE_INTEGER);return e(r,i)}},LAST_NUMBER_WEAK_MAP=new WeakMap,cache=createCache(LAST_NUMBER_WEAK_MAP),generateUniqueNumber=createGenerateUniqueNumber(cache,LAST_NUMBER_WEAK_MAP),addUniqueNumber=createAddUniqueNumber(generateUniqueNumber),isCallNotification=function(e){return void 0!==e.method&&"call"===e.method},isClearResponse=function(e){return null===e.error&&"number"==typeof e.id},load=function(e){var t=new Map([[0,function(){}]]),r=new Map([[0,function(){}]]),n=new Map,i=new Worker(e);i.addEventListener("message",(function(e){var i=e.data;if(isCallNotification(i)){var o=i.params,s=o.timerId,a=o.timerType;if("interval"===a){var c=t.get(s);if("number"==typeof c){var l=n.get(c);if(void 0===l||l.timerId!==s||l.timerType!==a)throw new Error("The timer is in an undefined state.")}else{if(void 0===c)throw new Error("The timer is in an undefined state.");c()}}else if("timeout"===a){var u=r.get(s);if("number"==typeof u){var d=n.get(u);if(void 0===d||d.timerId!==s||d.timerType!==a)throw new Error("The timer is in an undefined state.")}else{if(void 0===u)throw new Error("The timer is in an undefined state.");u(),r.delete(s)}}}else{if(!isClearResponse(i)){var h=i.error.message;throw new Error(h)}var f=i.id,p=n.get(f);if(void 0===p)throw new Error("The timer is in an undefined state.");var m=p.timerId,v=p.timerType;n.delete(f),"interval"===v?t.delete(m):r.delete(m)}}));return{clearInterval:function(e){var r=generateUniqueNumber(n);n.set(r,{timerId:e,timerType:"interval"}),t.set(e,r),i.postMessage({id:r,method:"clear",params:{timerId:e,timerType:"interval"}})},clearTimeout:function(e){var t=generateUniqueNumber(n);n.set(t,{timerId:e,timerType:"timeout"}),r.set(e,t),i.postMessage({id:t,method:"clear",params:{timerId:e,timerType:"timeout"}})},setInterval:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=generateUniqueNumber(t);return t.set(n,(function(){e(),"function"==typeof t.get(n)&&i.postMessage({id:null,method:"set",params:{delay:r,now:performance.now(),timerId:n,timerType:"interval"}})})),i.postMessage({id:null,method:"set",params:{delay:r,now:performance.now(),timerId:n,timerType:"interval"}}),n},setTimeout:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=generateUniqueNumber(r);return r.set(n,e),i.postMessage({id:null,method:"set",params:{delay:t,now:performance.now(),timerId:n,timerType:"timeout"}}),n}}},createLoadOrReturnBroker=function(e,t){var r=null;return function(){if(null!==r)return r;var n=new Blob([t],{type:"application/javascript; charset=utf-8"}),i=URL.createObjectURL(n);return r=e(i),setTimeout((function(){return URL.revokeObjectURL(i)})),r}},worker='(()=>{"use strict";const e=new Map,t=new Map,r=(e,t)=>{let r,o;const i=performance.now();r=i,o=e-Math.max(0,i-t);return{expected:r+o,remainingDelay:o}},o=(e,t,r,i)=>{const s=performance.now();s>r?postMessage({id:null,method:"call",params:{timerId:t,timerType:i}}):e.set(t,setTimeout(o,r-s,e,t,r,i))};addEventListener("message",(i=>{let{data:s}=i;try{if("clear"===s.method){const{id:r,params:{timerId:o,timerType:i}}=s;if("interval"===i)(t=>{const r=e.get(t);if(void 0===r)throw new Error(\'There is no interval scheduled with the given id "\'.concat(t,\'".\'));clearTimeout(r),e.delete(t)})(o),postMessage({error:null,id:r});else{if("timeout"!==i)throw new Error(\'The given type "\'.concat(i,\'" is not supported\'));(e=>{const r=t.get(e);if(void 0===r)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(r),t.delete(e)})(o),postMessage({error:null,id:r})}}else{if("set"!==s.method)throw new Error(\'The given method "\'.concat(s.method,\'" is not supported\'));{const{params:{delay:i,now:n,timerId:a,timerType:d}}=s;if("interval"===d)((t,i,s)=>{const{expected:n,remainingDelay:a}=r(t,s);e.set(i,setTimeout(o,a,e,i,n,"interval"))})(i,a,n);else{if("timeout"!==d)throw new Error(\'The given type "\'.concat(d,\'" is not supported\'));((e,i,s)=>{const{expected:n,remainingDelay:a}=r(e,s);t.set(i,setTimeout(o,a,t,i,n,"timeout"))})(i,a,n)}}}}catch(e){postMessage({error:{message:e.message},id:s.id,result:null})}}))})();',loadOrReturnBroker=createLoadOrReturnBroker(load,worker),clearInterval$1=function(e){return loadOrReturnBroker().clearInterval(e)},clearTimeout$1=function(e){return loadOrReturnBroker().clearTimeout(e)},setInterval$1=function(){var e;return(e=loadOrReturnBroker()).setInterval.apply(e,arguments)},setTimeout$1=function(){var e;return(e=loadOrReturnBroker()).setTimeout.apply(e,arguments)},module=Object.freeze({__proto__:null,clearInterval:clearInterval$1,clearTimeout:clearTimeout$1,setInterval:setInterval$1,setTimeout:setTimeout$1}),require$$0$2=getAugmentedNamespace(module),isBrowser$1={};Object.defineProperty(isBrowser$1,"__esModule",{value:!0});var isReactNativeBrowser=isBrowser$1.isReactNativeBrowser=isWebWorker=isBrowser$1.isWebWorker=void 0,isStandardBrowserEnv=function(){var e,t;return"undefined"!=typeof window&&("undefined"!=typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.toLowerCase().indexOf(" electron/"))>-1&&null!==(t=browser$1$1)&&void 0!==t&&t.versions?!Object.prototype.hasOwnProperty.call(browser$1$1.versions,"electron"):void 0!==window.document)},isWebWorkerEnv=function(){var e;return Boolean("object"===("undefined"==typeof self?"undefined":_typeof(self))&&(null===(e=self)||void 0===e||null===(e=e.constructor)||void 0===e||null===(e=e.name)||void 0===e?void 0:e.includes("WorkerGlobalScope")))},isReactNativeEnv=function(){return"undefined"!=typeof navigator&&"ReactNative"===navigator.product},isBrowser=isStandardBrowserEnv()||isWebWorkerEnv()||isReactNativeEnv(),isWebWorker=isBrowser$1.isWebWorker=isWebWorkerEnv();isReactNativeBrowser=isBrowser$1.isReactNativeBrowser=isReactNativeEnv();var _default$5=isBrowser$1.default=isBrowser,__createBinding$1=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),__setModuleDefault$1=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar$1=commonjsGlobal&&commonjsGlobal.__importStar||(_ownKeys=function(e){return _ownKeys=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},_ownKeys(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=_ownKeys(e),n=0;n<r.length;n++)"default"!==r[n]&&__createBinding$1(t,e,r[n]);return __setModuleDefault$1(t,e),t}),_ownKeys;Object.defineProperty(getTimer$1,"__esModule",{value:!0});var worker_timers_1=require$$0$2,is_browser_1$2=__importStar$1(isBrowser$1),workerTimer={set:worker_timers_1.setInterval,clear:worker_timers_1.clearInterval},nativeTimer={set:function(e,t){return setInterval(e,t)},clear:function(e){return clearInterval(e)}},getTimer=function(e){switch(e){case"native":return nativeTimer;case"worker":return workerTimer;default:return!is_browser_1$2.default||is_browser_1$2.isWebWorker||is_browser_1$2.isReactNativeBrowser?nativeTimer:workerTimer}},_default$4=getTimer$1.default=getTimer,__importDefault$2=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(KeepaliveManager$1,"__esModule",{value:!0});var get_timer_1=__importDefault$2(getTimer$1),KeepaliveManager=function(){function e(t,r){_classCallCheck(this,e),_defineProperty(this,"_keepalive",void 0),_defineProperty(this,"timerId",void 0),_defineProperty(this,"timer",void 0),_defineProperty(this,"destroyed",!1),_defineProperty(this,"counter",void 0),_defineProperty(this,"client",void 0),_defineProperty(this,"_keepaliveTimeoutTimestamp",void 0),_defineProperty(this,"_intervalEvery",void 0),this.client=t,this.timer="object"===_typeof(r)&&"set"in r&&"clear"in r?r:(0,get_timer_1.default)(r),this.setKeepalive(t.options.keepalive)}return _createClass(e,[{key:"keepaliveTimeoutTimestamp",get:function(){return this._keepaliveTimeoutTimestamp}},{key:"intervalEvery",get:function(){return this._intervalEvery}},{key:"keepalive",get:function(){return this._keepalive}},{key:"clear",value:function(){this.timerId&&(this.timer.clear(this.timerId),this.timerId=null)}},{key:"setKeepalive",value:function(e){if(e*=1e3,isNaN(e)||e<=0||e>2147483647)throw new Error("Keepalive value must be an integer between 0 and 2147483647. Provided value is ".concat(e));this._keepalive=e,this.reschedule(),this.client.log("KeepaliveManager: set keepalive to ".concat(e,"ms"))}},{key:"destroy",value:function(){this.clear(),this.destroyed=!0}},{key:"reschedule",value:function(){var e=this;if(!this.destroyed){this.clear(),this.counter=0;var t=Math.ceil(1.5*this._keepalive);this._keepaliveTimeoutTimestamp=Date.now()+t,this._intervalEvery=Math.ceil(this._keepalive/2),this.timerId=this.timer.set((function(){e.destroyed||(e.counter+=1,2===e.counter?e.client.sendPing():e.counter>2&&e.client.onKeepaliveTimeout())}),this._intervalEvery)}}}]),e}(),_default$3=KeepaliveManager$1.default=KeepaliveManager,__createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),__setModuleDefault=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=commonjsGlobal&&commonjsGlobal.__importStar||function(){var e=function(t){return e=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},e(t)};return function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var n=e(t),i=0;i<n.length;i++)"default"!==n[i]&&__createBinding(r,t,n[i]);return __setModuleDefault(r,t),r}}(),__importDefault$1=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(client,"__esModule",{value:!0});var mqtt_packet_1=__importDefault$1(mqtt$2),readable_stream_1=oursExports,default_1=__importDefault$1(_default$f),debug_1$1=__importDefault$1(srcExports),validations=__importStar(validations$1),store_1=__importDefault$1(store),handlers_1=__importDefault$1(handlers),default_message_id_provider_1=__importDefault$1(defaultMessageIdProvider),topic_alias_recv_1=__importDefault$1(topicAliasRecv),shared_1=shared,TypedEmitter_1=TypedEmitter,KeepaliveManager_1=__importDefault$1(KeepaliveManager$1),is_browser_1$1=__importStar(isBrowser$1),setImmediate$1=globalThis.setImmediate||function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.shift();(0,shared_1.nextTick)((function(){n.apply(void 0,t)}))},defaultConnectOptions={keepalive:60,reschedulePings:!0,protocolId:"MQTT",protocolVersion:4,reconnectPeriod:1e3,connectTimeout:3e4,clean:!0,resubscribe:!0,subscribeBatchSize:null,writeCache:!0,timerVariant:"auto"},MqttClient=function(e){function t(e,r){var n;for(var i in _classCallCheck(this,t),_defineProperty(_assertThisInitialized(n=_callSuper(this,t)),"connected",void 0),_defineProperty(_assertThisInitialized(n),"disconnecting",void 0),_defineProperty(_assertThisInitialized(n),"disconnected",void 0),_defineProperty(_assertThisInitialized(n),"reconnecting",void 0),_defineProperty(_assertThisInitialized(n),"incomingStore",void 0),_defineProperty(_assertThisInitialized(n),"outgoingStore",void 0),_defineProperty(_assertThisInitialized(n),"options",void 0),_defineProperty(_assertThisInitialized(n),"queueQoSZero",void 0),_defineProperty(_assertThisInitialized(n),"_reconnectCount",void 0),_defineProperty(_assertThisInitialized(n),"log",void 0),_defineProperty(_assertThisInitialized(n),"messageIdProvider",void 0),_defineProperty(_assertThisInitialized(n),"outgoing",void 0),_defineProperty(_assertThisInitialized(n),"messageIdToTopic",void 0),_defineProperty(_assertThisInitialized(n),"noop",void 0),_defineProperty(_assertThisInitialized(n),"keepaliveManager",void 0),_defineProperty(_assertThisInitialized(n),"stream",void 0),_defineProperty(_assertThisInitialized(n),"queue",void 0),_defineProperty(_assertThisInitialized(n),"streamBuilder",void 0),_defineProperty(_assertThisInitialized(n),"_resubscribeTopics",void 0),_defineProperty(_assertThisInitialized(n),"connackTimer",void 0),_defineProperty(_assertThisInitialized(n),"reconnectTimer",void 0),_defineProperty(_assertThisInitialized(n),"_storeProcessing",void 0),_defineProperty(_assertThisInitialized(n),"_packetIdsDuringStoreProcessing",void 0),_defineProperty(_assertThisInitialized(n),"_storeProcessingQueue",void 0),_defineProperty(_assertThisInitialized(n),"_firstConnection",void 0),_defineProperty(_assertThisInitialized(n),"topicAliasRecv",void 0),_defineProperty(_assertThisInitialized(n),"topicAliasSend",void 0),_defineProperty(_assertThisInitialized(n),"_deferredReconnect",void 0),_defineProperty(_assertThisInitialized(n),"connackPacket",void 0),n.options=r||{},defaultConnectOptions)void 0===n.options[i]?n.options[i]=defaultConnectOptions[i]:n.options[i]=r[i];return n.log=n.options.log||(0,debug_1$1.default)("mqttjs:client"),n.noop=n._noop.bind(_assertThisInitialized(n)),n.log("MqttClient :: version:",t.VERSION),is_browser_1$1.isWebWorker?n.log("MqttClient :: environment","webworker"):n.log("MqttClient :: environment",is_browser_1$1.default?"browser":"node"),n.log("MqttClient :: options.protocol",r.protocol),n.log("MqttClient :: options.protocolVersion",r.protocolVersion),n.log("MqttClient :: options.username",r.username),n.log("MqttClient :: options.keepalive",r.keepalive),n.log("MqttClient :: options.reconnectPeriod",r.reconnectPeriod),n.log("MqttClient :: options.rejectUnauthorized",r.rejectUnauthorized),n.log("MqttClient :: options.properties.topicAliasMaximum",r.properties?r.properties.topicAliasMaximum:void 0),n.options.clientId="string"==typeof r.clientId?r.clientId:t.defaultId(),n.log("MqttClient :: clientId",n.options.clientId),n.options.customHandleAcks=5===r.protocolVersion&&r.customHandleAcks?r.customHandleAcks:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t[3](null,0)},n.options.writeCache||(mqtt_packet_1.default.writeToStream.cacheNumbers=!1),n.streamBuilder=e,n.messageIdProvider=void 0===n.options.messageIdProvider?new default_message_id_provider_1.default:n.options.messageIdProvider,n.outgoingStore=r.outgoingStore||new store_1.default,n.incomingStore=r.incomingStore||new store_1.default,n.queueQoSZero=void 0===r.queueQoSZero||r.queueQoSZero,n._resubscribeTopics={},n.messageIdToTopic={},n.keepaliveManager=null,n.connected=!1,n.disconnecting=!1,n.reconnecting=!1,n.queue=[],n.connackTimer=null,n.reconnectTimer=null,n._storeProcessing=!1,n._packetIdsDuringStoreProcessing={},n._storeProcessingQueue=[],n.outgoing={},n._firstConnection=!0,r.properties&&r.properties.topicAliasMaximum>0&&(r.properties.topicAliasMaximum>65535?n.log("MqttClient :: options.properties.topicAliasMaximum is out of range"):n.topicAliasRecv=new topic_alias_recv_1.default(r.properties.topicAliasMaximum)),n.on("connect",(function(){var e=_assertThisInitialized(n).queue;n.log("connect :: sending queued packets"),function t(){var r=e.shift();n.log("deliver :: entry %o",r);var i;if(r){i=r.packet,n.log("deliver :: call _sendPacket for %o",i);var o=!0;i.messageId&&0!==i.messageId&&(n.messageIdProvider.register(i.messageId)||(o=!1)),o?n._sendPacket(i,(function(e){r.cb&&r.cb(e),t()})):(n.log("messageId: %d has already used. The message is skipped and removed.",i.messageId),t())}else n._resubscribe()}()})),n.on("close",(function(){n.log("close :: connected set to `false`"),n.connected=!1,n.log("close :: clearing connackTimer"),clearTimeout(n.connackTimer),n._destroyKeepaliveManager(),n.topicAliasRecv&&n.topicAliasRecv.clear(),n.log("close :: calling _setupReconnect"),n._setupReconnect()})),n.options.manualConnect||(n.log("MqttClient :: setting up stream"),n.connect()),n}return _inherits(t,e),_createClass(t,[{key:"handleAuth",value:function(e,t){t()}},{key:"handleMessage",value:function(e,t){t()}},{key:"_nextId",value:function(){return this.messageIdProvider.allocate()}},{key:"getLastMessageId",value:function(){return this.messageIdProvider.getLastAllocated()}},{key:"connect",value:function(){var e=this,t=new readable_stream_1.Writable,r=mqtt_packet_1.default.parser(this.options),n=null,i=[];this.log("connect :: calling method to clear reconnect"),this._clearReconnect(),this.disconnected&&!this.reconnecting&&(this.incomingStore=this.options.incomingStore||new store_1.default,this.outgoingStore=this.options.outgoingStore||new store_1.default,this.disconnecting=!1,this.disconnected=!1),this.log("connect :: using streamBuilder provided to client to create stream"),this.stream=this.streamBuilder(this),r.on("packet",(function(t){e.log("parser :: on packet push to packets array."),i.push(t)}));var o=function(){e.log("work :: getting next packet in queue");var t=i.shift();if(t)e.log("work :: packet pulled from queue"),(0,handlers_1.default)(e,t,s);else{e.log("work :: no packets in queue");var r=n;n=null,e.log("work :: done flag is %s",!!r),r&&r()}},s=function(){if(i.length)(0,shared_1.nextTick)(o);else{var e=n;n=null,e()}};t._write=function(t,i,s){n=s,e.log("writable stream :: parsing buffer"),r.parse(t),o()};this.log("connect :: pipe stream to writable stream"),this.stream.pipe(t),this.stream.on("error",(function(t){e.log("streamErrorHandler :: error",t.message),t.code?(e.log("streamErrorHandler :: emitting error"),e.emit("error",t)):e.noop(t)})),this.stream.on("close",(function(){e.log("(%s)stream :: on close",e.options.clientId),e._flushVolatile(),e.log("stream: emit close to MqttClient"),e.emit("close")})),this.log("connect: sending packet `connect`");var a,c={cmd:"connect",protocolId:this.options.protocolId,protocolVersion:this.options.protocolVersion,clean:this.options.clean,clientId:this.options.clientId,keepalive:this.options.keepalive,username:this.options.username,password:this.options.password,properties:this.options.properties};this.options.will&&(c.will=_objectSpread2(_objectSpread2({},this.options.will),{},{payload:null===(a=this.options.will)||void 0===a?void 0:a.payload}));if(this.topicAliasRecv&&(c.properties||(c.properties={}),this.topicAliasRecv&&(c.properties.topicAliasMaximum=this.topicAliasRecv.max)),this._writePacket(c),r.on("error",this.emit.bind(this,"error")),this.options.properties){if(!this.options.properties.authenticationMethod&&this.options.properties.authenticationData)return this.end((function(){return e.emit("error",new Error("Packet has no Authentication Method"))})),this;if(this.options.properties.authenticationMethod&&this.options.authPacket&&"object"===_typeof(this.options.authPacket)){var l=_objectSpread2({cmd:"auth",reasonCode:0},this.options.authPacket);this._writePacket(l)}}return this.stream.setMaxListeners(1e3),clearTimeout(this.connackTimer),this.connackTimer=setTimeout((function(){e.log("!!connectTimeout hit!! Calling _cleanUp with force `true`"),e.emit("error",new Error("connack timeout")),e._cleanUp(!0)}),this.options.connectTimeout),this}},{key:"publish",value:function(e,t,r,n){var i=this;this.log("publish :: message `%s` to topic `%s`",t,e);var o=this.options;"function"==typeof r&&(n=r,r=null),r=r||{};var s=r=_objectSpread2(_objectSpread2({},{qos:0,retain:!1,dup:!1}),r),a=s.qos,c=s.retain,l=s.dup,u=s.properties,d=s.cbStorePut;if(this._checkDisconnecting(n))return this;var h=function(){var r=0;if((1===a||2===a)&&null===(r=i._nextId()))return i.log("No messageId left"),!1;var s={cmd:"publish",topic:e,payload:t,qos:a,retain:c,messageId:r,dup:l};switch(5===o.protocolVersion&&(s.properties=u),i.log("publish :: qos",a),a){case 1:case 2:i.outgoing[s.messageId]={volatile:!1,cb:n||i.noop},i.log("MqttClient:publish: packet cmd: %s",s.cmd),i._sendPacket(s,void 0,d);break;default:i.log("MqttClient:publish: packet cmd: %s",s.cmd),i._sendPacket(s,n,d)}return!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!h())&&this._storeProcessingQueue.push({invoke:h,cbStorePut:r.cbStorePut,callback:n}),this}},{key:"publishAsync",value:function(e,t,r){var n=this;return new Promise((function(i,o){n.publish(e,t,r,(function(e,t){e?o(e):i(t)}))}))}},{key:"subscribe",value:function(e,t,r){var n=this,i=this.options.protocolVersion;"function"==typeof t&&(r=t),r=r||this.noop;var o=!1,s=[];"string"==typeof e?s=e=[e]:Array.isArray(e)?s=e:"object"===_typeof(e)&&(o=e.resubscribe,delete e.resubscribe,s=Object.keys(e));var a=validations.validateTopics(s);if(null!==a)return setImmediate$1(r,new Error("Invalid topic ".concat(a))),this;if(this._checkDisconnecting(r))return this.log("subscribe: discconecting true"),this;var c={qos:0};5===i&&(c.nl=!1,c.rap=!1,c.rh=0);var l=(t=_objectSpread2(_objectSpread2({},c),t)).properties,u=[],d=function(e,r){if(r=r||t,!Object.prototype.hasOwnProperty.call(n._resubscribeTopics,e)||n._resubscribeTopics[e].qos<r.qos||o){var s={topic:e,qos:r.qos};5===i&&(s.nl=r.nl,s.rap=r.rap,s.rh=r.rh,s.properties=l),n.log("subscribe: pushing topic `%s` and qos `%s` to subs list",s.topic,s.qos),u.push(s)}};if(Array.isArray(e)?e.forEach((function(e){n.log("subscribe: array topic %s",e),d(e)})):Object.keys(e).forEach((function(t){n.log("subscribe: object topic %s, %o",t,e[t]),d(t,e[t])})),!u.length)return r(null,[]),this;var h=function(e,t){var r={cmd:"subscribe",subscriptions:e,messageId:t};if(l&&(r.properties=l),n.options.resubscribe){n.log("subscribe :: resubscribe true");var o=[];e.forEach((function(e){if(n.options.reconnectPeriod>0){var t={qos:e.qos};5===i&&(t.nl=e.nl||!1,t.rap=e.rap||!1,t.rh=e.rh||0,t.properties=e.properties),n._resubscribeTopics[e.topic]=t,o.push(e.topic)}})),n.messageIdToTopic[r.messageId]=o}var s=new Promise((function(t,i){n.outgoing[r.messageId]={volatile:!0,cb:function(r,n){if(!r)for(var o=n.granted,s=0;s<o.length;s+=1)e[s].qos=o[s];r?i(new shared_1.ErrorWithSubackPacket(r.message,n)):t(n)}}}));return n.log("subscribe :: call _sendPacket"),n._sendPacket(r),s},f=function(){for(var e,t=null!==(e=n.options.subscribeBatchSize)&&void 0!==e?e:u.length,i=[],o=0;o<u.length;o+=t){var s=u.slice(o,o+t),a=n._nextId();if(null===a)return n.log("No messageId left"),!1;i.push(h(s,a))}return Promise.all(i).then((function(e){r(null,u,e.at(-1))})).catch((function(e){r(e,u,e.packet)})),!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!f())&&this._storeProcessingQueue.push({invoke:f,callback:r}),this}},{key:"subscribeAsync",value:function(e,t){var r=this;return new Promise((function(n,i){r.subscribe(e,t,(function(e,t){e?i(e):n(t)}))}))}},{key:"unsubscribe",value:function(e,t,r){var n=this;"string"==typeof e&&(e=[e]),"function"==typeof t&&(r=t),r=r||this.noop;var i=validations.validateTopics(e);if(null!==i)return setImmediate$1(r,new Error("Invalid topic ".concat(i))),this;if(this._checkDisconnecting(r))return this;var o=function(){var i=n._nextId();if(null===i)return n.log("No messageId left"),!1;var o={cmd:"unsubscribe",messageId:i,unsubscriptions:[]};return"string"==typeof e?o.unsubscriptions=[e]:Array.isArray(e)&&(o.unsubscriptions=e),n.options.resubscribe&&o.unsubscriptions.forEach((function(e){delete n._resubscribeTopics[e]})),"object"===_typeof(t)&&t.properties&&(o.properties=t.properties),n.outgoing[o.messageId]={volatile:!0,cb:r},n.log("unsubscribe: call _sendPacket"),n._sendPacket(o),!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!o())&&this._storeProcessingQueue.push({invoke:o,callback:r}),this}},{key:"unsubscribeAsync",value:function(e,t){var r=this;return new Promise((function(n,i){r.unsubscribe(e,t,(function(e,t){e?i(e):n(t)}))}))}},{key:"end",value:function(e,t,r){var n=this;this.log("end :: (%s)",this.options.clientId),null!=e&&"boolean"==typeof e||(r=r||t,t=e,e=!1),"object"!==_typeof(t)&&(r=r||t,t=null),this.log("end :: cb? %s",!!r),r&&"function"==typeof r||(r=this.noop);var i=function(){n.log("end :: closeStores: closing incoming and outgoing stores"),n.disconnected=!0,n.incomingStore.close((function(e){n.outgoingStore.close((function(t){if(n.log("end :: closeStores: emitting end"),n.emit("end"),r){var i=e||t;n.log("end :: closeStores: invoking callback with args"),r(i)}}))})),n._deferredReconnect?n._deferredReconnect():(0===n.options.reconnectPeriod||n.options.manualConnect)&&(n.disconnecting=!1)},o=function(){n.log("end :: (%s) :: finish :: calling _cleanUp with force %s",n.options.clientId,e),n._cleanUp(e,(function(){n.log("end :: finish :: calling process.nextTick on closeStores"),(0,shared_1.nextTick)(i)}),t)};return this.disconnecting?(r(),this):(this._clearReconnect(),this.disconnecting=!0,!e&&Object.keys(this.outgoing).length>0?(this.log("end :: (%s) :: calling finish in 10ms once outgoing is empty",this.options.clientId),this.once("outgoingEmpty",setTimeout.bind(null,o,10))):(this.log("end :: (%s) :: immediately calling finish",this.options.clientId),o()),this)}},{key:"endAsync",value:function(e,t){var r=this;return new Promise((function(n,i){r.end(e,t,(function(e){e?i(e):n()}))}))}},{key:"removeOutgoingMessage",value:function(e){if(this.outgoing[e]){var t=this.outgoing[e].cb;this._removeOutgoingAndStoreMessage(e,(function(){t(new Error("Message removed"))}))}return this}},{key:"reconnect",value:function(e){var t=this;this.log("client reconnect");var r=function(){e?(t.options.incomingStore=e.incomingStore,t.options.outgoingStore=e.outgoingStore):(t.options.incomingStore=null,t.options.outgoingStore=null),t.incomingStore=t.options.incomingStore||new store_1.default,t.outgoingStore=t.options.outgoingStore||new store_1.default,t.disconnecting=!1,t.disconnected=!1,t._deferredReconnect=null,t._reconnect()};return this.disconnecting&&!this.disconnected?this._deferredReconnect=r:r(),this}},{key:"_flushVolatile",value:function(){var e=this;this.outgoing&&(this.log("_flushVolatile :: deleting volatile messages from the queue and setting their callbacks as error function"),Object.keys(this.outgoing).forEach((function(t){e.outgoing[t].volatile&&"function"==typeof e.outgoing[t].cb&&(e.outgoing[t].cb(new Error("Connection closed")),delete e.outgoing[t])})))}},{key:"_flush",value:function(){var e=this;this.outgoing&&(this.log("_flush: queue exists? %b",!!this.outgoing),Object.keys(this.outgoing).forEach((function(t){"function"==typeof e.outgoing[t].cb&&(e.outgoing[t].cb(new Error("Connection closed")),delete e.outgoing[t])})))}},{key:"_removeTopicAliasAndRecoverTopicName",value:function(e){var t;e.properties&&(t=e.properties.topicAlias);var r=e.topic.toString();if(this.log("_removeTopicAliasAndRecoverTopicName :: alias %d, topic %o",t,r),0===r.length){if(void 0===t)return new Error("Unregistered Topic Alias");if(void 0===(r=this.topicAliasSend.getTopicByAlias(t)))return new Error("Unregistered Topic Alias");e.topic=r}t&&delete e.properties.topicAlias}},{key:"_checkDisconnecting",value:function(e){return this.disconnecting&&(e&&e!==this.noop?e(new Error("client disconnecting")):this.emit("error",new Error("client disconnecting"))),this.disconnecting}},{key:"_reconnect",value:function(){var e=this;this.log("_reconnect: emitting reconnect to client"),this.emit("reconnect"),this.connected?(this.end((function(){e.connect()})),this.log("client already connected. disconnecting first.")):(this.log("_reconnect: calling connect"),this.connect())}},{key:"_setupReconnect",value:function(){var e=this;!this.disconnecting&&!this.reconnectTimer&&this.options.reconnectPeriod>0?(this.reconnecting||(this.log("_setupReconnect :: emit `offline` state"),this.emit("offline"),this.log("_setupReconnect :: set `reconnecting` to `true`"),this.reconnecting=!0),this.log("_setupReconnect :: setting reconnectTimer for %d ms",this.options.reconnectPeriod),this.reconnectTimer=setInterval((function(){e.log("reconnectTimer :: reconnect triggered!"),e._reconnect()}),this.options.reconnectPeriod)):this.log("_setupReconnect :: doing nothing...")}},{key:"_clearReconnect",value:function(){this.log("_clearReconnect : clearing reconnect timer"),this.reconnectTimer&&(clearInterval(this.reconnectTimer),this.reconnectTimer=null)}},{key:"_cleanUp",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t&&(this.log("_cleanUp :: done callback provided for on stream close"),this.stream.on("close",t)),this.log("_cleanUp :: forced? %s",e),e)0===this.options.reconnectPeriod&&this.options.clean&&this._flush(),this.log("_cleanUp :: (%s) :: destroying stream",this.options.clientId),this.stream.destroy();else{var i=_objectSpread2({cmd:"disconnect"},n);this.log("_cleanUp :: (%s) :: call _sendPacket with disconnect packet",this.options.clientId),this._sendPacket(i,(function(){r.log("_cleanUp :: (%s) :: destroying stream",r.options.clientId),setImmediate$1((function(){r.stream.end((function(){r.log("_cleanUp :: (%s) :: stream destroyed",r.options.clientId)}))}))}))}this.disconnecting||this.reconnecting||(this.log("_cleanUp :: client not disconnecting/reconnecting. Clearing and resetting reconnect."),this._clearReconnect(),this._setupReconnect()),this._destroyKeepaliveManager(),t&&!this.connected&&(this.log("_cleanUp :: (%s) :: removing stream `done` callback `close` listener",this.options.clientId),this.stream.removeListener("close",t),t())}},{key:"_storeAndSend",value:function(e,t,r){var n=this;this.log("storeAndSend :: store packet with cmd %s to outgoingStore",e.cmd);var i,o=e;if("publish"===o.cmd&&(o=(0,default_1.default)(e),i=this._removeTopicAliasAndRecoverTopicName(o)))return t&&t(i);this.outgoingStore.put(o,(function(i){if(i)return t&&t(i);r(),n._writePacket(e,t)}))}},{key:"_applyTopicAlias",value:function(e){if(5===this.options.protocolVersion&&"publish"===e.cmd){var t;e.properties&&(t=e.properties.topicAlias);var r=e.topic.toString();if(this.topicAliasSend)if(t){if(0!==r.length&&(this.log("applyTopicAlias :: register topic: %s - alias: %d",r,t),!this.topicAliasSend.put(r,t)))return this.log("applyTopicAlias :: error out of range. topic: %s - alias: %d",r,t),new Error("Sending Topic Alias out of range")}else 0!==r.length&&(this.options.autoAssignTopicAlias?(t=this.topicAliasSend.getAliasByTopic(r))?(e.topic="",e.properties=_objectSpread2(_objectSpread2({},e.properties),{},{topicAlias:t}),this.log("applyTopicAlias :: auto assign(use) topic: %s - alias: %d",r,t)):(t=this.topicAliasSend.getLruAlias(),this.topicAliasSend.put(r,t),e.properties=_objectSpread2(_objectSpread2({},e.properties),{},{topicAlias:t}),this.log("applyTopicAlias :: auto assign topic: %s - alias: %d",r,t)):this.options.autoUseTopicAlias&&(t=this.topicAliasSend.getAliasByTopic(r))&&(e.topic="",e.properties=_objectSpread2(_objectSpread2({},e.properties),{},{topicAlias:t}),this.log("applyTopicAlias :: auto use topic: %s - alias: %d",r,t)));else if(t)return this.log("applyTopicAlias :: error out of range. topic: %s - alias: %d",r,t),new Error("Sending Topic Alias out of range")}}},{key:"_noop",value:function(e){this.log("noop ::",e)}},{key:"_writePacket",value:function(e,t){this.log("_writePacket :: packet: %O",e),this.log("_writePacket :: emitting `packetsend`"),this.emit("packetsend",e),this.log("_writePacket :: writing to stream");var r=mqtt_packet_1.default.writeToStream(e,this.stream,this.options);this.log("_writePacket :: writeToStream result %s",r),!r&&t&&t!==this.noop?(this.log("_writePacket :: handle events on `drain` once through callback."),this.stream.once("drain",t)):t&&(this.log("_writePacket :: invoking cb"),t())}},{key:"_sendPacket",value:function(e,t,r,n){this.log("_sendPacket :: (%s) ::  start",this.options.clientId),r=r||this.noop,t=t||this.noop;var i=this._applyTopicAlias(e);if(i)t(i);else{if(!this.connected)return"auth"===e.cmd?void this._writePacket(e,t):(this.log("_sendPacket :: client not connected. Storing packet offline."),void this._storePacket(e,t,r));if(n)this._writePacket(e,t);else{switch(e.cmd){case"publish":break;case"pubrel":return void this._storeAndSend(e,t,r);default:return void this._writePacket(e,t)}switch(e.qos){case 2:case 1:this._storeAndSend(e,t,r);break;default:this._writePacket(e,t)}this.log("_sendPacket :: (%s) ::  end",this.options.clientId)}}}},{key:"_storePacket",value:function(e,t,r){this.log("_storePacket :: packet: %o",e),this.log("_storePacket :: cb? %s",!!t),r=r||this.noop;var n=e;if("publish"===n.cmd){n=(0,default_1.default)(e);var i=this._removeTopicAliasAndRecoverTopicName(n);if(i)return t&&t(i)}var o=n.qos||0;0===o&&this.queueQoSZero||"publish"!==n.cmd?this.queue.push({packet:n,cb:t}):o>0?(t=this.outgoing[n.messageId]?this.outgoing[n.messageId].cb:null,this.outgoingStore.put(n,(function(e){if(e)return t&&t(e);r()}))):t&&t(new Error("No connection to broker"))}},{key:"_setupKeepaliveManager",value:function(){this.log("_setupKeepaliveManager :: keepalive %d (seconds)",this.options.keepalive),!this.keepaliveManager&&this.options.keepalive&&(this.keepaliveManager=new KeepaliveManager_1.default(this,this.options.timerVariant))}},{key:"_destroyKeepaliveManager",value:function(){this.keepaliveManager&&(this.log("_destroyKeepaliveManager :: destroying keepalive manager"),this.keepaliveManager.destroy(),this.keepaliveManager=null)}},{key:"reschedulePing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.keepaliveManager&&this.options.keepalive&&(e||this.options.reschedulePings)&&this._reschedulePing()}},{key:"_reschedulePing",value:function(){this.log("_reschedulePing :: rescheduling ping"),this.keepaliveManager.reschedule()}},{key:"sendPing",value:function(){this.log("_sendPing :: sending pingreq"),this._sendPacket({cmd:"pingreq"})}},{key:"onKeepaliveTimeout",value:function(){this.emit("error",new Error("Keepalive timeout")),this.log("onKeepaliveTimeout :: calling _cleanUp with force true"),this._cleanUp(!0)}},{key:"_resubscribe",value:function(){this.log("_resubscribe");var e=Object.keys(this._resubscribeTopics);if(!this._firstConnection&&(this.options.clean||this.options.protocolVersion>=4&&!this.connackPacket.sessionPresent)&&e.length>0)if(this.options.resubscribe)if(5===this.options.protocolVersion){this.log("_resubscribe: protocolVersion 5");for(var t=0;t<e.length;t++){var r={};r[e[t]]=this._resubscribeTopics[e[t]],r.resubscribe=!0,this.subscribe(r,{properties:r[e[t]].properties})}}else this._resubscribeTopics.resubscribe=!0,this.subscribe(this._resubscribeTopics);else this._resubscribeTopics={};this._firstConnection=!1}},{key:"_onConnect",value:function(e){var t=this;if(this.disconnected)this.emit("connect",e);else{this.connackPacket=e,this.messageIdProvider.clear(),this._setupKeepaliveManager(),this.connected=!0;!function r(){var n=t.outgoingStore.createStream(),i=function(){n.destroy(),n=null,t._flushStoreProcessingQueue(),o()},o=function(){t._storeProcessing=!1,t._packetIdsDuringStoreProcessing={}};t.once("close",i),n.on("error",(function(e){o(),t._flushStoreProcessingQueue(),t.removeListener("close",i),t.emit("error",e)}));n.on("end",(function(){var n=!0;for(var s in t._packetIdsDuringStoreProcessing)if(!t._packetIdsDuringStoreProcessing[s]){n=!1;break}t.removeListener("close",i),n?(o(),t._invokeAllStoreProcessingQueue(),t.emit("connect",e)):r()})),function e(){if(n){var r,i=n.read(1);i?(t._storeProcessing=!0,t._packetIdsDuringStoreProcessing[i.messageId]?e():t.disconnecting||t.reconnectTimer?n.destroy&&n.destroy():(r=t.outgoing[i.messageId]?t.outgoing[i.messageId].cb:null,t.outgoing[i.messageId]={volatile:!1,cb:function(t,n){r&&r(t,n),e()}},t._packetIdsDuringStoreProcessing[i.messageId]=!0,t.messageIdProvider.register(i.messageId)?t._sendPacket(i,void 0,void 0,!0):t.log("messageId: %d has already used.",i.messageId))):n.once("readable",e)}}()}()}}},{key:"_invokeStoreProcessingQueue",value:function(){if(!this._storeProcessing&&this._storeProcessingQueue.length>0){var e=this._storeProcessingQueue[0];if(e&&e.invoke())return this._storeProcessingQueue.shift(),!0}return!1}},{key:"_invokeAllStoreProcessingQueue",value:function(){for(;this._invokeStoreProcessingQueue(););}},{key:"_flushStoreProcessingQueue",value:function(){var e,t=_createForOfIteratorHelper(this._storeProcessingQueue);try{for(t.s();!(e=t.n()).done;){var r=e.value;r.cbStorePut&&r.cbStorePut(new Error("Connection closed")),r.callback&&r.callback(new Error("Connection closed"))}}catch(e){t.e(e)}finally{t.f()}this._storeProcessingQueue.splice(0)}},{key:"_removeOutgoingAndStoreMessage",value:function(e,t){var r=this;delete this.outgoing[e],this.outgoingStore.del({messageId:e},(function(n,i){t(n,i),r.messageIdProvider.deallocate(e),r._invokeStoreProcessingQueue()}))}}],[{key:"defaultId",value:function(){return"mqttjs_".concat(Math.random().toString(16).substr(2,8))}}]),t}(TypedEmitter_1.TypedEventEmitter);_defineProperty(MqttClient,"VERSION",shared_1.MQTTJS_VERSION);var _default$2=client.default=MqttClient,uniqueMessageIdProvider={};Object.defineProperty(uniqueMessageIdProvider,"__esModule",{value:!0});var number_allocator_1=numberAllocator$2,UniqueMessageIdProvider=function(){function e(){_classCallCheck(this,e),_defineProperty(this,"numberAllocator",void 0),_defineProperty(this,"lastId",void 0),this.numberAllocator=new number_allocator_1.NumberAllocator(1,65535)}return _createClass(e,[{key:"allocate",value:function(){return this.lastId=this.numberAllocator.alloc(),this.lastId}},{key:"getLastAllocated",value:function(){return this.lastId}},{key:"register",value:function(e){return this.numberAllocator.use(e)}},{key:"deallocate",value:function(e){this.numberAllocator.free(e)}},{key:"clear",value:function(){this.numberAllocator.clear()}}]),e}(),_default$1=uniqueMessageIdProvider.default=UniqueMessageIdProvider,connect$1={},maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexPunycode=/^xn--/,regexNonASCII=/[^\x20-\x7E]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},baseMinusTMin=base-tMin,floor=Math.floor,stringFromCharCode=String.fromCharCode;function error(e){throw new RangeError(errors[e])}function map$1(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function mapDomain(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+map$1((e=e.replace(regexSeparators,".")).split("."),t).join(".")}function ucs2decode(e){for(var t,r,n=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}function ucs2encode(e){return map$1(e,(function(e){var t="";return e>65535&&(t+=stringFromCharCode((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=stringFromCharCode(e)})).join("")}function basicToDigit(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:base}function digitToBasic(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function adapt(e,t,r){var n=0;for(e=r?floor(e/damp):e>>1,e+=floor(e/t);e>baseMinusTMin*tMax>>1;n+=base)e=floor(e/baseMinusTMin);return floor(n+(baseMinusTMin+1)*e/(e+skew))}function decode(e){var t,r,n,i,o,s,a,c,l,u,d=[],h=e.length,f=0,p=initialN,m=initialBias;for((r=e.lastIndexOf(delimiter))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&error("not-basic"),d.push(e.charCodeAt(n));for(i=r>0?r+1:0;i<h;){for(o=f,s=1,a=base;i>=h&&error("invalid-input"),((c=basicToDigit(e.charCodeAt(i++)))>=base||c>floor((maxInt-f)/s))&&error("overflow"),f+=c*s,!(c<(l=a<=m?tMin:a>=m+tMax?tMax:a-m));a+=base)s>floor(maxInt/(u=base-l))&&error("overflow"),s*=u;m=adapt(f-o,t=d.length+1,0==o),floor(f/t)>maxInt-p&&error("overflow"),p+=floor(f/t),f%=t,d.splice(f++,0,p)}return ucs2encode(d)}function encode(e){var t,r,n,i,o,s,a,c,l,u,d,h,f,p,m,v=[];for(h=(e=ucs2decode(e)).length,t=initialN,r=0,o=initialBias,s=0;s<h;++s)(d=e[s])<128&&v.push(stringFromCharCode(d));for(n=i=v.length,i&&v.push(delimiter);n<h;){for(a=maxInt,s=0;s<h;++s)(d=e[s])>=t&&d<a&&(a=d);for(a-t>floor((maxInt-r)/(f=n+1))&&error("overflow"),r+=(a-t)*f,t=a,s=0;s<h;++s)if((d=e[s])<t&&++r>maxInt&&error("overflow"),d==t){for(c=r,l=base;!(c<(u=l<=o?tMin:l>=o+tMax?tMax:l-o));l+=base)m=c-u,p=base-u,v.push(stringFromCharCode(digitToBasic(u+m%p,0))),c=floor(m/p);v.push(stringFromCharCode(digitToBasic(c,0))),o=adapt(r,f,n==i),r=0,++n}++r,++t}return v.join("")}function toUnicode(e){return mapDomain(e,(function(e){return regexPunycode.test(e)?decode(e.slice(4).toLowerCase()):e}))}function toASCII(e){return mapDomain(e,(function(e){return regexNonASCII.test(e)?"xn--"+encode(e):e}))}var version$1="1.4.1",ucs2={decode:ucs2decode,encode:ucs2encode},_polyfillNode_punycode={version:version$1,ucs2:ucs2,toASCII:toASCII,toUnicode:toUnicode,encode:encode,decode:decode};function hasOwnProperty(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function stringifyPrimitive(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}}function stringify$1(e,t,r,n){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?map(objectKeys$1(e),(function(n){var i=encodeURIComponent(stringifyPrimitive(n))+r;return isArray(e[n])?map(e[n],(function(e){return i+encodeURIComponent(stringifyPrimitive(e))})).join(t):i+encodeURIComponent(stringifyPrimitive(e[n]))})).join(t):n?encodeURIComponent(stringifyPrimitive(n))+r+encodeURIComponent(stringifyPrimitive(e)):""}function map(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var objectKeys$1=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t};function parse$2(e,t,r,n){t=t||"&",r=r||"=";var i={};if("string"!=typeof e||0===e.length)return i;var o=/\+/g;e=e.split(t);var s=1e3;n&&"number"==typeof n.maxKeys&&(s=n.maxKeys);var a=e.length;s>0&&a>s&&(a=s);for(var c=0;c<a;++c){var l,u,d,h,f=e[c].replace(o,"%20"),p=f.indexOf(r);p>=0?(l=f.substr(0,p),u=f.substr(p+1)):(l=f,u=""),d=decodeURIComponent(l),h=decodeURIComponent(u),hasOwnProperty(i,d)?isArray(i[d])?i[d].push(h):i[d]=[i[d],h]:i[d]=h}return i}var _polyfillNode_querystring={encode:stringify$1,stringify:stringify$1,decode:parse$2,parse:parse$2};const URL$2=global$1.URL,URLSearchParams=global$1.URLSearchParams;var _polyfillNode_url={parse:urlParse,resolve:urlResolve,resolveObject:urlResolveObject,fileURLToPath:urlFileURLToPath,format:urlFormat,Url:Url,URL:URL$2,URLSearchParams:URLSearchParams};function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,delims=["<",">",'"',"`"," ","\r","\n","\t"],unwise=["{","}","|","\\","^","`"].concat(delims),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnameMaxLen=255,hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:!0,"javascript:":!0},hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function urlParse(e,t,r){if(e&&isObject$1(e)&&e instanceof Url)return e;var n=new Url;return n.parse(e,t,r),n}function parse$1(e,t,r,n){if(!isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var i=t.indexOf("?"),o=-1!==i&&i<t.indexOf("#")?"?":"#",s=t.split(o);s[0]=s[0].replace(/\\/g,"/");var a=t=s.join(o);if(a=a.trim(),!n&&1===t.split("#").length){var c=simplePathPattern.exec(a);if(c)return e.path=a,e.href=a,e.pathname=c[1],c[2]?(e.search=c[2],e.query=r?parse$2(e.search.substr(1)):e.search.substr(1)):r&&(e.search="",e.query={}),e}var l,u,d,h,f=protocolPattern.exec(a);if(f){var p=(f=f[0]).toLowerCase();e.protocol=p,a=a.substr(f.length)}if(n||f||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var m="//"===a.substr(0,2);!m||f&&hostlessProtocol[f]||(a=a.substr(2),e.slashes=!0)}if(!hostlessProtocol[f]&&(m||f&&!slashedProtocol[f])){var v,g,_=-1;for(l=0;l<hostEndingChars.length;l++)-1!==(u=a.indexOf(hostEndingChars[l]))&&(-1===_||u<_)&&(_=u);for(-1!==(g=-1===_?a.lastIndexOf("@"):a.lastIndexOf("@",_))&&(v=a.slice(0,g),a=a.slice(g+1),e.auth=decodeURIComponent(v)),_=-1,l=0;l<nonHostChars.length;l++)-1!==(u=a.indexOf(nonHostChars[l]))&&(-1===_||u<_)&&(_=u);-1===_&&(_=a.length),e.host=a.slice(0,_),a=a.slice(_),parseHost(e),e.hostname=e.hostname||"";var y="["===e.hostname[0]&&"]"===e.hostname[e.hostname.length-1];if(!y){var b=e.hostname.split(/\./);for(l=0,d=b.length;l<d;l++){var w=b[l];if(w&&!w.match(hostnamePartPattern)){for(var k="",S=0,E=w.length;S<E;S++)w.charCodeAt(S)>127?k+="x":k+=w[S];if(!k.match(hostnamePartPattern)){var C=b.slice(0,l),T=b.slice(l+1),P=w.match(hostnamePartStart);P&&(C.push(P[1]),T.unshift(P[2])),T.length&&(a="/"+T.join(".")+a),e.hostname=C.join(".");break}}}}e.hostname.length>hostnameMaxLen?e.hostname="":e.hostname=e.hostname.toLowerCase(),y||(e.hostname=toASCII(e.hostname)),h=e.port?":"+e.port:"";var A=e.hostname||"";e.host=A+h,e.href+=e.host,y&&(e.hostname=e.hostname.substr(1,e.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!unsafeProtocol[p])for(l=0,d=autoEscape.length;l<d;l++){var x=autoEscape[l];if(-1!==a.indexOf(x)){var B=encodeURIComponent(x);B===x&&(B=escape(x)),a=a.split(x).join(B)}}var I=a.indexOf("#");-1!==I&&(e.hash=a.substr(I),a=a.slice(0,I));var R=a.indexOf("?");if(-1!==R?(e.search=a.substr(R),e.query=a.substr(R+1),r&&(e.query=parse$2(e.query)),a=a.slice(0,R)):r&&(e.search="",e.query={}),a&&(e.pathname=a),slashedProtocol[p]&&e.hostname&&!e.pathname&&(e.pathname="/"),e.pathname||e.search){h=e.pathname||"";var O=e.search||"";e.path=h+O}return e.href=format(e),e}function urlFileURLToPath(e){if("string"==typeof e)e=(new Url).parse(e);else if(!(e instanceof Url))throw new TypeError('The "path" argument must be of type string or an instance of URL. Received type '+typeof e+String(e));if("file:"!==e.protocol)throw new TypeError("The URL must be of scheme file");return getPathFromURLPosix(e)}function getPathFromURLPosix(e){const t=e.pathname;for(let e=0;e<t.length;e++)if("%"===t[e]){const r=32|t.codePointAt(e+2);if("2"===t[e+1]&&102===r)throw new TypeError("must not include encoded / characters")}return decodeURIComponent(t)}function urlFormat(e){return isString(e)&&(e=parse$1({},e)),format(e)}function format(e){var t=e.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var r=e.protocol||"",n=e.pathname||"",i=e.hash||"",o=!1,s="";e.host?o=t+e.host:e.hostname&&(o=t+(-1===e.hostname.indexOf(":")?e.hostname:"["+this.hostname+"]"),e.port&&(o+=":"+e.port)),e.query&&isObject$1(e.query)&&Object.keys(e.query).length&&(s=stringify$1(e.query));var a=e.search||s&&"?"+s||"";return r&&":"!==r.substr(-1)&&(r+=":"),e.slashes||(!r||slashedProtocol[r])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),i&&"#"!==i.charAt(0)&&(i="#"+i),a&&"?"!==a.charAt(0)&&(a="?"+a),r+o+(n=n.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(a=a.replace("#","%23"))+i}function urlResolve(e,t){return urlParse(e,!1,!0).resolve(t)}function urlResolveObject(e,t){return e?urlParse(e,!1,!0).resolveObject(t):t}function parseHost(e){var t=e.host,r=portPattern.exec(t);r&&(":"!==(r=r[0])&&(e.port=r.substr(1)),t=t.substr(0,t.length-r.length)),t&&(e.hostname=t)}Url.prototype.parse=function(e,t,r){return parse$1(this,e,t,r)},Url.prototype.format=function(){return format(this)},Url.prototype.resolve=function(e){return this.resolveObject(urlParse(e,!1,!0)).format()},Url.prototype.resolveObject=function(e){if(isString(e)){var t=new Url;t.parse(e,!1,!0),e=t}for(var r,n=new Url,i=Object.keys(this),o=0;o<i.length;o++){var s=i[o];n[s]=this[s]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var a=Object.keys(e),c=0;c<a.length;c++){var l=a[c];"protocol"!==l&&(n[l]=e[l])}return slashedProtocol[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!slashedProtocol[e.protocol]){for(var u=Object.keys(e),d=0;d<u.length;d++){var h=u[d];n[h]=e[h]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||hostlessProtocol[e.protocol])n.pathname=e.pathname;else{for(r=(e.pathname||"").split("/");r.length&&!(e.host=r.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==r[0]&&r.unshift(""),r.length<2&&r.unshift(""),n.pathname=r.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var f=n.pathname||"",p=n.search||"";n.path=f+p}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var m,v=n.pathname&&"/"===n.pathname.charAt(0),g=e.host||e.pathname&&"/"===e.pathname.charAt(0),_=g||v||n.host&&e.pathname,y=_,b=n.pathname&&n.pathname.split("/")||[],w=n.protocol&&!slashedProtocol[n.protocol];if(r=e.pathname&&e.pathname.split("/")||[],w&&(n.hostname="",n.port=null,n.host&&(""===b[0]?b[0]=n.host:b.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===r[0]?r[0]=e.host:r.unshift(e.host)),e.host=null),_=_&&(""===r[0]||""===b[0])),g)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,b=r;else if(r.length)b||(b=[]),b.pop(),b=b.concat(r),n.search=e.search,n.query=e.query;else if(!isNullOrUndefined(e.search))return w&&(n.hostname=n.host=b.shift(),(m=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=m.shift(),n.host=n.hostname=m.shift())),n.search=e.search,n.query=e.query,isNull(n.pathname)&&isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n;if(!b.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var k=b.slice(-1)[0],S=(n.host||e.host||b.length>1)&&("."===k||".."===k)||""===k,E=0,C=b.length;C>=0;C--)"."===(k=b[C])?b.splice(C,1):".."===k?(b.splice(C,1),E++):E&&(b.splice(C,1),E--);if(!_&&!y)for(;E--;E)b.unshift("..");!_||""===b[0]||b[0]&&"/"===b[0].charAt(0)||b.unshift(""),S&&"/"!==b.join("/").substr(-1)&&b.push("");var T=""===b[0]||b[0]&&"/"===b[0].charAt(0);return w&&(n.hostname=n.host=T?"":b.length?b.shift():"",(m=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=m.shift(),n.host=n.hostname=m.shift())),(_=_||n.host&&b.length)&&!T&&b.unshift(""),b.length?n.pathname=b.join("/"):(n.pathname=null,n.path=null),isNull(n.pathname)&&isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},Url.prototype.parseHost=function(){return parseHost(this)};var _polyfillNode_url$1=Object.freeze({__proto__:null,parse:urlParse,resolve:urlResolve,resolveObject:urlResolveObject,fileURLToPath:urlFileURLToPath,format:urlFormat,URL:URL$2,URLSearchParams:URLSearchParams,default:_polyfillNode_url,Url:Url}),require$$1$3=getAugmentedNamespace(_polyfillNode_url$1),ws$2={},hasFetch=isFunction(global$1.fetch)&&isFunction(global$1.ReadableStream),_blobConstructor,xhr;function blobConstructor(){if(void 0!==_blobConstructor)return _blobConstructor;try{new global$1.Blob([new ArrayBuffer(1)]),_blobConstructor=!0}catch(e){_blobConstructor=!1}return _blobConstructor}function checkTypeSupport(e){xhr||(xhr=new global$1.XMLHttpRequest).open("GET",global$1.location.host?"/":"https://example.com");try{return xhr.responseType=e,xhr.responseType===e}catch(e){return!1}}var haveArrayBuffer=void 0!==global$1.ArrayBuffer,haveSlice=haveArrayBuffer&&isFunction(global$1.ArrayBuffer.prototype.slice),arraybuffer=haveArrayBuffer&&checkTypeSupport("arraybuffer"),msstream=!hasFetch&&haveSlice&&checkTypeSupport("ms-stream"),mozchunkedarraybuffer=!hasFetch&&haveArrayBuffer&&checkTypeSupport("moz-chunked-arraybuffer"),overrideMimeType=isFunction(xhr.overrideMimeType),vbArray=isFunction(global$1.VBArray);function isFunction(e){return"function"==typeof e}xhr=null;var rStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4};function IncomingMessage(e,t,r){var n,i=this;if(Readable.call(i),i._mode=r,i.headers={},i.rawHeaders=[],i.trailers={},i.rawTrailers=[],i.on("end",(function(){browser$1$1.nextTick((function(){i.emit("close")}))})),"fetch"===r){i._fetchResponse=t,i.url=t.url,i.statusCode=t.status,i.statusMessage=t.statusText;for(var o,s,a=t.headers[Symbol.iterator]();o=(s=a.next()).value,!s.done;)i.headers[o[0].toLowerCase()]=o[1],i.rawHeaders.push(o[0],o[1]);var c=t.body.getReader();(n=function(){c.read().then((function(e){i._destroyed||(e.done?i.push(null):(i.push(new Buffer$4(e.value)),n()))}))})()}else{if(i._xhr=e,i._pos=0,i.url=e.responseURL,i.statusCode=e.status,i.statusMessage=e.statusText,e.getAllResponseHeaders().split(/\r?\n/).forEach((function(e){var t=e.match(/^([^:]+):\s*(.*)/);if(t){var r=t[1].toLowerCase();"set-cookie"===r?(void 0===i.headers[r]&&(i.headers[r]=[]),i.headers[r].push(t[2])):void 0!==i.headers[r]?i.headers[r]+=", "+t[2]:i.headers[r]=t[2],i.rawHeaders.push(t[1],t[2])}})),i._charset="x-user-defined",!overrideMimeType){var l=i.rawHeaders["mime-type"];if(l){var u=l.match(/;\s*charset=([^;])(;|$)/);u&&(i._charset=u[1].toLowerCase())}i._charset||(i._charset="utf-8")}}}function toArrayBuffer(e){if(e instanceof Uint8Array){if(0===e.byteOffset&&e.byteLength===e.buffer.byteLength)return e.buffer;if("function"==typeof e.buffer.slice)return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}if(isBuffer$1(e)){for(var t=new Uint8Array(e.length),r=e.length,n=0;n<r;n++)t[n]=e[n];return t.buffer}throw new Error("Argument must be a Buffer")}function decideMode(e,t){return hasFetch&&t?"fetch":mozchunkedarraybuffer?"moz-chunked-arraybuffer":msstream?"ms-stream":arraybuffer&&e?"arraybuffer":vbArray&&e?"text:vbarray":"text"}function ClientRequest(e){var t,r=this;Writable.call(r),r._opts=e,r._body=[],r._headers={},e.auth&&r.setHeader("Authorization","Basic "+new Buffer$4(e.auth).toString("base64")),Object.keys(e.headers).forEach((function(t){r.setHeader(t,e.headers[t])}));var n=!0;if("disable-fetch"===e.mode)n=!1,t=!0;else if("prefer-streaming"===e.mode)t=!1;else if("allow-wrong-content-type"===e.mode)t=!overrideMimeType;else{if(e.mode&&"default"!==e.mode&&"prefer-fast"!==e.mode)throw new Error("Invalid value for opts.mode");t=!0}r._mode=decideMode(t,n),r.on("finish",(function(){r._onFinish()}))}inherits$4(IncomingMessage,Readable),IncomingMessage.prototype._read=function(){},IncomingMessage.prototype._onXHRProgress=function(){var e=this,t=e._xhr,r=null;switch(e._mode){case"text:vbarray":if(t.readyState!==rStates.DONE)break;try{r=new global$1.VBArray(t.responseBody).toArray()}catch(e){}if(null!==r){e.push(new Buffer$4(r));break}case"text":try{r=t.responseText}catch(t){e._mode="text:vbarray";break}if(r.length>e._pos){var n=r.substr(e._pos);if("x-user-defined"===e._charset){for(var i=new Buffer$4(n.length),o=0;o<n.length;o++)i[o]=255&n.charCodeAt(o);e.push(i)}else e.push(n,e._charset);e._pos=r.length}break;case"arraybuffer":if(t.readyState!==rStates.DONE||!t.response)break;r=t.response,e.push(new Buffer$4(new Uint8Array(r)));break;case"moz-chunked-arraybuffer":if(r=t.response,t.readyState!==rStates.LOADING||!r)break;e.push(new Buffer$4(new Uint8Array(r)));break;case"ms-stream":if(r=t.response,t.readyState!==rStates.LOADING)break;var s=new global$1.MSStreamReader;s.onprogress=function(){s.result.byteLength>e._pos&&(e.push(new Buffer$4(new Uint8Array(s.result.slice(e._pos)))),e._pos=s.result.byteLength)},s.onload=function(){e.push(null)},s.readAsArrayBuffer(r)}e._xhr.readyState===rStates.DONE&&"ms-stream"!==e._mode&&e.push(null)},inherits$4(ClientRequest,Writable);var unsafeHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];function statusValid(e){try{var t=e.status;return null!==t&&0!==t}catch(e){return!1}}function request$1(e,t){"string"==typeof e&&(e=urlParse(e));var r=-1===global$1.location.protocol.search(/^https?:$/)?"http:":"",n=e.protocol||r,i=e.hostname||e.host,o=e.port,s=e.path||"/";i&&-1!==i.indexOf(":")&&(i="["+i+"]"),e.url=(i?n+"//"+i:"")+(o?":"+o:"")+s,e.method=(e.method||"GET").toUpperCase(),e.headers=e.headers||{};var a=new ClientRequest(e);return t&&a.on("response",t),a}function get$1(e,t){var r=request$1(e,t);return r.end(),r}function Agent$1(){}ClientRequest.prototype.setHeader=function(e,t){var r=e.toLowerCase();-1===unsafeHeaders.indexOf(r)&&(this._headers[r]={name:e,value:t})},ClientRequest.prototype.getHeader=function(e){return this._headers[e.toLowerCase()].value},ClientRequest.prototype.removeHeader=function(e){delete this._headers[e.toLowerCase()]},ClientRequest.prototype._onFinish=function(){var e=this;if(!e._destroyed){var t,r=e._opts,n=e._headers;if("POST"!==r.method&&"PUT"!==r.method&&"PATCH"!==r.method||(t=blobConstructor()?new global$1.Blob(e._body.map((function(e){return toArrayBuffer(e)})),{type:(n["content-type"]||{}).value||""}):Buffer$4.concat(e._body).toString()),"fetch"===e._mode){var i=Object.keys(n).map((function(e){return[n[e].name,n[e].value]}));global$1.fetch(e._opts.url,{method:e._opts.method,headers:i,body:t,mode:"cors",credentials:r.withCredentials?"include":"same-origin"}).then((function(t){e._fetchResponse=t,e._connect()}),(function(t){e.emit("error",t)}))}else{var o=e._xhr=new global$1.XMLHttpRequest;try{o.open(e._opts.method,e._opts.url,!0)}catch(t){return void browser$1$1.nextTick((function(){e.emit("error",t)}))}"responseType"in o&&(o.responseType=e._mode.split(":")[0]),"withCredentials"in o&&(o.withCredentials=!!r.withCredentials),"text"===e._mode&&"overrideMimeType"in o&&o.overrideMimeType("text/plain; charset=x-user-defined"),Object.keys(n).forEach((function(e){o.setRequestHeader(n[e].name,n[e].value)})),e._response=null,o.onreadystatechange=function(){switch(o.readyState){case rStates.LOADING:case rStates.DONE:e._onXHRProgress()}},"moz-chunked-arraybuffer"===e._mode&&(o.onprogress=function(){e._onXHRProgress()}),o.onerror=function(){e._destroyed||e.emit("error",new Error("XHR error"))};try{o.send(t)}catch(t){return void browser$1$1.nextTick((function(){e.emit("error",t)}))}}}},ClientRequest.prototype._onXHRProgress=function(){var e=this;statusValid(e._xhr)&&!e._destroyed&&(e._response||e._connect(),e._response._onXHRProgress())},ClientRequest.prototype._connect=function(){var e=this;e._destroyed||(e._response=new IncomingMessage(e._xhr,e._fetchResponse,e._mode),e.emit("response",e._response))},ClientRequest.prototype._write=function(e,t,r){this._body.push(e),r()},ClientRequest.prototype.abort=ClientRequest.prototype.destroy=function(){var e=this;e._destroyed=!0,e._response&&(e._response._destroyed=!0),e._xhr&&e._xhr.abort()},ClientRequest.prototype.end=function(e,t,r){"function"==typeof e&&(r=e,e=void 0),Writable.prototype.end.call(this,e,t,r)},ClientRequest.prototype.flushHeaders=function(){},ClientRequest.prototype.setTimeout=function(){},ClientRequest.prototype.setNoDelay=function(){},ClientRequest.prototype.setSocketKeepAlive=function(){},Agent$1.defaultMaxSockets=4;var METHODS$1=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"],STATUS_CODES$1={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"},_polyfillNode_https={request:request$1,get:get$1,Agent:Agent$1,METHODS:METHODS$1,STATUS_CODES:STATUS_CODES$1},_polyfillNode_https$1=Object.freeze({__proto__:null,request:request$1,get:get$1,Agent:Agent$1,METHODS:METHODS$1,STATUS_CODES:STATUS_CODES$1,default:_polyfillNode_https}),require$$1$2=getAugmentedNamespace(_polyfillNode_https$1);function request(e,t){"string"==typeof e&&(e=urlParse(e));var r=-1===global$1.location.protocol.search(/^https?:$/)?"http:":"",n=e.protocol||r,i=e.hostname||e.host,o=e.port,s=e.path||"/";i&&-1!==i.indexOf(":")&&(i="["+i+"]"),e.url=(i?n+"//"+i:"")+(o?":"+o:"")+s,e.method=(e.method||"GET").toUpperCase(),e.headers=e.headers||{};var a=new ClientRequest(e);return t&&a.on("response",t),a}function get(e,t){var r=request(e,t);return r.end(),r}function Agent(){}Agent.defaultMaxSockets=4;var METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"],STATUS_CODES={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"},_polyfillNode_http={request:request,get:get,Agent:Agent,METHODS:METHODS,STATUS_CODES:STATUS_CODES},_polyfillNode_http$1=Object.freeze({__proto__:null,request:request,get:get,Agent:Agent,METHODS:METHODS,STATUS_CODES:STATUS_CODES,default:_polyfillNode_http}),require$$1$1=getAugmentedNamespace(_polyfillNode_http$1),_polyfillNode_net={},_polyfillNode_net$1=Object.freeze({__proto__:null,default:_polyfillNode_net}),require$$1=getAugmentedNamespace(_polyfillNode_net$1),_polyfillNode_tls={},_polyfillNode_tls$1=Object.freeze({__proto__:null,default:_polyfillNode_tls}),require$$0$1=getAugmentedNamespace(_polyfillNode_tls$1),_polyfillNode_crypto={},_polyfillNode_crypto$1=Object.freeze({__proto__:null,default:_polyfillNode_crypto}),require$$3$1=getAugmentedNamespace(_polyfillNode_crypto$1),msg={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};function ZStream(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var TYPED_OK="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function assign(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}}return e}function shrinkBuf(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)}function arraySet(e,t,r,n,i){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),i);else for(var o=0;o<n;o++)e[i+o]=t[r+o]}function flattenChunks(e){var t,r,n,i,o,s;for(n=0,t=0,r=e.length;t<r;t++)n+=e[t].length;for(s=new Uint8Array(n),i=0,t=0,r=e.length;t<r;t++)o=e[t],s.set(o,i),i+=o.length;return s}var Buf8=Uint8Array,Buf16=Uint16Array,Buf32=Int32Array,Z_FIXED$2=4,Z_BINARY$1=0,Z_TEXT$1=1,Z_UNKNOWN$2=2;function zero$1(e){for(var t=e.length;--t>=0;)e[t]=0}var STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,MIN_MATCH$1=3,MAX_MATCH$1=258,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,BL_CODES$1=19,HEAP_SIZE$1=2*L_CODES$1+1,MAX_BITS$1=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],DIST_CODE_LEN=512,static_ltree=new Array(2*(L_CODES$1+2));zero$1(static_ltree);var static_dtree=new Array(2*D_CODES$1);zero$1(static_dtree);var _dist_code=new Array(DIST_CODE_LEN);zero$1(_dist_code);var _length_code=new Array(MAX_MATCH$1-MIN_MATCH$1+1);zero$1(_length_code);var base_length=new Array(LENGTH_CODES$1);zero$1(base_length);var base_dist=new Array(D_CODES$1),static_l_desc,static_d_desc,static_bl_desc;function StaticTreeDesc(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function TreeDesc(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function d_code(e){return e<256?_dist_code[e]:_dist_code[256+(e>>>7)]}function put_short(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function send_bits(e,t,r){e.bi_valid>Buf_size-r?(e.bi_buf|=t<<e.bi_valid&65535,put_short(e,e.bi_buf),e.bi_buf=t>>Buf_size-e.bi_valid,e.bi_valid+=r-Buf_size):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function send_code(e,t,r){send_bits(e,r[2*t],r[2*t+1])}function bi_reverse(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1}function bi_flush(e){16===e.bi_valid?(put_short(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}function gen_bitlen(e,t){var r,n,i,o,s,a,c=t.dyn_tree,l=t.max_code,u=t.stat_desc.static_tree,d=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,p=t.stat_desc.max_length,m=0;for(o=0;o<=MAX_BITS$1;o++)e.bl_count[o]=0;for(c[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<HEAP_SIZE$1;r++)(o=c[2*c[2*(n=e.heap[r])+1]+1]+1)>p&&(o=p,m++),c[2*n+1]=o,n>l||(e.bl_count[o]++,s=0,n>=f&&(s=h[n-f]),a=c[2*n],e.opt_len+=a*(o+s),d&&(e.static_len+=a*(u[2*n+1]+s)));if(0!==m){do{for(o=p-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[p]--,m-=2}while(m>0);for(o=p;0!==o;o--)for(n=e.bl_count[o];0!==n;)(i=e.heap[--r])>l||(c[2*i+1]!==o&&(e.opt_len+=(o-c[2*i+1])*c[2*i],c[2*i+1]=o),n--)}}function gen_codes(e,t,r){var n,i,o=new Array(MAX_BITS$1+1),s=0;for(n=1;n<=MAX_BITS$1;n++)o[n]=s=s+r[n-1]<<1;for(i=0;i<=t;i++){var a=e[2*i+1];0!==a&&(e[2*i]=bi_reverse(o[a]++,a))}}function tr_static_init(){var e,t,r,n,i,o=new Array(MAX_BITS$1+1);for(r=0,n=0;n<LENGTH_CODES$1-1;n++)for(base_length[n]=r,e=0;e<1<<extra_lbits[n];e++)_length_code[r++]=n;for(_length_code[r-1]=n,i=0,n=0;n<16;n++)for(base_dist[n]=i,e=0;e<1<<extra_dbits[n];e++)_dist_code[i++]=n;for(i>>=7;n<D_CODES$1;n++)for(base_dist[n]=i<<7,e=0;e<1<<extra_dbits[n]-7;e++)_dist_code[256+i++]=n;for(t=0;t<=MAX_BITS$1;t++)o[t]=0;for(e=0;e<=143;)static_ltree[2*e+1]=8,e++,o[8]++;for(;e<=255;)static_ltree[2*e+1]=9,e++,o[9]++;for(;e<=279;)static_ltree[2*e+1]=7,e++,o[7]++;for(;e<=287;)static_ltree[2*e+1]=8,e++,o[8]++;for(gen_codes(static_ltree,L_CODES$1+1,o),e=0;e<D_CODES$1;e++)static_dtree[2*e+1]=5,static_dtree[2*e]=bi_reverse(e,5);static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS$1+1,L_CODES$1,MAX_BITS$1),static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES$1,MAX_BITS$1),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES$1,MAX_BL_BITS)}function init_block(e){var t;for(t=0;t<L_CODES$1;t++)e.dyn_ltree[2*t]=0;for(t=0;t<D_CODES$1;t++)e.dyn_dtree[2*t]=0;for(t=0;t<BL_CODES$1;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*END_BLOCK]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function bi_windup(e){e.bi_valid>8?put_short(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function copy_block(e,t,r,n){bi_windup(e),n&&(put_short(e,r),put_short(e,~r)),arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}function smaller(e,t,r,n){var i=2*t,o=2*r;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]}function pqdownheap(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&smaller(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!smaller(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function compress_block(e,t,r){var n,i,o,s,a=0;if(0!==e.last_lit)do{n=e.pending_buf[e.d_buf+2*a]<<8|e.pending_buf[e.d_buf+2*a+1],i=e.pending_buf[e.l_buf+a],a++,0===n?send_code(e,i,t):(send_code(e,(o=_length_code[i])+LITERALS$1+1,t),0!==(s=extra_lbits[o])&&send_bits(e,i-=base_length[o],s),send_code(e,o=d_code(--n),r),0!==(s=extra_dbits[o])&&send_bits(e,n-=base_dist[o],s))}while(a<e.last_lit);send_code(e,END_BLOCK,t)}function build_tree(e,t){var r,n,i,o=t.dyn_tree,s=t.stat_desc.static_tree,a=t.stat_desc.has_stree,c=t.stat_desc.elems,l=-1;for(e.heap_len=0,e.heap_max=HEAP_SIZE$1,r=0;r<c;r++)0!==o[2*r]?(e.heap[++e.heap_len]=l=r,e.depth[r]=0):o[2*r+1]=0;for(;e.heap_len<2;)o[2*(i=e.heap[++e.heap_len]=l<2?++l:0)]=1,e.depth[i]=0,e.opt_len--,a&&(e.static_len-=s[2*i+1]);for(t.max_code=l,r=e.heap_len>>1;r>=1;r--)pqdownheap(e,o,r);i=c;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],pqdownheap(e,o,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,o[2*i]=o[2*r]+o[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,o[2*r+1]=o[2*n+1]=i,e.heap[1]=i++,pqdownheap(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],gen_bitlen(e,t),gen_codes(o,l,e.bl_count)}function scan_tree(e,t,r){var n,i,o=-1,s=t[1],a=0,c=7,l=4;for(0===s&&(c=138,l=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=s,s=t[2*(n+1)+1],++a<c&&i===s||(a<l?e.bl_tree[2*i]+=a:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[2*REP_3_6]++):a<=10?e.bl_tree[2*REPZ_3_10]++:e.bl_tree[2*REPZ_11_138]++,a=0,o=i,0===s?(c=138,l=3):i===s?(c=6,l=3):(c=7,l=4))}function send_tree(e,t,r){var n,i,o=-1,s=t[1],a=0,c=7,l=4;for(0===s&&(c=138,l=3),n=0;n<=r;n++)if(i=s,s=t[2*(n+1)+1],!(++a<c&&i===s)){if(a<l)do{send_code(e,i,e.bl_tree)}while(0!=--a);else 0!==i?(i!==o&&(send_code(e,i,e.bl_tree),a--),send_code(e,REP_3_6,e.bl_tree),send_bits(e,a-3,2)):a<=10?(send_code(e,REPZ_3_10,e.bl_tree),send_bits(e,a-3,3)):(send_code(e,REPZ_11_138,e.bl_tree),send_bits(e,a-11,7));a=0,o=i,0===s?(c=138,l=3):i===s?(c=6,l=3):(c=7,l=4)}}function build_bl_tree(e){var t;for(scan_tree(e,e.dyn_ltree,e.l_desc.max_code),scan_tree(e,e.dyn_dtree,e.d_desc.max_code),build_tree(e,e.bl_desc),t=BL_CODES$1-1;t>=3&&0===e.bl_tree[2*bl_order[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}function send_all_trees(e,t,r,n){var i;for(send_bits(e,t-257,5),send_bits(e,r-1,5),send_bits(e,n-4,4),i=0;i<n;i++)send_bits(e,e.bl_tree[2*bl_order[i]+1],3);send_tree(e,e.dyn_ltree,t-1),send_tree(e,e.dyn_dtree,r-1)}function detect_data_type(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return Z_BINARY$1;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return Z_TEXT$1;for(t=32;t<LITERALS$1;t++)if(0!==e.dyn_ltree[2*t])return Z_TEXT$1;return Z_BINARY$1}zero$1(base_dist);var static_init_done=!1;function _tr_init(e){static_init_done||(tr_static_init(),static_init_done=!0),e.l_desc=new TreeDesc(e.dyn_ltree,static_l_desc),e.d_desc=new TreeDesc(e.dyn_dtree,static_d_desc),e.bl_desc=new TreeDesc(e.bl_tree,static_bl_desc),e.bi_buf=0,e.bi_valid=0,init_block(e)}function _tr_stored_block(e,t,r,n){send_bits(e,(STORED_BLOCK<<1)+(n?1:0),3),copy_block(e,t,r,!0)}function _tr_align(e){send_bits(e,STATIC_TREES<<1,3),send_code(e,END_BLOCK,static_ltree),bi_flush(e)}function _tr_flush_block(e,t,r,n){var i,o,s=0;e.level>0?(e.strm.data_type===Z_UNKNOWN$2&&(e.strm.data_type=detect_data_type(e)),build_tree(e,e.l_desc),build_tree(e,e.d_desc),s=build_bl_tree(e),i=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=i&&(i=o)):i=o=r+5,r+4<=i&&-1!==t?_tr_stored_block(e,t,r,n):e.strategy===Z_FIXED$2||o===i?(send_bits(e,(STATIC_TREES<<1)+(n?1:0),3),compress_block(e,static_ltree,static_dtree)):(send_bits(e,(DYN_TREES<<1)+(n?1:0),3),send_all_trees(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),compress_block(e,e.dyn_ltree,e.dyn_dtree)),init_block(e),n&&bi_windup(e)}function _tr_tally(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(_length_code[r]+LITERALS$1+1)]++,e.dyn_dtree[2*d_code(t)]++),e.last_lit===e.lit_bufsize-1}function adler32(e,t,r,n){for(var i=65535&e|0,o=e>>>16&65535|0,s=0;0!==r;){r-=s=r>2e3?2e3:r;do{o=o+(i=i+t[n++]|0)|0}while(--s);i%=65521,o%=65521}return i|o<<16|0}function makeTable(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}var crcTable=makeTable();function crc32(e,t,r,n){var i=crcTable,o=n+r;e^=-1;for(var s=n;s<o;s++)e=e>>>8^i[255&(e^t[s])];return-1^e}var Z_NO_FLUSH$1=0,Z_PARTIAL_FLUSH$1=1,Z_FULL_FLUSH$1=3,Z_FINISH$2=4,Z_BLOCK$2=5,Z_OK$2=0,Z_STREAM_END$2=1,Z_STREAM_ERROR$2=-2,Z_DATA_ERROR$2=-3,Z_BUF_ERROR$2=-5,Z_DEFAULT_COMPRESSION$1=-1,Z_FILTERED$1=1,Z_HUFFMAN_ONLY$1=2,Z_RLE$1=3,Z_FIXED$1=4,Z_DEFAULT_STRATEGY$1=0,Z_UNKNOWN$1=2,Z_DEFLATED$2=8,MAX_MEM_LEVEL=9,MAX_WBITS$1=15,DEF_MEM_LEVEL=8,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,PRESET_DICT=32,INIT_STATE=42,EXTRA_STATE=69,NAME_STATE=73,COMMENT_STATE=91,HCRC_STATE=103,BUSY_STATE=113,FINISH_STATE=666,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4,OS_CODE=3,configuration_table;function err(e,t){return e.msg=msg[t],t}function rank(e){return(e<<1)-(e>4?9:0)}function zero(e){for(var t=e.length;--t>=0;)e[t]=0}function flush_pending(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function flush_block_only(e,t){_tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,flush_pending(e.strm)}function put_byte(e,t){e.pending_buf[e.pending++]=t}function putShortMSB(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function read_buf(e,t,r,n){var i=e.avail_in;return i>n&&(i=n),0===i?0:(e.avail_in-=i,arraySet(t,e.input,e.next_in,i,r),1===e.state.wrap?e.adler=adler32(e.adler,t,i,r):2===e.state.wrap&&(e.adler=crc32(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)}function longest_match(e,t){var r,n,i=e.max_chain_length,o=e.strstart,s=e.prev_length,a=e.nice_match,c=e.strstart>e.w_size-MIN_LOOKAHEAD?e.strstart-(e.w_size-MIN_LOOKAHEAD):0,l=e.window,u=e.w_mask,d=e.prev,h=e.strstart+MAX_MATCH,f=l[o+s-1],p=l[o+s];e.prev_length>=e.good_match&&(i>>=2),a>e.lookahead&&(a=e.lookahead);do{if(l[(r=t)+s]===p&&l[r+s-1]===f&&l[r]===l[o]&&l[++r]===l[o+1]){o+=2,r++;do{}while(l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&o<h);if(n=MAX_MATCH-(h-o),o=h-MAX_MATCH,n>s){if(e.match_start=t,s=n,n>=a)break;f=l[o+s-1],p=l[o+s]}}}while((t=d[t&u])>c&&0!=--i);return s<=e.lookahead?s:e.lookahead}function fill_window(e){var t,r,n,i,o,s=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=s+(s-MIN_LOOKAHEAD)){arraySet(e.window,e.window,s,s,0),e.match_start-=s,e.strstart-=s,e.block_start-=s,t=r=e.hash_size;do{n=e.head[--t],e.head[t]=n>=s?n-s:0}while(--r);t=r=s;do{n=e.prev[--t],e.prev[t]=n>=s?n-s:0}while(--r);i+=s}if(0===e.strm.avail_in)break;if(r=read_buf(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=r,e.lookahead+e.insert>=MIN_MATCH)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+MIN_MATCH-1])&e.hash_mask,e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<MIN_MATCH)););}while(e.lookahead<MIN_LOOKAHEAD&&0!==e.strm.avail_in)}function deflate_stored(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(fill_window(e),0===e.lookahead&&t===Z_NO_FLUSH$1)return BS_NEED_MORE;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,flush_block_only(e,!1),0===e.strm.avail_out))return BS_NEED_MORE;if(e.strstart-e.block_start>=e.w_size-MIN_LOOKAHEAD&&(flush_block_only(e,!1),0===e.strm.avail_out))return BS_NEED_MORE}return e.insert=0,t===Z_FINISH$2?(flush_block_only(e,!0),0===e.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):(e.strstart>e.block_start&&(flush_block_only(e,!1),e.strm.avail_out),BS_NEED_MORE)}function deflate_fast(e,t){for(var r,n;;){if(e.lookahead<MIN_LOOKAHEAD){if(fill_window(e),e.lookahead<MIN_LOOKAHEAD&&t===Z_NO_FLUSH$1)return BS_NEED_MORE;if(0===e.lookahead)break}if(r=0,e.lookahead>=MIN_MATCH&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+MIN_MATCH-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-MIN_LOOKAHEAD&&(e.match_length=longest_match(e,r)),e.match_length>=MIN_MATCH)if(n=_tr_tally(e,e.strstart-e.match_start,e.match_length-MIN_MATCH),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=MIN_MATCH){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+MIN_MATCH-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=_tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(flush_block_only(e,!1),0===e.strm.avail_out))return BS_NEED_MORE}return e.insert=e.strstart<MIN_MATCH-1?e.strstart:MIN_MATCH-1,t===Z_FINISH$2?(flush_block_only(e,!0),0===e.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):e.last_lit&&(flush_block_only(e,!1),0===e.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_slow(e,t){for(var r,n,i;;){if(e.lookahead<MIN_LOOKAHEAD){if(fill_window(e),e.lookahead<MIN_LOOKAHEAD&&t===Z_NO_FLUSH$1)return BS_NEED_MORE;if(0===e.lookahead)break}if(r=0,e.lookahead>=MIN_MATCH&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+MIN_MATCH-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=MIN_MATCH-1,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-MIN_LOOKAHEAD&&(e.match_length=longest_match(e,r),e.match_length<=5&&(e.strategy===Z_FILTERED$1||e.match_length===MIN_MATCH&&e.strstart-e.match_start>4096)&&(e.match_length=MIN_MATCH-1)),e.prev_length>=MIN_MATCH&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-MIN_MATCH,n=_tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-MIN_MATCH),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+MIN_MATCH-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=MIN_MATCH-1,e.strstart++,n&&(flush_block_only(e,!1),0===e.strm.avail_out))return BS_NEED_MORE}else if(e.match_available){if((n=_tr_tally(e,0,e.window[e.strstart-1]))&&flush_block_only(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return BS_NEED_MORE}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=_tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<MIN_MATCH-1?e.strstart:MIN_MATCH-1,t===Z_FINISH$2?(flush_block_only(e,!0),0===e.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):e.last_lit&&(flush_block_only(e,!1),0===e.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_rle(e,t){for(var r,n,i,o,s=e.window;;){if(e.lookahead<=MAX_MATCH){if(fill_window(e),e.lookahead<=MAX_MATCH&&t===Z_NO_FLUSH$1)return BS_NEED_MORE;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=MIN_MATCH&&e.strstart>0&&(n=s[i=e.strstart-1])===s[++i]&&n===s[++i]&&n===s[++i]){o=e.strstart+MAX_MATCH;do{}while(n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&i<o);e.match_length=MAX_MATCH-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=MIN_MATCH?(r=_tr_tally(e,1,e.match_length-MIN_MATCH),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=_tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(flush_block_only(e,!1),0===e.strm.avail_out))return BS_NEED_MORE}return e.insert=0,t===Z_FINISH$2?(flush_block_only(e,!0),0===e.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):e.last_lit&&(flush_block_only(e,!1),0===e.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_huff(e,t){for(var r;;){if(0===e.lookahead&&(fill_window(e),0===e.lookahead)){if(t===Z_NO_FLUSH$1)return BS_NEED_MORE;break}if(e.match_length=0,r=_tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(flush_block_only(e,!1),0===e.strm.avail_out))return BS_NEED_MORE}return e.insert=0,t===Z_FINISH$2?(flush_block_only(e,!0),0===e.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):e.last_lit&&(flush_block_only(e,!1),0===e.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE}function Config(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}function lm_init(e){e.window_size=2*e.w_size,zero(e.head),e.max_lazy_match=configuration_table[e.level].max_lazy,e.good_match=configuration_table[e.level].good_length,e.nice_match=configuration_table[e.level].nice_length,e.max_chain_length=configuration_table[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=MIN_MATCH-1,e.match_available=0,e.ins_h=0}function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED$2,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Buf16(2*HEAP_SIZE),this.dyn_dtree=new Buf16(2*(2*D_CODES+1)),this.bl_tree=new Buf16(2*(2*BL_CODES+1)),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Buf16(MAX_BITS+1),this.heap=new Buf16(2*L_CODES+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Buf16(2*L_CODES+1),zero(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function deflateResetKeep(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=Z_UNKNOWN$1,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?INIT_STATE:BUSY_STATE,e.adler=2===t.wrap?0:1,t.last_flush=Z_NO_FLUSH$1,_tr_init(t),Z_OK$2):err(e,Z_STREAM_ERROR$2)}function deflateReset(e){var t=deflateResetKeep(e);return t===Z_OK$2&&lm_init(e.state),t}function deflateSetHeader(e,t){return e&&e.state?2!==e.state.wrap?Z_STREAM_ERROR$2:(e.state.gzhead=t,Z_OK$2):Z_STREAM_ERROR$2}function deflateInit2(e,t,r,n,i,o){if(!e)return Z_STREAM_ERROR$2;var s=1;if(t===Z_DEFAULT_COMPRESSION$1&&(t=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),i<1||i>MAX_MEM_LEVEL||r!==Z_DEFLATED$2||n<8||n>15||t<0||t>9||o<0||o>Z_FIXED$1)return err(e,Z_STREAM_ERROR$2);8===n&&(n=9);var a=new DeflateState;return e.state=a,a.strm=e,a.wrap=s,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=i+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+MIN_MATCH-1)/MIN_MATCH),a.window=new Buf8(2*a.w_size),a.head=new Buf16(a.hash_size),a.prev=new Buf16(a.w_size),a.lit_bufsize=1<<i+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Buf8(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=t,a.strategy=o,a.method=r,deflateReset(e)}function deflateInit(e,t){return deflateInit2(e,t,Z_DEFLATED$2,MAX_WBITS$1,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY$1)}function deflate$1(e,t){var r,n,i,o;if(!e||!e.state||t>Z_BLOCK$2||t<0)return e?err(e,Z_STREAM_ERROR$2):Z_STREAM_ERROR$2;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||n.status===FINISH_STATE&&t!==Z_FINISH$2)return err(e,0===e.avail_out?Z_BUF_ERROR$2:Z_STREAM_ERROR$2);if(n.strm=e,r=n.last_flush,n.last_flush=t,n.status===INIT_STATE)if(2===n.wrap)e.adler=0,put_byte(n,31),put_byte(n,139),put_byte(n,8),n.gzhead?(put_byte(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),put_byte(n,255&n.gzhead.time),put_byte(n,n.gzhead.time>>8&255),put_byte(n,n.gzhead.time>>16&255),put_byte(n,n.gzhead.time>>24&255),put_byte(n,9===n.level?2:n.strategy>=Z_HUFFMAN_ONLY$1||n.level<2?4:0),put_byte(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(put_byte(n,255&n.gzhead.extra.length),put_byte(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=crc32(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=EXTRA_STATE):(put_byte(n,0),put_byte(n,0),put_byte(n,0),put_byte(n,0),put_byte(n,0),put_byte(n,9===n.level?2:n.strategy>=Z_HUFFMAN_ONLY$1||n.level<2?4:0),put_byte(n,OS_CODE),n.status=BUSY_STATE);else{var s=Z_DEFLATED$2+(n.w_bits-8<<4)<<8;s|=(n.strategy>=Z_HUFFMAN_ONLY$1||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(s|=PRESET_DICT),s+=31-s%31,n.status=BUSY_STATE,putShortMSB(n,s),0!==n.strstart&&(putShortMSB(n,e.adler>>>16),putShortMSB(n,65535&e.adler)),e.adler=1}if(n.status===EXTRA_STATE)if(n.gzhead.extra){for(i=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>i&&(e.adler=crc32(e.adler,n.pending_buf,n.pending-i,i)),flush_pending(e),i=n.pending,n.pending!==n.pending_buf_size));)put_byte(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>i&&(e.adler=crc32(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=NAME_STATE)}else n.status=NAME_STATE;if(n.status===NAME_STATE)if(n.gzhead.name){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=crc32(e.adler,n.pending_buf,n.pending-i,i)),flush_pending(e),i=n.pending,n.pending===n.pending_buf_size)){o=1;break}o=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,put_byte(n,o)}while(0!==o);n.gzhead.hcrc&&n.pending>i&&(e.adler=crc32(e.adler,n.pending_buf,n.pending-i,i)),0===o&&(n.gzindex=0,n.status=COMMENT_STATE)}else n.status=COMMENT_STATE;if(n.status===COMMENT_STATE)if(n.gzhead.comment){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=crc32(e.adler,n.pending_buf,n.pending-i,i)),flush_pending(e),i=n.pending,n.pending===n.pending_buf_size)){o=1;break}o=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,put_byte(n,o)}while(0!==o);n.gzhead.hcrc&&n.pending>i&&(e.adler=crc32(e.adler,n.pending_buf,n.pending-i,i)),0===o&&(n.status=HCRC_STATE)}else n.status=HCRC_STATE;if(n.status===HCRC_STATE&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&flush_pending(e),n.pending+2<=n.pending_buf_size&&(put_byte(n,255&e.adler),put_byte(n,e.adler>>8&255),e.adler=0,n.status=BUSY_STATE)):n.status=BUSY_STATE),0!==n.pending){if(flush_pending(e),0===e.avail_out)return n.last_flush=-1,Z_OK$2}else if(0===e.avail_in&&rank(t)<=rank(r)&&t!==Z_FINISH$2)return err(e,Z_BUF_ERROR$2);if(n.status===FINISH_STATE&&0!==e.avail_in)return err(e,Z_BUF_ERROR$2);if(0!==e.avail_in||0!==n.lookahead||t!==Z_NO_FLUSH$1&&n.status!==FINISH_STATE){var a=n.strategy===Z_HUFFMAN_ONLY$1?deflate_huff(n,t):n.strategy===Z_RLE$1?deflate_rle(n,t):configuration_table[n.level].func(n,t);if(a!==BS_FINISH_STARTED&&a!==BS_FINISH_DONE||(n.status=FINISH_STATE),a===BS_NEED_MORE||a===BS_FINISH_STARTED)return 0===e.avail_out&&(n.last_flush=-1),Z_OK$2;if(a===BS_BLOCK_DONE&&(t===Z_PARTIAL_FLUSH$1?_tr_align(n):t!==Z_BLOCK$2&&(_tr_stored_block(n,0,0,!1),t===Z_FULL_FLUSH$1&&(zero(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),flush_pending(e),0===e.avail_out))return n.last_flush=-1,Z_OK$2}return t!==Z_FINISH$2?Z_OK$2:n.wrap<=0?Z_STREAM_END$2:(2===n.wrap?(put_byte(n,255&e.adler),put_byte(n,e.adler>>8&255),put_byte(n,e.adler>>16&255),put_byte(n,e.adler>>24&255),put_byte(n,255&e.total_in),put_byte(n,e.total_in>>8&255),put_byte(n,e.total_in>>16&255),put_byte(n,e.total_in>>24&255)):(putShortMSB(n,e.adler>>>16),putShortMSB(n,65535&e.adler)),flush_pending(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?Z_OK$2:Z_STREAM_END$2)}function deflateEnd(e){var t;return e&&e.state?(t=e.state.status)!==INIT_STATE&&t!==EXTRA_STATE&&t!==NAME_STATE&&t!==COMMENT_STATE&&t!==HCRC_STATE&&t!==BUSY_STATE&&t!==FINISH_STATE?err(e,Z_STREAM_ERROR$2):(e.state=null,t===BUSY_STATE?err(e,Z_DATA_ERROR$2):Z_OK$2):Z_STREAM_ERROR$2}function deflateSetDictionary(e,t){var r,n,i,o,s,a,c,l,u=t.length;if(!e||!e.state)return Z_STREAM_ERROR$2;if(2===(o=(r=e.state).wrap)||1===o&&r.status!==INIT_STATE||r.lookahead)return Z_STREAM_ERROR$2;for(1===o&&(e.adler=adler32(e.adler,t,u,0)),r.wrap=0,u>=r.w_size&&(0===o&&(zero(r.head),r.strstart=0,r.block_start=0,r.insert=0),arraySet(l=new Buf8(r.w_size),t,u-r.w_size,r.w_size,0),t=l,u=r.w_size),s=e.avail_in,a=e.next_in,c=e.input,e.avail_in=u,e.next_in=0,e.input=t,fill_window(r);r.lookahead>=MIN_MATCH;){n=r.strstart,i=r.lookahead-(MIN_MATCH-1);do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+MIN_MATCH-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++}while(--i);r.strstart=n,r.lookahead=MIN_MATCH-1,fill_window(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=MIN_MATCH-1,r.match_available=0,e.next_in=a,e.input=c,e.avail_in=s,r.wrap=o,Z_OK$2}configuration_table=[new Config(0,0,0,0,deflate_stored),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)];var deflateInfo="pako deflate (from Nodeca project)",BAD$1=30,TYPE$1=12;function inflate_fast(e,t){var r,n,i,o,s,a,c,l,u,d,h,f,p,m,v,g,_,y,b,w,k,S,E,C,T;r=e.state,n=e.next_in,C=e.input,i=n+(e.avail_in-5),o=e.next_out,T=e.output,s=o-(t-e.avail_out),a=o+(e.avail_out-257),c=r.dmax,l=r.wsize,u=r.whave,d=r.wnext,h=r.window,f=r.hold,p=r.bits,m=r.lencode,v=r.distcode,g=(1<<r.lenbits)-1,_=(1<<r.distbits)-1;e:do{p<15&&(f+=C[n++]<<p,p+=8,f+=C[n++]<<p,p+=8),y=m[f&g];t:for(;;){if(f>>>=b=y>>>24,p-=b,0===(b=y>>>16&255))T[o++]=65535&y;else{if(!(16&b)){if(0==(64&b)){y=m[(65535&y)+(f&(1<<b)-1)];continue t}if(32&b){r.mode=TYPE$1;break e}e.msg="invalid literal/length code",r.mode=BAD$1;break e}w=65535&y,(b&=15)&&(p<b&&(f+=C[n++]<<p,p+=8),w+=f&(1<<b)-1,f>>>=b,p-=b),p<15&&(f+=C[n++]<<p,p+=8,f+=C[n++]<<p,p+=8),y=v[f&_];r:for(;;){if(f>>>=b=y>>>24,p-=b,!(16&(b=y>>>16&255))){if(0==(64&b)){y=v[(65535&y)+(f&(1<<b)-1)];continue r}e.msg="invalid distance code",r.mode=BAD$1;break e}if(k=65535&y,p<(b&=15)&&(f+=C[n++]<<p,(p+=8)<b&&(f+=C[n++]<<p,p+=8)),(k+=f&(1<<b)-1)>c){e.msg="invalid distance too far back",r.mode=BAD$1;break e}if(f>>>=b,p-=b,k>(b=o-s)){if((b=k-b)>u&&r.sane){e.msg="invalid distance too far back",r.mode=BAD$1;break e}if(S=0,E=h,0===d){if(S+=l-b,b<w){w-=b;do{T[o++]=h[S++]}while(--b);S=o-k,E=T}}else if(d<b){if(S+=l+d-b,(b-=d)<w){w-=b;do{T[o++]=h[S++]}while(--b);if(S=0,d<w){w-=b=d;do{T[o++]=h[S++]}while(--b);S=o-k,E=T}}}else if(S+=d-b,b<w){w-=b;do{T[o++]=h[S++]}while(--b);S=o-k,E=T}for(;w>2;)T[o++]=E[S++],T[o++]=E[S++],T[o++]=E[S++],w-=3;w&&(T[o++]=E[S++],w>1&&(T[o++]=E[S++]))}else{S=o-k;do{T[o++]=T[S++],T[o++]=T[S++],T[o++]=T[S++],w-=3}while(w>2);w&&(T[o++]=T[S++],w>1&&(T[o++]=T[S++]))}break}}break}}while(n<i&&o<a);n-=w=p>>3,f&=(1<<(p-=w<<3))-1,e.next_in=n,e.next_out=o,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=o<a?a-o+257:257-(o-a),r.hold=f,r.bits=p}var MAXBITS=15,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,CODES$1=0,LENS$1=1,DISTS$1=2,lbase=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],lext=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],dbase=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],dext=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];function inflate_table(e,t,r,n,i,o,s,a){var c,l,u,d,h,f,p,m,v,g=a.bits,_=0,y=0,b=0,w=0,k=0,S=0,E=0,C=0,T=0,P=0,A=null,x=0,B=new Buf16(MAXBITS+1),I=new Buf16(MAXBITS+1),R=null,O=0;for(_=0;_<=MAXBITS;_++)B[_]=0;for(y=0;y<n;y++)B[t[r+y]]++;for(k=g,w=MAXBITS;w>=1&&0===B[w];w--);if(k>w&&(k=w),0===w)return i[o++]=20971520,i[o++]=20971520,a.bits=1,0;for(b=1;b<w&&0===B[b];b++);for(k<b&&(k=b),C=1,_=1;_<=MAXBITS;_++)if(C<<=1,(C-=B[_])<0)return-1;if(C>0&&(e===CODES$1||1!==w))return-1;for(I[1]=0,_=1;_<MAXBITS;_++)I[_+1]=I[_]+B[_];for(y=0;y<n;y++)0!==t[r+y]&&(s[I[t[r+y]]++]=y);if(e===CODES$1?(A=R=s,f=19):e===LENS$1?(A=lbase,x-=257,R=lext,O-=257,f=256):(A=dbase,R=dext,f=-1),P=0,y=0,_=b,h=o,S=k,E=0,u=-1,d=(T=1<<k)-1,e===LENS$1&&T>ENOUGH_LENS$1||e===DISTS$1&&T>ENOUGH_DISTS$1)return 1;for(;;){p=_-E,s[y]<f?(m=0,v=s[y]):s[y]>f?(m=R[O+s[y]],v=A[x+s[y]]):(m=96,v=0),c=1<<_-E,b=l=1<<S;do{i[h+(P>>E)+(l-=c)]=p<<24|m<<16|v|0}while(0!==l);for(c=1<<_-1;P&c;)c>>=1;if(0!==c?(P&=c-1,P+=c):P=0,y++,0==--B[_]){if(_===w)break;_=t[r+s[y]]}if(_>k&&(P&d)!==u){for(0===E&&(E=k),h+=b,C=1<<(S=_-E);S+E<w&&!((C-=B[S+E])<=0);)S++,C<<=1;if(T+=1<<S,e===LENS$1&&T>ENOUGH_LENS$1||e===DISTS$1&&T>ENOUGH_DISTS$1)return 1;i[u=P&d]=k<<24|S<<16|h-o|0}}return 0!==P&&(i[h+P]=_-E<<24|64<<16|0),a.bits=k,0}var CODES=0,LENS=1,DISTS=2,Z_FINISH$1=4,Z_BLOCK$1=5,Z_TREES$1=6,Z_OK$1=0,Z_STREAM_END$1=1,Z_NEED_DICT$1=2,Z_STREAM_ERROR$1=-2,Z_DATA_ERROR$1=-3,Z_MEM_ERROR=-4,Z_BUF_ERROR$1=-5,Z_DEFLATED$1=8,HEAD=1,FLAGS=2,TIME=3,OS=4,EXLEN=5,EXTRA=6,NAME=7,COMMENT=8,HCRC=9,DICTID=10,DICT=11,TYPE=12,TYPEDO=13,STORED=14,COPY_=15,COPY=16,TABLE=17,LENLENS=18,CODELENS=19,LEN_=20,LEN=21,LENEXT=22,DIST=23,DISTEXT=24,MATCH=25,LIT=26,CHECK=27,LENGTH=28,DONE=29,BAD=30,MEM=31,SYNC=32,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS;function zswap32(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function InflateState(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Buf16(320),this.work=new Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function inflateResetKeep(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=HEAD,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Buf32(ENOUGH_LENS),t.distcode=t.distdyn=new Buf32(ENOUGH_DISTS),t.sane=1,t.back=-1,Z_OK$1):Z_STREAM_ERROR$1}function inflateReset(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,inflateResetKeep(e)):Z_STREAM_ERROR$1}function inflateReset2(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Z_STREAM_ERROR$1:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,inflateReset(e))):Z_STREAM_ERROR$1}function inflateInit2(e,t){var r,n;return e?(n=new InflateState,e.state=n,n.window=null,(r=inflateReset2(e,t))!==Z_OK$1&&(e.state=null),r):Z_STREAM_ERROR$1}function inflateInit(e){return inflateInit2(e,DEF_WBITS)}var virgin=!0,lenfix,distfix;function fixedtables(e){if(virgin){var t;for(lenfix=new Buf32(512),distfix=new Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(inflate_table(LENS,e.lens,0,288,lenfix,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;inflate_table(DISTS,e.lens,0,32,distfix,0,e.work,{bits:5}),virgin=!1}e.lencode=lenfix,e.lenbits=9,e.distcode=distfix,e.distbits=5}function updatewindow(e,t,r,n){var i,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Buf8(o.wsize)),n>=o.wsize?(arraySet(o.window,t,r-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((i=o.wsize-o.wnext)>n&&(i=n),arraySet(o.window,t,r-n,i,o.wnext),(n-=i)?(arraySet(o.window,t,r-n,n,0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0}function inflate$1(e,t){var r,n,i,o,s,a,c,l,u,d,h,f,p,m,v,g,_,y,b,w,k,S,E,C,T=0,P=new Buf8(4),A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return Z_STREAM_ERROR$1;(r=e.state).mode===TYPE&&(r.mode=TYPEDO),s=e.next_out,i=e.output,c=e.avail_out,o=e.next_in,n=e.input,a=e.avail_in,l=r.hold,u=r.bits,d=a,h=c,S=Z_OK$1;e:for(;;)switch(r.mode){case HEAD:if(0===r.wrap){r.mode=TYPEDO;break}for(;u<16;){if(0===a)break e;a--,l+=n[o++]<<u,u+=8}if(2&r.wrap&&35615===l){r.check=0,P[0]=255&l,P[1]=l>>>8&255,r.check=crc32(r.check,P,2,0),l=0,u=0,r.mode=FLAGS;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&l)<<8)+(l>>8))%31){e.msg="incorrect header check",r.mode=BAD;break}if((15&l)!==Z_DEFLATED$1){e.msg="unknown compression method",r.mode=BAD;break}if(u-=4,k=8+(15&(l>>>=4)),0===r.wbits)r.wbits=k;else if(k>r.wbits){e.msg="invalid window size",r.mode=BAD;break}r.dmax=1<<k,e.adler=r.check=1,r.mode=512&l?DICTID:TYPE,l=0,u=0;break;case FLAGS:for(;u<16;){if(0===a)break e;a--,l+=n[o++]<<u,u+=8}if(r.flags=l,(255&r.flags)!==Z_DEFLATED$1){e.msg="unknown compression method",r.mode=BAD;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=BAD;break}r.head&&(r.head.text=l>>8&1),512&r.flags&&(P[0]=255&l,P[1]=l>>>8&255,r.check=crc32(r.check,P,2,0)),l=0,u=0,r.mode=TIME;case TIME:for(;u<32;){if(0===a)break e;a--,l+=n[o++]<<u,u+=8}r.head&&(r.head.time=l),512&r.flags&&(P[0]=255&l,P[1]=l>>>8&255,P[2]=l>>>16&255,P[3]=l>>>24&255,r.check=crc32(r.check,P,4,0)),l=0,u=0,r.mode=OS;case OS:for(;u<16;){if(0===a)break e;a--,l+=n[o++]<<u,u+=8}r.head&&(r.head.xflags=255&l,r.head.os=l>>8),512&r.flags&&(P[0]=255&l,P[1]=l>>>8&255,r.check=crc32(r.check,P,2,0)),l=0,u=0,r.mode=EXLEN;case EXLEN:if(1024&r.flags){for(;u<16;){if(0===a)break e;a--,l+=n[o++]<<u,u+=8}r.length=l,r.head&&(r.head.extra_len=l),512&r.flags&&(P[0]=255&l,P[1]=l>>>8&255,r.check=crc32(r.check,P,2,0)),l=0,u=0}else r.head&&(r.head.extra=null);r.mode=EXTRA;case EXTRA:if(1024&r.flags&&((f=r.length)>a&&(f=a),f&&(r.head&&(k=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),arraySet(r.head.extra,n,o,f,k)),512&r.flags&&(r.check=crc32(r.check,n,f,o)),a-=f,o+=f,r.length-=f),r.length))break e;r.length=0,r.mode=NAME;case NAME:if(2048&r.flags){if(0===a)break e;f=0;do{k=n[o+f++],r.head&&k&&r.length<65536&&(r.head.name+=String.fromCharCode(k))}while(k&&f<a);if(512&r.flags&&(r.check=crc32(r.check,n,f,o)),a-=f,o+=f,k)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=COMMENT;case COMMENT:if(4096&r.flags){if(0===a)break e;f=0;do{k=n[o+f++],r.head&&k&&r.length<65536&&(r.head.comment+=String.fromCharCode(k))}while(k&&f<a);if(512&r.flags&&(r.check=crc32(r.check,n,f,o)),a-=f,o+=f,k)break e}else r.head&&(r.head.comment=null);r.mode=HCRC;case HCRC:if(512&r.flags){for(;u<16;){if(0===a)break e;a--,l+=n[o++]<<u,u+=8}if(l!==(65535&r.check)){e.msg="header crc mismatch",r.mode=BAD;break}l=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=TYPE;break;case DICTID:for(;u<32;){if(0===a)break e;a--,l+=n[o++]<<u,u+=8}e.adler=r.check=zswap32(l),l=0,u=0,r.mode=DICT;case DICT:if(0===r.havedict)return e.next_out=s,e.avail_out=c,e.next_in=o,e.avail_in=a,r.hold=l,r.bits=u,Z_NEED_DICT$1;e.adler=r.check=1,r.mode=TYPE;case TYPE:if(t===Z_BLOCK$1||t===Z_TREES$1)break e;case TYPEDO:if(r.last){l>>>=7&u,u-=7&u,r.mode=CHECK;break}for(;u<3;){if(0===a)break e;a--,l+=n[o++]<<u,u+=8}switch(r.last=1&l,u-=1,3&(l>>>=1)){case 0:r.mode=STORED;break;case 1:if(fixedtables(r),r.mode=LEN_,t===Z_TREES$1){l>>>=2,u-=2;break e}break;case 2:r.mode=TABLE;break;case 3:e.msg="invalid block type",r.mode=BAD}l>>>=2,u-=2;break;case STORED:for(l>>>=7&u,u-=7&u;u<32;){if(0===a)break e;a--,l+=n[o++]<<u,u+=8}if((65535&l)!=(l>>>16^65535)){e.msg="invalid stored block lengths",r.mode=BAD;break}if(r.length=65535&l,l=0,u=0,r.mode=COPY_,t===Z_TREES$1)break e;case COPY_:r.mode=COPY;case COPY:if(f=r.length){if(f>a&&(f=a),f>c&&(f=c),0===f)break e;arraySet(i,n,o,f,s),a-=f,o+=f,c-=f,s+=f,r.length-=f;break}r.mode=TYPE;break;case TABLE:for(;u<14;){if(0===a)break e;a--,l+=n[o++]<<u,u+=8}if(r.nlen=257+(31&l),l>>>=5,u-=5,r.ndist=1+(31&l),l>>>=5,u-=5,r.ncode=4+(15&l),l>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=BAD;break}r.have=0,r.mode=LENLENS;case LENLENS:for(;r.have<r.ncode;){for(;u<3;){if(0===a)break e;a--,l+=n[o++]<<u,u+=8}r.lens[A[r.have++]]=7&l,l>>>=3,u-=3}for(;r.have<19;)r.lens[A[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,E={bits:r.lenbits},S=inflate_table(CODES,r.lens,0,19,r.lencode,0,r.work,E),r.lenbits=E.bits,S){e.msg="invalid code lengths set",r.mode=BAD;break}r.have=0,r.mode=CODELENS;case CODELENS:for(;r.have<r.nlen+r.ndist;){for(;g=(T=r.lencode[l&(1<<r.lenbits)-1])>>>16&255,_=65535&T,!((v=T>>>24)<=u);){if(0===a)break e;a--,l+=n[o++]<<u,u+=8}if(_<16)l>>>=v,u-=v,r.lens[r.have++]=_;else{if(16===_){for(C=v+2;u<C;){if(0===a)break e;a--,l+=n[o++]<<u,u+=8}if(l>>>=v,u-=v,0===r.have){e.msg="invalid bit length repeat",r.mode=BAD;break}k=r.lens[r.have-1],f=3+(3&l),l>>>=2,u-=2}else if(17===_){for(C=v+3;u<C;){if(0===a)break e;a--,l+=n[o++]<<u,u+=8}u-=v,k=0,f=3+(7&(l>>>=v)),l>>>=3,u-=3}else{for(C=v+7;u<C;){if(0===a)break e;a--,l+=n[o++]<<u,u+=8}u-=v,k=0,f=11+(127&(l>>>=v)),l>>>=7,u-=7}if(r.have+f>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=BAD;break}for(;f--;)r.lens[r.have++]=k}}if(r.mode===BAD)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=BAD;break}if(r.lenbits=9,E={bits:r.lenbits},S=inflate_table(LENS,r.lens,0,r.nlen,r.lencode,0,r.work,E),r.lenbits=E.bits,S){e.msg="invalid literal/lengths set",r.mode=BAD;break}if(r.distbits=6,r.distcode=r.distdyn,E={bits:r.distbits},S=inflate_table(DISTS,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,E),r.distbits=E.bits,S){e.msg="invalid distances set",r.mode=BAD;break}if(r.mode=LEN_,t===Z_TREES$1)break e;case LEN_:r.mode=LEN;case LEN:if(a>=6&&c>=258){e.next_out=s,e.avail_out=c,e.next_in=o,e.avail_in=a,r.hold=l,r.bits=u,inflate_fast(e,h),s=e.next_out,i=e.output,c=e.avail_out,o=e.next_in,n=e.input,a=e.avail_in,l=r.hold,u=r.bits,r.mode===TYPE&&(r.back=-1);break}for(r.back=0;g=(T=r.lencode[l&(1<<r.lenbits)-1])>>>16&255,_=65535&T,!((v=T>>>24)<=u);){if(0===a)break e;a--,l+=n[o++]<<u,u+=8}if(g&&0==(240&g)){for(y=v,b=g,w=_;g=(T=r.lencode[w+((l&(1<<y+b)-1)>>y)])>>>16&255,_=65535&T,!(y+(v=T>>>24)<=u);){if(0===a)break e;a--,l+=n[o++]<<u,u+=8}l>>>=y,u-=y,r.back+=y}if(l>>>=v,u-=v,r.back+=v,r.length=_,0===g){r.mode=LIT;break}if(32&g){r.back=-1,r.mode=TYPE;break}if(64&g){e.msg="invalid literal/length code",r.mode=BAD;break}r.extra=15&g,r.mode=LENEXT;case LENEXT:if(r.extra){for(C=r.extra;u<C;){if(0===a)break e;a--,l+=n[o++]<<u,u+=8}r.length+=l&(1<<r.extra)-1,l>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=DIST;case DIST:for(;g=(T=r.distcode[l&(1<<r.distbits)-1])>>>16&255,_=65535&T,!((v=T>>>24)<=u);){if(0===a)break e;a--,l+=n[o++]<<u,u+=8}if(0==(240&g)){for(y=v,b=g,w=_;g=(T=r.distcode[w+((l&(1<<y+b)-1)>>y)])>>>16&255,_=65535&T,!(y+(v=T>>>24)<=u);){if(0===a)break e;a--,l+=n[o++]<<u,u+=8}l>>>=y,u-=y,r.back+=y}if(l>>>=v,u-=v,r.back+=v,64&g){e.msg="invalid distance code",r.mode=BAD;break}r.offset=_,r.extra=15&g,r.mode=DISTEXT;case DISTEXT:if(r.extra){for(C=r.extra;u<C;){if(0===a)break e;a--,l+=n[o++]<<u,u+=8}r.offset+=l&(1<<r.extra)-1,l>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=BAD;break}r.mode=MATCH;case MATCH:if(0===c)break e;if(f=h-c,r.offset>f){if((f=r.offset-f)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=BAD;break}f>r.wnext?(f-=r.wnext,p=r.wsize-f):p=r.wnext-f,f>r.length&&(f=r.length),m=r.window}else m=i,p=s-r.offset,f=r.length;f>c&&(f=c),c-=f,r.length-=f;do{i[s++]=m[p++]}while(--f);0===r.length&&(r.mode=LEN);break;case LIT:if(0===c)break e;i[s++]=r.length,c--,r.mode=LEN;break;case CHECK:if(r.wrap){for(;u<32;){if(0===a)break e;a--,l|=n[o++]<<u,u+=8}if(h-=c,e.total_out+=h,r.total+=h,h&&(e.adler=r.check=r.flags?crc32(r.check,i,h,s-h):adler32(r.check,i,h,s-h)),h=c,(r.flags?l:zswap32(l))!==r.check){e.msg="incorrect data check",r.mode=BAD;break}l=0,u=0}r.mode=LENGTH;case LENGTH:if(r.wrap&&r.flags){for(;u<32;){if(0===a)break e;a--,l+=n[o++]<<u,u+=8}if(l!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=BAD;break}l=0,u=0}r.mode=DONE;case DONE:S=Z_STREAM_END$1;break e;case BAD:S=Z_DATA_ERROR$1;break e;case MEM:return Z_MEM_ERROR;default:return Z_STREAM_ERROR$1}return e.next_out=s,e.avail_out=c,e.next_in=o,e.avail_in=a,r.hold=l,r.bits=u,(r.wsize||h!==e.avail_out&&r.mode<BAD&&(r.mode<CHECK||t!==Z_FINISH$1))&&updatewindow(e,e.output,e.next_out,h-e.avail_out)?(r.mode=MEM,Z_MEM_ERROR):(d-=e.avail_in,h-=e.avail_out,e.total_in+=d,e.total_out+=h,r.total+=h,r.wrap&&h&&(e.adler=r.check=r.flags?crc32(r.check,i,h,e.next_out-h):adler32(r.check,i,h,e.next_out-h)),e.data_type=r.bits+(r.last?64:0)+(r.mode===TYPE?128:0)+(r.mode===LEN_||r.mode===COPY_?256:0),(0===d&&0===h||t===Z_FINISH$1)&&S===Z_OK$1&&(S=Z_BUF_ERROR$1),S)}function inflateEnd(e){if(!e||!e.state)return Z_STREAM_ERROR$1;var t=e.state;return t.window&&(t.window=null),e.state=null,Z_OK$1}function inflateGetHeader(e,t){var r;return e&&e.state?0==(2&(r=e.state).wrap)?Z_STREAM_ERROR$1:(r.head=t,t.done=!1,Z_OK$1):Z_STREAM_ERROR$1}function inflateSetDictionary(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&r.mode!==DICT?Z_STREAM_ERROR$1:r.mode===DICT&&adler32(1,t,n,0)!==r.check?Z_DATA_ERROR$1:updatewindow(e,t,n,n)?(r.mode=MEM,Z_MEM_ERROR):(r.havedict=1,Z_OK$1):Z_STREAM_ERROR$1}var inflateInfo="pako inflate (from Nodeca project)",NONE=0,DEFLATE=1,INFLATE=2,GZIP=3,GUNZIP=4,DEFLATERAW=5,INFLATERAW=6,UNZIP=7,Z_NO_FLUSH=0,Z_PARTIAL_FLUSH=1,Z_SYNC_FLUSH=2,Z_FULL_FLUSH=3,Z_FINISH=4,Z_BLOCK=5,Z_TREES=6,Z_OK=0,Z_STREAM_END=1,Z_NEED_DICT=2,Z_ERRNO=-1,Z_STREAM_ERROR=-2,Z_DATA_ERROR=-3,Z_BUF_ERROR=-5,Z_NO_COMPRESSION=0,Z_BEST_SPEED=1,Z_BEST_COMPRESSION=9,Z_DEFAULT_COMPRESSION=-1,Z_FILTERED=1,Z_HUFFMAN_ONLY=2,Z_RLE=3,Z_FIXED=4,Z_DEFAULT_STRATEGY=0,Z_BINARY=0,Z_TEXT=1,Z_UNKNOWN=2,Z_DEFLATED=8,status;function Zlib$1(e){if(e<DEFLATE||e>UNZIP)throw new TypeError("Bad argument");this.mode=e,this.init_done=!1,this.write_in_progress=!1,this.pending_close=!1,this.windowBits=0,this.level=0,this.memLevel=0,this.strategy=0,this.dictionary=null}function bufferSet(e,t){for(var r=0;r<e.length;r++)this[t+r]=e[r]}Zlib$1.prototype.init=function(e,t,r,n,i){var o;switch(this.windowBits=e,this.level=t,this.memLevel=r,this.strategy=n,this.mode!==GZIP&&this.mode!==GUNZIP||(this.windowBits+=16),this.mode===UNZIP&&(this.windowBits+=32),this.mode!==DEFLATERAW&&this.mode!==INFLATERAW||(this.windowBits=-this.windowBits),this.strm=new ZStream,this.mode){case DEFLATE:case GZIP:case DEFLATERAW:o=deflateInit2(this.strm,this.level,Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case INFLATE:case GUNZIP:case INFLATERAW:case UNZIP:o=inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}o===Z_OK?(this.write_in_progress=!1,this.init_done=!0):this._error(o)},Zlib$1.prototype.params=function(){throw new Error("deflateParams Not supported")},Zlib$1.prototype._writeCheck=function(){if(!this.init_done)throw new Error("write before init");if(this.mode===NONE)throw new Error("already finalized");if(this.write_in_progress)throw new Error("write already in progress");if(this.pending_close)throw new Error("close is pending")},Zlib$1.prototype.write=function(e,t,r,n,i,o,s){this._writeCheck(),this.write_in_progress=!0;var a=this;return browser$1$1.nextTick((function(){a.write_in_progress=!1;var c=a._write(e,t,r,n,i,o,s);a.callback(c[0],c[1]),a.pending_close&&a.close()})),this},Zlib$1.prototype.writeSync=function(e,t,r,n,i,o,s){return this._writeCheck(),this._write(e,t,r,n,i,o,s)},Zlib$1.prototype._write=function(e,t,r,n,i,o,s){if(this.write_in_progress=!0,e!==Z_NO_FLUSH&&e!==Z_PARTIAL_FLUSH&&e!==Z_SYNC_FLUSH&&e!==Z_FULL_FLUSH&&e!==Z_FINISH&&e!==Z_BLOCK)throw new Error("Invalid flush value");null==t&&(t=new Buffer$4(0),n=0,r=0),i._set?i.set=i._set:i.set=bufferSet;var a,c=this.strm;switch(c.avail_in=n,c.input=t,c.next_in=r,c.avail_out=s,c.output=i,c.next_out=o,this.mode){case DEFLATE:case GZIP:case DEFLATERAW:a=deflate$1(c,e);break;case UNZIP:case INFLATE:case GUNZIP:case INFLATERAW:a=inflate$1(c,e);break;default:throw new Error("Unknown mode "+this.mode)}return this._checkError(a,c,e)||this._error(a),this.write_in_progress=!1,[c.avail_in,c.avail_out]},Zlib$1.prototype._checkError=function(e,t,r){switch(e){case Z_OK:case Z_BUF_ERROR:if(0!==t.avail_out&&r===Z_FINISH)return!1;break;case Z_STREAM_END:break;default:return!1}return!0},Zlib$1.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,this.mode===DEFLATE||this.mode===GZIP||this.mode===DEFLATERAW?deflateEnd(this.strm):inflateEnd(this.strm),this.mode=NONE)},Zlib$1.prototype.reset=function(){switch(this.mode){case DEFLATE:case DEFLATERAW:status=deflateReset(this.strm);break;case INFLATE:case INFLATERAW:status=inflateReset(this.strm)}status!==Z_OK&&this._error(status)},Zlib$1.prototype._error=function(e){this.onerror(msg[e]+": "+this.strm.msg,e),this.write_in_progress=!1,this.pending_close&&this.close()};var _binding=Object.freeze({__proto__:null,NONE:NONE,DEFLATE:DEFLATE,INFLATE:INFLATE,GZIP:GZIP,GUNZIP:GUNZIP,DEFLATERAW:DEFLATERAW,INFLATERAW:INFLATERAW,UNZIP:UNZIP,Z_NO_FLUSH:Z_NO_FLUSH,Z_PARTIAL_FLUSH:Z_PARTIAL_FLUSH,Z_SYNC_FLUSH:Z_SYNC_FLUSH,Z_FULL_FLUSH:Z_FULL_FLUSH,Z_FINISH:Z_FINISH,Z_BLOCK:Z_BLOCK,Z_TREES:Z_TREES,Z_OK:Z_OK,Z_STREAM_END:Z_STREAM_END,Z_NEED_DICT:Z_NEED_DICT,Z_ERRNO:Z_ERRNO,Z_STREAM_ERROR:Z_STREAM_ERROR,Z_DATA_ERROR:Z_DATA_ERROR,Z_BUF_ERROR:Z_BUF_ERROR,Z_NO_COMPRESSION:Z_NO_COMPRESSION,Z_BEST_SPEED:Z_BEST_SPEED,Z_BEST_COMPRESSION:Z_BEST_COMPRESSION,Z_DEFAULT_COMPRESSION:Z_DEFAULT_COMPRESSION,Z_FILTERED:Z_FILTERED,Z_HUFFMAN_ONLY:Z_HUFFMAN_ONLY,Z_RLE:Z_RLE,Z_FIXED:Z_FIXED,Z_DEFAULT_STRATEGY:Z_DEFAULT_STRATEGY,Z_BINARY:Z_BINARY,Z_TEXT:Z_TEXT,Z_UNKNOWN:Z_UNKNOWN,Z_DEFLATED:Z_DEFLATED,Zlib:Zlib$1});function assert$1(e,t){if(!e)throw new Error(t)}var binding={};Object.keys(_binding).forEach((function(e){binding[e]=_binding[e]})),binding.Z_MIN_WINDOWBITS=8,binding.Z_MAX_WINDOWBITS=15,binding.Z_DEFAULT_WINDOWBITS=15,binding.Z_MIN_CHUNK=64,binding.Z_MAX_CHUNK=1/0,binding.Z_DEFAULT_CHUNK=16384,binding.Z_MIN_MEMLEVEL=1,binding.Z_MAX_MEMLEVEL=9,binding.Z_DEFAULT_MEMLEVEL=8,binding.Z_MIN_LEVEL=-1,binding.Z_MAX_LEVEL=9,binding.Z_DEFAULT_LEVEL=binding.Z_DEFAULT_COMPRESSION;var codes={Z_OK:binding.Z_OK,Z_STREAM_END:binding.Z_STREAM_END,Z_NEED_DICT:binding.Z_NEED_DICT,Z_ERRNO:binding.Z_ERRNO,Z_STREAM_ERROR:binding.Z_STREAM_ERROR,Z_DATA_ERROR:binding.Z_DATA_ERROR,Z_MEM_ERROR:binding.Z_MEM_ERROR,Z_BUF_ERROR:binding.Z_BUF_ERROR,Z_VERSION_ERROR:binding.Z_VERSION_ERROR};function createDeflate(e){return new Deflate(e)}function createInflate(e){return new Inflate(e)}function createDeflateRaw(e){return new DeflateRaw(e)}function createInflateRaw(e){return new InflateRaw(e)}function createGzip(e){return new Gzip(e)}function createGunzip(e){return new Gunzip(e)}function createUnzip(e){return new Unzip(e)}function deflate(e,t,r){return"function"==typeof t&&(r=t,t={}),zlibBuffer(new Deflate(t),e,r)}function deflateSync(e,t){return zlibBufferSync(new Deflate(t),e)}function gzip(e,t,r){return"function"==typeof t&&(r=t,t={}),zlibBuffer(new Gzip(t),e,r)}function gzipSync(e,t){return zlibBufferSync(new Gzip(t),e)}function deflateRaw(e,t,r){return"function"==typeof t&&(r=t,t={}),zlibBuffer(new DeflateRaw(t),e,r)}function deflateRawSync(e,t){return zlibBufferSync(new DeflateRaw(t),e)}function unzip(e,t,r){return"function"==typeof t&&(r=t,t={}),zlibBuffer(new Unzip(t),e,r)}function unzipSync(e,t){return zlibBufferSync(new Unzip(t),e)}function inflate(e,t,r){return"function"==typeof t&&(r=t,t={}),zlibBuffer(new Inflate(t),e,r)}function inflateSync(e,t){return zlibBufferSync(new Inflate(t),e)}function gunzip(e,t,r){return"function"==typeof t&&(r=t,t={}),zlibBuffer(new Gunzip(t),e,r)}function gunzipSync(e,t){return zlibBufferSync(new Gunzip(t),e)}function inflateRaw(e,t,r){return"function"==typeof t&&(r=t,t={}),zlibBuffer(new InflateRaw(t),e,r)}function inflateRawSync(e,t){return zlibBufferSync(new InflateRaw(t),e)}function zlibBuffer(e,t,r){var n=[],i=0;function o(){for(var t;null!==(t=e.read());)n.push(t),i+=t.length;e.once("readable",o)}function s(){var t=Buffer$4.concat(n,i);n=[],r(null,t),e.close()}e.on("error",(function(t){e.removeListener("end",s),e.removeListener("readable",o),r(t)})),e.on("end",s),e.end(t),o()}function zlibBufferSync(e,t){if("string"==typeof t&&(t=new Buffer$4(t)),!Buffer$4.isBuffer(t))throw new TypeError("Not a string or buffer");var r=binding.Z_FINISH;return e._processChunk(t,r)}function Deflate(e){if(!(this instanceof Deflate))return new Deflate(e);Zlib.call(this,e,binding.DEFLATE)}function Inflate(e){if(!(this instanceof Inflate))return new Inflate(e);Zlib.call(this,e,binding.INFLATE)}function Gzip(e){if(!(this instanceof Gzip))return new Gzip(e);Zlib.call(this,e,binding.GZIP)}function Gunzip(e){if(!(this instanceof Gunzip))return new Gunzip(e);Zlib.call(this,e,binding.GUNZIP)}function DeflateRaw(e){if(!(this instanceof DeflateRaw))return new DeflateRaw(e);Zlib.call(this,e,binding.DEFLATERAW)}function InflateRaw(e){if(!(this instanceof InflateRaw))return new InflateRaw(e);Zlib.call(this,e,binding.INFLATERAW)}function Unzip(e){if(!(this instanceof Unzip))return new Unzip(e);Zlib.call(this,e,binding.UNZIP)}function Zlib(e,t){if(this._opts=e=e||{},this._chunkSize=e.chunkSize||binding.Z_DEFAULT_CHUNK,Transform.call(this,e),e.flush&&e.flush!==binding.Z_NO_FLUSH&&e.flush!==binding.Z_PARTIAL_FLUSH&&e.flush!==binding.Z_SYNC_FLUSH&&e.flush!==binding.Z_FULL_FLUSH&&e.flush!==binding.Z_FINISH&&e.flush!==binding.Z_BLOCK)throw new Error("Invalid flush flag: "+e.flush);if(this._flushFlag=e.flush||binding.Z_NO_FLUSH,e.chunkSize&&(e.chunkSize<binding.Z_MIN_CHUNK||e.chunkSize>binding.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+e.chunkSize);if(e.windowBits&&(e.windowBits<binding.Z_MIN_WINDOWBITS||e.windowBits>binding.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+e.windowBits);if(e.level&&(e.level<binding.Z_MIN_LEVEL||e.level>binding.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+e.level);if(e.memLevel&&(e.memLevel<binding.Z_MIN_MEMLEVEL||e.memLevel>binding.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+e.memLevel);if(e.strategy&&e.strategy!=binding.Z_FILTERED&&e.strategy!=binding.Z_HUFFMAN_ONLY&&e.strategy!=binding.Z_RLE&&e.strategy!=binding.Z_FIXED&&e.strategy!=binding.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+e.strategy);if(e.dictionary&&!Buffer$4.isBuffer(e.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._binding=new binding.Zlib(t);var r=this;this._hadError=!1,this._binding.onerror=function(e,t){r._binding=null,r._hadError=!0;var n=new Error(e);n.errno=t,n.code=codes[t],r.emit("error",n)};var n=binding.Z_DEFAULT_COMPRESSION;"number"==typeof e.level&&(n=e.level);var i=binding.Z_DEFAULT_STRATEGY;"number"==typeof e.strategy&&(i=e.strategy),this._binding.init(e.windowBits||binding.Z_DEFAULT_WINDOWBITS,n,e.memLevel||binding.Z_DEFAULT_MEMLEVEL,i,e.dictionary),this._buffer=new Buffer$4(this._chunkSize),this._offset=0,this._closed=!1,this._level=n,this._strategy=i,this.once("end",this.close)}Object.keys(codes).forEach((function(e){codes[codes[e]]=e})),inherits$4(Zlib,Transform),Zlib.prototype.params=function(e,t,r){if(e<binding.Z_MIN_LEVEL||e>binding.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+e);if(t!=binding.Z_FILTERED&&t!=binding.Z_HUFFMAN_ONLY&&t!=binding.Z_RLE&&t!=binding.Z_FIXED&&t!=binding.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+t);if(this._level!==e||this._strategy!==t){var n=this;this.flush(binding.Z_SYNC_FLUSH,(function(){n._binding.params(e,t),n._hadError||(n._level=e,n._strategy=t,r&&r())}))}else browser$1$1.nextTick(r)},Zlib.prototype.reset=function(){return this._binding.reset()},Zlib.prototype._flush=function(e){this._transform(new Buffer$4(0),"",e)},Zlib.prototype.flush=function(e,t){var r=this._writableState;if(("function"==typeof e||void 0===e&&!t)&&(t=e,e=binding.Z_FULL_FLUSH),r.ended)t&&browser$1$1.nextTick(t);else if(r.ending)t&&this.once("end",t);else if(r.needDrain){var n=this;this.once("drain",(function(){n.flush(t)}))}else this._flushFlag=e,this.write(new Buffer$4(0),"",t)},Zlib.prototype.close=function(e){if(e&&browser$1$1.nextTick(e),!this._closed){this._closed=!0,this._binding.close();var t=this;browser$1$1.nextTick((function(){t.emit("close")}))}},Zlib.prototype._transform=function(e,t,r){var n,i=this._writableState,o=(i.ending||i.ended)&&(!e||i.length===e.length);if(null===!e&&!Buffer$4.isBuffer(e))return r(new Error("invalid input"));o?n=binding.Z_FINISH:(n=this._flushFlag,e.length>=i.length&&(this._flushFlag=this._opts.flush||binding.Z_NO_FLUSH)),this._processChunk(e,n,r)},Zlib.prototype._processChunk=function(e,t,r){var n=e&&e.length,i=this._chunkSize-this._offset,o=0,s=this,a="function"==typeof r;if(!a){var c,l=[],u=0;this.on("error",(function(e){c=e}));do{var d=this._binding.writeSync(t,e,o,n,this._buffer,this._offset,i)}while(!this._hadError&&p(d[0],d[1]));if(this._hadError)throw c;var h=Buffer$4.concat(l,u);return this.close(),h}var f=this._binding.write(t,e,o,n,this._buffer,this._offset,i);function p(c,d){if(!s._hadError){var h=i-d;if(assert$1(h>=0,"have should not go down"),h>0){var f=s._buffer.slice(s._offset,s._offset+h);s._offset+=h,a?s.push(f):(l.push(f),u+=f.length)}if((0===d||s._offset>=s._chunkSize)&&(i=s._chunkSize,s._offset=0,s._buffer=new Buffer$4(s._chunkSize)),0===d){if(o+=n-c,n=c,!a)return!0;var m=s._binding.write(t,e,o,n,s._buffer,s._offset,s._chunkSize);return m.callback=p,void(m.buffer=e)}if(!a)return!1;r()}}f.buffer=e,f.callback=p},inherits$4(Deflate,Zlib),inherits$4(Inflate,Zlib),inherits$4(Gzip,Zlib),inherits$4(Gunzip,Zlib),inherits$4(DeflateRaw,Zlib),inherits$4(InflateRaw,Zlib),inherits$4(Unzip,Zlib);var _polyfillNode_zlib={codes:codes,createDeflate:createDeflate,createInflate:createInflate,createDeflateRaw:createDeflateRaw,createInflateRaw:createInflateRaw,createGzip:createGzip,createGunzip:createGunzip,createUnzip:createUnzip,deflate:deflate,deflateSync:deflateSync,gzip:gzip,gzipSync:gzipSync,deflateRaw:deflateRaw,deflateRawSync:deflateRawSync,unzip:unzip,unzipSync:unzipSync,inflate:inflate,inflateSync:inflateSync,gunzip:gunzip,gunzipSync:gunzipSync,inflateRaw:inflateRaw,inflateRawSync:inflateRawSync,Deflate:Deflate,Inflate:Inflate,Gzip:Gzip,Gunzip:Gunzip,DeflateRaw:DeflateRaw,InflateRaw:InflateRaw,Unzip:Unzip,Zlib:Zlib},_polyfillNode_zlib$1=Object.freeze({__proto__:null,codes:codes,createDeflate:createDeflate,createInflate:createInflate,createDeflateRaw:createDeflateRaw,createInflateRaw:createInflateRaw,createGzip:createGzip,createGunzip:createGunzip,createUnzip:createUnzip,deflate:deflate,deflateSync:deflateSync,gzip:gzip,gzipSync:gzipSync,deflateRaw:deflateRaw,deflateRawSync:deflateRawSync,unzip:unzip,unzipSync:unzipSync,inflate:inflate,inflateSync:inflateSync,gunzip:gunzip,gunzipSync:gunzipSync,inflateRaw:inflateRaw,inflateRawSync:inflateRawSync,Deflate:Deflate,Inflate:Inflate,Gzip:Gzip,Gunzip:Gunzip,DeflateRaw:DeflateRaw,InflateRaw:InflateRaw,Unzip:Unzip,Zlib:Zlib,default:_polyfillNode_zlib}),require$$0=getAugmentedNamespace(_polyfillNode_zlib$1),bufferUtil={exports:{}},constants$3,hasRequiredConstants$3;function requireConstants$3(){if(hasRequiredConstants$3)return constants$3;hasRequiredConstants$3=1;var e=["nodebuffer","arraybuffer","fragments"],t="undefined"!=typeof Blob;return t&&e.push("blob"),constants$3={BINARY_TYPES:e,EMPTY_BUFFER:Buffer$4.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:t,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:function(){}}}var bufferUtil_1=bufferUtil.exports,hasRequiredBufferUtil,limiter,hasRequiredLimiter,permessageDeflate,hasRequiredPermessageDeflate;function requireBufferUtil(){if(hasRequiredBufferUtil)return bufferUtil.exports;hasRequiredBufferUtil=1;var e=requireConstants$3().EMPTY_BUFFER,t=Buffer$4[Symbol.species];function r(e,t,r,n,i){for(var o=0;o<i;o++)r[n+o]=e[o]^t[3&o]}function n(e,t){for(var r=0;r<e.length;r++)e[r]^=t[3&r]}if(bufferUtil.exports={concat:function(r,n){if(0===r.length)return e;if(1===r.length)return r[0];for(var i=Buffer$4.allocUnsafe(n),o=0,s=0;s<r.length;s++){var a=r[s];i.set(a,o),o+=a.length}return o<n?new t(i.buffer,i.byteOffset,o):i},mask:r,toArrayBuffer:function(e){return e.length===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.length)},toBuffer:function e(r){return e.readOnly=!0,Buffer$4.isBuffer(r)?r:(r instanceof ArrayBuffer?n=new t(r):ArrayBuffer.isView(r)?n=new t(r.buffer,r.byteOffset,r.byteLength):(n=Buffer$4.from(r),e.readOnly=!1),n);var n},unmask:n},!browser$1$1.env.WS_NO_BUFFER_UTIL)try{var i=require("bufferutil");bufferUtil.exports.mask=function(e,t,n,o,s){s<48?r(e,t,n,o,s):i.mask(e,t,n,o,s)},bufferUtil.exports.unmask=function(e,t){e.length<32?n(e,t):i.unmask(e,t)}}catch(e){}return bufferUtil.exports}function requireLimiter(){if(hasRequiredLimiter)return limiter;hasRequiredLimiter=1;var e=Symbol("kDone"),t=Symbol("kRun");return limiter=function(){function r(n){var i=this;_classCallCheck(this,r),this[e]=function(){i.pending--,i[t]()},this.concurrency=n||1/0,this.jobs=[],this.pending=0}return _createClass(r,[{key:"add",value:function(e){this.jobs.push(e),this[t]()}},{key:t,value:function(){if(this.pending!==this.concurrency&&this.jobs.length){var t=this.jobs.shift();this.pending++,t(this[e])}}}]),r}()}function requirePermessageDeflate(){if(hasRequiredPermessageDeflate)return permessageDeflate;hasRequiredPermessageDeflate=1;var e,t=require$$0,r=requireBufferUtil(),n=requireLimiter(),i=requireConstants$3().kStatusCode,o=Buffer$4[Symbol.species],s=Buffer$4.from([0,0,255,255]),a=Symbol("permessage-deflate"),c=Symbol("total-length"),l=Symbol("callback"),u=Symbol("buffers"),d=Symbol("error"),h=function(){function i(t,r,o){if(_classCallCheck(this,i),this._maxPayload=0|o,this._options=t||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!r,this._deflate=null,this._inflate=null,this.params=null,!e){var s=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;e=new n(s)}}return _createClass(i,[{key:"offer",value:function(){var e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}},{key:"accept",value:function(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}},{key:"cleanup",value:function(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){var e=this._deflate[l];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}},{key:"acceptAsServer",value:function(e){var t=this._options,r=e.find((function(e){return!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits)}));if(!r)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(r.server_no_context_takeover=!0),t.clientNoContextTakeover&&(r.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(r.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?r.client_max_window_bits=t.clientMaxWindowBits:!0!==r.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete r.client_max_window_bits,r}},{key:"acceptAsClient",value:function(e){var t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}},{key:"normalizeParams",value:function(e){var t=this;return e.forEach((function(e){Object.keys(e).forEach((function(r){var n=e[r];if(n.length>1)throw new Error('Parameter "'.concat(r,'" must have only a single value'));if(n=n[0],"client_max_window_bits"===r){if(!0!==n){var i=+n;if(!Number.isInteger(i)||i<8||i>15)throw new TypeError('Invalid value for parameter "'.concat(r,'": ').concat(n));n=i}else if(!t._isServer)throw new TypeError('Invalid value for parameter "'.concat(r,'": ').concat(n))}else if("server_max_window_bits"===r){var o=+n;if(!Number.isInteger(o)||o<8||o>15)throw new TypeError('Invalid value for parameter "'.concat(r,'": ').concat(n));n=o}else{if("client_no_context_takeover"!==r&&"server_no_context_takeover"!==r)throw new Error('Unknown parameter "'.concat(r,'"'));if(!0!==n)throw new TypeError('Invalid value for parameter "'.concat(r,'": ').concat(n))}e[r]=n}))})),e}},{key:"decompress",value:function(t,r,n){var i=this;e.add((function(e){i._decompress(t,r,(function(t,r){e(),n(t,r)}))}))}},{key:"compress",value:function(t,r,n){var i=this;e.add((function(e){i._compress(t,r,(function(t,r){e(),n(t,r)}))}))}},{key:"_decompress",value:function(e,n,i){var o=this,h=this._isServer?"client":"server";if(!this._inflate){var f="".concat(h,"_max_window_bits"),v="number"!=typeof this.params[f]?t.Z_DEFAULT_WINDOWBITS:this.params[f];this._inflate=t.createInflateRaw(_objectSpread2(_objectSpread2({},this._options.zlibInflateOptions),{},{windowBits:v})),this._inflate[a]=this,this._inflate[c]=0,this._inflate[u]=[],this._inflate.on("error",m),this._inflate.on("data",p)}this._inflate[l]=i,this._inflate.write(e),n&&this._inflate.write(s),this._inflate.flush((function(){var e=o._inflate[d];if(e)return o._inflate.close(),o._inflate=null,void i(e);var t=r.concat(o._inflate[u],o._inflate[c]);o._inflate._readableState.endEmitted?(o._inflate.close(),o._inflate=null):(o._inflate[c]=0,o._inflate[u]=[],n&&o.params["".concat(h,"_no_context_takeover")]&&o._inflate.reset()),i(null,t)}))}},{key:"_compress",value:function(e,n,i){var s=this,a=this._isServer?"server":"client";if(!this._deflate){var d="".concat(a,"_max_window_bits"),h="number"!=typeof this.params[d]?t.Z_DEFAULT_WINDOWBITS:this.params[d];this._deflate=t.createDeflateRaw(_objectSpread2(_objectSpread2({},this._options.zlibDeflateOptions),{},{windowBits:h})),this._deflate[c]=0,this._deflate[u]=[],this._deflate.on("data",f)}this._deflate[l]=i,this._deflate.write(e),this._deflate.flush(t.Z_SYNC_FLUSH,(function(){if(s._deflate){var e=r.concat(s._deflate[u],s._deflate[c]);n&&(e=new o(e.buffer,e.byteOffset,e.length-4)),s._deflate[l]=null,s._deflate[c]=0,s._deflate[u]=[],n&&s.params["".concat(a,"_no_context_takeover")]&&s._deflate.reset(),i(null,e)}}))}}],[{key:"extensionName",get:function(){return"permessage-deflate"}}]),i}();function f(e){this[u].push(e),this[c]+=e.length}function p(e){this[c]+=e.length,this[a]._maxPayload<1||this[c]<=this[a]._maxPayload?this[u].push(e):(this[d]=new RangeError("Max payload size exceeded"),this[d].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[d][i]=1009,this.removeListener("data",p),this.reset())}function m(e){this[a]._inflate=null,this[d]?this[l](this[d]):(e[i]=1007,this[l](e))}return permessageDeflate=h}var validation$1={exports:{}},validation=validation$1.exports,hasRequiredValidation,receiver,hasRequiredReceiver,sender,hasRequiredSender,eventTarget,hasRequiredEventTarget,extension,hasRequiredExtension,websocket,hasRequiredWebsocket,stream,hasRequiredStream,subprotocol,hasRequiredSubprotocol,websocketServer,hasRequiredWebsocketServer,ws$1,hasRequiredWs$1;function requireValidation(){if(hasRequiredValidation)return validation$1.exports;hasRequiredValidation=1;var e=require$$0$a.isUtf8,t=requireConstants$3().hasBlob;function r(e){for(var t=e.length,r=0;r<t;)if(0==(128&e[r]))r++;else if(192==(224&e[r])){if(r+1===t||128!=(192&e[r+1])||192==(254&e[r]))return!1;r+=2}else if(224==(240&e[r])){if(r+2>=t||128!=(192&e[r+1])||128!=(192&e[r+2])||224===e[r]&&128==(224&e[r+1])||237===e[r]&&160==(224&e[r+1]))return!1;r+=3}else{if(240!=(248&e[r]))return!1;if(r+3>=t||128!=(192&e[r+1])||128!=(192&e[r+2])||128!=(192&e[r+3])||240===e[r]&&128==(240&e[r+1])||244===e[r]&&e[r+1]>143||e[r]>244)return!1;r+=4}return!0}if(validation$1.exports={isBlob:function(e){return t&&"object"===_typeof(e)&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&("Blob"===e[Symbol.toStringTag]||"File"===e[Symbol.toStringTag])},isValidStatusCode:function(e){return e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},isValidUTF8:r,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},e)validation$1.exports.isValidUTF8=function(t){return t.length<24?r(t):e(t)};else if(!browser$1$1.env.WS_NO_UTF_8_VALIDATE)try{var n=require("utf-8-validate");validation$1.exports.isValidUTF8=function(e){return e.length<32?r(e):n(e)}}catch(e){}return validation$1.exports}function requireReceiver(){if(hasRequiredReceiver)return receiver;hasRequiredReceiver=1;var e=require$$1$5.Writable,t=requirePermessageDeflate(),r=requireConstants$3(),n=r.BINARY_TYPES,i=r.EMPTY_BUFFER,o=r.kStatusCode,s=r.kWebSocket,a=requireBufferUtil(),c=a.concat,l=a.toArrayBuffer,u=a.unmask,d=requireValidation(),h=d.isValidStatusCode,f=d.isValidUTF8,p=Buffer$4[Symbol.species],m=function(e){function r(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,r),(e=_callSuper(this,r))._allowSynchronousEvents=void 0===t.allowSynchronousEvents||t.allowSynchronousEvents,e._binaryType=t.binaryType||n[0],e._extensions=t.extensions||{},e._isServer=!!t.isServer,e._maxPayload=0|t.maxPayload,e._skipUTF8Validation=!!t.skipUTF8Validation,e[s]=void 0,e._bufferedBytes=0,e._buffers=[],e._compressed=!1,e._payloadLength=0,e._mask=void 0,e._fragmented=0,e._masked=!1,e._fin=!1,e._opcode=0,e._totalPayloadLength=0,e._messageLength=0,e._fragments=[],e._errored=!1,e._loop=!1,e._state=0,e}return _inherits(r,e),_createClass(r,[{key:"_write",value:function(e,t,r){if(8===this._opcode&&0==this._state)return r();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(r)}},{key:"consume",value:function(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){var t=this._buffers[0];return this._buffers[0]=new p(t.buffer,t.byteOffset+e,t.length-e),new p(t.buffer,t.byteOffset,e)}var r=Buffer$4.allocUnsafe(e);do{var n=this._buffers[0],i=r.length-e;e>=n.length?r.set(this._buffers.shift(),i):(r.set(new Uint8Array(n.buffer,n.byteOffset,e),i),this._buffers[0]=new p(n.buffer,n.byteOffset+e,n.length-e)),e-=n.length}while(e>0);return r}},{key:"startLoop",value:function(e){this._loop=!0;do{switch(this._state){case 0:this.getInfo(e);break;case 1:this.getPayloadLength16(e);break;case 2:this.getPayloadLength64(e);break;case 3:this.getMask();break;case 4:this.getData(e);break;case 5:case 6:return void(this._loop=!1)}}while(this._loop);this._errored||e()}},{key:"getInfo",value:function(e){if(this._bufferedBytes<2)this._loop=!1;else{var r=this.consume(2);if(0==(48&r[0])){var n=64==(64&r[0]);if(!n||this._extensions[t.extensionName]){if(this._fin=128==(128&r[0]),this._opcode=15&r[0],this._payloadLength=127&r[1],0===this._opcode){if(n)return void e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(!this._fragmented)return void e(this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE"));this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return void e(this.createError(RangeError,"invalid opcode ".concat(this._opcode),!0,1002,"WS_ERR_INVALID_OPCODE"));this._compressed=n}else{if(!(this._opcode>7&&this._opcode<11))return void e(this.createError(RangeError,"invalid opcode ".concat(this._opcode),!0,1002,"WS_ERR_INVALID_OPCODE"));if(!this._fin)return void e(this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN"));if(n)return void e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength)return void e(this.createError(RangeError,"invalid payload length ".concat(this._payloadLength),!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH"))}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=128==(128&r[1]),this._isServer){if(!this._masked)return void e(this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK"))}else if(this._masked){return void e(this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK"))}126===this._payloadLength?this._state=1:127===this._payloadLength?this._state=2:this.haveLength(e)}else{e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"))}}else{e(this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3"))}}}},{key:"getPayloadLength16",value:function(e){this._bufferedBytes<2?this._loop=!1:(this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e))}},{key:"getPayloadLength64",value:function(e){if(this._bufferedBytes<8)this._loop=!1;else{var t=this.consume(8),r=t.readUInt32BE(0);if(r>Math.pow(2,21)-1)e(this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH"));else this._payloadLength=r*Math.pow(2,32)+t.readUInt32BE(4),this.haveLength(e)}}},{key:"haveLength",value:function(e){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return void e(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._masked?this._state=3:this._state=4}},{key:"getMask",value:function(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=4)}},{key:"getData",value:function(e){var t=i;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&0!=(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])&&u(t,this._mask)}if(this._opcode>7)this.controlMessage(t,e);else{if(this._compressed)return this._state=5,void this.decompress(t,e);t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage(e)}}},{key:"decompress",value:function(e,r){var n=this;this._extensions[t.extensionName].decompress(e,this._fin,(function(e,t){if(e)return r(e);if(t.length){if(n._messageLength+=t.length,n._messageLength>n._maxPayload&&n._maxPayload>0){var i=n.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");return void r(i)}n._fragments.push(t)}n.dataMessage(r),0===n._state&&n.startLoop(r)}))}},{key:"dataMessage",value:function(e){var t=this;if(this._fin){var r=this._messageLength,n=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){var i;i="nodebuffer"===this._binaryType?c(n,r):"arraybuffer"===this._binaryType?l(c(n,r)):"blob"===this._binaryType?new Blob(n):n,this._allowSynchronousEvents?(this.emit("message",i,!0),this._state=0):(this._state=6,setImmediate((function(){t.emit("message",i,!0),t._state=0,t.startLoop(e)})))}else{var o=c(n,r);if(!this._skipUTF8Validation&&!f(o)){var s=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");return void e(s)}5===this._state||this._allowSynchronousEvents?(this.emit("message",o,!1),this._state=0):(this._state=6,setImmediate((function(){t.emit("message",o,!1),t._state=0,t.startLoop(e)})))}}else this._state=0}},{key:"controlMessage",value:function(e,t){var r=this;if(8!==this._opcode)this._allowSynchronousEvents?(this.emit(9===this._opcode?"ping":"pong",e),this._state=0):(this._state=6,setImmediate((function(){r.emit(9===r._opcode?"ping":"pong",e),r._state=0,r.startLoop(t)})));else{if(0===e.length)this._loop=!1,this.emit("conclude",1005,i),this.end();else{var n=e.readUInt16BE(0);if(!h(n)){var o=this.createError(RangeError,"invalid status code ".concat(n),!0,1002,"WS_ERR_INVALID_CLOSE_CODE");return void t(o)}var s=new p(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!f(s)){var a=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");return void t(a)}this._loop=!1,this.emit("conclude",n,s),this.end()}this._state=0}}},{key:"createError",value:function(e,t,r,n,i){this._loop=!1,this._errored=!0;var s=new e(r?"Invalid WebSocket frame: ".concat(t):t);return Error.captureStackTrace(s,this.createError),s.code=i,s[o]=n,s}}]),r}(e);return receiver=m}function requireSender(){if(hasRequiredSender)return sender;hasRequiredSender=1;require$$1$5.Duplex;var e,t=require$$3$1.randomFillSync,r=requirePermessageDeflate(),n=requireConstants$3(),i=n.EMPTY_BUFFER,o=n.kWebSocket,s=n.NOOP,a=requireValidation(),c=a.isBlob,l=a.isValidStatusCode,u=requireBufferUtil(),d=u.mask,h=u.toBuffer,f=Symbol("kByteLength"),p=Buffer$4.alloc(4),m=8192,v=m,g=function(){function n(e,t,r){_classCallCheck(this,n),this._extensions=t||{},r&&(this._generateMask=r,this._maskBuffer=Buffer$4.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=0,this.onerror=s,this[o]=void 0}return _createClass(n,[{key:"close",value:function(e,t,r,o){var s;if(void 0===e)s=i;else{if("number"!=typeof e||!l(e))throw new TypeError("First argument must be a valid error code number");if(void 0!==t&&t.length){var a=Buffer$4.byteLength(t);if(a>123)throw new RangeError("The message must not be greater than 123 bytes");(s=Buffer$4.allocUnsafe(2+a)).writeUInt16BE(e,0),"string"==typeof t?s.write(t,2):s.set(t,2)}else(s=Buffer$4.allocUnsafe(2)).writeUInt16BE(e,0)}var c=_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},f,s.length),"fin",!0),"generateMask",this._generateMask),"mask",r),"maskBuffer",this._maskBuffer),"opcode",8),"readOnly",!1),"rsv1",!1);0!==this._state?this.enqueue([this.dispatch,s,!1,c,o]):this.sendFrame(n.frame(s,c),o)}},{key:"ping",value:function(e,t,r){var i,o;if("string"==typeof e?(i=Buffer$4.byteLength(e),o=!1):c(e)?(i=e.size,o=!1):(i=(e=h(e)).length,o=h.readOnly),i>125)throw new RangeError("The data size must not be greater than 125 bytes");var s=_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},f,i),"fin",!0),"generateMask",this._generateMask),"mask",t),"maskBuffer",this._maskBuffer),"opcode",9),"readOnly",o),"rsv1",!1);c(e)?0!==this._state?this.enqueue([this.getBlobData,e,!1,s,r]):this.getBlobData(e,!1,s,r):0!==this._state?this.enqueue([this.dispatch,e,!1,s,r]):this.sendFrame(n.frame(e,s),r)}},{key:"pong",value:function(e,t,r){var i,o;if("string"==typeof e?(i=Buffer$4.byteLength(e),o=!1):c(e)?(i=e.size,o=!1):(i=(e=h(e)).length,o=h.readOnly),i>125)throw new RangeError("The data size must not be greater than 125 bytes");var s=_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},f,i),"fin",!0),"generateMask",this._generateMask),"mask",t),"maskBuffer",this._maskBuffer),"opcode",10),"readOnly",o),"rsv1",!1);c(e)?0!==this._state?this.enqueue([this.getBlobData,e,!1,s,r]):this.getBlobData(e,!1,s,r):0!==this._state?this.enqueue([this.dispatch,e,!1,s,r]):this.sendFrame(n.frame(e,s),r)}},{key:"send",value:function(e,t,n){var i,o,s=this._extensions[r.extensionName],a=t.binary?2:1,l=t.compress;"string"==typeof e?(i=Buffer$4.byteLength(e),o=!1):c(e)?(i=e.size,o=!1):(i=(e=h(e)).length,o=h.readOnly),this._firstFragment?(this._firstFragment=!1,l&&s&&s.params[s._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(l=i>=s._threshold),this._compress=l):(l=!1,a=0),t.fin&&(this._firstFragment=!0);var u=_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},f,i),"fin",t.fin),"generateMask",this._generateMask),"mask",t.mask),"maskBuffer",this._maskBuffer),"opcode",a),"readOnly",o),"rsv1",l);c(e)?0!==this._state?this.enqueue([this.getBlobData,e,this._compress,u,n]):this.getBlobData(e,this._compress,u,n):0!==this._state?this.enqueue([this.dispatch,e,this._compress,u,n]):this.dispatch(e,this._compress,u,n)}},{key:"getBlobData",value:function(e,t,r,i){var o=this;this._bufferedBytes+=r[f],this._state=2,e.arrayBuffer().then((function(e){if(o._socket.destroyed){var s=new Error("The socket was closed while the blob was being read");browser$1$1.nextTick(_,o,s,i)}else{o._bufferedBytes-=r[f];var a=h(e);t?o.dispatch(a,t,r,i):(o._state=0,o.sendFrame(n.frame(a,r),i),o.dequeue())}})).catch((function(e){browser$1$1.nextTick(y,o,e,i)}))}},{key:"dispatch",value:function(e,t,i,o){var s=this;if(t){var a=this._extensions[r.extensionName];this._bufferedBytes+=i[f],this._state=1,a.compress(e,i.fin,(function(e,t){if(s._socket.destroyed){var r=new Error("The socket was closed while data was being compressed");_(s,r,o)}else s._bufferedBytes-=i[f],s._state=0,i.readOnly=!1,s.sendFrame(n.frame(t,i),o),s.dequeue()}))}else this.sendFrame(n.frame(e,i),o)}},{key:"dequeue",value:function(){for(;0===this._state&&this._queue.length;){var e=this._queue.shift();this._bufferedBytes-=e[3][f],Reflect.apply(e[0],this,e.slice(1))}}},{key:"enqueue",value:function(e){this._bufferedBytes+=e[3][f],this._queue.push(e)}},{key:"sendFrame",value:function(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}],[{key:"frame",value:function(r,n){var i,o,s=!1,a=2,c=!1;n.mask&&(i=n.maskBuffer||p,n.generateMask?n.generateMask(i):(v===m&&(void 0===e&&(e=Buffer$4.alloc(m)),t(e,0,m),v=0),i[0]=e[v++],i[1]=e[v++],i[2]=e[v++],i[3]=e[v++]),c=0==(i[0]|i[1]|i[2]|i[3]),a=6),"string"==typeof r?o=n.mask&&!c||void 0===n[f]?(r=Buffer$4.from(r)).length:n[f]:(o=r.length,s=n.mask&&n.readOnly&&!c);var l=o;o>=65536?(a+=8,l=127):o>125&&(a+=2,l=126);var u=Buffer$4.allocUnsafe(s?o+a:a);return u[0]=n.fin?128|n.opcode:n.opcode,n.rsv1&&(u[0]|=64),u[1]=l,126===l?u.writeUInt16BE(o,2):127===l&&(u[2]=u[3]=0,u.writeUIntBE(o,4,6)),n.mask?(u[1]|=128,u[a-4]=i[0],u[a-3]=i[1],u[a-2]=i[2],u[a-1]=i[3],c?[u,r]:s?(d(r,i,u,a,o),[u]):(d(r,i,r,0,o),[u,r])):[u,r]}}]),n}();function _(e,t,r){"function"==typeof r&&r(t);for(var n=0;n<e._queue.length;n++){var i=e._queue[n],o=i[i.length-1];"function"==typeof o&&o(t)}}function y(e,t,r){_(e,t,r),e.onerror(t)}return sender=g}function requireEventTarget(){if(hasRequiredEventTarget)return eventTarget;hasRequiredEventTarget=1;var e=requireConstants$3(),t=e.kForOnEventAttribute,r=e.kListener,n=Symbol("kCode"),i=Symbol("kData"),o=Symbol("kError"),s=Symbol("kMessage"),a=Symbol("kReason"),c=Symbol("kTarget"),l=Symbol("kType"),u=Symbol("kWasClean"),d=function(){function e(t){_classCallCheck(this,e),this[c]=null,this[l]=t}return _createClass(e,[{key:"target",get:function(){return this[c]}},{key:"type",get:function(){return this[l]}}]),e}();Object.defineProperty(d.prototype,"target",{enumerable:!0}),Object.defineProperty(d.prototype,"type",{enumerable:!0});var h=function(e){function t(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _classCallCheck(this,t),(r=_callSuper(this,t,[e]))[n]=void 0===i.code?0:i.code,r[a]=void 0===i.reason?"":i.reason,r[u]=void 0!==i.wasClean&&i.wasClean,r}return _inherits(t,e),_createClass(t,[{key:"code",get:function(){return this[n]}},{key:"reason",get:function(){return this[a]}},{key:"wasClean",get:function(){return this[u]}}]),t}(d);Object.defineProperty(h.prototype,"code",{enumerable:!0}),Object.defineProperty(h.prototype,"reason",{enumerable:!0}),Object.defineProperty(h.prototype,"wasClean",{enumerable:!0});var f=function(e){function t(e){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _classCallCheck(this,t),(r=_callSuper(this,t,[e]))[o]=void 0===n.error?null:n.error,r[s]=void 0===n.message?"":n.message,r}return _inherits(t,e),_createClass(t,[{key:"error",get:function(){return this[o]}},{key:"message",get:function(){return this[s]}}]),t}(d);Object.defineProperty(f.prototype,"error",{enumerable:!0}),Object.defineProperty(f.prototype,"message",{enumerable:!0});var p=function(e){function t(e){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _classCallCheck(this,t),(r=_callSuper(this,t,[e]))[i]=void 0===n.data?null:n.data,r}return _inherits(t,e),_createClass(t,[{key:"data",get:function(){return this[i]}}]),t}(d);Object.defineProperty(p.prototype,"data",{enumerable:!0});var m={addEventListener:function(e,n){var i,o,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=_createForOfIteratorHelper(this.listeners(e));try{for(a.s();!(i=a.n()).done;){var l=i.value;if(!s[t]&&l[r]===n&&!l[t])return}}catch(e){a.e(e)}finally{a.f()}if("message"===e)o=function(e,t){var r=new p("message",{data:t?e:e.toString()});r[c]=this,v(n,this,r)};else if("close"===e)o=function(e,t){var r=new h("close",{code:e,reason:t.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});r[c]=this,v(n,this,r)};else if("error"===e)o=function(e){var t=new f("error",{error:e,message:e.message});t[c]=this,v(n,this,t)};else{if("open"!==e)return;o=function(){var e=new d("open");e[c]=this,v(n,this,e)}}o[t]=!!s[t],o[r]=n,s.once?this.once(e,o):this.on(e,o)},removeEventListener:function(e,n){var i,o=_createForOfIteratorHelper(this.listeners(e));try{for(o.s();!(i=o.n()).done;){var s=i.value;if(s[r]===n&&!s[t]){this.removeListener(e,s);break}}}catch(e){o.e(e)}finally{o.f()}}};function v(e,t,r){"object"===_typeof(e)&&e.handleEvent?e.handleEvent.call(e,r):e.call(t,r)}return eventTarget={CloseEvent:h,ErrorEvent:f,Event:d,EventTarget:m,MessageEvent:p}}function requireExtension(){if(hasRequiredExtension)return extension;hasRequiredExtension=1;var e=requireValidation().tokenChars;function t(e,t,r){void 0===e[t]?e[t]=[r]:e[t].push(r)}return extension={format:function(e){return Object.keys(e).map((function(t){var r=e[t];return Array.isArray(r)||(r=[r]),r.map((function(e){return[t].concat(Object.keys(e).map((function(t){var r=e[t];return Array.isArray(r)||(r=[r]),r.map((function(e){return!0===e?t:"".concat(t,"=").concat(e)})).join("; ")}))).join("; ")})).join(", ")})).join(", ")},parse:function(r){for(var n,i,o=Object.create(null),s=Object.create(null),a=!1,c=!1,l=!1,u=-1,d=-1,h=-1,f=0;f<r.length;f++)if(d=r.charCodeAt(f),void 0===n)if(-1===h&&1===e[d])-1===u&&(u=f);else if(0===f||32!==d&&9!==d){if(59!==d&&44!==d)throw new SyntaxError("Unexpected character at index ".concat(f));if(-1===u)throw new SyntaxError("Unexpected character at index ".concat(f));-1===h&&(h=f);var p=r.slice(u,h);44===d?(t(o,p,s),s=Object.create(null)):n=p,u=h=-1}else-1===h&&-1!==u&&(h=f);else if(void 0===i)if(-1===h&&1===e[d])-1===u&&(u=f);else if(32===d||9===d)-1===h&&-1!==u&&(h=f);else if(59===d||44===d){if(-1===u)throw new SyntaxError("Unexpected character at index ".concat(f));-1===h&&(h=f),t(s,r.slice(u,h),!0),44===d&&(t(o,n,s),s=Object.create(null),n=void 0),u=h=-1}else{if(61!==d||-1===u||-1!==h)throw new SyntaxError("Unexpected character at index ".concat(f));i=r.slice(u,f),u=h=-1}else if(c){if(1!==e[d])throw new SyntaxError("Unexpected character at index ".concat(f));-1===u?u=f:a||(a=!0),c=!1}else if(l)if(1===e[d])-1===u&&(u=f);else if(34===d&&-1!==u)l=!1,h=f;else{if(92!==d)throw new SyntaxError("Unexpected character at index ".concat(f));c=!0}else if(34===d&&61===r.charCodeAt(f-1))l=!0;else if(-1===h&&1===e[d])-1===u&&(u=f);else if(-1===u||32!==d&&9!==d){if(59!==d&&44!==d)throw new SyntaxError("Unexpected character at index ".concat(f));if(-1===u)throw new SyntaxError("Unexpected character at index ".concat(f));-1===h&&(h=f);var m=r.slice(u,h);a&&(m=m.replace(/\\/g,""),a=!1),t(s,i,m),44===d&&(t(o,n,s),s=Object.create(null),n=void 0),i=void 0,u=h=-1}else-1===h&&(h=f);if(-1===u||l||32===d||9===d)throw new SyntaxError("Unexpected end of input");-1===h&&(h=f);var v=r.slice(u,h);return void 0===n?t(o,v,s):(void 0===i?t(s,v,!0):t(s,i,a?v.replace(/\\/g,""):v),t(o,n,s)),o}},extension}function requireWebsocket(){if(hasRequiredWebsocket)return websocket;hasRequiredWebsocket=1;var e=require$$0$8,t=require$$1$2,r=require$$1$1,n=require$$1,i=require$$0$1,o=require$$3$1.randomBytes,s=require$$3$1.createHash,a=(require$$1$5.Duplex,require$$1$5.Readable,require$$1$3.URL),c=requirePermessageDeflate(),l=requireReceiver(),u=requireSender(),d=requireValidation().isBlob,h=requireConstants$3(),f=h.BINARY_TYPES,p=h.EMPTY_BUFFER,m=h.GUID,v=h.kForOnEventAttribute,g=h.kListener,_=h.kStatusCode,y=h.kWebSocket,b=h.NOOP,w=requireEventTarget().EventTarget,k=w.addEventListener,S=w.removeEventListener,E=requireExtension(),C=E.format,T=E.parse,P=requireBufferUtil().toBuffer,A=3e4,x=Symbol("kAborted"),B=[8,13],I=["CONNECTING","OPEN","CLOSING","CLOSED"],R=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,O=function(e){function t(e,r,n){var i;return _classCallCheck(this,t),(i=_callSuper(this,t))._binaryType=f[0],i._closeCode=1006,i._closeFrameReceived=!1,i._closeFrameSent=!1,i._closeMessage=p,i._closeTimer=null,i._errorEmitted=!1,i._extensions={},i._paused=!1,i._protocol="",i._readyState=t.CONNECTING,i._receiver=null,i._sender=null,i._socket=null,null!==e?(i._bufferedAmount=0,i._isServer=!1,i._redirects=0,void 0===r?r=[]:Array.isArray(r)||("object"===_typeof(r)&&null!==r?(n=r,r=[]):r=[r]),M(_assertThisInitialized(i),e,r,n)):(i._autoPong=n.autoPong,i._isServer=!0),i}return _inherits(t,e),_createClass(t,[{key:"binaryType",get:function(){return this._binaryType},set:function(e){f.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}},{key:"bufferedAmount",get:function(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}},{key:"extensions",get:function(){return Object.keys(this._extensions).join()}},{key:"isPaused",get:function(){return this._paused}},{key:"onclose",get:function(){return null}},{key:"onerror",get:function(){return null}},{key:"onopen",get:function(){return null}},{key:"onmessage",get:function(){return null}},{key:"protocol",get:function(){return this._protocol}},{key:"readyState",get:function(){return this._readyState}},{key:"url",get:function(){return this._url}},{key:"setSocket",value:function(e,r,n){var i=new l({allowSynchronousEvents:n.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:n.maxPayload,skipUTF8Validation:n.skipUTF8Validation}),o=new u(e,this._extensions,n.generateMask);this._receiver=i,this._sender=o,this._socket=e,i[y]=this,o[y]=this,e[y]=this,i.on("conclude",U),i.on("drain",j),i.on("error",q),i.on("message",V),i.on("ping",z),i.on("pong",H),o.onerror=K,e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),r.length>0&&e.unshift(r),e.on("close",Y),e.on("data",X),e.on("end",Q),e.on("error",J),this._readyState=t.OPEN,this.emit("open")}},{key:"emitClose",value:function(){if(!this._socket)return this._readyState=t.CLOSED,void this.emit("close",this._closeCode,this._closeMessage);this._extensions[c.extensionName]&&this._extensions[c.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=t.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}},{key:"close",value:function(e,r){var n=this;if(this.readyState!==t.CLOSED)if(this.readyState!==t.CONNECTING)this.readyState!==t.CLOSING?(this._readyState=t.CLOSING,this._sender.close(e,r,!this._isServer,(function(e){e||(n._closeFrameSent=!0,(n._closeFrameReceived||n._receiver._writableState.errorEmitted)&&n._socket.end())})),Z(this)):this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();else{F(this,this._req,"WebSocket was closed before the connection was established")}}},{key:"pause",value:function(){this.readyState!==t.CONNECTING&&this.readyState!==t.CLOSED&&(this._paused=!0,this._socket.pause())}},{key:"ping",value:function(e,r,n){if(this.readyState===t.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(n=e,e=r=void 0):"function"==typeof r&&(n=r,r=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===t.OPEN?(void 0===r&&(r=!this._isServer),this._sender.ping(e||p,r,n)):$(this,e,n)}},{key:"pong",value:function(e,r,n){if(this.readyState===t.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(n=e,e=r=void 0):"function"==typeof r&&(n=r,r=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===t.OPEN?(void 0===r&&(r=!this._isServer),this._sender.pong(e||p,r,n)):$(this,e,n)}},{key:"resume",value:function(){this.readyState!==t.CONNECTING&&this.readyState!==t.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}},{key:"send",value:function(e,r,n){if(this.readyState===t.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof r&&(n=r,r={}),"number"==typeof e&&(e=e.toString()),this.readyState===t.OPEN){var i=_objectSpread2({binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0},r);this._extensions[c.extensionName]||(i.compress=!1),this._sender.send(e||p,i,n)}else $(this,e,n)}},{key:"terminate",value:function(){if(this.readyState!==t.CLOSED)if(this.readyState!==t.CONNECTING)this._socket&&(this._readyState=t.CLOSING,this._socket.destroy());else{F(this,this._req,"WebSocket was closed before the connection was established")}}}]),t}(e);function M(e,n,i,l){var u,d=_objectSpread2(_objectSpread2({allowSynchronousEvents:!0,autoPong:!0,protocolVersion:B[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10},l),{},{socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0});if(e._autoPong=d.autoPong,!B.includes(d.protocolVersion))throw new RangeError("Unsupported protocol version: ".concat(d.protocolVersion," ")+"(supported versions: ".concat(B.join(", "),")"));if(n instanceof a)u=n;else try{u=new a(n)}catch(e){throw new SyntaxError("Invalid URL: ".concat(n))}"http:"===u.protocol?u.protocol="ws:":"https:"===u.protocol&&(u.protocol="wss:"),e._url=u.href;var h,f="wss:"===u.protocol,p="ws+unix:"===u.protocol;if("ws:"===u.protocol||f||p?p&&!u.pathname?h="The URL's pathname is empty":u.hash&&(h="The URL contains a fragment identifier"):h='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https:", or "ws+unix:"',h){var v=new SyntaxError(h);if(0===e._redirects)throw v;L(e,v)}else{var g,_,y=f?443:80,b=o(16).toString("base64"),w=f?t.request:r.request,k=new Set;if(d.createConnection=d.createConnection||(f?N:D),d.defaultPort=d.defaultPort||y,d.port=u.port||y,d.host=u.hostname.startsWith("[")?u.hostname.slice(1,-1):u.hostname,d.headers=_objectSpread2(_objectSpread2({},d.headers),{},{"Sec-WebSocket-Version":d.protocolVersion,"Sec-WebSocket-Key":b,Connection:"Upgrade",Upgrade:"websocket"}),d.path=u.pathname+u.search,d.timeout=d.handshakeTimeout,d.perMessageDeflate&&(g=new c(!0!==d.perMessageDeflate?d.perMessageDeflate:{},!1,d.maxPayload),d.headers["Sec-WebSocket-Extensions"]=C(_defineProperty({},c.extensionName,g.offer()))),i.length){var S,E=_createForOfIteratorHelper(i);try{for(E.s();!(S=E.n()).done;){var P=S.value;if("string"!=typeof P||!R.test(P)||k.has(P))throw new SyntaxError("An invalid or duplicated subprotocol was specified");k.add(P)}}catch(v){E.e(v)}finally{E.f()}d.headers["Sec-WebSocket-Protocol"]=i.join(",")}if(d.origin&&(d.protocolVersion<13?d.headers["Sec-WebSocket-Origin"]=d.origin:d.headers.Origin=d.origin),(u.username||u.password)&&(d.auth="".concat(u.username,":").concat(u.password)),p){var A=d.path.split(":");d.socketPath=A[0],d.path=A[1]}if(d.followRedirects){if(0===e._redirects){e._originalIpc=p,e._originalSecure=f,e._originalHostOrSocketPath=p?d.socketPath:u.host;var I=l&&l.headers;if(l=_objectSpread2(_objectSpread2({},l),{},{headers:{}}),I)for(var $=0,U=Object.entries(I);$<U.length;$++){var j=_slicedToArray(U[$],2),q=j[0],G=j[1];l.headers[q.toLowerCase()]=G}}else if(0===e.listenerCount("redirect")){var V=p?!!e._originalIpc&&d.socketPath===e._originalHostOrSocketPath:!e._originalIpc&&u.host===e._originalHostOrSocketPath;(!V||e._originalSecure&&!f)&&(delete d.headers.authorization,delete d.headers.cookie,V||delete d.headers.host,d.auth=void 0)}d.auth&&!l.headers.authorization&&(l.headers.authorization="Basic "+Buffer$4.from(d.auth).toString("base64")),_=e._req=w(d),e._redirects&&e.emit("redirect",e.url,_)}else _=e._req=w(d);d.timeout&&_.on("timeout",(function(){F(e,_,"Opening handshake has timed out")})),_.on("error",(function(t){null===_||_[x]||(_=e._req=null,L(e,t))})),_.on("response",(function(t){var r=t.headers.location,o=t.statusCode;if(r&&d.followRedirects&&o>=300&&o<400){if(++e._redirects>d.maxRedirects)return void F(e,_,"Maximum redirects exceeded");var s;_.abort();try{s=new a(r,n)}catch(t){var c=new SyntaxError("Invalid URL: ".concat(r));return void L(e,c)}M(e,s,i,l)}else e.emit("unexpected-response",_,t)||F(e,_,"Unexpected server response: ".concat(t.statusCode))})),_.on("upgrade",(function(t,r,n){if(e.emit("upgrade",t),e.readyState===O.CONNECTING){_=e._req=null;var i=t.headers.upgrade;if(void 0!==i&&"websocket"===i.toLowerCase()){var o=s("sha1").update(b+m).digest("base64");if(t.headers["sec-websocket-accept"]===o){var a,l=t.headers["sec-websocket-protocol"];if(void 0!==l?k.size?k.has(l)||(a="Server sent an invalid subprotocol"):a="Server sent a subprotocol but none was requested":k.size&&(a="Server sent no subprotocol"),a)F(e,r,a);else{l&&(e._protocol=l);var u=t.headers["sec-websocket-extensions"];if(void 0!==u){if(!g){return void F(e,r,"Server sent a Sec-WebSocket-Extensions header but no extension was requested")}var h;try{h=T(u)}catch(t){return void F(e,r,"Invalid Sec-WebSocket-Extensions header")}var f=Object.keys(h);if(1!==f.length||f[0]!==c.extensionName){return void F(e,r,"Server indicated an extension that was not requested")}try{g.accept(h[c.extensionName])}catch(t){return void F(e,r,"Invalid Sec-WebSocket-Extensions header")}e._extensions[c.extensionName]=g}e.setSocket(r,n,{allowSynchronousEvents:d.allowSynchronousEvents,generateMask:d.generateMask,maxPayload:d.maxPayload,skipUTF8Validation:d.skipUTF8Validation})}}else F(e,r,"Invalid Sec-WebSocket-Accept header")}else F(e,r,"Invalid Upgrade header")}})),d.finishRequest?d.finishRequest(_,e):_.end()}}function L(e,t){e._readyState=O.CLOSING,e._errorEmitted=!0,e.emit("error",t),e.emitClose()}function D(e){return e.path=e.socketPath,n.connect(e)}function N(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=n.isIP(e.host)?"":e.host),i.connect(e)}function F(e,t,r){e._readyState=O.CLOSING;var n=new Error(r);Error.captureStackTrace(n,F),t.setHeader?(t[x]=!0,t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),browser$1$1.nextTick(L,e,n)):(t.destroy(n),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function $(e,t,r){if(t){var n=d(t)?t.size:P(t).length;e._socket?e._sender._bufferedBytes+=n:e._bufferedAmount+=n}if(r){var i=new Error("WebSocket is not open: readyState ".concat(e.readyState," ")+"(".concat(I[e.readyState],")"));browser$1$1.nextTick(r,i)}}function U(e,t){var r=this[y];r._closeFrameReceived=!0,r._closeMessage=t,r._closeCode=e,void 0!==r._socket[y]&&(r._socket.removeListener("data",X),browser$1$1.nextTick(W,r._socket),1005===e?r.close():r.close(e,t))}function j(){var e=this[y];e.isPaused||e._socket.resume()}function q(e){var t=this[y];void 0!==t._socket[y]&&(t._socket.removeListener("data",X),browser$1$1.nextTick(W,t._socket),t.close(e[_])),t._errorEmitted||(t._errorEmitted=!0,t.emit("error",e))}function G(){this[y].emitClose()}function V(e,t){this[y].emit("message",e,t)}function z(e){var t=this[y];t._autoPong&&t.pong(e,!this._isServer,b),t.emit("ping",e)}function H(e){this[y].emit("pong",e)}function W(e){e.resume()}function K(e){var t=this[y];t.readyState!==O.CLOSED&&(t.readyState===O.OPEN&&(t._readyState=O.CLOSING,Z(t)),this._socket.end(),t._errorEmitted||(t._errorEmitted=!0,t.emit("error",e)))}function Z(e){e._closeTimer=setTimeout(e._socket.destroy.bind(e._socket),A)}function Y(){var e,t=this[y];this.removeListener("close",Y),this.removeListener("data",X),this.removeListener("end",Q),t._readyState=O.CLOSING,this._readableState.endEmitted||t._closeFrameReceived||t._receiver._writableState.errorEmitted||null===(e=t._socket.read())||t._receiver.write(e),t._receiver.end(),this[y]=void 0,clearTimeout(t._closeTimer),t._receiver._writableState.finished||t._receiver._writableState.errorEmitted?t.emitClose():(t._receiver.on("error",G),t._receiver.on("finish",G))}function X(e){this[y]._receiver.write(e)||this.pause()}function Q(){var e=this[y];e._readyState=O.CLOSING,e._receiver.end(),this.end()}function J(){var e=this[y];this.removeListener("error",J),this.on("error",b),e&&(e._readyState=O.CLOSING,this.destroy())}return Object.defineProperty(O,"CONNECTING",{enumerable:!0,value:I.indexOf("CONNECTING")}),Object.defineProperty(O.prototype,"CONNECTING",{enumerable:!0,value:I.indexOf("CONNECTING")}),Object.defineProperty(O,"OPEN",{enumerable:!0,value:I.indexOf("OPEN")}),Object.defineProperty(O.prototype,"OPEN",{enumerable:!0,value:I.indexOf("OPEN")}),Object.defineProperty(O,"CLOSING",{enumerable:!0,value:I.indexOf("CLOSING")}),Object.defineProperty(O.prototype,"CLOSING",{enumerable:!0,value:I.indexOf("CLOSING")}),Object.defineProperty(O,"CLOSED",{enumerable:!0,value:I.indexOf("CLOSED")}),Object.defineProperty(O.prototype,"CLOSED",{enumerable:!0,value:I.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach((function(e){Object.defineProperty(O.prototype,e,{enumerable:!0})})),["open","error","close","message"].forEach((function(e){Object.defineProperty(O.prototype,"on".concat(e),{enumerable:!0,get:function(){var t,r=_createForOfIteratorHelper(this.listeners(e));try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n[v])return n[g]}}catch(e){r.e(e)}finally{r.f()}return null},set:function(t){var r,n=_createForOfIteratorHelper(this.listeners(e));try{for(n.s();!(r=n.n()).done;){var i=r.value;if(i[v]){this.removeListener(e,i);break}}}catch(e){n.e(e)}finally{n.f()}"function"==typeof t&&this.addEventListener(e,t,_defineProperty({},v,!0))}})})),O.prototype.addEventListener=k,O.prototype.removeEventListener=S,websocket=O}function requireStream(){if(hasRequiredStream)return stream;hasRequiredStream=1;requireWebsocket();var e=require$$1$5.Duplex;function t(e){e.emit("close")}function r(){!this.destroyed&&this._writableState.finished&&this.destroy()}function n(e){this.removeListener("error",n),this.destroy(),0===this.listenerCount("error")&&this.emit("error",e)}return stream=function(i,o){var s=!0,a=new e(_objectSpread2(_objectSpread2({},o),{},{autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1}));return i.on("message",(function(e,t){var r=!t&&a._readableState.objectMode?e.toString():e;a.push(r)||i.pause()})),i.once("error",(function(e){a.destroyed||(s=!1,a.destroy(e))})),i.once("close",(function(){a.destroyed||a.push(null)})),a._destroy=function(e,r){if(i.readyState===i.CLOSED)return r(e),void browser$1$1.nextTick(t,a);var n=!1;i.once("error",(function(e){n=!0,r(e)})),i.once("close",(function(){n||r(e),browser$1$1.nextTick(t,a)})),s&&i.terminate()},a._final=function(e){i.readyState!==i.CONNECTING?null!==i._socket&&(i._socket._writableState.finished?(e(),a._readableState.endEmitted&&a.destroy()):(i._socket.once("finish",(function(){e()})),i.close())):i.once("open",(function(){a._final(e)}))},a._read=function(){i.isPaused&&i.resume()},a._write=function(e,t,r){i.readyState!==i.CONNECTING?i.send(e,r):i.once("open",(function(){a._write(e,t,r)}))},a.on("end",r),a.on("error",n),a},stream}function requireSubprotocol(){if(hasRequiredSubprotocol)return subprotocol;hasRequiredSubprotocol=1;var e=requireValidation().tokenChars;return subprotocol={parse:function(t){for(var r=new Set,n=-1,i=-1,o=0;o<t.length;o++){var s=t.charCodeAt(o);if(-1===i&&1===e[s])-1===n&&(n=o);else if(0===o||32!==s&&9!==s){if(44!==s)throw new SyntaxError("Unexpected character at index ".concat(o));if(-1===n)throw new SyntaxError("Unexpected character at index ".concat(o));-1===i&&(i=o);var a=t.slice(n,i);if(r.has(a))throw new SyntaxError('The "'.concat(a,'" subprotocol is duplicated'));r.add(a),n=i=-1}else-1===i&&-1!==n&&(i=o)}if(-1===n||-1!==i)throw new SyntaxError("Unexpected end of input");var c=t.slice(n,o);if(r.has(c))throw new SyntaxError('The "'.concat(c,'" subprotocol is duplicated'));return r.add(c),r}},subprotocol}function requireWebsocketServer(){if(hasRequiredWebsocketServer)return websocketServer;hasRequiredWebsocketServer=1;var e=require$$0$8,t=require$$1$1,r=(require$$1$5.Duplex,require$$3$1.createHash),n=requireExtension(),i=requirePermessageDeflate(),o=requireSubprotocol(),s=requireWebsocket(),a=requireConstants$3(),c=a.GUID,l=a.kWebSocket,u=/^[+/0-9A-Za-z]{22}==$/,d=function(e){function a(e,r){var n;if(_classCallCheck(this,a),n=_callSuper(this,a),null==(e=_objectSpread2({allowSynchronousEvents:!0,autoPong:!0,maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:s},e)).port&&!e.server&&!e.noServer||null!=e.port&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=e.port?(n._server=t.createServer((function(e,r){var n=t.STATUS_CODES[426];r.writeHead(426,{"Content-Length":n.length,"Content-Type":"text/plain"}),r.end(n)})),n._server.listen(e.port,e.host,e.backlog,r)):e.server&&(n._server=e.server),n._server){var i=n.emit.bind(_assertThisInitialized(n),"connection");n._removeListeners=function(e,t){for(var r=0,n=Object.keys(t);r<n.length;r++){var i=n[r];e.on(i,t[i])}return function(){for(var r=0,n=Object.keys(t);r<n.length;r++){var i=n[r];e.removeListener(i,t[i])}}}(n._server,{listening:n.emit.bind(_assertThisInitialized(n),"listening"),error:n.emit.bind(_assertThisInitialized(n),"error"),upgrade:function(e,t,r){n.handleUpgrade(e,t,r,i)}})}return!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(n.clients=new Set,n._shouldEmitClose=!1),n.options=e,n._state=0,n}return _inherits(a,e),_createClass(a,[{key:"address",value:function(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}},{key:"close",value:function(e){var t=this;if(2===this._state)return e&&this.once("close",(function(){e(new Error("The server is not running"))})),void browser$1$1.nextTick(h,this);if(e&&this.once("close",e),1!==this._state)if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:browser$1$1.nextTick(h,this);else{var r=this._server;this._removeListeners(),this._removeListeners=this._server=null,r.close((function(){h(t)}))}}},{key:"shouldHandle",value:function(e){if(this.options.path){var t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}},{key:"handleUpgrade",value:function(e,t,r,s){var a=this;t.on("error",f);var c=e.headers["sec-websocket-key"],l=e.headers.upgrade,d=+e.headers["sec-websocket-version"];if("GET"===e.method)if(void 0!==l&&"websocket"===l.toLowerCase())if(void 0!==c&&u.test(c))if(13===d||8===d)if(this.shouldHandle(e)){var h=e.headers["sec-websocket-protocol"],v=new Set;if(void 0!==h)try{v=o.parse(h)}catch(r){return void m(this,e,t,400,"Invalid Sec-WebSocket-Protocol header")}var g=e.headers["sec-websocket-extensions"],_={};if(this.options.perMessageDeflate&&void 0!==g){var y=new i(this.options.perMessageDeflate,!0,this.options.maxPayload);try{var b=n.parse(g);b[i.extensionName]&&(y.accept(b[i.extensionName]),_[i.extensionName]=y)}catch(r){return void m(this,e,t,400,"Invalid or unacceptable Sec-WebSocket-Extensions header")}}if(this.options.verifyClient){var w={origin:e.headers["".concat(8===d?"sec-websocket-origin":"origin")],secure:!(!e.socket.authorized&&!e.socket.encrypted),req:e};if(2===this.options.verifyClient.length)return void this.options.verifyClient(w,(function(n,i,o,l){if(!n)return p(t,i||401,o,l);a.completeUpgrade(_,c,v,e,t,r,s)}));if(!this.options.verifyClient(w))return p(t,401)}this.completeUpgrade(_,c,v,e,t,r,s)}else p(t,400);else{m(this,e,t,400,"Missing or invalid Sec-WebSocket-Version header",{"Sec-WebSocket-Version":"13, 8"})}else{m(this,e,t,400,"Missing or invalid Sec-WebSocket-Key header")}else{m(this,e,t,400,"Invalid Upgrade header")}else{m(this,e,t,405,"Invalid HTTP method")}}},{key:"completeUpgrade",value:function(e,t,o,s,a,u,d){var m=this;if(!a.readable||!a.writable)return a.destroy();if(a[l])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return p(a,503);var v=r("sha1").update(t+c).digest("base64"),g=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade","Sec-WebSocket-Accept: ".concat(v)],_=new this.options.WebSocket(null,void 0,this.options);if(o.size){var y=this.options.handleProtocols?this.options.handleProtocols(o,s):o.values().next().value;y&&(g.push("Sec-WebSocket-Protocol: ".concat(y)),_._protocol=y)}if(e[i.extensionName]){var b=e[i.extensionName].params,w=n.format(_defineProperty({},i.extensionName,[b]));g.push("Sec-WebSocket-Extensions: ".concat(w)),_._extensions=e}this.emit("headers",g,s),a.write(g.concat("\r\n").join("\r\n")),a.removeListener("error",f),_.setSocket(a,u,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(_),_.on("close",(function(){m.clients.delete(_),m._shouldEmitClose&&!m.clients.size&&browser$1$1.nextTick(h,m)}))),d(_,s)}}]),a}(e);function h(e){e._state=2,e.emit("close")}function f(){this.destroy()}function p(e,r,n,i){n=n||t.STATUS_CODES[r],i=_objectSpread2({Connection:"close","Content-Type":"text/html","Content-Length":Buffer$4.byteLength(n)},i),e.once("finish",e.destroy),e.end("HTTP/1.1 ".concat(r," ").concat(t.STATUS_CODES[r],"\r\n")+Object.keys(i).map((function(e){return"".concat(e,": ").concat(i[e])})).join("\r\n")+"\r\n\r\n"+n)}function m(e,t,r,n,i,o){if(e.listenerCount("wsClientError")){var s=new Error(i);Error.captureStackTrace(s,m),e.emit("wsClientError",s,r,t)}else p(r,n,i,o)}return websocketServer=d}function requireWs$1(){if(hasRequiredWs$1)return ws$1;hasRequiredWs$1=1;var e=requireWebsocket();return e.createWebSocketStream=requireStream(),e.Server=requireWebsocketServer(),e.Receiver=requireReceiver(),e.Sender=requireSender(),e.WebSocket=e,e.WebSocketServer=e.Server,ws$1=e}var BufferedDuplex={},hasRequiredBufferedDuplex,hasRequiredWs;function requireBufferedDuplex(){if(hasRequiredBufferedDuplex)return BufferedDuplex;hasRequiredBufferedDuplex=1,Object.defineProperty(BufferedDuplex,"__esModule",{value:!0}),BufferedDuplex.BufferedDuplex=void 0,BufferedDuplex.writev=t;var e=require$$0$a;function t(t,r){for(var n=new Array(t.length),i=0;i<t.length;i++)"string"==typeof t[i].chunk?n[i]=e.Buffer.from(t[i].chunk,"utf8"):n[i]=t[i].chunk;this._write(e.Buffer.concat(n),"binary",r)}var r=function(e){function r(e,n,i){var o;return _classCallCheck(this,r),_defineProperty(_assertThisInitialized(o=_callSuper(this,r,[{objectMode:!0}])),"socket",void 0),_defineProperty(_assertThisInitialized(o),"proxy",void 0),_defineProperty(_assertThisInitialized(o),"isSocketOpen",void 0),_defineProperty(_assertThisInitialized(o),"writeQueue",void 0),o.proxy=n,o.socket=i,o.writeQueue=[],e.objectMode||(o._writev=t.bind(_assertThisInitialized(o))),o.isSocketOpen=!1,o.proxy.on("data",(function(e){!o.destroyed&&o.readable&&o.push(e)})),o}return _inherits(r,e),_createClass(r,[{key:"_read",value:function(e){this.proxy.read(e)}},{key:"_write",value:function(e,t,r){this.isSocketOpen?this.writeToProxy(e,t,r):this.writeQueue.push({chunk:e,encoding:t,cb:r})}},{key:"_final",value:function(e){this.writeQueue=[],this.proxy.end(e)}},{key:"_destroy",value:function(e,t){this.writeQueue=[],this.proxy.destroy(),t(e)}},{key:"socketReady",value:function(){this.emit("connect"),this.isSocketOpen=!0,this.processWriteQueue()}},{key:"writeToProxy",value:function(e,t,r){!1===this.proxy.write(e,t)?this.proxy.once("drain",r):r()}},{key:"processWriteQueue",value:function(){for(;this.writeQueue.length>0;){var e=this.writeQueue.shift(),t=e.chunk,r=e.encoding,n=e.cb;this.writeToProxy(t,r,n)}}}]),r}(oursExports.Duplex);return BufferedDuplex.BufferedDuplex=r,BufferedDuplex}function requireWs(){if(hasRequiredWs)return ws$2;hasRequiredWs=1;var e=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ws$2,"__esModule",{value:!0}),ws$2.streamBuilder=ws$2.browserStreamBuilder=void 0;var t=require$$0$a,r=e(requireWs$1()),n=e(srcExports),i=oursExports,o=e(isBrowser$1),s=requireBufferedDuplex(),a=(0,n.default)("mqttjs:ws"),c=["rejectUnauthorized","ca","cert","key","pfx","passphrase"];function l(e,t){var r="".concat(e.protocol,"://").concat(e.hostname,":").concat(e.port).concat(e.path);return"function"==typeof e.transformWsUrl&&(r=e.transformWsUrl(r,e,t)),r}function u(e){var t=e;return e.port||("wss"===e.protocol?t.port=443:t.port=80),e.path||(t.path="/"),e.wsOptions||(t.wsOptions={}),o.default||e.forceNativeWebSocket||"wss"!==e.protocol||c.forEach((function(r){Object.prototype.hasOwnProperty.call(e,r)&&!Object.prototype.hasOwnProperty.call(e.wsOptions,r)&&(t.wsOptions[r]=e[r])})),t}ws$2.streamBuilder=function(e,t){a("streamBuilder");var n=u(t);n.hostname=n.hostname||n.host||"localhost";var i=l(n,e),o=function(e,t,n){a("createWebSocket"),a("protocol: ".concat(n.protocolId," ").concat(n.protocolVersion));var i="MQIsdp"===n.protocolId&&3===n.protocolVersion?"mqttv3.1":"mqtt";return a("creating new Websocket for url: ".concat(t," and protocol: ").concat(i)),n.createWebsocket?n.createWebsocket(t,[i],n):new r.default(t,[i],n.wsOptions)}(0,i,n),s=r.default.createWebSocketStream(o,n.wsOptions);return s.url=i,o.on("close",(function(){s.destroy()})),s};return ws$2.browserStreamBuilder=function(e,r){var n;a("browserStreamBuilder");var o,c,d,h,f=function(e){var t=u(e);if(t.hostname||(t.hostname=t.host),!t.hostname){if("undefined"==typeof document)throw new Error("Could not determine host. Specify host manually.");var r=new URL(document.URL);t.hostname=r.hostname,t.port||(t.port=Number(r.port))}return void 0===t.objectMode&&(t.objectMode=!(!0===t.binary||void 0===t.binary)),t}(r),p=f.browserBufferSize||524288,m=r.browserBufferTimeout||1e3,v=!r.objectMode,g=function(e,t){var r,n="MQIsdp"===t.protocolId&&3===t.protocolVersion?"mqttv3.1":"mqtt",i=l(t,e);return(r=t.createWebsocket?t.createWebsocket(i,[n],t):new WebSocket(i,[n])).binaryType="arraybuffer",r}(e,r),_=(o=r,c=function e(r,n,i){if(g.bufferedAmount>p)setTimeout(e,m,r,n,i);else{v&&"string"==typeof r&&(r=t.Buffer.from(r,"utf8"));try{g.send(r)}catch(e){return i(e)}i()}},d=function(e){g.close(),e()},(h=new i.Transform({objectMode:o.objectMode}))._write=c,h._flush=d,h);r.objectMode||(_._writev=s.writev.bind(_)),_.on("close",(function(){g.close()}));var y=void 0!==g.addEventListener;function b(){a("WebSocket onOpen"),n instanceof s.BufferedDuplex&&n.socketReady()}function w(e){a("WebSocket onClose",e),n.end(),n.destroy()}function k(e){a("WebSocket onError",e);var t=new Error("WebSocket error");t.event=e,n.destroy(t)}function S(e){return E.apply(this,arguments)}function E(){return(E=_asyncToGenerator(_regeneratorRuntime().mark((function e(r){var n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_&&!_.destroyed&&_.readable){e.next=2;break}return e.abrupt("return");case 2:if(!((n=r.data)instanceof ArrayBuffer)){e.next=7;break}n=t.Buffer.from(n),e.next=16;break;case 7:if(!(n instanceof Blob)){e.next=15;break}return e.t0=t.Buffer,e.next=11,new Response(n).arrayBuffer();case 11:e.t1=e.sent,n=e.t0.from.call(e.t0,e.t1),e.next=16;break;case 15:n=t.Buffer.from(n,"utf8");case 16:_.push(n);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return g.readyState===g.OPEN?(n=_).socket=g:(n=new s.BufferedDuplex(r,_,g),y?g.addEventListener("open",b):g.onopen=b),y?(g.addEventListener("close",w),g.addEventListener("error",k),g.addEventListener("message",S)):(g.onclose=w,g.onerror=k,g.onmessage=S),n},ws$2}var tcp={},socks={},build={},socksclient={},smartbuffer={},utils={},hasRequiredUtils,hasRequiredSmartbuffer;function requireUtils(){if(hasRequiredUtils)return utils;hasRequiredUtils=1,Object.defineProperty(utils,"__esModule",{value:!0});var e=require$$0$a,t={INVALID_ENCODING:"Invalid encoding provided. Please specify a valid encoding the internal Node.js Buffer supports.",INVALID_SMARTBUFFER_SIZE:"Invalid size provided. Size must be a valid integer greater than zero.",INVALID_SMARTBUFFER_BUFFER:"Invalid Buffer provided in SmartBufferOptions.",INVALID_SMARTBUFFER_OBJECT:"Invalid SmartBufferOptions object supplied to SmartBuffer constructor or factory methods.",INVALID_OFFSET:"An invalid offset value was provided.",INVALID_OFFSET_NON_NUMBER:"An invalid offset value was provided. A numeric value is required.",INVALID_LENGTH:"An invalid length value was provided.",INVALID_LENGTH_NON_NUMBER:"An invalid length value was provived. A numeric value is required.",INVALID_TARGET_OFFSET:"Target offset is beyond the bounds of the internal SmartBuffer data.",INVALID_TARGET_LENGTH:"Specified length value moves cursor beyong the bounds of the internal SmartBuffer data.",INVALID_READ_BEYOND_BOUNDS:"Attempted to read beyond the bounds of the managed data.",INVALID_WRITE_BEYOND_BOUNDS:"Attempted to write beyond the bounds of the managed data."};function r(e){return"number"==typeof e&&isFinite(e)&&function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}(e)}function n(e,n){if("number"!=typeof e)throw new Error(n?t.INVALID_OFFSET_NON_NUMBER:t.INVALID_LENGTH_NON_NUMBER);if(!r(e)||e<0)throw new Error(n?t.INVALID_OFFSET:t.INVALID_LENGTH)}return utils.ERRORS=t,utils.checkEncoding=function(r){if(!e.Buffer.isEncoding(r))throw new Error(t.INVALID_ENCODING)},utils.isFiniteInteger=r,utils.checkLengthValue=function(e){n(e,!1)},utils.checkOffsetValue=function(e){n(e,!0)},utils.checkTargetOffset=function(e,r){if(e<0||e>r.length)throw new Error(t.INVALID_TARGET_OFFSET)},utils.bigIntAndBufferInt64Check=function(t){if("undefined"==typeof BigInt)throw new Error("Platform does not support JS BigInt type.");if(void 0===e.Buffer.prototype[t])throw new Error("Platform does not support Buffer.prototype.".concat(t,"."))},utils}function requireSmartbuffer(){if(hasRequiredSmartbuffer)return smartbuffer;hasRequiredSmartbuffer=1,Object.defineProperty(smartbuffer,"__esModule",{value:!0});var e=requireUtils(),t=function(){function t(r){if(_classCallCheck(this,t),this.length=0,this._encoding="utf8",this._writeOffset=0,this._readOffset=0,t.isSmartBufferOptions(r))if(r.encoding&&(e.checkEncoding(r.encoding),this._encoding=r.encoding),r.size){if(!(e.isFiniteInteger(r.size)&&r.size>0))throw new Error(e.ERRORS.INVALID_SMARTBUFFER_SIZE);this._buff=Buffer$4.allocUnsafe(r.size)}else if(r.buff){if(!Buffer$4.isBuffer(r.buff))throw new Error(e.ERRORS.INVALID_SMARTBUFFER_BUFFER);this._buff=r.buff,this.length=r.buff.length}else this._buff=Buffer$4.allocUnsafe(4096);else{if(void 0!==r)throw new Error(e.ERRORS.INVALID_SMARTBUFFER_OBJECT);this._buff=Buffer$4.allocUnsafe(4096)}}return _createClass(t,[{key:"readInt8",value:function(e){return this._readNumberValue(Buffer$4.prototype.readInt8,1,e)}},{key:"readInt16BE",value:function(e){return this._readNumberValue(Buffer$4.prototype.readInt16BE,2,e)}},{key:"readInt16LE",value:function(e){return this._readNumberValue(Buffer$4.prototype.readInt16LE,2,e)}},{key:"readInt32BE",value:function(e){return this._readNumberValue(Buffer$4.prototype.readInt32BE,4,e)}},{key:"readInt32LE",value:function(e){return this._readNumberValue(Buffer$4.prototype.readInt32LE,4,e)}},{key:"readBigInt64BE",value:function(t){return e.bigIntAndBufferInt64Check("readBigInt64BE"),this._readNumberValue(Buffer$4.prototype.readBigInt64BE,8,t)}},{key:"readBigInt64LE",value:function(t){return e.bigIntAndBufferInt64Check("readBigInt64LE"),this._readNumberValue(Buffer$4.prototype.readBigInt64LE,8,t)}},{key:"writeInt8",value:function(e,t){return this._writeNumberValue(Buffer$4.prototype.writeInt8,1,e,t),this}},{key:"insertInt8",value:function(e,t){return this._insertNumberValue(Buffer$4.prototype.writeInt8,1,e,t)}},{key:"writeInt16BE",value:function(e,t){return this._writeNumberValue(Buffer$4.prototype.writeInt16BE,2,e,t)}},{key:"insertInt16BE",value:function(e,t){return this._insertNumberValue(Buffer$4.prototype.writeInt16BE,2,e,t)}},{key:"writeInt16LE",value:function(e,t){return this._writeNumberValue(Buffer$4.prototype.writeInt16LE,2,e,t)}},{key:"insertInt16LE",value:function(e,t){return this._insertNumberValue(Buffer$4.prototype.writeInt16LE,2,e,t)}},{key:"writeInt32BE",value:function(e,t){return this._writeNumberValue(Buffer$4.prototype.writeInt32BE,4,e,t)}},{key:"insertInt32BE",value:function(e,t){return this._insertNumberValue(Buffer$4.prototype.writeInt32BE,4,e,t)}},{key:"writeInt32LE",value:function(e,t){return this._writeNumberValue(Buffer$4.prototype.writeInt32LE,4,e,t)}},{key:"insertInt32LE",value:function(e,t){return this._insertNumberValue(Buffer$4.prototype.writeInt32LE,4,e,t)}},{key:"writeBigInt64BE",value:function(t,r){return e.bigIntAndBufferInt64Check("writeBigInt64BE"),this._writeNumberValue(Buffer$4.prototype.writeBigInt64BE,8,t,r)}},{key:"insertBigInt64BE",value:function(t,r){return e.bigIntAndBufferInt64Check("writeBigInt64BE"),this._insertNumberValue(Buffer$4.prototype.writeBigInt64BE,8,t,r)}},{key:"writeBigInt64LE",value:function(t,r){return e.bigIntAndBufferInt64Check("writeBigInt64LE"),this._writeNumberValue(Buffer$4.prototype.writeBigInt64LE,8,t,r)}},{key:"insertBigInt64LE",value:function(t,r){return e.bigIntAndBufferInt64Check("writeBigInt64LE"),this._insertNumberValue(Buffer$4.prototype.writeBigInt64LE,8,t,r)}},{key:"readUInt8",value:function(e){return this._readNumberValue(Buffer$4.prototype.readUInt8,1,e)}},{key:"readUInt16BE",value:function(e){return this._readNumberValue(Buffer$4.prototype.readUInt16BE,2,e)}},{key:"readUInt16LE",value:function(e){return this._readNumberValue(Buffer$4.prototype.readUInt16LE,2,e)}},{key:"readUInt32BE",value:function(e){return this._readNumberValue(Buffer$4.prototype.readUInt32BE,4,e)}},{key:"readUInt32LE",value:function(e){return this._readNumberValue(Buffer$4.prototype.readUInt32LE,4,e)}},{key:"readBigUInt64BE",value:function(t){return e.bigIntAndBufferInt64Check("readBigUInt64BE"),this._readNumberValue(Buffer$4.prototype.readBigUInt64BE,8,t)}},{key:"readBigUInt64LE",value:function(t){return e.bigIntAndBufferInt64Check("readBigUInt64LE"),this._readNumberValue(Buffer$4.prototype.readBigUInt64LE,8,t)}},{key:"writeUInt8",value:function(e,t){return this._writeNumberValue(Buffer$4.prototype.writeUInt8,1,e,t)}},{key:"insertUInt8",value:function(e,t){return this._insertNumberValue(Buffer$4.prototype.writeUInt8,1,e,t)}},{key:"writeUInt16BE",value:function(e,t){return this._writeNumberValue(Buffer$4.prototype.writeUInt16BE,2,e,t)}},{key:"insertUInt16BE",value:function(e,t){return this._insertNumberValue(Buffer$4.prototype.writeUInt16BE,2,e,t)}},{key:"writeUInt16LE",value:function(e,t){return this._writeNumberValue(Buffer$4.prototype.writeUInt16LE,2,e,t)}},{key:"insertUInt16LE",value:function(e,t){return this._insertNumberValue(Buffer$4.prototype.writeUInt16LE,2,e,t)}},{key:"writeUInt32BE",value:function(e,t){return this._writeNumberValue(Buffer$4.prototype.writeUInt32BE,4,e,t)}},{key:"insertUInt32BE",value:function(e,t){return this._insertNumberValue(Buffer$4.prototype.writeUInt32BE,4,e,t)}},{key:"writeUInt32LE",value:function(e,t){return this._writeNumberValue(Buffer$4.prototype.writeUInt32LE,4,e,t)}},{key:"insertUInt32LE",value:function(e,t){return this._insertNumberValue(Buffer$4.prototype.writeUInt32LE,4,e,t)}},{key:"writeBigUInt64BE",value:function(t,r){return e.bigIntAndBufferInt64Check("writeBigUInt64BE"),this._writeNumberValue(Buffer$4.prototype.writeBigUInt64BE,8,t,r)}},{key:"insertBigUInt64BE",value:function(t,r){return e.bigIntAndBufferInt64Check("writeBigUInt64BE"),this._insertNumberValue(Buffer$4.prototype.writeBigUInt64BE,8,t,r)}},{key:"writeBigUInt64LE",value:function(t,r){return e.bigIntAndBufferInt64Check("writeBigUInt64LE"),this._writeNumberValue(Buffer$4.prototype.writeBigUInt64LE,8,t,r)}},{key:"insertBigUInt64LE",value:function(t,r){return e.bigIntAndBufferInt64Check("writeBigUInt64LE"),this._insertNumberValue(Buffer$4.prototype.writeBigUInt64LE,8,t,r)}},{key:"readFloatBE",value:function(e){return this._readNumberValue(Buffer$4.prototype.readFloatBE,4,e)}},{key:"readFloatLE",value:function(e){return this._readNumberValue(Buffer$4.prototype.readFloatLE,4,e)}},{key:"writeFloatBE",value:function(e,t){return this._writeNumberValue(Buffer$4.prototype.writeFloatBE,4,e,t)}},{key:"insertFloatBE",value:function(e,t){return this._insertNumberValue(Buffer$4.prototype.writeFloatBE,4,e,t)}},{key:"writeFloatLE",value:function(e,t){return this._writeNumberValue(Buffer$4.prototype.writeFloatLE,4,e,t)}},{key:"insertFloatLE",value:function(e,t){return this._insertNumberValue(Buffer$4.prototype.writeFloatLE,4,e,t)}},{key:"readDoubleBE",value:function(e){return this._readNumberValue(Buffer$4.prototype.readDoubleBE,8,e)}},{key:"readDoubleLE",value:function(e){return this._readNumberValue(Buffer$4.prototype.readDoubleLE,8,e)}},{key:"writeDoubleBE",value:function(e,t){return this._writeNumberValue(Buffer$4.prototype.writeDoubleBE,8,e,t)}},{key:"insertDoubleBE",value:function(e,t){return this._insertNumberValue(Buffer$4.prototype.writeDoubleBE,8,e,t)}},{key:"writeDoubleLE",value:function(e,t){return this._writeNumberValue(Buffer$4.prototype.writeDoubleLE,8,e,t)}},{key:"insertDoubleLE",value:function(e,t){return this._insertNumberValue(Buffer$4.prototype.writeDoubleLE,8,e,t)}},{key:"readString",value:function(t,r){var n;"number"==typeof t?(e.checkLengthValue(t),n=Math.min(t,this.length-this._readOffset)):(r=t,n=this.length-this._readOffset),void 0!==r&&e.checkEncoding(r);var i=this._buff.slice(this._readOffset,this._readOffset+n).toString(r||this._encoding);return this._readOffset+=n,i}},{key:"insertString",value:function(t,r,n){return e.checkOffsetValue(r),this._handleString(t,!0,r,n)}},{key:"writeString",value:function(e,t,r){return this._handleString(e,!1,t,r)}},{key:"readStringNT",value:function(t){void 0!==t&&e.checkEncoding(t);for(var r=this.length,n=this._readOffset;n<this.length;n++)if(0===this._buff[n]){r=n;break}var i=this._buff.slice(this._readOffset,r);return this._readOffset=r+1,i.toString(t||this._encoding)}},{key:"insertStringNT",value:function(t,r,n){return e.checkOffsetValue(r),this.insertString(t,r,n),this.insertUInt8(0,r+t.length),this}},{key:"writeStringNT",value:function(e,t,r){return this.writeString(e,t,r),this.writeUInt8(0,"number"==typeof t?t+e.length:this.writeOffset),this}},{key:"readBuffer",value:function(t){void 0!==t&&e.checkLengthValue(t);var r="number"==typeof t?t:this.length,n=Math.min(this.length,this._readOffset+r),i=this._buff.slice(this._readOffset,n);return this._readOffset=n,i}},{key:"insertBuffer",value:function(t,r){return e.checkOffsetValue(r),this._handleBuffer(t,!0,r)}},{key:"writeBuffer",value:function(e,t){return this._handleBuffer(e,!1,t)}},{key:"readBufferNT",value:function(){for(var e=this.length,t=this._readOffset;t<this.length;t++)if(0===this._buff[t]){e=t;break}var r=this._buff.slice(this._readOffset,e);return this._readOffset=e+1,r}},{key:"insertBufferNT",value:function(t,r){return e.checkOffsetValue(r),this.insertBuffer(t,r),this.insertUInt8(0,r+t.length),this}},{key:"writeBufferNT",value:function(t,r){return void 0!==r&&e.checkOffsetValue(r),this.writeBuffer(t,r),this.writeUInt8(0,"number"==typeof r?r+t.length:this._writeOffset),this}},{key:"clear",value:function(){return this._writeOffset=0,this._readOffset=0,this.length=0,this}},{key:"remaining",value:function(){return this.length-this._readOffset}},{key:"readOffset",get:function(){return this._readOffset},set:function(t){e.checkOffsetValue(t),e.checkTargetOffset(t,this),this._readOffset=t}},{key:"writeOffset",get:function(){return this._writeOffset},set:function(t){e.checkOffsetValue(t),e.checkTargetOffset(t,this),this._writeOffset=t}},{key:"encoding",get:function(){return this._encoding},set:function(t){e.checkEncoding(t),this._encoding=t}},{key:"internalBuffer",get:function(){return this._buff}},{key:"toBuffer",value:function(){return this._buff.slice(0,this.length)}},{key:"toString",value:function(t){var r="string"==typeof t?t:this._encoding;return e.checkEncoding(r),this._buff.toString(r,0,this.length)}},{key:"destroy",value:function(){return this.clear(),this}},{key:"_handleString",value:function(t,r,n,i){var o=this._writeOffset,s=this._encoding;"number"==typeof n?o=n:"string"==typeof n&&(e.checkEncoding(n),s=n),"string"==typeof i&&(e.checkEncoding(i),s=i);var a=Buffer$4.byteLength(t,s);return r?this.ensureInsertable(a,o):this._ensureWriteable(a,o),this._buff.write(t,o,a,s),r?this._writeOffset+=a:"number"==typeof n?this._writeOffset=Math.max(this._writeOffset,o+a):this._writeOffset+=a,this}},{key:"_handleBuffer",value:function(e,t,r){var n="number"==typeof r?r:this._writeOffset;return t?this.ensureInsertable(e.length,n):this._ensureWriteable(e.length,n),e.copy(this._buff,n),t?this._writeOffset+=e.length:"number"==typeof r?this._writeOffset=Math.max(this._writeOffset,n+e.length):this._writeOffset+=e.length,this}},{key:"ensureReadable",value:function(t,r){var n=this._readOffset;if(void 0!==r&&(e.checkOffsetValue(r),n=r),n<0||n+t>this.length)throw new Error(e.ERRORS.INVALID_READ_BEYOND_BOUNDS)}},{key:"ensureInsertable",value:function(t,r){e.checkOffsetValue(r),this._ensureCapacity(this.length+t),r<this.length&&this._buff.copy(this._buff,r+t,r,this._buff.length),r+t>this.length?this.length=r+t:this.length+=t}},{key:"_ensureWriteable",value:function(e,t){var r="number"==typeof t?t:this._writeOffset;this._ensureCapacity(r+e),r+e>this.length&&(this.length=r+e)}},{key:"_ensureCapacity",value:function(e){var t=this._buff.length;if(e>t){var r=this._buff,n=3*t/2+1;n<e&&(n=e),this._buff=Buffer$4.allocUnsafe(n),r.copy(this._buff,0,0,t)}}},{key:"_readNumberValue",value:function(e,t,r){this.ensureReadable(t,r);var n=e.call(this._buff,"number"==typeof r?r:this._readOffset);return void 0===r&&(this._readOffset+=t),n}},{key:"_insertNumberValue",value:function(t,r,n,i){return e.checkOffsetValue(i),this.ensureInsertable(r,i),t.call(this._buff,n,i),this._writeOffset+=r,this}},{key:"_writeNumberValue",value:function(t,r,n,i){if("number"==typeof i){if(i<0)throw new Error(e.ERRORS.INVALID_WRITE_BEYOND_BOUNDS);e.checkOffsetValue(i)}var o="number"==typeof i?i:this._writeOffset;return this._ensureWriteable(r,o),t.call(this._buff,n,o),"number"==typeof i?this._writeOffset=Math.max(this._writeOffset,o+r):this._writeOffset+=r,this}}],[{key:"fromSize",value:function(e,t){return new this({size:e,encoding:t})}},{key:"fromBuffer",value:function(e,t){return new this({buff:e,encoding:t})}},{key:"fromOptions",value:function(e){return new this(e)}},{key:"isSmartBufferOptions",value:function(e){var t=e;return t&&(void 0!==t.encoding||void 0!==t.size||void 0!==t.buff)}}]),t}();return smartbuffer.SmartBuffer=t,smartbuffer}var constants$2={},hasRequiredConstants$2;function requireConstants$2(){if(hasRequiredConstants$2)return constants$2;hasRequiredConstants$2=1,Object.defineProperty(constants$2,"__esModule",{value:!0}),constants$2.SOCKS5_NO_ACCEPTABLE_AUTH=constants$2.SOCKS5_CUSTOM_AUTH_END=constants$2.SOCKS5_CUSTOM_AUTH_START=constants$2.SOCKS_INCOMING_PACKET_SIZES=constants$2.SocksClientState=constants$2.Socks5Response=constants$2.Socks5HostType=constants$2.Socks5Auth=constants$2.Socks4Response=constants$2.SocksCommand=constants$2.ERRORS=constants$2.DEFAULT_TIMEOUT=void 0;constants$2.DEFAULT_TIMEOUT=3e4;constants$2.ERRORS={InvalidSocksCommand:"An invalid SOCKS command was provided. Valid options are connect, bind, and associate.",InvalidSocksCommandForOperation:"An invalid SOCKS command was provided. Only a subset of commands are supported for this operation.",InvalidSocksCommandChain:"An invalid SOCKS command was provided. Chaining currently only supports the connect command.",InvalidSocksClientOptionsDestination:"An invalid destination host was provided.",InvalidSocksClientOptionsExistingSocket:"An invalid existing socket was provided. This should be an instance of stream.Duplex.",InvalidSocksClientOptionsProxy:"Invalid SOCKS proxy details were provided.",InvalidSocksClientOptionsTimeout:"An invalid timeout value was provided. Please enter a value above 0 (in ms).",InvalidSocksClientOptionsProxiesLength:"At least two socks proxies must be provided for chaining.",InvalidSocksClientOptionsCustomAuthRange:"Custom auth must be a value between 0x80 and 0xFE.",InvalidSocksClientOptionsCustomAuthOptions:"When a custom_auth_method is provided, custom_auth_request_handler, custom_auth_response_size, and custom_auth_response_handler must also be provided and valid.",NegotiationError:"Negotiation error",SocketClosed:"Socket closed",ProxyConnectionTimedOut:"Proxy connection timed out",InternalError:"SocksClient internal error (this should not happen)",InvalidSocks4HandshakeResponse:"Received invalid Socks4 handshake response",Socks4ProxyRejectedConnection:"Socks4 Proxy rejected connection",InvalidSocks4IncomingConnectionResponse:"Socks4 invalid incoming connection response",Socks4ProxyRejectedIncomingBoundConnection:"Socks4 Proxy rejected incoming bound connection",InvalidSocks5InitialHandshakeResponse:"Received invalid Socks5 initial handshake response",InvalidSocks5IntiailHandshakeSocksVersion:"Received invalid Socks5 initial handshake (invalid socks version)",InvalidSocks5InitialHandshakeNoAcceptedAuthType:"Received invalid Socks5 initial handshake (no accepted authentication type)",InvalidSocks5InitialHandshakeUnknownAuthType:"Received invalid Socks5 initial handshake (unknown authentication type)",Socks5AuthenticationFailed:"Socks5 Authentication failed",InvalidSocks5FinalHandshake:"Received invalid Socks5 final handshake response",InvalidSocks5FinalHandshakeRejected:"Socks5 proxy rejected connection",InvalidSocks5IncomingConnectionResponse:"Received invalid Socks5 incoming connection response",Socks5ProxyRejectedIncomingBoundConnection:"Socks5 Proxy rejected incoming bound connection"};var e,t,r;constants$2.SOCKS_INCOMING_PACKET_SIZES={Socks5InitialHandshakeResponse:2,Socks5UserPassAuthenticationResponse:2,Socks5ResponseHeader:5,Socks5ResponseIPv4:10,Socks5ResponseIPv6:22,Socks5ResponseHostname:function(e){return e+7},Socks4Response:8},function(e){e[e.connect=1]="connect",e[e.bind=2]="bind",e[e.associate=3]="associate"}(e||(constants$2.SocksCommand=e={})),function(e){e[e.Granted=90]="Granted",e[e.Failed=91]="Failed",e[e.Rejected=92]="Rejected",e[e.RejectedIdent=93]="RejectedIdent"}(t||(constants$2.Socks4Response=t={})),function(e){e[e.NoAuth=0]="NoAuth",e[e.GSSApi=1]="GSSApi",e[e.UserPass=2]="UserPass"}(r||(constants$2.Socks5Auth=r={}));constants$2.SOCKS5_CUSTOM_AUTH_START=128;constants$2.SOCKS5_CUSTOM_AUTH_END=254;var n,i,o;return constants$2.SOCKS5_NO_ACCEPTABLE_AUTH=255,function(e){e[e.Granted=0]="Granted",e[e.Failure=1]="Failure",e[e.NotAllowed=2]="NotAllowed",e[e.NetworkUnreachable=3]="NetworkUnreachable",e[e.HostUnreachable=4]="HostUnreachable",e[e.ConnectionRefused=5]="ConnectionRefused",e[e.TTLExpired=6]="TTLExpired",e[e.CommandNotSupported=7]="CommandNotSupported",e[e.AddressNotSupported=8]="AddressNotSupported"}(n||(constants$2.Socks5Response=n={})),function(e){e[e.IPv4=1]="IPv4",e[e.Hostname=3]="Hostname",e[e.IPv6=4]="IPv6"}(i||(constants$2.Socks5HostType=i={})),function(e){e[e.Created=0]="Created",e[e.Connecting=1]="Connecting",e[e.Connected=2]="Connected",e[e.SentInitialHandshake=3]="SentInitialHandshake",e[e.ReceivedInitialHandshakeResponse=4]="ReceivedInitialHandshakeResponse",e[e.SentAuthentication=5]="SentAuthentication",e[e.ReceivedAuthenticationResponse=6]="ReceivedAuthenticationResponse",e[e.SentFinalHandshake=7]="SentFinalHandshake",e[e.ReceivedFinalResponse=8]="ReceivedFinalResponse",e[e.BoundWaitingForConnection=9]="BoundWaitingForConnection",e[e.Established=10]="Established",e[e.Disconnected=11]="Disconnected",e[e.Error=99]="Error"}(o||(constants$2.SocksClientState=o={})),constants$2}var helpers$1={},util={},hasRequiredUtil;function requireUtil(){if(hasRequiredUtil)return util;hasRequiredUtil=1,Object.defineProperty(util,"__esModule",{value:!0}),util.shuffleArray=util.SocksClientError=void 0;var e=function(e){function t(e,r){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).options=r,n}return _inherits(t,e),_createClass(t)}(_wrapNativeSuper(Error));return util.SocksClientError=e,util.shuffleArray=function(e){for(var t=e.length-1;t>0;t--){var r=Math.floor(Math.random()*(t+1)),n=[e[r],e[t]];e[t]=n[0],e[r]=n[1]}},util}var ipAddress={},ipv4={},common={},hasRequiredCommon;function requireCommon(){if(hasRequiredCommon)return common;return hasRequiredCommon=1,Object.defineProperty(common,"__esModule",{value:!0}),common.isCorrect=common.isInSubnet=void 0,common.isInSubnet=function(e){return!(this.subnetMask<e.subnetMask)&&this.mask(e.subnetMask)===e.mask()},common.isCorrect=function(e){return function(){return this.addressMinusSuffix===this.correctForm()&&(this.subnetMask===e&&!this.parsedSubnet||this.parsedSubnet===String(this.subnetMask))}},common}var constants$1={},hasRequiredConstants$1;function requireConstants$1(){return hasRequiredConstants$1||(hasRequiredConstants$1=1,Object.defineProperty(constants$1,"__esModule",{value:!0}),constants$1.RE_SUBNET_STRING=constants$1.RE_ADDRESS=constants$1.GROUPS=constants$1.BITS=void 0,constants$1.BITS=32,constants$1.GROUPS=4,constants$1.RE_ADDRESS=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/g,constants$1.RE_SUBNET_STRING=/\/\d{1,2}$/),constants$1}var addressError={},hasRequiredAddressError;function requireAddressError(){if(hasRequiredAddressError)return addressError;hasRequiredAddressError=1,Object.defineProperty(addressError,"__esModule",{value:!0}),addressError.AddressError=void 0;var e=function(e){function t(e,r){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).name="AddressError",null!==r&&(n.parseMessage=r),n}return _inherits(t,e),_createClass(t)}(_wrapNativeSuper(Error));return addressError.AddressError=e,addressError}var jsbn$1={exports:{}},jsbn=jsbn$1.exports,hasRequiredJsbn;function requireJsbn(){return hasRequiredJsbn||(hasRequiredJsbn=1,function(e,t){(function(){var t;function r(e,t,r){null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function n(){return new r(null)}var i="undefined"!=typeof navigator;i&&"Microsoft Internet Explorer"==navigator.appName?(r.prototype.am=function(e,t,r,n,i,o){for(var s=32767&t,a=t>>15;--o>=0;){var c=32767&this[e],l=this[e++]>>15,u=a*c+l*s;i=((c=s*c+((32767&u)<<15)+r[n]+(1073741823&i))>>>30)+(u>>>15)+a*l+(i>>>30),r[n++]=1073741823&c}return i},t=30):i&&"Netscape"!=navigator.appName?(r.prototype.am=function(e,t,r,n,i,o){for(;--o>=0;){var s=t*this[e++]+r[n]+i;i=Math.floor(s/67108864),r[n++]=67108863&s}return i},t=26):(r.prototype.am=function(e,t,r,n,i,o){for(var s=16383&t,a=t>>14;--o>=0;){var c=16383&this[e],l=this[e++]>>14,u=a*c+l*s;i=((c=s*c+((16383&u)<<14)+r[n]+i)>>28)+(u>>14)+a*l,r[n++]=268435455&c}return i},t=28),r.prototype.DB=t,r.prototype.DM=(1<<t)-1,r.prototype.DV=1<<t;r.prototype.FV=Math.pow(2,52),r.prototype.F1=52-t,r.prototype.F2=2*t-52;var o,s,a="0123456789abcdefghijklmnopqrstuvwxyz",c=new Array;for(o="0".charCodeAt(0),s=0;s<=9;++s)c[o++]=s;for(o="a".charCodeAt(0),s=10;s<36;++s)c[o++]=s;for(o="A".charCodeAt(0),s=10;s<36;++s)c[o++]=s;function l(e){return a.charAt(e)}function u(e,t){var r=c[e.charCodeAt(t)];return null==r?-1:r}function d(e){var t=n();return t.fromInt(e),t}function h(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function f(e){this.m=e}function p(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function m(e,t){return e&t}function v(e,t){return e|t}function g(e,t){return e^t}function _(e,t){return e&~t}function y(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function b(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function w(){}function k(e){return e}function S(e){this.r2=n(),this.q3=n(),r.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}f.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},f.prototype.revert=function(e){return e},f.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},f.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},f.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},p.prototype.convert=function(e){var t=n();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(r.ZERO)>0&&this.m.subTo(t,t),t},p.prototype.revert=function(e){var t=n();return e.copyTo(t),this.reduce(t),t},p.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e[t],n=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[r=t+this.m.t]+=this.m.am(0,n,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},p.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},p.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},r.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},r.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0},r.prototype.fromString=function(e,t){var n;if(16==t)n=4;else if(8==t)n=3;else if(256==t)n=8;else if(2==t)n=1;else if(32==t)n=5;else{if(4!=t)return void this.fromRadix(e,t);n=2}this.t=0,this.s=0;for(var i=e.length,o=!1,s=0;--i>=0;){var a=8==n?255&e[i]:u(e,i);a<0?"-"==e.charAt(i)&&(o=!0):(o=!1,0==s?this[this.t++]=a:s+n>this.DB?(this[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this[this.t++]=a>>this.DB-s):this[this.t-1]|=a<<s,(s+=n)>=this.DB&&(s-=this.DB))}8==n&&0!=(128&e[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),o&&r.ZERO.subTo(this,this)},r.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t},r.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s},r.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s},r.prototype.lShiftTo=function(e,t){var r,n=e%this.DB,i=this.DB-n,o=(1<<i)-1,s=Math.floor(e/this.DB),a=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t[r+s+1]=this[r]>>i|a,a=(this[r]&o)<<n;for(r=s-1;r>=0;--r)t[r]=0;t[s]=a,t.t=this.t+s+1,t.s=this.s,t.clamp()},r.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,i=this.DB-n,o=(1<<n)-1;t[0]=this[r]>>n;for(var s=r+1;s<this.t;++s)t[s-r-1]|=(this[s]&o)<<i,t[s-r]=this[s]>>n;n>0&&(t[this.t-r-1]|=(this.s&o)<<i),t.t=this.t-r,t.clamp()}},r.prototype.subTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]-e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e[r],t[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[r++]=this.DV+n:n>0&&(t[r++]=n),t.t=r,t.clamp()},r.prototype.multiplyTo=function(e,t){var n=this.abs(),i=e.abs(),o=n.t;for(t.t=o+i.t;--o>=0;)t[o]=0;for(o=0;o<i.t;++o)t[o+n.t]=n.am(0,i[o],t,o,0,n.t);t.s=0,t.clamp(),this.s!=e.s&&r.ZERO.subTo(t,t)},r.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()},r.prototype.divRemTo=function(e,t,i){var o=e.abs();if(!(o.t<=0)){var s=this.abs();if(s.t<o.t)return null!=t&&t.fromInt(0),void(null!=i&&this.copyTo(i));null==i&&(i=n());var a=n(),c=this.s,l=e.s,u=this.DB-h(o[o.t-1]);u>0?(o.lShiftTo(u,a),s.lShiftTo(u,i)):(o.copyTo(a),s.copyTo(i));var d=a.t,f=a[d-1];if(0!=f){var p=f*(1<<this.F1)+(d>1?a[d-2]>>this.F2:0),m=this.FV/p,v=(1<<this.F1)/p,g=1<<this.F2,_=i.t,y=_-d,b=null==t?n():t;for(a.dlShiftTo(y,b),i.compareTo(b)>=0&&(i[i.t++]=1,i.subTo(b,i)),r.ONE.dlShiftTo(d,b),b.subTo(a,a);a.t<d;)a[a.t++]=0;for(;--y>=0;){var w=i[--_]==f?this.DM:Math.floor(i[_]*m+(i[_-1]+g)*v);if((i[_]+=a.am(0,w,i,y,0,d))<w)for(a.dlShiftTo(y,b),i.subTo(b,i);i[_]<--w;)i.subTo(b,i)}null!=t&&(i.drShiftTo(d,t),c!=l&&r.ZERO.subTo(t,t)),i.t=d,i.clamp(),u>0&&i.rShiftTo(u,i),c<0&&r.ZERO.subTo(i,i)}}},r.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},r.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},r.prototype.exp=function(e,t){if(e>4294967295||e<1)return r.ONE;var i=n(),o=n(),s=t.convert(this),a=h(e)-1;for(s.copyTo(i);--a>=0;)if(t.sqrTo(i,o),(e&1<<a)>0)t.mulTo(o,s,i);else{var c=i;i=o,o=c}return t.revert(i)},r.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,i=!1,o="",s=this.t,a=this.DB-s*this.DB%t;if(s-- >0)for(a<this.DB&&(r=this[s]>>a)>0&&(i=!0,o=l(r));s>=0;)a<t?(r=(this[s]&(1<<a)-1)<<t-a,r|=this[--s]>>(a+=this.DB-t)):(r=this[s]>>(a-=t)&n,a<=0&&(a+=this.DB,--s)),r>0&&(i=!0),i&&(o+=l(r));return i?o:"0"},r.prototype.negate=function(){var e=n();return r.ZERO.subTo(this,e),e},r.prototype.abs=function(){return this.s<0?this.negate():this},r.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this[r]-e[r]))return t;return 0},r.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+h(this[this.t-1]^this.s&this.DM)},r.prototype.mod=function(e){var t=n();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(r.ZERO)>0&&e.subTo(t,t),t},r.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new f(t):new p(t),this.exp(e,r)},r.ZERO=d(0),r.ONE=d(1),w.prototype.convert=k,w.prototype.revert=k,w.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},w.prototype.sqrTo=function(e,t){e.squareTo(t)},S.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=n();return e.copyTo(t),this.reduce(t),t},S.prototype.revert=function(e){return e},S.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},S.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},S.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var E,C,T,P=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],A=(1<<26)/P[P.length-1];function x(){!function(e){C[T++]^=255&e,C[T++]^=e>>8&255,C[T++]^=e>>16&255,C[T++]^=e>>24&255,T>=D&&(T-=D)}((new Date).getTime())}if(r.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},r.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),i=d(r),o=n(),s=n(),a="";for(this.divRemTo(i,o,s);o.signum()>0;)a=(r+s.intValue()).toString(e).substr(1)+a,o.divRemTo(i,o,s);return s.intValue().toString(e)+a},r.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var n=this.chunkSize(t),i=Math.pow(t,n),o=!1,s=0,a=0,c=0;c<e.length;++c){var l=u(e,c);l<0?"-"==e.charAt(c)&&0==this.signum()&&(o=!0):(a=t*a+l,++s>=n&&(this.dMultiply(i),this.dAddOffset(a,0),s=0,a=0))}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(a,0)),o&&r.ZERO.subTo(this,this)},r.prototype.fromNumber=function(e,t,n){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,n),this.testBit(e-1)||this.bitwiseTo(r.ONE.shiftLeft(e-1),v,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(r.ONE.shiftLeft(e-1),this);else{var i=new Array,o=7&e;i.length=1+(e>>3),t.nextBytes(i),o>0?i[0]&=(1<<o)-1:i[0]=0,this.fromString(i,256)}},r.prototype.bitwiseTo=function(e,t,r){var n,i,o=Math.min(e.t,this.t);for(n=0;n<o;++n)r[n]=t(this[n],e[n]);if(e.t<this.t){for(i=e.s&this.DM,n=o;n<this.t;++n)r[n]=t(this[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=o;n<e.t;++n)r[n]=t(i,e[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},r.prototype.changeBit=function(e,t){var n=r.ONE.shiftLeft(e);return this.bitwiseTo(n,t,n),n},r.prototype.addTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]+e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e[r],t[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t[r++]=n:n<-1&&(t[r++]=this.DV+n),t.t=r,t.clamp()},r.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},r.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},r.prototype.multiplyLowerTo=function(e,t,r){var n,i=Math.min(this.t+e.t,t);for(r.s=0,r.t=i;i>0;)r[--i]=0;for(n=r.t-this.t;i<n;++i)r[i+this.t]=this.am(0,e[i],r,i,0,this.t);for(n=Math.min(e.t,t);i<n;++i)this.am(0,e[i],r,i,0,t-i);r.clamp()},r.prototype.multiplyUpperTo=function(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r[this.t+n-t]=this.am(t-n,e[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},r.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this[n])%e;return r},r.prototype.millerRabin=function(e){var t=this.subtract(r.ONE),i=t.getLowestSetBit();if(i<=0)return!1;var o=t.shiftRight(i);(e=e+1>>1)>P.length&&(e=P.length);for(var s=n(),a=0;a<e;++a){s.fromInt(P[Math.floor(Math.random()*P.length)]);var c=s.modPow(o,this);if(0!=c.compareTo(r.ONE)&&0!=c.compareTo(t)){for(var l=1;l++<i&&0!=c.compareTo(t);)if(0==(c=c.modPowInt(2,this)).compareTo(r.ONE))return!1;if(0!=c.compareTo(t))return!1}}return!0},r.prototype.clone=function(){var e=n();return this.copyTo(e),e},r.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},r.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},r.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},r.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},r.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,i=0;if(e-- >0)for(n<this.DB&&(r=this[e]>>n)!=(this.s&this.DM)>>n&&(t[i++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this[e]&(1<<n)-1)<<8-n,r|=this[--e]>>(n+=this.DB-8)):(r=this[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(i>0||r!=this.s)&&(t[i++]=r);return t},r.prototype.equals=function(e){return 0==this.compareTo(e)},r.prototype.min=function(e){return this.compareTo(e)<0?this:e},r.prototype.max=function(e){return this.compareTo(e)>0?this:e},r.prototype.and=function(e){var t=n();return this.bitwiseTo(e,m,t),t},r.prototype.or=function(e){var t=n();return this.bitwiseTo(e,v,t),t},r.prototype.xor=function(e){var t=n();return this.bitwiseTo(e,g,t),t},r.prototype.andNot=function(e){var t=n();return this.bitwiseTo(e,_,t),t},r.prototype.not=function(){for(var e=n(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},r.prototype.shiftLeft=function(e){var t=n();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},r.prototype.shiftRight=function(e){var t=n();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},r.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+y(this[e]);return this.s<0?this.t*this.DB:-1},r.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=b(this[r]^t);return e},r.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<e%this.DB)},r.prototype.setBit=function(e){return this.changeBit(e,v)},r.prototype.clearBit=function(e){return this.changeBit(e,_)},r.prototype.flipBit=function(e){return this.changeBit(e,g)},r.prototype.add=function(e){var t=n();return this.addTo(e,t),t},r.prototype.subtract=function(e){var t=n();return this.subTo(e,t),t},r.prototype.multiply=function(e){var t=n();return this.multiplyTo(e,t),t},r.prototype.divide=function(e){var t=n();return this.divRemTo(e,t,null),t},r.prototype.remainder=function(e){var t=n();return this.divRemTo(e,null,t),t},r.prototype.divideAndRemainder=function(e){var t=n(),r=n();return this.divRemTo(e,t,r),new Array(t,r)},r.prototype.modPow=function(e,t){var r,i,o=e.bitLength(),s=d(1);if(o<=0)return s;r=o<18?1:o<48?3:o<144?4:o<768?5:6,i=o<8?new f(t):t.isEven()?new S(t):new p(t);var a=new Array,c=3,l=r-1,u=(1<<r)-1;if(a[1]=i.convert(this),r>1){var m=n();for(i.sqrTo(a[1],m);c<=u;)a[c]=n(),i.mulTo(m,a[c-2],a[c]),c+=2}var v,g,_=e.t-1,y=!0,b=n();for(o=h(e[_])-1;_>=0;){for(o>=l?v=e[_]>>o-l&u:(v=(e[_]&(1<<o+1)-1)<<l-o,_>0&&(v|=e[_-1]>>this.DB+o-l)),c=r;0==(1&v);)v>>=1,--c;if((o-=c)<0&&(o+=this.DB,--_),y)a[v].copyTo(s),y=!1;else{for(;c>1;)i.sqrTo(s,b),i.sqrTo(b,s),c-=2;c>0?i.sqrTo(s,b):(g=s,s=b,b=g),i.mulTo(b,a[v],s)}for(;_>=0&&0==(e[_]&1<<o);)i.sqrTo(s,b),g=s,s=b,b=g,--o<0&&(o=this.DB-1,--_)}return i.revert(s)},r.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return r.ZERO;for(var n=e.clone(),i=this.clone(),o=d(1),s=d(0),a=d(0),c=d(1);0!=n.signum();){for(;n.isEven();)n.rShiftTo(1,n),t?(o.isEven()&&s.isEven()||(o.addTo(this,o),s.subTo(e,s)),o.rShiftTo(1,o)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;i.isEven();)i.rShiftTo(1,i),t?(a.isEven()&&c.isEven()||(a.addTo(this,a),c.subTo(e,c)),a.rShiftTo(1,a)):c.isEven()||c.subTo(e,c),c.rShiftTo(1,c);n.compareTo(i)>=0?(n.subTo(i,n),t&&o.subTo(a,o),s.subTo(c,s)):(i.subTo(n,i),t&&a.subTo(o,a),c.subTo(s,c))}return 0!=i.compareTo(r.ONE)?r.ZERO:c.compareTo(e)>=0?c.subtract(e):c.signum()<0?(c.addTo(e,c),c.signum()<0?c.add(e):c):c},r.prototype.pow=function(e){return this.exp(e,new w)},r.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return t;for(i<o&&(o=i),o>0&&(t.rShiftTo(o,t),r.rShiftTo(o,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r},r.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r[0]<=P[P.length-1]){for(t=0;t<P.length;++t)if(r[0]==P[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<P.length;){for(var n=P[t],i=t+1;i<P.length&&n<A;)n*=P[i++];for(n=r.modInt(n);t<i;)if(n%P[t++]==0)return!1}return r.millerRabin(e)},r.prototype.square=function(){var e=n();return this.squareTo(e),e},r.prototype.Barrett=S,null==C){var B;if(C=new Array,T=0,"undefined"!=typeof window&&window.crypto)if(window.crypto.getRandomValues){var I=new Uint8Array(32);for(window.crypto.getRandomValues(I),B=0;B<32;++B)C[T++]=I[B]}else if("Netscape"==navigator.appName&&navigator.appVersion<"5"){var R=window.crypto.random(32);for(B=0;B<R.length;++B)C[T++]=255&R.charCodeAt(B)}for(;T<D;)B=Math.floor(65536*Math.random()),C[T++]=B>>>8,C[T++]=255&B;T=0,x()}function O(){if(null==E){for(x(),(E=new L).init(C),T=0;T<C.length;++T)C[T]=0;T=0}return E.next()}function M(){}function L(){this.i=0,this.j=0,this.S=new Array}M.prototype.nextBytes=function(e){var t;for(t=0;t<e.length;++t)e[t]=O()},L.prototype.init=function(e){var t,r,n;for(t=0;t<256;++t)this.S[t]=t;for(r=0,t=0;t<256;++t)r=r+this.S[t]+e[t%e.length]&255,n=this.S[t],this.S[t]=this.S[r],this.S[r]=n;this.i=0,this.j=0},L.prototype.next=function(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]};var D=256;e.exports={default:r,BigInteger:r,SecureRandom:M}}).call(commonjsGlobal)}(jsbn$1,jsbn$1.exports)),jsbn$1.exports}var sprintf={},hasRequiredSprintf,hasRequiredIpv4;function requireSprintf(){return hasRequiredSprintf||(hasRequiredSprintf=1,function(e){!function(){var t={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function r(e){return function(e,n){var i,o,s,a,c,l,u,d,h,f=1,p=e.length,m="";for(o=0;o<p;o++)if("string"==typeof e[o])m+=e[o];else if("object"===_typeof(e[o])){if((a=e[o]).keys)for(i=n[f],s=0;s<a.keys.length;s++){if(null==i)throw new Error(r('[sprintf] Cannot access property "%s" of undefined value "%s"',a.keys[s],a.keys[s-1]));i=i[a.keys[s]]}else i=a.param_no?n[a.param_no]:n[f++];if(t.not_type.test(a.type)&&t.not_primitive.test(a.type)&&i instanceof Function&&(i=i()),t.numeric_arg.test(a.type)&&"number"!=typeof i&&isNaN(i))throw new TypeError(r("[sprintf] expecting number but found %T",i));switch(t.number.test(a.type)&&(d=i>=0),a.type){case"b":i=parseInt(i,10).toString(2);break;case"c":i=String.fromCharCode(parseInt(i,10));break;case"d":case"i":i=parseInt(i,10);break;case"j":i=JSON.stringify(i,null,a.width?parseInt(a.width):0);break;case"e":i=a.precision?parseFloat(i).toExponential(a.precision):parseFloat(i).toExponential();break;case"f":i=a.precision?parseFloat(i).toFixed(a.precision):parseFloat(i);break;case"g":i=a.precision?String(Number(i.toPrecision(a.precision))):parseFloat(i);break;case"o":i=(parseInt(i,10)>>>0).toString(8);break;case"s":i=String(i),i=a.precision?i.substring(0,a.precision):i;break;case"t":i=String(!!i),i=a.precision?i.substring(0,a.precision):i;break;case"T":i=Object.prototype.toString.call(i).slice(8,-1).toLowerCase(),i=a.precision?i.substring(0,a.precision):i;break;case"u":i=parseInt(i,10)>>>0;break;case"v":i=i.valueOf(),i=a.precision?i.substring(0,a.precision):i;break;case"x":i=(parseInt(i,10)>>>0).toString(16);break;case"X":i=(parseInt(i,10)>>>0).toString(16).toUpperCase()}t.json.test(a.type)?m+=i:(!t.number.test(a.type)||d&&!a.sign?h="":(h=d?"+":"-",i=i.toString().replace(t.sign,"")),l=a.pad_char?"0"===a.pad_char?"0":a.pad_char.charAt(1):" ",u=a.width-(h+i).length,c=a.width&&u>0?l.repeat(u):"",m+=a.align?h+i+c:"0"===l?h+c+i:c+h+i)}return m}(function(e){if(i[e])return i[e];var r,n=e,o=[],s=0;for(;n;){if(null!==(r=t.text.exec(n)))o.push(r[0]);else if(null!==(r=t.modulo.exec(n)))o.push("%");else{if(null===(r=t.placeholder.exec(n)))throw new SyntaxError("[sprintf] unexpected placeholder");if(r[2]){s|=1;var a=[],c=r[2],l=[];if(null===(l=t.key.exec(c)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(a.push(l[1]);""!==(c=c.substring(l[0].length));)if(null!==(l=t.key_access.exec(c)))a.push(l[1]);else{if(null===(l=t.index_access.exec(c)))throw new SyntaxError("[sprintf] failed to parse named argument key");a.push(l[1])}r[2]=a}else s|=2;if(3===s)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");o.push({placeholder:r[0],param_no:r[1],keys:r[2],sign:r[3],pad_char:r[4],align:r[5],width:r[6],precision:r[7],type:r[8]})}n=n.substring(r[0].length)}return i[e]=o}(e),arguments)}function n(e,t){return r.apply(null,[e].concat(t||[]))}var i=Object.create(null);e.sprintf=r,e.vsprintf=n,"undefined"!=typeof window&&(window.sprintf=r,window.vsprintf=n)}()}(sprintf)),sprintf}function requireIpv4(){if(hasRequiredIpv4)return ipv4;hasRequiredIpv4=1;var e=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),t=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=commonjsGlobal&&commonjsGlobal.__importStar||function(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var i in r)"default"!==i&&Object.prototype.hasOwnProperty.call(r,i)&&e(n,r,i);return t(n,r),n};Object.defineProperty(ipv4,"__esModule",{value:!0}),ipv4.Address4=void 0;var n=r(requireCommon()),i=r(requireConstants$1()),o=requireAddressError(),s=requireJsbn(),a=requireSprintf(),c=function(){function e(t){_classCallCheck(this,e),this.groups=i.GROUPS,this.parsedAddress=[],this.parsedSubnet="",this.subnet="/32",this.subnetMask=32,this.v4=!0,this.isCorrect=n.isCorrect(i.BITS),this.isInSubnet=n.isInSubnet,this.address=t;var r=i.RE_SUBNET_STRING.exec(t);if(r){if(this.parsedSubnet=r[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/".concat(this.subnetMask),this.subnetMask<0||this.subnetMask>i.BITS)throw new o.AddressError("Invalid subnet mask.");t=t.replace(i.RE_SUBNET_STRING,"")}this.addressMinusSuffix=t,this.parsedAddress=this.parse(t)}return _createClass(e,[{key:"parse",value:function(e){var t=e.split(".");if(!e.match(i.RE_ADDRESS))throw new o.AddressError("Invalid IPv4 address.");return t}},{key:"correctForm",value:function(){return this.parsedAddress.map((function(e){return parseInt(e,10)})).join(".")}},{key:"toHex",value:function(){return this.parsedAddress.map((function(e){return(0,a.sprintf)("%02x",parseInt(e,10))})).join(":")}},{key:"toArray",value:function(){return this.parsedAddress.map((function(e){return parseInt(e,10)}))}},{key:"toGroup6",value:function(){var e,t=[];for(e=0;e<i.GROUPS;e+=2){var r=(0,a.sprintf)("%02x%02x",parseInt(this.parsedAddress[e],10),parseInt(this.parsedAddress[e+1],10));t.push((0,a.sprintf)("%x",parseInt(r,16)))}return t.join(":")}},{key:"bigInteger",value:function(){return new s.BigInteger(this.parsedAddress.map((function(e){return(0,a.sprintf)("%02x",parseInt(e,10))})).join(""),16)}},{key:"_startAddress",value:function(){return new s.BigInteger(this.mask()+"0".repeat(i.BITS-this.subnetMask),2)}},{key:"startAddress",value:function(){return e.fromBigInteger(this._startAddress())}},{key:"startAddressExclusive",value:function(){var t=new s.BigInteger("1");return e.fromBigInteger(this._startAddress().add(t))}},{key:"_endAddress",value:function(){return new s.BigInteger(this.mask()+"1".repeat(i.BITS-this.subnetMask),2)}},{key:"endAddress",value:function(){return e.fromBigInteger(this._endAddress())}},{key:"endAddressExclusive",value:function(){var t=new s.BigInteger("1");return e.fromBigInteger(this._endAddress().subtract(t))}},{key:"mask",value:function(e){return void 0===e&&(e=this.subnetMask),this.getBitsBase2(0,e)}},{key:"getBitsBase2",value:function(e,t){return this.binaryZeroPad().slice(e,t)}},{key:"reverseForm",value:function(e){e||(e={});var t=this.correctForm().split(".").reverse().join(".");return e.omitSuffix?t:(0,a.sprintf)("%s.in-addr.arpa.",t)}},{key:"isMulticast",value:function(){return this.isInSubnet(new e("224.0.0.0/4"))}},{key:"binaryZeroPad",value:function(){return this.bigInteger().toString(2).padStart(i.BITS,"0")}},{key:"groupForV6",value:function(){var e=this.parsedAddress;return this.address.replace(i.RE_ADDRESS,(0,a.sprintf)('<span class="hover-group group-v4 group-6">%s</span>.<span class="hover-group group-v4 group-7">%s</span>',e.slice(0,2).join("."),e.slice(2,4).join(".")))}}],[{key:"isValid",value:function(t){try{return new e(t),!0}catch(e){return!1}}},{key:"fromHex",value:function(t){var r,n=t.replace(/:/g,"").padStart(8,"0"),i=[];for(r=0;r<8;r+=2){var o=n.slice(r,r+2);i.push(parseInt(o,16))}return new e(i.join("."))}},{key:"fromInteger",value:function(t){return e.fromHex(t.toString(16))}},{key:"fromArpa",value:function(t){return new e(t.replace(/(\.in-addr\.arpa)?\.$/,"").split(".").reverse().join("."))}},{key:"fromBigInteger",value:function(t){return e.fromInteger(parseInt(t.toString(),10))}}]),e}();return ipv4.Address4=c,ipv4}var ipv6={},constants={},hasRequiredConstants;function requireConstants(){return hasRequiredConstants||(hasRequiredConstants=1,Object.defineProperty(constants,"__esModule",{value:!0}),constants.RE_URL_WITH_PORT=constants.RE_URL=constants.RE_ZONE_STRING=constants.RE_SUBNET_STRING=constants.RE_BAD_ADDRESS=constants.RE_BAD_CHARACTERS=constants.TYPES=constants.SCOPES=constants.GROUPS=constants.BITS=void 0,constants.BITS=128,constants.GROUPS=8,constants.SCOPES={0:"Reserved",1:"Interface local",2:"Link local",4:"Admin local",5:"Site local",8:"Organization local",14:"Global",15:"Reserved"},constants.TYPES={"ff01::1/128":"Multicast (All nodes on this interface)","ff01::2/128":"Multicast (All routers on this interface)","ff02::1/128":"Multicast (All nodes on this link)","ff02::2/128":"Multicast (All routers on this link)","ff05::2/128":"Multicast (All routers in this site)","ff02::5/128":"Multicast (OSPFv3 AllSPF routers)","ff02::6/128":"Multicast (OSPFv3 AllDR routers)","ff02::9/128":"Multicast (RIP routers)","ff02::a/128":"Multicast (EIGRP routers)","ff02::d/128":"Multicast (PIM routers)","ff02::16/128":"Multicast (MLDv2 reports)","ff01::fb/128":"Multicast (mDNSv6)","ff02::fb/128":"Multicast (mDNSv6)","ff05::fb/128":"Multicast (mDNSv6)","ff02::1:2/128":"Multicast (All DHCP servers and relay agents on this link)","ff05::1:2/128":"Multicast (All DHCP servers and relay agents in this site)","ff02::1:3/128":"Multicast (All DHCP servers on this link)","ff05::1:3/128":"Multicast (All DHCP servers in this site)","::/128":"Unspecified","::1/128":"Loopback","ff00::/8":"Multicast","fe80::/10":"Link-local unicast"},constants.RE_BAD_CHARACTERS=/([^0-9a-f:/%])/gi,constants.RE_BAD_ADDRESS=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/gi,constants.RE_SUBNET_STRING=/\/\d{1,3}(?=%|$)/,constants.RE_ZONE_STRING=/%.*$/,constants.RE_URL=new RegExp(/^\[{0,1}([0-9a-f:]+)\]{0,1}/),constants.RE_URL_WITH_PORT=new RegExp(/\[([0-9a-f:]+)\]:([0-9]{1,5})/)),constants}var helpers={},hasRequiredHelpers$1;function requireHelpers$1(){if(hasRequiredHelpers$1)return helpers;hasRequiredHelpers$1=1,Object.defineProperty(helpers,"__esModule",{value:!0}),helpers.simpleGroup=helpers.spanLeadingZeroes=helpers.spanAll=helpers.spanAllZeroes=void 0;var e=requireSprintf();function t(e){return e.replace(/(0+)/g,'<span class="zero">$1</span>')}function r(e){return e.replace(/^(0+)/,'<span class="zero">$1</span>')}return helpers.spanAllZeroes=t,helpers.spanAll=function(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return r.split("").map((function(r,i){return(0,e.sprintf)('<span class="digit value-%s position-%d">%s</span>',r,i+n,t(r))})).join("")},helpers.spanLeadingZeroes=function(e){return e.split(":").map((function(e){return r(e)})).join(":")},helpers.simpleGroup=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.split(":").map((function(t,i){return/group-v4/.test(t)?t:(0,e.sprintf)('<span class="hover-group group-%d">%s</span>',i+n,r(t))}))},helpers}var regularExpressions={},hasRequiredRegularExpressions,hasRequiredIpv6,hasRequiredIpAddress,hasRequiredHelpers;function requireRegularExpressions(){if(hasRequiredRegularExpressions)return regularExpressions;hasRequiredRegularExpressions=1;var e=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),t=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=commonjsGlobal&&commonjsGlobal.__importStar||function(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var i in r)"default"!==i&&Object.prototype.hasOwnProperty.call(r,i)&&e(n,r,i);return t(n,r),n};Object.defineProperty(regularExpressions,"__esModule",{value:!0}),regularExpressions.possibleElisions=regularExpressions.simpleRegularExpression=regularExpressions.ADDRESS_BOUNDARY=regularExpressions.padGroup=regularExpressions.groupPossibilities=void 0;var n=r(requireConstants()),i=requireSprintf();function o(e){return(0,i.sprintf)("(%s)",e.join("|"))}function s(e){return e.length<4?(0,i.sprintf)("0{0,%d}%s",4-e.length,e):e}return regularExpressions.groupPossibilities=o,regularExpressions.padGroup=s,regularExpressions.ADDRESS_BOUNDARY="[^A-Fa-f0-9:]",regularExpressions.simpleRegularExpression=function(e){var t=[];e.forEach((function(e,r){0===parseInt(e,16)&&t.push(r)}));var r=t.map((function(t){return e.map((function(e,r){if(r===t){var i=0===r||r===n.GROUPS-1?":":"";return o([s(e),i])}return s(e)})).join(":")}));return r.push(e.map(s).join(":")),o(r)},regularExpressions.possibleElisions=function(e,t,r){var n=t?"":":",s=r?"":":",a=[];t||r||a.push("::"),t&&r&&a.push(""),(r&&!t||!r&&t)&&a.push(":"),a.push((0,i.sprintf)("%s(:0{1,4}){1,%d}",n,e-1)),a.push((0,i.sprintf)("(0{1,4}:){1,%d}%s",e-1,s)),a.push((0,i.sprintf)("(0{1,4}:){%d}0{1,4}",e-1));for(var c=1;c<e-1;c++)for(var l=1;l<e-c;l++)a.push((0,i.sprintf)("(0{1,4}:){%d}:(0{1,4}:){%d}0{1,4}",l,e-l-c-1));return o(a)},regularExpressions}function requireIpv6(){if(hasRequiredIpv6)return ipv6;hasRequiredIpv6=1;var e=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),t=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=commonjsGlobal&&commonjsGlobal.__importStar||function(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var i in r)"default"!==i&&Object.prototype.hasOwnProperty.call(r,i)&&e(n,r,i);return t(n,r),n};Object.defineProperty(ipv6,"__esModule",{value:!0}),ipv6.Address6=void 0;var n=r(requireCommon()),i=r(requireConstants$1()),o=r(requireConstants()),s=r(requireHelpers$1()),a=requireIpv4(),c=requireRegularExpressions(),l=requireAddressError(),u=requireJsbn(),d=requireSprintf();function h(e){if(!e)throw new Error("Assertion failed.")}function f(e){return e=(e=e.replace(/^(0{1,})([1-9]+)$/,'<span class="parse-error">$1</span>$2')).replace(/^(0{1,})(0)$/,'<span class="parse-error">$1</span>$2')}function p(e){return(0,d.sprintf)("%04x",parseInt(e,16))}function m(e){return 255&e}var v=function(){function e(t,r){_classCallCheck(this,e),this.addressMinusSuffix="",this.parsedSubnet="",this.subnet="/128",this.subnetMask=128,this.v4=!1,this.zone="",this.isInSubnet=n.isInSubnet,this.isCorrect=n.isCorrect(o.BITS),this.groups=void 0===r?o.GROUPS:r,this.address=t;var i=o.RE_SUBNET_STRING.exec(t);if(i){if(this.parsedSubnet=i[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/".concat(this.subnetMask),Number.isNaN(this.subnetMask)||this.subnetMask<0||this.subnetMask>o.BITS)throw new l.AddressError("Invalid subnet mask.");t=t.replace(o.RE_SUBNET_STRING,"")}else if(/\//.test(t))throw new l.AddressError("Invalid subnet mask.");var s=o.RE_ZONE_STRING.exec(t);s&&(this.zone=s[0],t=t.replace(o.RE_ZONE_STRING,"")),this.addressMinusSuffix=t,this.parsedAddress=this.parse(this.addressMinusSuffix)}return _createClass(e,[{key:"microsoftTranscription",value:function(){return(0,d.sprintf)("%s.ipv6-literal.net",this.correctForm().replace(/:/g,"-"))}},{key:"mask",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.subnetMask;return this.getBitsBase2(0,e)}},{key:"possibleSubnets",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128,t=o.BITS-this.subnetMask-Math.abs(e-o.BITS);return t<0?"0":function(e){for(var t=/(\d+)(\d{3})/;t.test(e);)e=e.replace(t,"$1,$2");return e}(new u.BigInteger("2",10).pow(t).toString(10))}},{key:"_startAddress",value:function(){return new u.BigInteger(this.mask()+"0".repeat(o.BITS-this.subnetMask),2)}},{key:"startAddress",value:function(){return e.fromBigInteger(this._startAddress())}},{key:"startAddressExclusive",value:function(){var t=new u.BigInteger("1");return e.fromBigInteger(this._startAddress().add(t))}},{key:"_endAddress",value:function(){return new u.BigInteger(this.mask()+"1".repeat(o.BITS-this.subnetMask),2)}},{key:"endAddress",value:function(){return e.fromBigInteger(this._endAddress())}},{key:"endAddressExclusive",value:function(){var t=new u.BigInteger("1");return e.fromBigInteger(this._endAddress().subtract(t))}},{key:"getScope",value:function(){var e=o.SCOPES[this.getBits(12,16).intValue()];return"Global unicast"===this.getType()&&"Link local"!==e&&(e="Global"),e||"Unknown"}},{key:"getType",value:function(){for(var t=0,r=Object.keys(o.TYPES);t<r.length;t++){var n=r[t];if(this.isInSubnet(new e(n)))return o.TYPES[n]}return"Global unicast"}},{key:"getBits",value:function(e,t){return new u.BigInteger(this.getBitsBase2(e,t),2)}},{key:"getBitsBase2",value:function(e,t){return this.binaryZeroPad().slice(e,t)}},{key:"getBitsBase16",value:function(e,t){var r=t-e;if(r%4!=0)throw new Error("Length of bits to retrieve must be divisible by four");return this.getBits(e,t).toString(16).padStart(r/4,"0")}},{key:"getBitsPastSubnet",value:function(){return this.getBitsBase2(this.subnetMask,o.BITS)}},{key:"reverseForm",value:function(e){e||(e={});var t=Math.floor(this.subnetMask/4),r=this.canonicalForm().replace(/:/g,"").split("").slice(0,t).reverse().join(".");return t>0?e.omitSuffix?r:(0,d.sprintf)("%s.ip6.arpa.",r):e.omitSuffix?"":"ip6.arpa."}},{key:"correctForm",value:function(){var e,t=[],r=0,n=[];for(e=0;e<this.parsedAddress.length;e++){var i=parseInt(this.parsedAddress[e],16);0===i&&r++,0!==i&&r>0&&(r>1&&n.push([e-r,e-1]),r=0)}r>1&&n.push([this.parsedAddress.length-r,this.parsedAddress.length-1]);var o=n.map((function(e){return e[1]-e[0]+1}));if(n.length>0){var s=o.indexOf(Math.max.apply(Math,_toConsumableArray(o)));t=function(e,t){var r,n=[],i=[];for(r=0;r<e.length;r++)r<t[0]?n.push(e[r]):r>t[1]&&i.push(e[r]);return n.concat(["compact"]).concat(i)}(this.parsedAddress,n[s])}else t=this.parsedAddress;for(e=0;e<t.length;e++)"compact"!==t[e]&&(t[e]=parseInt(t[e],16).toString(16));var a=t.join(":");return a=(a=(a=a.replace(/^compact$/,"::")).replace(/^compact|compact$/,":")).replace(/compact/,"")}},{key:"binaryZeroPad",value:function(){return this.bigInteger().toString(2).padStart(o.BITS,"0")}},{key:"parse4in6",value:function(e){var t=e.split(":"),r=t.slice(-1)[0].match(i.RE_ADDRESS);if(r){this.parsedAddress4=r[0],this.address4=new a.Address4(this.parsedAddress4);for(var n=0;n<this.address4.groups;n++)if(/^0[0-9]+/.test(this.address4.parsedAddress[n]))throw new l.AddressError("IPv4 addresses can't have leading zeroes.",e.replace(i.RE_ADDRESS,this.address4.parsedAddress.map(f).join(".")));this.v4=!0,t[t.length-1]=this.address4.toGroup6(),e=t.join(":")}return e}},{key:"parse",value:function(e){var t=(e=this.parse4in6(e)).match(o.RE_BAD_CHARACTERS);if(t)throw new l.AddressError((0,d.sprintf)("Bad character%s detected in address: %s",t.length>1?"s":"",t.join("")),e.replace(o.RE_BAD_CHARACTERS,'<span class="parse-error">$1</span>'));var r=e.match(o.RE_BAD_ADDRESS);if(r)throw new l.AddressError((0,d.sprintf)("Address failed regex: %s",r.join("")),e.replace(o.RE_BAD_ADDRESS,'<span class="parse-error">$1</span>'));var n=[],i=e.split("::");if(2===i.length){var s=i[0].split(":"),a=i[1].split(":");1===s.length&&""===s[0]&&(s=[]),1===a.length&&""===a[0]&&(a=[]);var c=this.groups-(s.length+a.length);if(!c)throw new l.AddressError("Error parsing groups");this.elidedGroups=c,this.elisionBegin=s.length,this.elisionEnd=s.length+this.elidedGroups,n=n.concat(s);for(var u=0;u<c;u++)n.push("0");n=n.concat(a)}else{if(1!==i.length)throw new l.AddressError("Too many :: groups found");n=e.split(":"),this.elidedGroups=0}if((n=n.map((function(e){return(0,d.sprintf)("%x",parseInt(e,16))}))).length!==this.groups)throw new l.AddressError("Incorrect number of groups found");return n}},{key:"canonicalForm",value:function(){return this.parsedAddress.map(p).join(":")}},{key:"decimal",value:function(){return this.parsedAddress.map((function(e){return(0,d.sprintf)("%05d",parseInt(e,16))})).join(":")}},{key:"bigInteger",value:function(){return new u.BigInteger(this.parsedAddress.map(p).join(""),16)}},{key:"to4",value:function(){var e=this.binaryZeroPad().split("");return a.Address4.fromHex(new u.BigInteger(e.slice(96,128).join(""),2).toString(16))}},{key:"to4in6",value:function(){var t=this.to4(),r=new e(this.parsedAddress.slice(0,6).join(":"),6).correctForm(),n="";return/:$/.test(r)||(n=":"),r+n+t.address}},{key:"inspectTeredo",value:function(){var e=this.getBitsBase16(0,32),t=this.getBits(80,96).xor(new u.BigInteger("ffff",16)).toString(),r=a.Address4.fromHex(this.getBitsBase16(32,64)),n=a.Address4.fromHex(this.getBits(96,128).xor(new u.BigInteger("ffffffff",16)).toString(16)),i=this.getBits(64,80),o=this.getBitsBase2(64,80),s=i.testBit(15),c=i.testBit(14),l=i.testBit(8),h=i.testBit(9),f=new u.BigInteger(o.slice(2,6)+o.slice(8,16),2).toString(10);return{prefix:(0,d.sprintf)("%s:%s",e.slice(0,4),e.slice(4,8)),server4:r.address,client4:n.address,flags:o,coneNat:s,microsoft:{reserved:c,universalLocal:h,groupIndividual:l,nonce:f},udpPort:t}}},{key:"inspect6to4",value:function(){var e=this.getBitsBase16(0,16),t=a.Address4.fromHex(this.getBitsBase16(16,48));return{prefix:(0,d.sprintf)("%s",e.slice(0,4)),gateway:t.address}}},{key:"to6to4",value:function(){return this.is4()?new e(["2002",this.getBitsBase16(96,112),this.getBitsBase16(112,128),"","/16"].join(":")):null}},{key:"toByteArray",value:function(){var e=this.bigInteger().toByteArray();return 17===e.length&&0===e[0]?e.slice(1):e}},{key:"toUnsignedByteArray",value:function(){return this.toByteArray().map(m)}},{key:"isCanonical",value:function(){return this.addressMinusSuffix===this.canonicalForm()}},{key:"isLinkLocal",value:function(){return"1111111010000000000000000000000000000000000000000000000000000000"===this.getBitsBase2(0,64)}},{key:"isMulticast",value:function(){return"Multicast"===this.getType()}},{key:"is4",value:function(){return this.v4}},{key:"isTeredo",value:function(){return this.isInSubnet(new e("2001::/32"))}},{key:"is6to4",value:function(){return this.isInSubnet(new e("2002::/16"))}},{key:"isLoopback",value:function(){return"Loopback"===this.getType()}},{key:"href",value:function(e){return e=void 0===e?"":(0,d.sprintf)(":%s",e),(0,d.sprintf)("http://[%s]%s/",this.correctForm(),e)}},{key:"link",value:function(e){e||(e={}),void 0===e.className&&(e.className=""),void 0===e.prefix&&(e.prefix="/#address="),void 0===e.v4&&(e.v4=!1);var t=this.correctForm;return e.v4&&(t=this.to4in6),e.className?(0,d.sprintf)('<a href="%1$s%2$s" class="%3$s">%2$s</a>',e.prefix,t.call(this),e.className):(0,d.sprintf)('<a href="%1$s%2$s">%2$s</a>',e.prefix,t.call(this))}},{key:"group",value:function(){if(0===this.elidedGroups)return s.simpleGroup(this.address).join(":");h("number"==typeof this.elidedGroups),h("number"==typeof this.elisionBegin);var e=[],t=_slicedToArray(this.address.split("::"),2),r=t[0],n=t[1];r.length?e.push.apply(e,_toConsumableArray(s.simpleGroup(r))):e.push("");for(var i=["hover-group"],o=this.elisionBegin;o<this.elisionBegin+this.elidedGroups;o++)i.push((0,d.sprintf)("group-%d",o));return e.push((0,d.sprintf)('<span class="%s"></span>',i.join(" "))),n.length?e.push.apply(e,_toConsumableArray(s.simpleGroup(n,this.elisionEnd))):e.push(""),this.is4()&&(h(this.address4 instanceof a.Address4),e.pop(),e.push(this.address4.groupForV6())),e.join(":")}},{key:"regularExpressionString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=[],n=new e(this.correctForm());if(0===n.elidedGroups)r.push((0,c.simpleRegularExpression)(n.parsedAddress));else if(n.elidedGroups===o.GROUPS)r.push((0,c.possibleElisions)(o.GROUPS));else{var i=n.address.split("::");i[0].length&&r.push((0,c.simpleRegularExpression)(i[0].split(":"))),h("number"==typeof n.elidedGroups),r.push((0,c.possibleElisions)(n.elidedGroups,0!==i[0].length,0!==i[1].length)),i[1].length&&r.push((0,c.simpleRegularExpression)(i[1].split(":"))),r=[r.join(":")]}return t||(r=["(?=^|",c.ADDRESS_BOUNDARY,"|[^\\w\\:])("].concat(_toConsumableArray(r),[")(?=[^\\w\\:]|",c.ADDRESS_BOUNDARY,"|$)"])),r.join("")}},{key:"regularExpression",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new RegExp(this.regularExpressionString(e),"i")}}],[{key:"isValid",value:function(t){try{return new e(t),!0}catch(e){return!1}}},{key:"fromBigInteger",value:function(t){var r,n=t.toString(16).padStart(32,"0"),i=[];for(r=0;r<o.GROUPS;r++)i.push(n.slice(4*r,4*(r+1)));return new e(i.join(":"))}},{key:"fromURL",value:function(t){var r,n,i=null;if(-1!==t.indexOf("[")&&-1!==t.indexOf("]:")){if(null===(n=o.RE_URL_WITH_PORT.exec(t)))return{error:"failed to parse address with port",address:null,port:null};r=n[1],i=n[2]}else if(-1!==t.indexOf("/")){if(t=t.replace(/^[a-z0-9]+:\/\//,""),null===(n=o.RE_URL.exec(t)))return{error:"failed to parse address from URL",address:null,port:null};r=n[1]}else r=t;return i?((i=parseInt(i,10))<0||i>65536)&&(i=null):i=null,{address:new e(r),port:i}}},{key:"fromAddress4",value:function(t){var r=new a.Address4(t),n=o.BITS-(i.BITS-r.subnetMask);return new e("::ffff:".concat(r.correctForm(),"/").concat(n))}},{key:"fromArpa",value:function(t){var r=t.replace(/(\.ip6\.arpa)?\.$/,"");if(63!==r.length)throw new l.AddressError("Invalid 'ip6.arpa' form.");for(var n=r.split(".").reverse(),i=7;i>0;i--){var o=4*i;n.splice(o,0,":")}return new e(r=n.join(""))}},{key:"fromByteArray",value:function(e){return this.fromUnsignedByteArray(e.map(m))}},{key:"fromUnsignedByteArray",value:function(t){for(var r=new u.BigInteger("256",10),n=new u.BigInteger("0",10),i=new u.BigInteger("1",10),o=t.length-1;o>=0;o--)n=n.add(i.multiply(new u.BigInteger(t[o].toString(10),10))),i=i.multiply(r);return e.fromBigInteger(n)}}]),e}();return ipv6.Address6=v,ipv6}function requireIpAddress(){return hasRequiredIpAddress||(hasRequiredIpAddress=1,function(e){var t=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&t(n,e,i);return r(n,e),n};Object.defineProperty(e,"__esModule",{value:!0}),e.v6=e.AddressError=e.Address6=e.Address4=void 0;var i=requireIpv4();Object.defineProperty(e,"Address4",{enumerable:!0,get:function(){return i.Address4}});var o=requireIpv6();Object.defineProperty(e,"Address6",{enumerable:!0,get:function(){return o.Address6}});var s=requireAddressError();Object.defineProperty(e,"AddressError",{enumerable:!0,get:function(){return s.AddressError}});var a=n(requireHelpers$1());e.v6={helpers:a}}(ipAddress)),ipAddress}function requireHelpers(){if(hasRequiredHelpers)return helpers$1;hasRequiredHelpers=1,Object.defineProperty(helpers$1,"__esModule",{value:!0}),helpers$1.ipToBuffer=helpers$1.int32ToIpv4=helpers$1.ipv4ToInt32=helpers$1.validateSocksClientChainOptions=helpers$1.validateSocksClientOptions=void 0;var e=requireUtil(),t=requireConstants$2(),r=require$$1$5,n=requireIpAddress(),i=require$$1;function o(r,n){if(void 0!==r.custom_auth_method){if(r.custom_auth_method<t.SOCKS5_CUSTOM_AUTH_START||r.custom_auth_method>t.SOCKS5_CUSTOM_AUTH_END)throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsCustomAuthRange,n);if(void 0===r.custom_auth_request_handler||"function"!=typeof r.custom_auth_request_handler)throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsCustomAuthOptions,n);if(void 0===r.custom_auth_response_size)throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsCustomAuthOptions,n);if(void 0===r.custom_auth_response_handler||"function"!=typeof r.custom_auth_response_handler)throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsCustomAuthOptions,n)}}function s(e){return e&&"string"==typeof e.host&&Buffer$4.byteLength(e.host)<256&&"number"==typeof e.port&&e.port>=0&&e.port<=65535}function a(e){return e&&("string"==typeof e.host||"string"==typeof e.ipaddress)&&"number"==typeof e.port&&e.port>=0&&e.port<=65535&&(4===e.type||5===e.type)}function c(e){return"number"==typeof e&&e>0}return helpers$1.validateSocksClientOptions=function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["connect","bind","associate"];if(!t.SocksCommand[n.command])throw new e.SocksClientError(t.ERRORS.InvalidSocksCommand,n);if(-1===i.indexOf(n.command))throw new e.SocksClientError(t.ERRORS.InvalidSocksCommandForOperation,n);if(!s(n.destination))throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsDestination,n);if(!a(n.proxy))throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsProxy,n);if(o(n.proxy,n),n.timeout&&!c(n.timeout))throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsTimeout,n);if(n.existing_socket&&!(n.existing_socket instanceof r.Duplex))throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsExistingSocket,n)},helpers$1.validateSocksClientChainOptions=function(r){if("connect"!==r.command)throw new e.SocksClientError(t.ERRORS.InvalidSocksCommandChain,r);if(!s(r.destination))throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsDestination,r);if(!(r.proxies&&Array.isArray(r.proxies)&&r.proxies.length>=2))throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsProxiesLength,r);if(r.proxies.forEach((function(n){if(!a(n))throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsProxy,r);o(n,r)})),r.timeout&&!c(r.timeout))throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsTimeout,r)},helpers$1.ipv4ToInt32=function(e){return new n.Address4(e).toArray().reduce((function(e,t){return(e<<8)+t}),0)>>>0},helpers$1.int32ToIpv4=function(e){return[e>>>24&255,e>>>16&255,e>>>8&255,255&e].join(".")},helpers$1.ipToBuffer=function(e){if(i.isIPv4(e)){var t=new n.Address4(e);return Buffer$4.from(t.toArray())}if(i.isIPv6(e)){var r=new n.Address6(e);return Buffer$4.from(r.canonicalForm().split(":").map((function(e){return e.padStart(4,"0")})).join(""),"hex")}throw new Error("Invalid IP address format")},helpers$1}var receivebuffer={},hasRequiredReceivebuffer,hasRequiredSocksclient,hasRequiredBuild;function requireReceivebuffer(){if(hasRequiredReceivebuffer)return receivebuffer;hasRequiredReceivebuffer=1,Object.defineProperty(receivebuffer,"__esModule",{value:!0}),receivebuffer.ReceiveBuffer=void 0;var e=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4096;_classCallCheck(this,e),this.buffer=Buffer$4.allocUnsafe(t),this.offset=0,this.originalSize=t}return _createClass(e,[{key:"length",get:function(){return this.offset}},{key:"append",value:function(e){if(!Buffer$4.isBuffer(e))throw new Error("Attempted to append a non-buffer instance to ReceiveBuffer.");if(this.offset+e.length>=this.buffer.length){var t=this.buffer;this.buffer=Buffer$4.allocUnsafe(Math.max(this.buffer.length+this.originalSize,this.buffer.length+e.length)),t.copy(this.buffer)}return e.copy(this.buffer,this.offset),this.offset+=e.length}},{key:"peek",value:function(e){if(e>this.offset)throw new Error("Attempted to read beyond the bounds of the managed internal data.");return this.buffer.slice(0,e)}},{key:"get",value:function(e){if(e>this.offset)throw new Error("Attempted to read beyond the bounds of the managed internal data.");var t=Buffer$4.allocUnsafe(e);return this.buffer.slice(0,e).copy(t),this.buffer.copyWithin(0,e,e+this.offset-e),this.offset-=e,t}}]),e}();return receivebuffer.ReceiveBuffer=e,receivebuffer}function requireSocksclient(){return hasRequiredSocksclient||(hasRequiredSocksclient=1,function(e){var t=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.SocksClientError=e.SocksClient=void 0;var r=require$$0$8,n=require$$1,i=requireSmartbuffer(),o=requireConstants$2(),s=requireHelpers(),a=requireReceivebuffer(),c=requireUtil();Object.defineProperty(e,"SocksClientError",{enumerable:!0,get:function(){return c.SocksClientError}});var l=requireIpAddress(),u=function(e){function r(e){var t;return _classCallCheck(this,r),(t=_callSuper(this,r)).options=Object.assign({},e),(0,s.validateSocksClientOptions)(e),t.setState(o.SocksClientState.Created),t}return _inherits(r,e),_createClass(r,[{key:"setState",value:function(e){this.state!==o.SocksClientState.Error&&(this.state=e)}},{key:"connect",value:function(e){var t=this;this.onDataReceived=function(e){return t.onDataReceivedHandler(e)},this.onClose=function(){return t.onCloseHandler()},this.onError=function(e){return t.onErrorHandler(e)},this.onConnect=function(){return t.onConnectHandler()};var r=setTimeout((function(){return t.onEstablishedTimeout()}),this.options.timeout||o.DEFAULT_TIMEOUT);r.unref&&"function"==typeof r.unref&&r.unref(),this.socket=e||new n.Socket,this.socket.once("close",this.onClose),this.socket.once("error",this.onError),this.socket.once("connect",this.onConnect),this.socket.on("data",this.onDataReceived),this.setState(o.SocksClientState.Connecting),this.receiveBuffer=new a.ReceiveBuffer,e?this.socket.emit("connect"):(this.socket.connect(this.getSocketOptions()),void 0!==this.options.set_tcp_nodelay&&null!==this.options.set_tcp_nodelay&&this.socket.setNoDelay(!!this.options.set_tcp_nodelay)),this.prependOnceListener("established",(function(e){setImmediate((function(){if(t.receiveBuffer.length>0){var r=t.receiveBuffer.get(t.receiveBuffer.length);e.socket.emit("data",r)}e.socket.resume()}))}))}},{key:"getSocketOptions",value:function(){return Object.assign(Object.assign({},this.options.socket_options),{host:this.options.proxy.host||this.options.proxy.ipaddress,port:this.options.proxy.port})}},{key:"onEstablishedTimeout",value:function(){this.state!==o.SocksClientState.Established&&this.state!==o.SocksClientState.BoundWaitingForConnection&&this.closeSocket(o.ERRORS.ProxyConnectionTimedOut)}},{key:"onConnectHandler",value:function(){this.setState(o.SocksClientState.Connected),4===this.options.proxy.type?this.sendSocks4InitialHandshake():this.sendSocks5InitialHandshake(),this.setState(o.SocksClientState.SentInitialHandshake)}},{key:"onDataReceivedHandler",value:function(e){this.receiveBuffer.append(e),this.processData()}},{key:"processData",value:function(){for(;this.state!==o.SocksClientState.Established&&this.state!==o.SocksClientState.Error&&this.receiveBuffer.length>=this.nextRequiredPacketBufferSize;)if(this.state===o.SocksClientState.SentInitialHandshake)4===this.options.proxy.type?this.handleSocks4FinalHandshakeResponse():this.handleInitialSocks5HandshakeResponse();else if(this.state===o.SocksClientState.SentAuthentication)this.handleInitialSocks5AuthenticationHandshakeResponse();else if(this.state===o.SocksClientState.SentFinalHandshake)this.handleSocks5FinalHandshakeResponse();else{if(this.state!==o.SocksClientState.BoundWaitingForConnection){this.closeSocket(o.ERRORS.InternalError);break}4===this.options.proxy.type?this.handleSocks4IncomingConnectionResponse():this.handleSocks5IncomingConnectionResponse()}}},{key:"onCloseHandler",value:function(){this.closeSocket(o.ERRORS.SocketClosed)}},{key:"onErrorHandler",value:function(e){this.closeSocket(e.message)}},{key:"removeInternalSocketHandlers",value:function(){this.socket.pause(),this.socket.removeListener("data",this.onDataReceived),this.socket.removeListener("close",this.onClose),this.socket.removeListener("error",this.onError),this.socket.removeListener("connect",this.onConnect)}},{key:"closeSocket",value:function(e){this.state!==o.SocksClientState.Error&&(this.setState(o.SocksClientState.Error),this.socket.destroy(),this.removeInternalSocketHandlers(),this.emit("error",new c.SocksClientError(e,this.options)))}},{key:"sendSocks4InitialHandshake",value:function(){var e=this.options.proxy.userId||"",t=new i.SmartBuffer;t.writeUInt8(4),t.writeUInt8(o.SocksCommand[this.options.command]),t.writeUInt16BE(this.options.destination.port),n.isIPv4(this.options.destination.host)?(t.writeBuffer((0,s.ipToBuffer)(this.options.destination.host)),t.writeStringNT(e)):(t.writeUInt8(0),t.writeUInt8(0),t.writeUInt8(0),t.writeUInt8(1),t.writeStringNT(e),t.writeStringNT(this.options.destination.host)),this.nextRequiredPacketBufferSize=o.SOCKS_INCOMING_PACKET_SIZES.Socks4Response,this.socket.write(t.toBuffer())}},{key:"handleSocks4FinalHandshakeResponse",value:function(){var e=this.receiveBuffer.get(8);if(e[1]!==o.Socks4Response.Granted)this.closeSocket("".concat(o.ERRORS.Socks4ProxyRejectedConnection," - (").concat(o.Socks4Response[e[1]],")"));else if(o.SocksCommand[this.options.command]===o.SocksCommand.bind){var t=i.SmartBuffer.fromBuffer(e);t.readOffset=2;var r={port:t.readUInt16BE(),host:(0,s.int32ToIpv4)(t.readUInt32BE())};"0.0.0.0"===r.host&&(r.host=this.options.proxy.ipaddress),this.setState(o.SocksClientState.BoundWaitingForConnection),this.emit("bound",{remoteHost:r,socket:this.socket})}else this.setState(o.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{socket:this.socket})}},{key:"handleSocks4IncomingConnectionResponse",value:function(){var e=this.receiveBuffer.get(8);if(e[1]!==o.Socks4Response.Granted)this.closeSocket("".concat(o.ERRORS.Socks4ProxyRejectedIncomingBoundConnection," - (").concat(o.Socks4Response[e[1]],")"));else{var t=i.SmartBuffer.fromBuffer(e);t.readOffset=2;var r={port:t.readUInt16BE(),host:(0,s.int32ToIpv4)(t.readUInt32BE())};this.setState(o.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:r,socket:this.socket})}}},{key:"sendSocks5InitialHandshake",value:function(){var e=new i.SmartBuffer,t=[o.Socks5Auth.NoAuth];(this.options.proxy.userId||this.options.proxy.password)&&t.push(o.Socks5Auth.UserPass),void 0!==this.options.proxy.custom_auth_method&&t.push(this.options.proxy.custom_auth_method),e.writeUInt8(5),e.writeUInt8(t.length);for(var r=0,n=t;r<n.length;r++){var s=n[r];e.writeUInt8(s)}this.nextRequiredPacketBufferSize=o.SOCKS_INCOMING_PACKET_SIZES.Socks5InitialHandshakeResponse,this.socket.write(e.toBuffer()),this.setState(o.SocksClientState.SentInitialHandshake)}},{key:"handleInitialSocks5HandshakeResponse",value:function(){var e=this.receiveBuffer.get(2);5!==e[0]?this.closeSocket(o.ERRORS.InvalidSocks5IntiailHandshakeSocksVersion):e[1]===o.SOCKS5_NO_ACCEPTABLE_AUTH?this.closeSocket(o.ERRORS.InvalidSocks5InitialHandshakeNoAcceptedAuthType):e[1]===o.Socks5Auth.NoAuth?(this.socks5ChosenAuthType=o.Socks5Auth.NoAuth,this.sendSocks5CommandRequest()):e[1]===o.Socks5Auth.UserPass?(this.socks5ChosenAuthType=o.Socks5Auth.UserPass,this.sendSocks5UserPassAuthentication()):e[1]===this.options.proxy.custom_auth_method?(this.socks5ChosenAuthType=this.options.proxy.custom_auth_method,this.sendSocks5CustomAuthentication()):this.closeSocket(o.ERRORS.InvalidSocks5InitialHandshakeUnknownAuthType)}},{key:"sendSocks5UserPassAuthentication",value:function(){var e=this.options.proxy.userId||"",t=this.options.proxy.password||"",r=new i.SmartBuffer;r.writeUInt8(1),r.writeUInt8(Buffer$4.byteLength(e)),r.writeString(e),r.writeUInt8(Buffer$4.byteLength(t)),r.writeString(t),this.nextRequiredPacketBufferSize=o.SOCKS_INCOMING_PACKET_SIZES.Socks5UserPassAuthenticationResponse,this.socket.write(r.toBuffer()),this.setState(o.SocksClientState.SentAuthentication)}},{key:"sendSocks5CustomAuthentication",value:function(){return t(this,void 0,void 0,_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.nextRequiredPacketBufferSize=this.options.proxy.custom_auth_response_size,e.t0=this.socket,e.next=4,this.options.proxy.custom_auth_request_handler();case 4:e.t1=e.sent,e.t0.write.call(e.t0,e.t1),this.setState(o.SocksClientState.SentAuthentication);case 7:case"end":return e.stop()}}),e,this)})))}},{key:"handleSocks5CustomAuthHandshakeResponse",value:function(e){return t(this,void 0,void 0,_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.options.proxy.custom_auth_response_handler(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"handleSocks5AuthenticationNoAuthHandshakeResponse",value:function(e){return t(this,void 0,void 0,_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",0===e[1]);case 1:case"end":return t.stop()}}),t)})))}},{key:"handleSocks5AuthenticationUserPassHandshakeResponse",value:function(e){return t(this,void 0,void 0,_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",0===e[1]);case 1:case"end":return t.stop()}}),t)})))}},{key:"handleInitialSocks5AuthenticationHandshakeResponse",value:function(){return t(this,void 0,void 0,_regeneratorRuntime().mark((function e(){var t;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setState(o.SocksClientState.ReceivedAuthenticationResponse),t=!1,this.socks5ChosenAuthType!==o.Socks5Auth.NoAuth){e.next=8;break}return e.next=5,this.handleSocks5AuthenticationNoAuthHandshakeResponse(this.receiveBuffer.get(2));case 5:t=e.sent,e.next=18;break;case 8:if(this.socks5ChosenAuthType!==o.Socks5Auth.UserPass){e.next=14;break}return e.next=11,this.handleSocks5AuthenticationUserPassHandshakeResponse(this.receiveBuffer.get(2));case 11:t=e.sent,e.next=18;break;case 14:if(this.socks5ChosenAuthType!==this.options.proxy.custom_auth_method){e.next=18;break}return e.next=17,this.handleSocks5CustomAuthHandshakeResponse(this.receiveBuffer.get(this.options.proxy.custom_auth_response_size));case 17:t=e.sent;case 18:t?this.sendSocks5CommandRequest():this.closeSocket(o.ERRORS.Socks5AuthenticationFailed);case 19:case"end":return e.stop()}}),e,this)})))}},{key:"sendSocks5CommandRequest",value:function(){var e=new i.SmartBuffer;e.writeUInt8(5),e.writeUInt8(o.SocksCommand[this.options.command]),e.writeUInt8(0),n.isIPv4(this.options.destination.host)?(e.writeUInt8(o.Socks5HostType.IPv4),e.writeBuffer((0,s.ipToBuffer)(this.options.destination.host))):n.isIPv6(this.options.destination.host)?(e.writeUInt8(o.Socks5HostType.IPv6),e.writeBuffer((0,s.ipToBuffer)(this.options.destination.host))):(e.writeUInt8(o.Socks5HostType.Hostname),e.writeUInt8(this.options.destination.host.length),e.writeString(this.options.destination.host)),e.writeUInt16BE(this.options.destination.port),this.nextRequiredPacketBufferSize=o.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHeader,this.socket.write(e.toBuffer()),this.setState(o.SocksClientState.SentFinalHandshake)}},{key:"handleSocks5FinalHandshakeResponse",value:function(){var e=this.receiveBuffer.peek(5);if(5!==e[0]||e[1]!==o.Socks5Response.Granted)this.closeSocket("".concat(o.ERRORS.InvalidSocks5FinalHandshakeRejected," - ").concat(o.Socks5Response[e[1]]));else{var t,r,n=e[3];if(n===o.Socks5HostType.IPv4){var a=o.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv4;if(this.receiveBuffer.length<a)return void(this.nextRequiredPacketBufferSize=a);r=i.SmartBuffer.fromBuffer(this.receiveBuffer.get(a).slice(4)),"0.0.0.0"===(t={host:(0,s.int32ToIpv4)(r.readUInt32BE()),port:r.readUInt16BE()}).host&&(t.host=this.options.proxy.ipaddress)}else if(n===o.Socks5HostType.Hostname){var c=e[4],u=o.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHostname(c);if(this.receiveBuffer.length<u)return void(this.nextRequiredPacketBufferSize=u);t={host:(r=i.SmartBuffer.fromBuffer(this.receiveBuffer.get(u).slice(5))).readString(c),port:r.readUInt16BE()}}else if(n===o.Socks5HostType.IPv6){var d=o.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv6;if(this.receiveBuffer.length<d)return void(this.nextRequiredPacketBufferSize=d);r=i.SmartBuffer.fromBuffer(this.receiveBuffer.get(d).slice(4)),t={host:l.Address6.fromByteArray(Array.from(r.readBuffer(16))).canonicalForm(),port:r.readUInt16BE()}}this.setState(o.SocksClientState.ReceivedFinalResponse),o.SocksCommand[this.options.command]===o.SocksCommand.connect?(this.setState(o.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:t,socket:this.socket})):o.SocksCommand[this.options.command]===o.SocksCommand.bind?(this.setState(o.SocksClientState.BoundWaitingForConnection),this.nextRequiredPacketBufferSize=o.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHeader,this.emit("bound",{remoteHost:t,socket:this.socket})):o.SocksCommand[this.options.command]===o.SocksCommand.associate&&(this.setState(o.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:t,socket:this.socket}))}}},{key:"handleSocks5IncomingConnectionResponse",value:function(){var e=this.receiveBuffer.peek(5);if(5!==e[0]||e[1]!==o.Socks5Response.Granted)this.closeSocket("".concat(o.ERRORS.Socks5ProxyRejectedIncomingBoundConnection," - ").concat(o.Socks5Response[e[1]]));else{var t,r,n=e[3];if(n===o.Socks5HostType.IPv4){var a=o.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv4;if(this.receiveBuffer.length<a)return void(this.nextRequiredPacketBufferSize=a);r=i.SmartBuffer.fromBuffer(this.receiveBuffer.get(a).slice(4)),"0.0.0.0"===(t={host:(0,s.int32ToIpv4)(r.readUInt32BE()),port:r.readUInt16BE()}).host&&(t.host=this.options.proxy.ipaddress)}else if(n===o.Socks5HostType.Hostname){var c=e[4],u=o.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHostname(c);if(this.receiveBuffer.length<u)return void(this.nextRequiredPacketBufferSize=u);t={host:(r=i.SmartBuffer.fromBuffer(this.receiveBuffer.get(u).slice(5))).readString(c),port:r.readUInt16BE()}}else if(n===o.Socks5HostType.IPv6){var d=o.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv6;if(this.receiveBuffer.length<d)return void(this.nextRequiredPacketBufferSize=d);r=i.SmartBuffer.fromBuffer(this.receiveBuffer.get(d).slice(4)),t={host:l.Address6.fromByteArray(Array.from(r.readBuffer(16))).canonicalForm(),port:r.readUInt16BE()}}this.setState(o.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:t,socket:this.socket})}}},{key:"socksClientOptions",get:function(){return Object.assign({},this.options)}}],[{key:"createConnection",value:function(e,t){return new Promise((function(n,i){try{(0,s.validateSocksClientOptions)(e,["connect"])}catch(e){return"function"==typeof t?(t(e),n(e)):i(e)}var o=new r(e);o.connect(e.existing_socket),o.once("established",(function(e){o.removeAllListeners(),"function"==typeof t?(t(null,e),n(e)):n(e)})),o.once("error",(function(e){o.removeAllListeners(),"function"==typeof t?(t(e),n(e)):i(e)}))}))}},{key:"createConnectionChain",value:function(e,n){var i=this;return new Promise((function(o,a){return t(i,void 0,void 0,_regeneratorRuntime().mark((function t(){var i,l,u,d,h;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,(0,s.validateSocksClientChainOptions)(e),t.next=12;break;case 4:if(t.prev=4,t.t0=t.catch(0),"function"!=typeof n){t.next=11;break}return n(t.t0),t.abrupt("return",o(t.t0));case 11:return t.abrupt("return",a(t.t0));case 12:e.randomizeChain&&(0,c.shuffleArray)(e.proxies),t.prev=13,l=0;case 15:if(!(l<e.proxies.length)){t.next=25;break}return u=e.proxies[l],d=l===e.proxies.length-1?e.destination:{host:e.proxies[l+1].host||e.proxies[l+1].ipaddress,port:e.proxies[l+1].port},t.next=20,r.createConnection({command:"connect",proxy:u,destination:d,existing_socket:i});case 20:h=t.sent,i=i||h.socket;case 22:l++,t.next=15;break;case 25:"function"==typeof n?(n(null,{socket:i}),o({socket:i})):o({socket:i}),t.next=31;break;case 28:t.prev=28,t.t1=t.catch(13),"function"==typeof n?(n(t.t1),o(t.t1)):a(t.t1);case 31:case"end":return t.stop()}}),t,null,[[0,4],[13,28]])})))}))}},{key:"createUDPFrame",value:function(e){var t=new i.SmartBuffer;return t.writeUInt16BE(0),t.writeUInt8(e.frameNumber||0),n.isIPv4(e.remoteHost.host)?(t.writeUInt8(o.Socks5HostType.IPv4),t.writeUInt32BE((0,s.ipv4ToInt32)(e.remoteHost.host))):n.isIPv6(e.remoteHost.host)?(t.writeUInt8(o.Socks5HostType.IPv6),t.writeBuffer((0,s.ipToBuffer)(e.remoteHost.host))):(t.writeUInt8(o.Socks5HostType.Hostname),t.writeUInt8(Buffer$4.byteLength(e.remoteHost.host)),t.writeString(e.remoteHost.host)),t.writeUInt16BE(e.remoteHost.port),t.writeBuffer(e.data),t.toBuffer()}},{key:"parseUDPFrame",value:function(e){var t=i.SmartBuffer.fromBuffer(e);t.readOffset=2;var r=t.readUInt8(),n=t.readUInt8();return{frameNumber:r,remoteHost:{host:n===o.Socks5HostType.IPv4?(0,s.int32ToIpv4)(t.readUInt32BE()):n===o.Socks5HostType.IPv6?l.Address6.fromByteArray(Array.from(t.readBuffer(16))).canonicalForm():t.readString(t.readUInt8()),port:t.readUInt16BE()},data:t.readBuffer()}}}]),r}(r.EventEmitter);e.SocksClient=u}(socksclient)),socksclient}function requireBuild(){return hasRequiredBuild||(hasRequiredBuild=1,function(e){var t=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=commonjsGlobal&&commonjsGlobal.__exportStar||function(e,r){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(r,n)||t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(requireSocksclient(),e)}(build)),build}var _polyfillNode_dns={},_polyfillNode_dns$1=Object.freeze({__proto__:null,default:_polyfillNode_dns}),require$$3=getAugmentedNamespace(_polyfillNode_dns$1);function compare(e,t){if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0}var hasOwn=Object.prototype.hasOwnProperty,objectKeys=Object.keys||function(e){var t=[];for(var r in e)hasOwn.call(e,r)&&t.push(r);return t},pSlice=Array.prototype.slice,_functionsHaveNames;function functionsHaveNames(){return void 0!==_functionsHaveNames?_functionsHaveNames:_functionsHaveNames="foo"===function(){}.name}function pToString(e){return Object.prototype.toString.call(e)}function isView(e){return!isBuffer$1(e)&&("function"==typeof global$1.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}function assert(e,t){e||fail(e,!0,t,"==",ok)}var regex=/\s*function\s+([^\(\s]*)\s*/;function getName(e){if(isFunction$1(e)){if(functionsHaveNames())return e.name;var t=e.toString().match(regex);return t&&t[1]}}function AssertionError(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=getMessage(this),this.generatedMessage=!0);var t=e.stackStartFunction||fail;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var r=new Error;if(r.stack){var n=r.stack,i=getName(t),o=n.indexOf("\n"+i);if(o>=0){var s=n.indexOf("\n",o+1);n=n.substring(s+1)}this.stack=n}}}function truncate(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function inspect(e){if(functionsHaveNames()||!isFunction$1(e))return inspect$2(e);var t=getName(e);return"[Function"+(t?": "+t:"")+"]"}function getMessage(e){return truncate(inspect(e.actual),128)+" "+e.operator+" "+truncate(inspect(e.expected),128)}function fail(e,t,r,n,i){throw new AssertionError({message:r,actual:e,expected:t,operator:n,stackStartFunction:i})}function ok(e,t){e||fail(e,!0,t,"==",ok)}function equal(e,t,r){e!=t&&fail(e,t,r,"==",equal)}function notEqual(e,t,r){e==t&&fail(e,t,r,"!=",notEqual)}function deepEqual(e,t,r){_deepEqual(e,t,!1)||fail(e,t,r,"deepEqual",deepEqual)}function deepStrictEqual(e,t,r){_deepEqual(e,t,!0)||fail(e,t,r,"deepStrictEqual",deepStrictEqual)}function _deepEqual(e,t,r,n){if(e===t)return!0;if(isBuffer$1(e)&&isBuffer$1(t))return 0===compare(e,t);if(isDate(e)&&isDate(t))return e.getTime()===t.getTime();if(isRegExp(e)&&isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(isView(e)&&isView(t)&&pToString(e)===pToString(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===compare(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(isBuffer$1(e)!==isBuffer$1(t))return!1;var i=(n=n||{actual:[],expected:[]}).actual.indexOf(e);return-1!==i&&i===n.expected.indexOf(t)||(n.actual.push(e),n.expected.push(t),objEquiv(e,t,r,n))}return r?e===t:e==t}function isArguments(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function objEquiv(e,t,r,n){if(null==e||null==t)return!1;if(isPrimitive(e)||isPrimitive(t))return e===t;if(r&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var i=isArguments(e),o=isArguments(t);if(i&&!o||!i&&o)return!1;if(i)return _deepEqual(e=pSlice.call(e),t=pSlice.call(t),r);var s,a,c=objectKeys(e),l=objectKeys(t);if(c.length!==l.length)return!1;for(c.sort(),l.sort(),a=c.length-1;a>=0;a--)if(c[a]!==l[a])return!1;for(a=c.length-1;a>=0;a--)if(!_deepEqual(e[s=c[a]],t[s],r,n))return!1;return!0}function notDeepEqual(e,t,r){_deepEqual(e,t,!1)&&fail(e,t,r,"notDeepEqual",notDeepEqual)}function notDeepStrictEqual(e,t,r){_deepEqual(e,t,!0)&&fail(e,t,r,"notDeepStrictEqual",notDeepStrictEqual)}function strictEqual(e,t,r){e!==t&&fail(e,t,r,"===",strictEqual)}function notStrictEqual(e,t,r){e===t&&fail(e,t,r,"!==",notStrictEqual)}function expectedException(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function _tryBlock(e){var t;try{e()}catch(e){t=e}return t}function _throws(e,t,r,n){var i;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof r&&(n=r,r=null),i=_tryBlock(t),n=(r&&r.name?" ("+r.name+").":".")+(n?" "+n:"."),e&&!i&&fail(i,r,"Missing expected exception"+n);var o="string"==typeof n,s=!e&&i&&!r;if((!e&&isError(i)&&o&&expectedException(i,r)||s)&&fail(i,r,"Got unwanted exception"+n),e&&i&&r&&!expectedException(i,r)||!e&&i)throw i}function throws(e,t,r){_throws(!0,e,t,r)}function doesNotThrow(e,t,r){_throws(!1,e,t,r)}function ifError(e){if(e)throw e}assert.AssertionError=AssertionError,inherits$4(AssertionError,Error),assert.fail=fail,assert.ok=ok,assert.equal=equal,assert.notEqual=notEqual,assert.deepEqual=deepEqual,assert.deepStrictEqual=deepStrictEqual,assert.notDeepEqual=notDeepEqual,assert.notDeepStrictEqual=notDeepStrictEqual,assert.strictEqual=strictEqual,assert.notStrictEqual=notStrictEqual,assert.throws=throws,assert.doesNotThrow=doesNotThrow,assert.ifError=ifError;var _polyfillNode_assert=Object.freeze({__proto__:null,default:assert,AssertionError:AssertionError,fail:fail,ok:ok,assert:ok,equal:equal,notEqual:notEqual,deepEqual:deepEqual,deepStrictEqual:deepStrictEqual,notDeepEqual:notDeepEqual,notDeepStrictEqual:notDeepStrictEqual,strictEqual:strictEqual,notStrictEqual:notStrictEqual,throws:throws,doesNotThrow:doesNotThrow,ifError:ifError}),require$$5=getAugmentedNamespace(_polyfillNode_assert),hasRequiredSocks,hasRequiredTcp;function requireSocks(){if(hasRequiredSocks)return socks;hasRequiredSocks=1;var e=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),t=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=commonjsGlobal&&commonjsGlobal.__importStar||function(){var r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},r(e)};return function(n){if(n&&n.__esModule)return n;var i={};if(null!=n)for(var o=r(n),s=0;s<o.length;s++)"default"!==o[s]&&e(i,n,o[s]);return t(i,n),i}}(),n=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(socks,"__esModule",{value:!0}),socks.default=function(e,t,r,n){u("SOCKS connection to %s:%d via %s",e,t,r);var i=new d;return function(e,t,r,n){return p.apply(this,arguments)}(e,t,r,i,n).catch((function(e){u("SOCKS failed: %s",e),i.destroy(e)})),i};var i=n(srcExports),o=require$$1$5,s=requireBuild(),a=r(require$$3),c=require$$4,l=n(require$$5),u=(0,i.default)("mqttjs:socks"),d=function(e){function t(){var e;return _classCallCheck(this,t),_defineProperty(_assertThisInitialized(e=_callSuper(this,t,[{autoDestroy:!1}])),"_flowing",!1),_defineProperty(_assertThisInitialized(e),"_socket",void 0),_defineProperty(_assertThisInitialized(e),"_onData",(function(t){(0,l.default)(e._socket),e._flowing=e.push(t),e._flowing||e._socket.pause()})),_defineProperty(_assertThisInitialized(e),"_onEnd",(function(){u("proxy stream received EOF"),e.push(null)})),_defineProperty(_assertThisInitialized(e),"_onClose",(function(){u("proxy stream closed"),e.destroy()})),_defineProperty(_assertThisInitialized(e),"_onError",(function(t){u("proxy stream died with error %s",t),e.destroy(t)})),e.cork(),e}return _inherits(t,e),_createClass(t,[{key:"_start",value:function(e){u("proxy stream started"),(0,l.default)(!this._socket),this.destroyed?e.destroy(this.errored):(this._socket=e,this._flowing||e.pause(),e.on("data",this._onData),e.on("end",this._onEnd),e.on("error",this._onError),e.on("close",this._onClose),e.emit("connect"),this.uncork())}},{key:"_write",value:function(e,t,r){(0,l.default)(this._socket),this._socket.write(e,r)}},{key:"_read",value:function(e){var t,r;this._flowing=!0,null===(t=this._socket)||void 0===t||null===(r=t.resume)||void 0===r||r.call(t)}},{key:"_destroy",value:function(e,t){var r,n;null===(r=this._socket)||void 0===r||null===(n=r.destroy)||void 0===n||n.call(r,e),t(e)}}]),t}(o.Duplex);function h(e){try{return void 0===e.code&&(e.code="SOCKS"),e}catch(t){return e}}function f(e){var t=new URL(e);if(t.pathname||t.hash||t.search)throw h(new Error("bad SOCKS URL"));var r=_slicedToArray(function(e){switch(e){case"socks5h:":return[5,!0];case"socks4a:":return[4,!0];case"socks5:":return[5,!1];case"socks4:":return[4,!1];default:return[void 0,!1]}}(t.protocol),2),n=r[0],i=r[1];if(!n)throw h(new Error("bad SOCKS URL: invalid protocol"));var o=parseInt(t.port,10);if(Number.isNaN(o))throw h(new Error("bad SOCKS URL: invalid port"));return[{host:t.hostname,port:o,type:n},i]}function p(){return p=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,r,n,i){var o,l,d,p,m,v,g,_=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d=null!==(o=(l=_.length>4&&void 0!==_[4]?_[4]:{}).lookup)&&void 0!==o?o:(0,c.promisify)(a.lookup),p=f(n),m=_slicedToArray(p,2),v=m[0],m[1]){e.next=8;break}return u("resolving %s locally",t),e.next=7,d(t,{family:4===v.type?4:0});case 7:t=e.sent.address;case 8:u("establishing SOCKS%d connection to %s:%d via %s:%d",v.type,t,r,v.host,v.port),(g=new s.SocksClient({command:"connect",destination:{host:t,port:r},proxy:_objectSpread2({},v),timeout:l.timeout})).connect(),g.on("established",(function(e){var t=e.socket;return i._start(t)})),g.on("error",(function(e){u("SOCKS failed: %s",e),i.destroy(h(e))}));case 13:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}return socks}function requireTcp(){if(hasRequiredTcp)return tcp;hasRequiredTcp=1;var e=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(tcp,"__esModule",{value:!0});var t=e(require$$1),r=e(srcExports),n=e(requireSocks()),i=(0,r.default)("mqttjs:tcp");return tcp.default=function(e,r){if(r.port=r.port||1883,r.hostname=r.hostname||r.host||"localhost",r.socksProxy)return(0,n.default)(r.hostname,r.port,r.socksProxy,{timeout:r.socksTimeout});var o=r.port,s=r.path,a=r.hostname;return i("port %d and host %s",o,a),t.default.createConnection({port:o,host:a,path:s})},tcp}var tls={},_excluded=["host","port","socksProxy"],hasRequiredTls;function requireTls(){if(hasRequiredTls)return tls;hasRequiredTls=1;var e=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(tls,"__esModule",{value:!0});var t=require$$0$1,r=e(require$$1),n=e(srcExports),i=e(requireSocks()),o=(0,n.default)("mqttjs:tls");return tls.default=function(e,n){n.port=n.port||8883,n.host=n.hostname||n.host||"localhost",0===r.default.isIP(n.host)&&(n.servername=n.host),n.rejectUnauthorized=!1!==n.rejectUnauthorized,delete n.path,o("port %d host %s rejectUnauthorized %b",n.port,n.host,n.rejectUnauthorized);var s=function(e){var r=e.host,n=e.port,o=e.socksProxy,s=_objectWithoutProperties(e,_excluded);if(void 0!==o){var a=(0,i.default)(r,n,o,{timeout:e.socksTimeout});return(0,t.connect)(_objectSpread2(_objectSpread2({},s),{},{socket:a}))}return(0,t.connect)(e)}(n);function a(t){n.rejectUnauthorized&&e.emit("error",t),s.end()}return s.on("secureConnect",(function(){n.rejectUnauthorized&&!s.authorized?s.emit("error",new Error("TLS not authorized")):s.removeListener("error",a)})),s.on("error",a),s},tls}var wx$1={},hasRequiredWx;function requireWx(){if(hasRequiredWx)return wx$1;hasRequiredWx=1,Object.defineProperty(wx$1,"__esModule",{value:!0});var e,t,r,n=require$$0$a,i=oursExports,o=requireBufferedDuplex();return wx$1.default=function(s,a){if(a.hostname=a.hostname||a.host,!a.hostname)throw new Error("Could not determine host. Specify host manually.");var c="MQIsdp"===a.protocolId&&3===a.protocolVersion?"mqttv3.1":"mqtt";!function(e){e.hostname||(e.hostname="localhost"),e.path||(e.path="/"),e.wsOptions||(e.wsOptions={})}(a);var l,u=function(e,t){var r="wxs"===e.protocol?"wss":"ws",n="".concat(r,"://").concat(e.hostname).concat(e.path);return e.port&&80!==e.port&&443!==e.port&&(n="".concat(r,"://").concat(e.hostname,":").concat(e.port).concat(e.path)),"function"==typeof e.transformWsUrl&&(n=e.transformWsUrl(n,e,t)),n}(a,s);e=wx.connectSocket({url:u,protocols:[c]}),(l=new i.Transform)._write=function(t,r,n){e.send({data:t.buffer,success:function(){n()},fail:function(e){n(new Error(e))}})},l._flush=function(t){e.close({success:function(){t()}})},t=l,(r=new o.BufferedDuplex(a,t,e))._destroy=function(t,r){e.close({success:function(){r&&r(t)}})};var d=r.destroy;return r.destroy=function(t,n){return r.destroy=d,setTimeout((function(){e.close({fail:function(){r._destroy(t,n)}})}),0),r},e.onOpen((function(){r.socketReady()})),e.onMessage((function(e){var r=e.data;r=r instanceof ArrayBuffer?n.Buffer.from(r):n.Buffer.from(r,"utf8"),t.push(r)})),e.onClose((function(){r.emit("close"),r.end(),r.destroy()})),e.onError((function(e){var t=new Error(e.errMsg);r.destroy(t)})),r},wx$1}var ali={},hasRequiredAli,_process;function requireAli(){if(hasRequiredAli)return ali;hasRequiredAli=1,Object.defineProperty(ali,"__esModule",{value:!0});var e,t,r,n=require$$0$a,i=oursExports,o=requireBufferedDuplex(),s=!1;return ali.default=function(a,c){if(c.hostname=c.hostname||c.host,!c.hostname)throw new Error("Could not determine host. Specify host manually.");var l="MQIsdp"===c.protocolId&&3===c.protocolVersion?"mqttv3.1":"mqtt";!function(e){e.hostname||(e.hostname="localhost"),e.path||(e.path="/"),e.wsOptions||(e.wsOptions={})}(c);var u,d=function(e,t){var r="alis"===e.protocol?"wss":"ws",n="".concat(r,"://").concat(e.hostname).concat(e.path);return e.port&&80!==e.port&&443!==e.port&&(n="".concat(r,"://").concat(e.hostname,":").concat(e.port).concat(e.path)),"function"==typeof e.transformWsUrl&&(n=e.transformWsUrl(n,e,t)),n}(c,a);return(e=c.my).connectSocket({url:d,protocols:l}),(u=new i.Transform)._write=function(t,r,n){e.sendSocketMessage({data:t.buffer,success:function(){n()},fail:function(){n(new Error)}})},u._flush=function(t){e.closeSocket({success:function(){t()}})},t=u,r=new o.BufferedDuplex(c,t,e),s||(s=!0,e.onSocketOpen((function(){r.socketReady()})),e.onSocketMessage((function(e){if("string"==typeof e.data){var r=n.Buffer.from(e.data,"base64");t.push(r)}else{var i=new FileReader;i.addEventListener("load",(function(){i.result instanceof ArrayBuffer?t.push(n.Buffer.from(i.result)):t.push(n.Buffer.from(i.result,"utf-8"))})),i.readAsArrayBuffer(e.data)}})),e.onSocketClose((function(){r.end(),r.destroy()})),e.onSocketError((function(e){r.destroy(e)}))),r},ali}var __importDefault=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(connect$1,"__esModule",{value:!0});var connectAsync_1=connect$1.connectAsync=connectAsync,debug_1=__importDefault(srcExports),url_1=__importDefault(require$$1$3),client_1=__importDefault(client),is_browser_1=__importDefault(isBrowser$1);"function"!=typeof(null===(_process=browser$1$1)||void 0===_process?void 0:_process.nextTick)&&(browser$1$1.nextTick=setImmediate);var debug=(0,debug_1.default)("mqttjs"),protocols=null;function parseAuthOptions(e){var t;if(e.auth)if(t=e.auth.match(/^(.+):(.+)$/)){var r=_slicedToArray(t,3),n=r[1],i=r[2];e.username=n,e.password=i}else e.username=e.auth}function connect(e,t){var r,n,i;if(debug("connecting to an MQTT broker..."),"object"!==_typeof(e)||t||(t=e,e=""),t=t||{},e&&"string"==typeof e){var o=url_1.default.parse(e,!0),s={};if(null!=o.port&&(s.port=Number(o.port)),s.host=o.hostname,s.query=o.query,s.auth=o.auth,s.protocol=o.protocol,s.path=o.path,!(t=_objectSpread2(_objectSpread2({},s),t)).protocol)throw new Error("Missing protocol");t.protocol=t.protocol.replace(/:$/,"")}if(t.unixSocket=t.unixSocket||(null===(r=t.protocol)||void 0===r?void 0:r.includes("+unix")),t.unixSocket?t.protocol=t.protocol.replace("+unix",""):null!==(n=t.protocol)&&void 0!==n&&n.startsWith("ws")||null!==(i=t.protocol)&&void 0!==i&&i.startsWith("wx")||delete t.path,parseAuthOptions(t),t.query&&"string"==typeof t.query.clientId&&(t.clientId=t.query.clientId),is_browser_1.default||t.unixSocket?t.socksProxy=void 0:void 0===t.socksProxy&&void 0!==browser$1$1&&(t.socksProxy=browser$1$1.env.MQTTJS_SOCKS_PROXY),t.cert&&t.key){if(!t.protocol)throw new Error("Missing secure protocol key");if(-1===["mqtts","wss","wxs","alis"].indexOf(t.protocol))switch(t.protocol){case"mqtt":t.protocol="mqtts";break;case"ws":t.protocol="wss";break;case"wx":t.protocol="wxs";break;case"ali":t.protocol="alis";break;default:throw new Error('Unknown protocol for secure connection: "'.concat(t.protocol,'"!'))}}if(protocols||(protocols={},is_browser_1.default||t.forceNativeWebSocket?(protocols.ws=requireWs().browserStreamBuilder,protocols.wss=requireWs().browserStreamBuilder,protocols.wx=requireWx().default,protocols.wxs=requireWx().default,protocols.ali=requireAli().default,protocols.alis=requireAli().default):(protocols.ws=requireWs().streamBuilder,protocols.wss=requireWs().streamBuilder,protocols.mqtt=requireTcp().default,protocols.tcp=requireTcp().default,protocols.ssl=requireTls().default,protocols.tls=protocols.ssl,protocols.mqtts=requireTls().default)),!protocols[t.protocol]){var a=-1!==["mqtts","wss"].indexOf(t.protocol);t.protocol=["mqtt","mqtts","ws","wss","wx","wxs","ali","alis"].filter((function(e,t){return(!a||t%2!=0)&&"function"==typeof protocols[e]}))[0]}if(!1===t.clean&&!t.clientId)throw new Error("Missing clientId for unclean clients");t.protocol&&(t.defaultProtocol=t.protocol);var c=new client_1.default((function(e){return t.servers&&(e._reconnectCount&&e._reconnectCount!==t.servers.length||(e._reconnectCount=0),t.host=t.servers[e._reconnectCount].host,t.port=t.servers[e._reconnectCount].port,t.protocol=t.servers[e._reconnectCount].protocol?t.servers[e._reconnectCount].protocol:t.defaultProtocol,t.hostname=t.host,e._reconnectCount++),debug("calling streambuilder for",t.protocol),protocols[t.protocol](e,t)}),t);return c.on("error",(function(){})),c}function connectAsync(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return new Promise((function(n,i){var o=connect(e,t),s={connect:function(e){a(),n(o)},end:function(){a(),n(o)},error:function(e){a(),o.end(),i(e)}};function a(){Object.keys(s).forEach((function(e){o.off(e,s[e])}))}!1===r&&(s.close=function(){s.error(new Error("Couldn't connect to server"))}),Object.keys(s).forEach((function(e){o.on(e,s[e])}))}))}var _default=connect$1.default=connect;!function(e){var t=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=commonjsGlobal&&commonjsGlobal.__importStar||function(){var e=function(t){return e=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},e(t)};return function(n){if(n&&n.__esModule)return n;var i={};if(null!=n)for(var o=e(n),s=0;s<o.length;s++)"default"!==o[s]&&t(i,n,o[s]);return r(i,n),i}}(),i=commonjsGlobal&&commonjsGlobal.__exportStar||function(e,r){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(r,n)||t(r,e,n)},o=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.ReasonCodes=e.KeepaliveManager=e.UniqueMessageIdProvider=e.DefaultMessageIdProvider=e.Store=e.MqttClient=e.connectAsync=e.connect=e.Client=void 0;var s=o(client);e.MqttClient=s.default;var a=o(defaultMessageIdProvider);e.DefaultMessageIdProvider=a.default;var c=o(uniqueMessageIdProvider);e.UniqueMessageIdProvider=c.default;var l=o(store);e.Store=l.default;var u=n(connect$1);e.connect=u.default,Object.defineProperty(e,"connectAsync",{enumerable:!0,get:function(){return u.connectAsync}});var d=o(KeepaliveManager$1);e.KeepaliveManager=d.default,e.Client=s.default,i(client,e),i(shared,e);var h=ack$1;Object.defineProperty(e,"ReasonCodes",{enumerable:!0,get:function(){return h.ReasonCodes}})}(mqtt$3);var mqtt$1=getDefaultExportFromCjs(mqtt$3);!function(e){var t=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=commonjsGlobal&&commonjsGlobal.__importStar||function(){var e=function(t){return e=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},e(t)};return function(n){if(n&&n.__esModule)return n;var i={};if(null!=n)for(var o=e(n),s=0;s<o.length;s++)"default"!==o[s]&&t(i,n,o[s]);return r(i,n),i}}(),i=commonjsGlobal&&commonjsGlobal.__exportStar||function(e,r){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(r,n)||t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(mqtt$3);e.default=o,i(mqtt$3,e)}(build$1);var mqtt=getDefaultExportFromCjs(build$1),e$1=function(){function e(t,r,n,i,o){var s=this;_classCallCheck(this,e),this._legacyCanvasSize=e.DEFAULT_CANVAS_SIZE,this._preferredCamera="environment",this._maxScansPerSecond=25,this._lastScanTimestamp=-1,this._destroyed=this._flashOn=this._paused=this._active=!1,this.$video=t,this.$canvas=document.createElement("canvas"),n&&"object"===_typeof(n)?this._onDecode=r:(n||i||o?console.warn("You're using a deprecated version of the QrScanner constructor which will be removed in the future"):console.warn("Note that the type of the scan result passed to onDecode will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),this._legacyOnDecode=r),r="object"===_typeof(n)?n:{},this._onDecodeError=r.onDecodeError||("function"==typeof n?n:this._onDecodeError),this._calculateScanRegion=r.calculateScanRegion||("function"==typeof i?i:this._calculateScanRegion),this._preferredCamera=r.preferredCamera||o||this._preferredCamera,this._legacyCanvasSize="number"==typeof n?n:"number"==typeof i?i:this._legacyCanvasSize,this._maxScansPerSecond=r.maxScansPerSecond||this._maxScansPerSecond,this._onPlay=this._onPlay.bind(this),this._onLoadedMetaData=this._onLoadedMetaData.bind(this),this._onVisibilityChange=this._onVisibilityChange.bind(this),this._updateOverlay=this._updateOverlay.bind(this),t.disablePictureInPicture=!0,t.playsInline=!0,t.muted=!0;var a=!1;if(t.hidden&&(t.hidden=!1,a=!0),document.body.contains(t)||(document.body.appendChild(t),a=!0),n=t.parentElement,r.highlightScanRegion||r.highlightCodeOutline){if(i=!!r.overlay,this.$overlay=r.overlay||document.createElement("div"),(o=this.$overlay.style).position="absolute",o.display="none",o.pointerEvents="none",this.$overlay.classList.add("scan-region-highlight"),!i&&r.highlightScanRegion){this.$overlay.innerHTML='<svg class="scan-region-highlight-svg" viewBox="0 0 238 238" preserveAspectRatio="none" style="position:absolute;width:100%;height:100%;left:0;top:0;fill:none;stroke:#e9b213;stroke-width:4;stroke-linecap:round;stroke-linejoin:round"><path d="M31 2H10a8 8 0 0 0-8 8v21M207 2h21a8 8 0 0 1 8 8v21m0 176v21a8 8 0 0 1-8 8h-21m-176 0H10a8 8 0 0 1-8-8v-21"/></svg>';try{this.$overlay.firstElementChild.animate({transform:["scale(.98)","scale(1.01)"]},{duration:400,iterations:1/0,direction:"alternate",easing:"ease-in-out"})}catch(e){}n.insertBefore(this.$overlay,this.$video.nextSibling)}r.highlightCodeOutline&&(this.$overlay.insertAdjacentHTML("beforeend",'<svg class="code-outline-highlight" preserveAspectRatio="none" style="display:none;width:100%;height:100%;fill:none;stroke:#e9b213;stroke-width:5;stroke-dasharray:25;stroke-linecap:round;stroke-linejoin:round"><polygon/></svg>'),this.$codeOutlineHighlight=this.$overlay.lastElementChild)}this._scanRegion=this._calculateScanRegion(t),requestAnimationFrame((function(){var e=window.getComputedStyle(t);"none"===e.display&&(t.style.setProperty("display","block","important"),a=!0),"visible"!==e.visibility&&(t.style.setProperty("visibility","visible","important"),a=!0),a&&(console.warn("QrScanner has overwritten the video hiding style to avoid Safari stopping the playback."),t.style.opacity="0",t.style.width="0",t.style.height="0",s.$overlay&&s.$overlay.parentElement&&s.$overlay.parentElement.removeChild(s.$overlay),delete s.$overlay,delete s.$codeOutlineHighlight),s.$overlay&&s._updateOverlay()})),t.addEventListener("play",this._onPlay),t.addEventListener("loadedmetadata",this._onLoadedMetaData),document.addEventListener("visibilitychange",this._onVisibilityChange),window.addEventListener("resize",this._updateOverlay),this._qrEnginePromise=e.createQrEngine()}var t,r,n,i,o,s,a,c,l,u,d,h,f,p,m,v;return _createClass(e,[{key:"hasFlash",value:(v=_asyncToGenerator(_regeneratorRuntime().mark((function t(){var r;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!this.$video.srcObject){t.next=7;break}if(this.$video.srcObject instanceof MediaStream){t.next=4;break}return t.abrupt("return",!1);case 4:r=this.$video.srcObject,t.next=10;break;case 7:return t.next=9,this._getCameraStream();case 9:r=t.sent.stream;case 10:return t.abrupt("return","torch"in r.getVideoTracks()[0].getSettings());case 13:return t.prev=13,t.t0=t.catch(0),t.abrupt("return",!1);case 16:return t.prev=16,r&&r!==this.$video.srcObject&&(console.warn("Call hasFlash after successfully starting the scanner to avoid creating a temporary video stream"),e._stopVideoStream(r)),t.finish(16);case 19:case"end":return t.stop()}}),t,this,[[0,13,16,19]])}))),function(){return v.apply(this,arguments)})},{key:"isFlashOn",value:function(){return this._flashOn}},{key:"toggleFlash",value:(m=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._flashOn){e.next=5;break}return e.next=3,this.turnFlashOff();case 3:e.next=7;break;case 5:return e.next=7,this.turnFlashOn();case 7:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"turnFlashOn",value:(p=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._flashOn||this._destroyed||(this._flashOn=!0,!this._active||this._paused)){e.next=13;break}return e.prev=1,e.next=4,this.hasFlash();case 4:if(e.sent){e.next=6;break}throw"No flash available";case 6:return e.next=8,this.$video.srcObject.getVideoTracks()[0].applyConstraints({advanced:[{torch:!0}]});case 8:e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(1),this._flashOn=!1,e.t0;case 13:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(){return p.apply(this,arguments)})},{key:"turnFlashOff",value:(f=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this._flashOn,!e.t0){e.next=5;break}return this._flashOn=!1,e.next=5,this._restartVideoStream();case 5:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"destroy",value:function(){this.$video.removeEventListener("loadedmetadata",this._onLoadedMetaData),this.$video.removeEventListener("play",this._onPlay),document.removeEventListener("visibilitychange",this._onVisibilityChange),window.removeEventListener("resize",this._updateOverlay),this._destroyed=!0,this._flashOn=!1,this.stop(),e._postWorkerMessage(this._qrEnginePromise,"close")}},{key:"start",value:(h=_asyncToGenerator(_regeneratorRuntime().mark((function t(){var r,n,i;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._destroyed){t.next=2;break}throw Error("The QR scanner can not be started as it had been destroyed.");case 2:if(this._active&&!this._paused){t.next=30;break}if("https:"!==window.location.protocol&&console.warn("The camera stream is only accessible if the page is transferred via https."),this._active=!0,document.hidden){t.next=30;break}if(this._paused=!1,!this.$video.srcObject){t.next=9;break}return t.next=7,this.$video.play();case 7:t.next=30;break;case 9:return t.prev=9,t.next=12,this._getCameraStream();case 12:if(r=t.sent,n=r.stream,i=r.facingMode,this._active&&!this._paused){t.next=19;break}e._stopVideoStream(n),t.next=24;break;case 19:return this._setVideoMirror(i),this.$video.srcObject=n,t.next=23,this.$video.play();case 23:this._flashOn&&(this._flashOn=!1,this.turnFlashOn().catch((function(){})));case 24:t.next=30;break;case 26:if(t.prev=26,t.t0=t.catch(9),this._paused){t.next=30;break}throw this._active=!1,t.t0;case 30:case"end":return t.stop()}}),t,this,[[9,26]])}))),function(){return h.apply(this,arguments)})},{key:"stop",value:function(){this.pause(),this._active=!1}},{key:"pause",value:(d=_asyncToGenerator(_regeneratorRuntime().mark((function t(){var r,n,i=this,o=arguments;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=o.length>0&&void 0!==o[0]&&o[0],this._paused=!0,this._active){t.next=4;break}return t.abrupt("return",!0);case 4:if(this.$video.pause(),this.$overlay&&(this.$overlay.style.display="none"),n=function(){i.$video.srcObject instanceof MediaStream&&(e._stopVideoStream(i.$video.srcObject),i.$video.srcObject=null)},!r){t.next=9;break}return t.abrupt("return",(n(),!0));case 9:return t.next=11,new Promise((function(e){return setTimeout(e,300)}));case 11:if(this._paused){t.next=13;break}return t.abrupt("return",!1);case 13:return n(),t.abrupt("return",!0);case 15:case"end":return t.stop()}}),t,this)}))),function(){return d.apply(this,arguments)})},{key:"setCamera",value:(u=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t!==this._preferredCamera,!e.t0){e.next=5;break}return this._preferredCamera=t,e.next=5,this._restartVideoStream();case 5:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"setGrayscaleWeights",value:function(t,r,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];e._postWorkerMessage(this._qrEnginePromise,"grayscaleWeights",{red:t,green:r,blue:n,useIntegerApproximation:i})}},{key:"setInversionMode",value:function(t){e._postWorkerMessage(this._qrEnginePromise,"inversionMode",t)}},{key:"_onPlay",value:function(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay(),this.$overlay&&(this.$overlay.style.display=""),this._scanFrame()}},{key:"_onLoadedMetaData",value:function(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay()}},{key:"_onVisibilityChange",value:function(){document.hidden?this.pause():this._active&&this.start()}},{key:"_calculateScanRegion",value:function(e){var t=Math.round(2/3*Math.min(e.videoWidth,e.videoHeight));return{x:Math.round((e.videoWidth-t)/2),y:Math.round((e.videoHeight-t)/2),width:t,height:t,downScaledWidth:this._legacyCanvasSize,downScaledHeight:this._legacyCanvasSize}}},{key:"_updateOverlay",value:function(){var e=this;requestAnimationFrame((function(){if(e.$overlay){var t=e.$video,r=t.videoWidth,n=t.videoHeight,i=t.offsetWidth,o=t.offsetHeight,s=t.offsetLeft,a=t.offsetTop,c=window.getComputedStyle(t),l=c.objectFit,u=r/n,d=i/o;switch(l){case"none":var h=r,f=n;break;case"fill":h=i,f=o;break;default:("cover"===l?u>d:u<d)?h=(f=o)*u:f=(h=i)/u,"scale-down"===l&&(h=Math.min(h,r),f=Math.min(f,n))}var p=c.objectPosition.split(" ").map((function(e,t){var r=parseFloat(e);return e.endsWith("%")?(t?o-f:i-h)*r/100:r})),m=_slicedToArray(p,2),v=m[0],g=m[1];c=e._scanRegion.width||r,d=e._scanRegion.height||n,l=e._scanRegion.x||0;var _=e._scanRegion.y||0;(u=e.$overlay.style).width="".concat(c/r*h,"px"),u.height="".concat(d/n*f,"px"),u.top="".concat(a+g+_/n*f,"px"),n=/scaleX\(-1\)/.test(t.style.transform),u.left="".concat(s+(n?i-v-h:v)+(n?r-l-c:l)/r*h,"px"),u.transform=t.style.transform}}))}},{key:"_scanFrame",value:function(){var t=this;!this._active||this.$video.paused||this.$video.ended||("requestVideoFrameCallback"in this.$video?this.$video.requestVideoFrameCallback.bind(this.$video):requestAnimationFrame)(_asyncToGenerator(_regeneratorRuntime().mark((function r(){var n,i,o;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(1>=t.$video.readyState){r.next=29;break}if(n=Date.now()-t._lastScanTimestamp,i=1e3/t._maxScansPerSecond,r.t0=n<i,!r.t0){r.next=6;break}return r.next=6,new Promise((function(e){return setTimeout(e,i-n)}));case 6:return t._lastScanTimestamp=Date.now(),r.prev=7,r.next=10,e.scanImage(t.$video,{scanRegion:t._scanRegion,qrEngine:t._qrEnginePromise,canvas:t.$canvas});case 10:o=r.sent,r.next=18;break;case 13:if(r.prev=13,r.t1=r.catch(7),t._active){r.next=17;break}return r.abrupt("return");case 17:t._onDecodeError(r.t1);case 18:if(r.t2=!e._disableBarcodeDetector,r.t2){r.next=25;break}return r.next=22,t._qrEnginePromise;case 22:r.t3=r.sent,r.t4=Worker,r.t2=r.t3 instanceof r.t4;case 25:if(r.t5=r.t2,r.t5){r.next=28;break}t._qrEnginePromise=e.createQrEngine();case 28:o?(t._onDecode?t._onDecode(o):t._legacyOnDecode&&t._legacyOnDecode(o.data),t.$codeOutlineHighlight&&(clearTimeout(t._codeOutlineHighlightRemovalTimeout),t._codeOutlineHighlightRemovalTimeout=void 0,t.$codeOutlineHighlight.setAttribute("viewBox","".concat(t._scanRegion.x||0," ")+"".concat(t._scanRegion.y||0," ")+"".concat(t._scanRegion.width||t.$video.videoWidth," ")+"".concat(t._scanRegion.height||t.$video.videoHeight)),t.$codeOutlineHighlight.firstElementChild.setAttribute("points",o.cornerPoints.map((function(e){var t=e.x,r=e.y;return"".concat(t,",").concat(r)})).join(" ")),t.$codeOutlineHighlight.style.display="")):t.$codeOutlineHighlight&&!t._codeOutlineHighlightRemovalTimeout&&(t._codeOutlineHighlightRemovalTimeout=setTimeout((function(){return t.$codeOutlineHighlight.style.display="none"}),100));case 29:t._scanFrame();case 30:case"end":return r.stop()}}),r,null,[[7,13]])}))))}},{key:"_onDecodeError",value:function(t){t!==e.NO_QR_CODE_FOUND&&console.log(t)}},{key:"_getCameraStream",value:(l=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,r,n,i,o,s,a,c,l=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.mediaDevices){e.next=2;break}throw"Camera not found.";case 2:t=/^(environment|user)$/.test(this._preferredCamera)?"facingMode":"deviceId",n=(r=[{width:{min:1024}},{width:{min:768}},{}]).map((function(e){return Object.assign({},e,_defineProperty({},t,{exact:l._preferredCamera}))})),i=0,o=[].concat(_toConsumableArray(n),r);case 4:if(!(i<o.length)){e.next=19;break}return s=o[i],e.prev=6,e.next=9,navigator.mediaDevices.getUserMedia({video:s,audio:!1});case 9:return a=e.sent,c=this._getFacingMode(a)||(s.facingMode?this._preferredCamera:"environment"===this._preferredCamera?"user":"environment"),e.abrupt("return",{stream:a,facingMode:c});case 14:e.prev=14,e.t0=e.catch(6);case 16:i++,e.next=4;break;case 19:throw"Camera not found.";case 20:case"end":return e.stop()}}),e,this,[[6,14]])}))),function(){return l.apply(this,arguments)})},{key:"_restartVideoStream",value:(c=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._paused,e.next=3,this.pause(!0);case 3:if(e.t1=e.sent,!e.t1){e.next=6;break}e.t1=!t;case 6:if(e.t0=e.t1,!e.t0){e.next=9;break}e.t0=this._active;case 9:if(e.t2=e.t0,!e.t2){e.next=13;break}return e.next=13,this.start();case 13:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"_setVideoMirror",value:function(e){this.$video.style.transform="scaleX("+("user"===e?-1:1)+")"}},{key:"_getFacingMode",value:function(e){return(e=e.getVideoTracks()[0])?/rear|back|environment/i.test(e.label)?"environment":/front|user|face/i.test(e.label)?"user":null:null}}],[{key:"WORKER_PATH",set:function(e){console.warn("Setting QrScanner.WORKER_PATH is not required and not supported anymore. Have a look at the README for new setup instructions.")}},{key:"hasCamera",value:(a=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.listCameras(!1);case 3:return t.abrupt("return",!!t.sent.length);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",!1);case 9:case"end":return t.stop()}}),t,null,[[0,6]])}))),function(){return a.apply(this,arguments)})},{key:"listCameras",value:(s=_asyncToGenerator(_regeneratorRuntime().mark((function t(){var r,n,i,o=arguments;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=o.length>0&&void 0!==o[0]&&o[0],navigator.mediaDevices){t.next=3;break}return t.abrupt("return",[]);case 3:if(n=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.enumerateDevices();case 2:return e.abrupt("return",e.sent.filter((function(e){return"videoinput"===e.kind})));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.prev=4,t.t0=r,!t.t0){t.next=10;break}return t.next=9,n();case 9:t.t0=t.sent.every((function(e){return!e.label}));case 10:if(t.t1=t.t0,!t.t1){t.next=15;break}return t.next=14,navigator.mediaDevices.getUserMedia({audio:!1,video:!0});case 14:i=t.sent;case 15:t.next=19;break;case 17:t.prev=17,t.t2=t.catch(4);case 19:return t.prev=19,t.next=22,n();case 22:return t.abrupt("return",t.sent.map((function(e,t){return{id:e.deviceId,label:e.label||(0===t?"Default Camera":"Camera ".concat(t+1))}})));case 23:return t.prev=23,i&&(console.warn("Call listCameras after successfully starting a QR scanner to avoid creating a temporary video stream"),e._stopVideoStream(i)),t.finish(23);case 26:case"end":return t.stop()}}),t,null,[[4,17],[19,,23,26]])}))),function(){return s.apply(this,arguments)})},{key:"scanImage",value:(o=_asyncToGenerator(_regeneratorRuntime().mark((function t(r,n,i,o){var s,a,c,l,u,d,h,f,p,m,v,g,_,y=arguments;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=y.length>4&&void 0!==y[4]&&y[4],a=y.length>5&&void 0!==y[5]&&y[5],l=!1,n&&("scanRegion"in n||"qrEngine"in n||"canvas"in n||"disallowCanvasResizing"in n||"alsoTryWithoutScanRegion"in n||"returnDetailedScanResult"in n)?(c=n.scanRegion,i=n.qrEngine,o=n.canvas,s=n.disallowCanvasResizing||!1,a=n.alsoTryWithoutScanRegion||!1,l=!0):n||i||o||s||a?console.warn("You're using a deprecated api for scanImage which will be removed in the future."):console.warn("Note that the return type of scanImage will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),n=!!i,t.prev=5,t.next=8,Promise.all([i||e.createQrEngine(),e._loadImage(r)]);case 8:if(h=t.sent,f=_slicedToArray(h,2),i=f[0],u=f[1],p=e._drawToCanvas(u,c,o,s),m=_slicedToArray(p,2),o=m[0],d=m[1],!(i instanceof Worker)){t.next=24;break}return g=i,n||e._postWorkerMessageSync(g,"inversionMode","both"),t.next=21,new Promise((function(t,r){var n,i,s,a=-1;i=function(o){o.data.id===a&&(g.removeEventListener("message",i),g.removeEventListener("error",s),clearTimeout(n),null!==o.data.data?t({data:o.data.data,cornerPoints:e._convertPoints(o.data.cornerPoints,c)}):r(e.NO_QR_CODE_FOUND))},s=function(e){g.removeEventListener("message",i),g.removeEventListener("error",s),clearTimeout(n),r("Scanner error: "+(e?e.message||e:"Unknown Error"))},g.addEventListener("message",i),g.addEventListener("error",s),n=setTimeout((function(){return s("timeout")}),1e4);var l=d.getImageData(0,0,o.width,o.height);a=e._postWorkerMessageSync(g,"decode",l,[l.data.buffer])}));case 21:v=t.sent,t.next=27;break;case 24:return t.next=26,Promise.race([new Promise((function(e,t){return window.setTimeout((function(){return t("Scanner error: timeout")}),1e4)})),_asyncToGenerator(_regeneratorRuntime().mark((function t(){var n,l,u;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.detect(o);case 3:if(n=t.sent,l=_slicedToArray(n,1),u=l[0]){t.next=8;break}throw e.NO_QR_CODE_FOUND;case 8:return t.abrupt("return",{data:u.rawValue,cornerPoints:e._convertPoints(u.cornerPoints,c)});case 11:if(t.prev=11,t.t0=t.catch(0),u=t.t0.message||t.t0,!/not implemented|service unavailable/.test(u)){t.next=16;break}return t.abrupt("return",(e._disableBarcodeDetector=!0,e.scanImage(r,{scanRegion:c,canvas:o,disallowCanvasResizing:s,alsoTryWithoutScanRegion:a})));case 16:throw"Scanner error: ".concat(u);case 17:case"end":return t.stop()}}),t,null,[[0,11]])})))()]);case 26:v=t.sent;case 27:return t.abrupt("return",l?v:v.data);case 30:if(t.prev=30,t.t0=t.catch(5),c&&a){t.next=34;break}throw t.t0;case 34:return t.next=36,e.scanImage(r,{qrEngine:i,canvas:o,disallowCanvasResizing:s});case 36:return _=t.sent,t.abrupt("return",l?_:_.data);case 38:return t.prev=38,n||e._postWorkerMessage(i,"close"),t.finish(38);case 41:case"end":return t.stop()}}),t,null,[[5,30,38,41]])}))),function(e,t,r,n){return o.apply(this,arguments)})},{key:"createQrEngine",value:(i=_asyncToGenerator(_regeneratorRuntime().mark((function t(r){var n;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r&&console.warn("Specifying a worker path is not required and not supported anymore."),r=function(){return Promise.resolve().then((function(){return qrScannerWorker_min$1})).then((function(e){return e.createWorker()}))},t.t0=!e._disableBarcodeDetector&&"BarcodeDetector"in window&&BarcodeDetector.getSupportedFormats,!t.t0){t.next=7;break}return t.next=6,BarcodeDetector.getSupportedFormats();case 6:t.t0=t.sent.includes("qr_code");case 7:if(t.t0){t.next=9;break}return t.abrupt("return",r());case 9:if(n=navigator.userAgentData,t.t1=n&&n.brands.some((function(e){var t=e.brand;return/Chromium/i.test(t)}))&&/mac ?OS/i.test(n.platform),!t.t1){t.next=15;break}return t.next=14,n.getHighEntropyValues(["architecture","platformVersion"]).then((function(e){var t=e.architecture,r=e.platformVersion;return/arm/i.test(t||"arm")&&13<=parseInt(r||"13")})).catch((function(){return!0}));case 14:t.t1=t.sent;case 15:if(!t.t1){t.next=19;break}t.t2=r(),t.next=20;break;case 19:t.t2=new BarcodeDetector({formats:["qr_code"]});case 20:return t.abrupt("return",t.t2);case 21:case"end":return t.stop()}}),t)}))),function(e){return i.apply(this,arguments)})},{key:"_convertPoints",value:function(e,t){if(!t)return e;var r=t.x||0,n=t.y||0,i=t.width&&t.downScaledWidth?t.width/t.downScaledWidth:1;t=t.height&&t.downScaledHeight?t.height/t.downScaledHeight:1;var o,s=_createForOfIteratorHelper(e);try{for(s.s();!(o=s.n()).done;){var a=o.value;a.x=a.x*i+r,a.y=a.y*t+n}}catch(e){s.e(e)}finally{s.f()}return e}},{key:"_stopVideoStream",value:function(e){var t,r=_createForOfIteratorHelper(e.getTracks());try{for(r.s();!(t=r.n()).done;){var n=t.value;n.stop(),e.removeTrack(n)}}catch(e){r.e(e)}finally{r.f()}}},{key:"_drawToCanvas",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];r=r||document.createElement("canvas");var i=t&&t.x?t.x:0,o=t&&t.y?t.y:0,s=t&&t.width?t.width:e.videoWidth||e.width,a=t&&t.height?t.height:e.videoHeight||e.height;return n||(n=t&&t.downScaledWidth?t.downScaledWidth:s,t=t&&t.downScaledHeight?t.downScaledHeight:a,r.width!==n&&(r.width=n),r.height!==t&&(r.height=t)),(t=r.getContext("2d",{alpha:!1})).imageSmoothingEnabled=!1,t.drawImage(e,i,o,s,a,0,0,r.width,r.height),[r,t]}},{key:"_loadImage",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function t(r){var n;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r instanceof Image)){t.next=4;break}return t.next=3,e._awaitImageLoad(r);case 3:return t.abrupt("return",r);case 4:if(!(r instanceof HTMLVideoElement||r instanceof HTMLCanvasElement||r instanceof SVGImageElement||"OffscreenCanvas"in window&&r instanceof OffscreenCanvas||"ImageBitmap"in window&&r instanceof ImageBitmap)){t.next=6;break}return t.abrupt("return",r);case 6:if(!(r instanceof File||r instanceof Blob||r instanceof URL||"string"==typeof r)){t.next=18;break}return(n=new Image).src=r instanceof File||r instanceof Blob?URL.createObjectURL(r):r.toString(),t.prev=9,t.next=12,e._awaitImageLoad(n);case 12:return t.abrupt("return",n);case 13:return t.prev=13,(r instanceof File||r instanceof Blob)&&URL.revokeObjectURL(n.src),t.finish(13);case 16:t.next=19;break;case 18:throw"Unsupported image type.";case 19:case"end":return t.stop()}}),t,null,[[9,,13,16]])}))),function(e){return n.apply(this,arguments)})},{key:"_awaitImageLoad",value:(r=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.complete&&0!==t.naturalWidth,e.t0){e.next=4;break}return e.next=4,new Promise((function(e,r){var n=function n(i){t.removeEventListener("load",n),t.removeEventListener("error",n),i instanceof ErrorEvent?r("Image load error"):e()};t.addEventListener("load",n),t.addEventListener("error",n)}));case 4:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"_postWorkerMessage",value:(t=_asyncToGenerator(_regeneratorRuntime().mark((function t(r,n,i,o){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,r;case 3:return t.t1=t.sent,t.t2=n,t.t3=i,t.t4=o,t.abrupt("return",t.t0._postWorkerMessageSync.call(t.t0,t.t1,t.t2,t.t3,t.t4));case 8:case"end":return t.stop()}}),t)}))),function(e,r,n,i){return t.apply(this,arguments)})},{key:"_postWorkerMessageSync",value:function(t,r,n,i){if(!(t instanceof Worker))return-1;var o=e._workerMessageId++;return t.postMessage({id:o,type:r,data:n},i),o}}]),e}();e$1.DEFAULT_CANVAS_SIZE=400,e$1.NO_QR_CODE_FOUND="No QR code found",e$1._disableBarcodeDetector=!1,e$1._workerMessageId=0;var max="ffffffff-ffff-ffff-ffff-ffffffffffff",nil="00000000-0000-0000-0000-000000000000",REGEX=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function validate(e){return"string"==typeof e&&REGEX.test(e)}function parse(e){if(!validate(e))throw TypeError("Invalid UUID");var t;return Uint8Array.of((t=parseInt(e.slice(0,8),16))>>>24,t>>>16&255,t>>>8&255,255&t,(t=parseInt(e.slice(9,13),16))>>>8,255&t,(t=parseInt(e.slice(14,18),16))>>>8,255&t,(t=parseInt(e.slice(19,23),16))>>>8,255&t,(t=parseInt(e.slice(24,36),16))/1099511627776&255,t/4294967296&255,t>>>24&255,t>>>16&255,t>>>8&255,255&t)}for(var byteToHex=[],i$1=0,getRandomValues;i$1<256;++i$1)byteToHex.push((i$1+256).toString(16).slice(1));function unsafeStringify(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(byteToHex[e[t+0]]+byteToHex[e[t+1]]+byteToHex[e[t+2]]+byteToHex[e[t+3]]+"-"+byteToHex[e[t+4]]+byteToHex[e[t+5]]+"-"+byteToHex[e[t+6]]+byteToHex[e[t+7]]+"-"+byteToHex[e[t+8]]+byteToHex[e[t+9]]+"-"+byteToHex[e[t+10]]+byteToHex[e[t+11]]+byteToHex[e[t+12]]+byteToHex[e[t+13]]+byteToHex[e[t+14]]+byteToHex[e[t+15]]).toLowerCase()}function stringify(e){var t=unsafeStringify(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0);if(!validate(t))throw TypeError("Stringified UUID is invalid");return t}var rnds8=new Uint8Array(16);function rng(){if(!getRandomValues){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");getRandomValues=crypto.getRandomValues.bind(crypto)}return getRandomValues(rnds8)}var _state$1={};function v1(e,t,r){var n,i,o,s=null!==(n=null===(i=e)||void 0===i?void 0:i._v6)&&void 0!==n&&n;if(e){var a=Object.keys(e);1===a.length&&"_v6"===a[0]&&(e=void 0)}if(e){var c,l,u,d;o=v1Bytes(null!==(c=null!==(l=e.random)&&void 0!==l?l:null===(u=(d=e).rng)||void 0===u?void 0:u.call(d))&&void 0!==c?c:rng(),e.msecs,e.nsecs,e.clockseq,e.node,t,r)}else{var h=Date.now(),f=rng();updateV1State(_state$1,h,f),o=v1Bytes(f,_state$1.msecs,_state$1.nsecs,s?void 0:_state$1.clockseq,s?void 0:_state$1.node,t,r)}return null!=t?t:unsafeStringify(o)}function updateV1State(e,t,r){var n,i;return null!==(n=e.msecs)&&void 0!==n||(e.msecs=-1/0),null!==(i=e.nsecs)&&void 0!==i||(e.nsecs=0),t===e.msecs?(e.nsecs++,e.nsecs>=1e4&&(e.node=void 0,e.nsecs=0)):t>e.msecs?e.nsecs=0:t<e.msecs&&(e.node=void 0),e.node||(e.node=r.slice(10,16),e.node[0]|=1,e.clockseq=16383&(r[8]<<8|r[9])),e.msecs=t,e}function v1Bytes(e,t,r,n,i,o){var s,a,c,l,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if(e.length<16)throw new Error("Random bytes length must be >= 16");if(o){if(u<0||u+16>o.length)throw new RangeError("UUID byte range ".concat(u,":").concat(u+15," is out of buffer bounds"))}else o=new Uint8Array(16),u=0;null!==(s=t)&&void 0!==s||(t=Date.now()),null!==(a=r)&&void 0!==a||(r=0),null!==(c=n)&&void 0!==c||(n=16383&(e[8]<<8|e[9])),null!==(l=i)&&void 0!==l||(i=e.slice(10,16));var d=(1e4*(268435455&(t+=122192928e5))+r)%4294967296;o[u++]=d>>>24&255,o[u++]=d>>>16&255,o[u++]=d>>>8&255,o[u++]=255&d;var h=t/4294967296*1e4&268435455;o[u++]=h>>>8&255,o[u++]=255&h,o[u++]=h>>>24&15|16,o[u++]=h>>>16&255,o[u++]=n>>>8|128,o[u++]=255&n;for(var f=0;f<6;++f)o[u++]=i[f];return o}function v1ToV6(e){var t=_v1ToV6("string"==typeof e?parse(e):e);return"string"==typeof e?unsafeStringify(t):t}function _v1ToV6(e){return Uint8Array.of((15&e[6])<<4|e[7]>>4&15,(15&e[7])<<4|(240&e[4])>>4,(15&e[4])<<4|(240&e[5])>>4,(15&e[5])<<4|(240&e[0])>>4,(15&e[0])<<4|(240&e[1])>>4,(15&e[1])<<4|(240&e[2])>>4,96|15&e[2],e[3],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function md5(e){return uint32ToUint8(wordsToMd5(uint8ToUint32(e),8*e.length))}function uint32ToUint8(e){for(var t=new Uint8Array(4*e.length),r=0;r<4*e.length;r++)t[r]=e[r>>2]>>>r%4*8&255;return t}function getOutputLength(e){return 14+(e+64>>>9<<4)+1}function wordsToMd5(e,t){var r=new Uint32Array(getOutputLength(t)).fill(0);r.set(e),r[t>>5]|=128<<t%32,r[r.length-1]=t,e=r;for(var n=1732584193,i=-271733879,o=-1732584194,s=271733878,a=0;a<e.length;a+=16){var c=n,l=i,u=o,d=s;n=md5ff(n,i,o,s,e[a],7,-680876936),s=md5ff(s,n,i,o,e[a+1],12,-389564586),o=md5ff(o,s,n,i,e[a+2],17,606105819),i=md5ff(i,o,s,n,e[a+3],22,-1044525330),n=md5ff(n,i,o,s,e[a+4],7,-176418897),s=md5ff(s,n,i,o,e[a+5],12,1200080426),o=md5ff(o,s,n,i,e[a+6],17,-1473231341),i=md5ff(i,o,s,n,e[a+7],22,-45705983),n=md5ff(n,i,o,s,e[a+8],7,1770035416),s=md5ff(s,n,i,o,e[a+9],12,-1958414417),o=md5ff(o,s,n,i,e[a+10],17,-42063),i=md5ff(i,o,s,n,e[a+11],22,-1990404162),n=md5ff(n,i,o,s,e[a+12],7,1804603682),s=md5ff(s,n,i,o,e[a+13],12,-40341101),o=md5ff(o,s,n,i,e[a+14],17,-1502002290),n=md5gg(n,i=md5ff(i,o,s,n,e[a+15],22,1236535329),o,s,e[a+1],5,-165796510),s=md5gg(s,n,i,o,e[a+6],9,-1069501632),o=md5gg(o,s,n,i,e[a+11],14,643717713),i=md5gg(i,o,s,n,e[a],20,-373897302),n=md5gg(n,i,o,s,e[a+5],5,-701558691),s=md5gg(s,n,i,o,e[a+10],9,38016083),o=md5gg(o,s,n,i,e[a+15],14,-660478335),i=md5gg(i,o,s,n,e[a+4],20,-405537848),n=md5gg(n,i,o,s,e[a+9],5,568446438),s=md5gg(s,n,i,o,e[a+14],9,-1019803690),o=md5gg(o,s,n,i,e[a+3],14,-187363961),i=md5gg(i,o,s,n,e[a+8],20,1163531501),n=md5gg(n,i,o,s,e[a+13],5,-1444681467),s=md5gg(s,n,i,o,e[a+2],9,-51403784),o=md5gg(o,s,n,i,e[a+7],14,1735328473),n=md5hh(n,i=md5gg(i,o,s,n,e[a+12],20,-1926607734),o,s,e[a+5],4,-378558),s=md5hh(s,n,i,o,e[a+8],11,-2022574463),o=md5hh(o,s,n,i,e[a+11],16,1839030562),i=md5hh(i,o,s,n,e[a+14],23,-35309556),n=md5hh(n,i,o,s,e[a+1],4,-1530992060),s=md5hh(s,n,i,o,e[a+4],11,1272893353),o=md5hh(o,s,n,i,e[a+7],16,-155497632),i=md5hh(i,o,s,n,e[a+10],23,-1094730640),n=md5hh(n,i,o,s,e[a+13],4,681279174),s=md5hh(s,n,i,o,e[a],11,-358537222),o=md5hh(o,s,n,i,e[a+3],16,-722521979),i=md5hh(i,o,s,n,e[a+6],23,76029189),n=md5hh(n,i,o,s,e[a+9],4,-640364487),s=md5hh(s,n,i,o,e[a+12],11,-421815835),o=md5hh(o,s,n,i,e[a+15],16,530742520),n=md5ii(n,i=md5hh(i,o,s,n,e[a+2],23,-995338651),o,s,e[a],6,-198630844),s=md5ii(s,n,i,o,e[a+7],10,1126891415),o=md5ii(o,s,n,i,e[a+14],15,-1416354905),i=md5ii(i,o,s,n,e[a+5],21,-57434055),n=md5ii(n,i,o,s,e[a+12],6,1700485571),s=md5ii(s,n,i,o,e[a+3],10,-1894986606),o=md5ii(o,s,n,i,e[a+10],15,-1051523),i=md5ii(i,o,s,n,e[a+1],21,-2054922799),n=md5ii(n,i,o,s,e[a+8],6,1873313359),s=md5ii(s,n,i,o,e[a+15],10,-30611744),o=md5ii(o,s,n,i,e[a+6],15,-1560198380),i=md5ii(i,o,s,n,e[a+13],21,1309151649),n=md5ii(n,i,o,s,e[a+4],6,-145523070),s=md5ii(s,n,i,o,e[a+11],10,-1120210379),o=md5ii(o,s,n,i,e[a+2],15,718787259),i=md5ii(i,o,s,n,e[a+9],21,-343485551),n=safeAdd(n,c),i=safeAdd(i,l),o=safeAdd(o,u),s=safeAdd(s,d)}return Uint32Array.of(n,i,o,s)}function uint8ToUint32(e){if(0===e.length)return new Uint32Array;for(var t=new Uint32Array(getOutputLength(8*e.length)).fill(0),r=0;r<e.length;r++)t[r>>2]|=(255&e[r])<<r%4*8;return t}function safeAdd(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function bitRotateLeft(e,t){return e<<t|e>>>32-t}function md5cmn(e,t,r,n,i,o){return safeAdd(bitRotateLeft(safeAdd(safeAdd(t,e),safeAdd(n,o)),i),r)}function md5ff(e,t,r,n,i,o,s){return md5cmn(t&r|~t&n,e,t,i,o,s)}function md5gg(e,t,r,n,i,o,s){return md5cmn(t&n|r&~n,e,t,i,o,s)}function md5hh(e,t,r,n,i,o,s){return md5cmn(t^r^n,e,t,i,o,s)}function md5ii(e,t,r,n,i,o,s){return md5cmn(r^(t|~n),e,t,i,o,s)}function stringToBytes(e){e=unescape(encodeURIComponent(e));for(var t=new Uint8Array(e.length),r=0;r<e.length;++r)t[r]=e.charCodeAt(r);return t}var DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",URL$1="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function v35(e,t,r,n,i,o){var s,a="string"==typeof r?stringToBytes(r):r,c="string"==typeof n?parse(n):n;if("string"==typeof n&&(n=parse(n)),16!==(null===(s=n)||void 0===s?void 0:s.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var l=new Uint8Array(16+a.length);if(l.set(c),l.set(a,c.length),(l=t(l))[6]=15&l[6]|e,l[8]=63&l[8]|128,i){o=o||0;for(var u=0;u<16;++u)i[o+u]=l[u];return i}return unsafeStringify(l)}function v3(e,t,r,n){return v35(48,md5,e,t,r,n)}v3.DNS=DNS,v3.URL=URL$1;var randomUUID="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),_native={randomUUID:randomUUID};function v4(e,t,r){var n,i,o,s;if(_native.randomUUID&&!t&&!e)return _native.randomUUID();var a=null!==(n=null!==(i=(e=e||{}).random)&&void 0!==i?i:null===(o=(s=e).rng)||void 0===o?void 0:o.call(s))&&void 0!==n?n:rng();if(a.length<16)throw new Error("Random bytes length must be >= 16");if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){if((r=r||0)<0||r+16>t.length)throw new RangeError("UUID byte range ".concat(r,":").concat(r+15," is out of buffer bounds"));for(var c=0;c<16;++c)t[r+c]=a[c];return t}return unsafeStringify(a)}function f$2(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:case 3:return t^r^n;case 2:return t&r^t&n^r&n}}function ROTL(e,t){return e<<t|e>>>32-t}function sha1(e){var t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520],n=new Uint8Array(e.length+1);n.set(e),n[e.length]=128;for(var i=(e=n).length/4+2,o=Math.ceil(i/16),s=new Array(o),a=0;a<o;++a){for(var c=new Uint32Array(16),l=0;l<16;++l)c[l]=e[64*a+4*l]<<24|e[64*a+4*l+1]<<16|e[64*a+4*l+2]<<8|e[64*a+4*l+3];s[a]=c}s[o-1][14]=8*(e.length-1)/Math.pow(2,32),s[o-1][14]=Math.floor(s[o-1][14]),s[o-1][15]=8*(e.length-1)&4294967295;for(var u=0;u<o;++u){for(var d=new Uint32Array(80),h=0;h<16;++h)d[h]=s[u][h];for(var f=16;f<80;++f)d[f]=ROTL(d[f-3]^d[f-8]^d[f-14]^d[f-16],1);for(var p=r[0],m=r[1],v=r[2],g=r[3],_=r[4],y=0;y<80;++y){var b=Math.floor(y/20),w=ROTL(p,5)+f$2(b,m,v,g)+_+t[b]+d[y]>>>0;_=g,g=v,v=ROTL(m,30)>>>0,m=p,p=w}r[0]=r[0]+p>>>0,r[1]=r[1]+m>>>0,r[2]=r[2]+v>>>0,r[3]=r[3]+g>>>0,r[4]=r[4]+_>>>0}return Uint8Array.of(r[0]>>24,r[0]>>16,r[0]>>8,r[0],r[1]>>24,r[1]>>16,r[1]>>8,r[1],r[2]>>24,r[2]>>16,r[2]>>8,r[2],r[3]>>24,r[3]>>16,r[3]>>8,r[3],r[4]>>24,r[4]>>16,r[4]>>8,r[4])}function v5(e,t,r,n){return v35(80,sha1,e,t,r,n)}function v6(e,t,r){var n,i;null!==(n=e)&&void 0!==n||(e={}),null!==(i=r)&&void 0!==i||(r=0);var o=v1(_objectSpread2(_objectSpread2({},e),{},{_v6:!0}),new Uint8Array(16));if(o=v1ToV6(o),t){for(var s=0;s<16;s++)t[r+s]=o[s];return t}return unsafeStringify(o)}function v6ToV1(e){var t=_v6ToV1("string"==typeof e?parse(e):e);return"string"==typeof e?unsafeStringify(t):t}function _v6ToV1(e){return Uint8Array.of((15&e[3])<<4|e[4]>>4&15,(15&e[4])<<4|(240&e[5])>>4,(15&e[5])<<4|15&e[6],e[7],(15&e[1])<<4|(240&e[2])>>4,(15&e[2])<<4|(240&e[3])>>4,16|(240&e[0])>>4,(15&e[0])<<4|(240&e[1])>>4,e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}v5.DNS=DNS,v5.URL=URL$1;var _state={};function v7(e,t,r){var n;if(e){var i,o,s;n=v7Bytes(null!==(i=null!==(o=e.random)&&void 0!==o?o:null===(s=e.rng)||void 0===s?void 0:s.call(e))&&void 0!==i?i:rng(),e.msecs,e.seq,t,r)}else{var a=Date.now(),c=rng();updateV7State(_state,a,c),n=v7Bytes(c,_state.msecs,_state.seq,t,r)}return null!=t?t:unsafeStringify(n)}function updateV7State(e,t,r){var n,i;return null!==(n=e.msecs)&&void 0!==n||(e.msecs=-1/0),null!==(i=e.seq)&&void 0!==i||(e.seq=0),t>e.msecs?(e.seq=r[6]<<23|r[7]<<16|r[8]<<8|r[9],e.msecs=t):(e.seq=e.seq+1|0,0===e.seq&&e.msecs++),e}function v7Bytes(e,t,r,n){var i,o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(e.length<16)throw new Error("Random bytes length must be >= 16");if(n){if(s<0||s+16>n.length)throw new RangeError("UUID byte range ".concat(s,":").concat(s+15," is out of buffer bounds"))}else n=new Uint8Array(16),s=0;return null!==(i=t)&&void 0!==i||(t=Date.now()),null!==(o=r)&&void 0!==o||(r=127*e[6]<<24|e[7]<<16|e[8]<<8|e[9]),n[s++]=t/1099511627776&255,n[s++]=t/4294967296&255,n[s++]=t/16777216&255,n[s++]=t/65536&255,n[s++]=t/256&255,n[s++]=255&t,n[s++]=112|r>>>28&15,n[s++]=r>>>20&255,n[s++]=128|r>>>14&63,n[s++]=r>>>6&255,n[s++]=r<<2&255|3&e[10],n[s++]=e[11],n[s++]=e[12],n[s++]=e[13],n[s++]=e[14],n[s++]=e[15],n}function version(e){if(!validate(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}var f$1=function(){function e(t,r,n,i,o,s,a,c,l,u){var d=this;_classCallCheck(this,e),this._legacyCanvasSize=e.DEFAULT_CANVAS_SIZE,this._preferredCamera="environment",this._maxScansPerSecond=25,this._lastScanTimestamp=-1,this._destroyed=this._flashOn=this._paused=this._active=!1,this._stream=void 0,this._stream=u,this._xpandR=null!=s?s:0,this._xpandL=null!=a?a:0,this._xpandT=null!=c?c:0,this._xpandB=null!=l?l:0,this.$video=t,this.$canvas=document.createElement("canvas"),n&&"object"===_typeof(n)?this._onDecode=r:(n||i||o?console.warn("You're using a deprecated version of the QrScanner constructor which will be removed in the future"):console.warn("Note that the type of the scan result passed to onDecode will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),this._legacyOnDecode=r),r="object"===_typeof(n)?n:{},this._onDecodeError=r.onDecodeError||("function"==typeof n?n:this._onDecodeError),this._calculateScanRegion=r.calculateScanRegion||("function"==typeof i?i:this._calculateScanRegion),this._preferredCamera=r.preferredCamera||o||this._preferredCamera,this._legacyCanvasSize="number"==typeof n?n:"number"==typeof i?i:this._legacyCanvasSize,this._maxScansPerSecond=r.maxScansPerSecond||this._maxScansPerSecond,this._onPlay=this._onPlay.bind(this),this._onLoadedMetaData=this._onLoadedMetaData.bind(this),this._onVisibilityChange=this._onVisibilityChange.bind(this),this._updateOverlay=this._updateOverlay.bind(this),t.disablePictureInPicture=!0,t.playsInline=!0,t.muted=!0;var h=!1;if(t.hidden&&(t.hidden=!1,h=!0),document.body.contains(t)||(document.body.appendChild(t),h=!0),n=t.parentElement,r.highlightScanRegion||r.highlightCodeOutline){if(i=!!r.overlay,this.$overlay=r.overlay||document.createElement("div"),(o=this.$overlay.style).position="absolute",o.display="none",o.pointerEvents="none",this.$overlay.classList.add("scan-region-highlight"),!i&&r.highlightScanRegion){this.$overlay.innerHTML='<svg class="scan-region-highlight-svg" width="389" height="206" viewBox="0 0 389 206" fill="none" xmlns="http://www.w3.org/2000/svg">                    <path d="M42.9997 6.75146H13.6406C9.22235 6.75146 5.64062 10.3332 5.64062 14.7515V43.0004" stroke-width="5"/>                    <path d="M5.64062 163L5.64062 191.249C5.64062 195.667 9.22235 199.249 13.6406 199.249L42.9997 199.249" stroke-width="5"/>                    <path d="M348.996 199.249L378.355 199.249C382.774 199.249 386.355 195.667 386.355 191.249L386.355 163" stroke-width="5"/>                    <path d="M386.355 43.0004L386.355 14.7515C386.355 10.3332 382.774 6.75146 378.355 6.75146L348.996 6.75146" stroke-width="5"/>                    <rect x="6.14062" y="7.25146" width="379.715" height="191.497" rx="7.5" stroke-dasharray="4 4"/>                    </svg>';try{this.$overlay.firstElementChild.animate({transform:["scale(.98)","scale(1.01)"]},{duration:400,iterations:1/0,direction:"alternate",easing:"ease-in-out"})}catch(e){}n.insertBefore(this.$overlay,this.$video.nextSibling)}r.highlightCodeOutline&&(this.$overlay.insertAdjacentHTML("beforeend",'<svg class="code-outline-highlight" preserveAspectRatio="none" style="display:none;width:100%;height:100%;fill:none;stroke:#e9b213;stroke-width:5;stroke-dasharray:25;stroke-linecap:round;stroke-linejoin:round"><polygon/></svg>'),this.$codeOutlineHighlight=this.$overlay.lastElementChild)}this._scanRegion=this._calculateScanRegion(t),requestAnimationFrame((function(){var e=window.getComputedStyle(t);"none"===e.display&&(t.style.setProperty("display","block","important"),h=!0),"visible"!==e.visibility&&(t.style.setProperty("visibility","visible","important"),h=!0),h&&(console.warn("QrScanner has overwritten the video hiding style to avoid Safari stopping the playback."),t.style.opacity="0",t.style.width="0",t.style.height="0",d.$overlay&&d.$overlay.parentElement&&d.$overlay.parentElement.removeChild(d.$overlay),delete d.$overlay,delete d.$codeOutlineHighlight),d.$overlay&&d._updateOverlay()})),t.addEventListener("play",this._onPlay),t.addEventListener("loadedmetadata",this._onLoadedMetaData),document.addEventListener("visibilitychange",this._onVisibilityChange),window.addEventListener("resize",this._updateOverlay),this._qrEnginePromise=e.createQrEngine()}var t,r,n,i,o,s,a,c,l,u,d,h,f,p,m,v;return _createClass(e,[{key:"hasFlash",value:(v=_asyncToGenerator(_regeneratorRuntime().mark((function t(){var r;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!this.$video.srcObject){t.next=7;break}if(this.$video.srcObject instanceof MediaStream){t.next=4;break}return t.abrupt("return",!1);case 4:r=this.$video.srcObject,t.next=10;break;case 7:return t.next=9,this._getCameraStream();case 9:r=t.sent.stream;case 10:return t.abrupt("return","torch"in r.getVideoTracks()[0].getSettings());case 13:return t.prev=13,t.t0=t.catch(0),t.abrupt("return",!1);case 16:return t.prev=16,r&&r!==this.$video.srcObject&&(console.warn("Call hasFlash after successfully starting the scanner to avoid creating a temporary video stream"),e._stopVideoStream(r)),t.finish(16);case 19:case"end":return t.stop()}}),t,this,[[0,13,16,19]])}))),function(){return v.apply(this,arguments)})},{key:"isFlashOn",value:function(){return this._flashOn}},{key:"toggleFlash",value:(m=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._flashOn){e.next=5;break}return e.next=3,this.turnFlashOff();case 3:e.next=7;break;case 5:return e.next=7,this.turnFlashOn();case 7:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"turnFlashOn",value:(p=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._flashOn||this._destroyed||(this._flashOn=!0,!this._active||this._paused)){e.next=13;break}return e.prev=1,e.next=4,this.hasFlash();case 4:if(e.sent){e.next=6;break}throw"No flash available";case 6:return e.next=8,this.$video.srcObject.getVideoTracks()[0].applyConstraints({advanced:[{torch:!0}]});case 8:e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(1),this._flashOn=!1,e.t0;case 13:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(){return p.apply(this,arguments)})},{key:"turnFlashOff",value:(f=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this._flashOn,!e.t0){e.next=5;break}return this._flashOn=!1,e.next=5,this._restartVideoStream();case 5:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"destroy",value:function(){this.$video.removeEventListener("loadedmetadata",this._onLoadedMetaData),this.$video.removeEventListener("play",this._onPlay),document.removeEventListener("visibilitychange",this._onVisibilityChange),window.removeEventListener("resize",this._updateOverlay),this._destroyed=!0,this._flashOn=!1,this.stop(),e._postWorkerMessage(this._qrEnginePromise,"close")}},{key:"start",value:(h=_asyncToGenerator(_regeneratorRuntime().mark((function t(){var r,n,i;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._destroyed){t.next=2;break}throw Error("The QR scanner can not be started as it had been destroyed.");case 2:if(this._active&&!this._paused){t.next=30;break}if("https:"!==window.location.protocol&&console.warn("The camera stream is only accessible if the page is transferred via https."),this._active=!0,document.hidden){t.next=30;break}if(this._paused=!1,!this.$video.srcObject){t.next=9;break}return t.next=7,this.$video.play();case 7:t.next=30;break;case 9:return t.prev=9,t.next=12,this._getCameraStream();case 12:if(r=t.sent,n=r.stream,i=r.facingMode,this._active&&!this._paused){t.next=19;break}e._stopVideoStream(n),t.next=24;break;case 19:return this._setVideoMirror(i),this.$video.srcObject=n,t.next=23,this.$video.play();case 23:this._flashOn&&(this._flashOn=!1,this.turnFlashOn().catch((function(){})));case 24:t.next=30;break;case 26:if(t.prev=26,t.t0=t.catch(9),this._paused){t.next=30;break}throw this._active=!1,t.t0;case 30:case"end":return t.stop()}}),t,this,[[9,26]])}))),function(){return h.apply(this,arguments)})},{key:"stop",value:function(){this.pause(),this._active=!1}},{key:"pause",value:(d=_asyncToGenerator(_regeneratorRuntime().mark((function t(){var r,n,i=this,o=arguments;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=o.length>0&&void 0!==o[0]&&o[0],this._paused=!0,this._active){t.next=4;break}return t.abrupt("return",!0);case 4:if(this.$video.pause(),this.$overlay&&(this.$overlay.style.display="none"),n=function(){i.$video.srcObject instanceof MediaStream&&(e._stopVideoStream(i.$video.srcObject),i.$video.srcObject=null)},!r){t.next=9;break}return t.abrupt("return",(n(),!0));case 9:return t.next=11,new Promise((function(e){return setTimeout(e,300)}));case 11:if(this._paused){t.next=13;break}return t.abrupt("return",!1);case 13:return n(),t.abrupt("return",!0);case 15:case"end":return t.stop()}}),t,this)}))),function(){return d.apply(this,arguments)})},{key:"setCamera",value:(u=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t!==this._preferredCamera,!e.t0){e.next=5;break}return this._preferredCamera=t,e.next=5,this._restartVideoStream();case 5:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"setGrayscaleWeights",value:function(t,r,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];e._postWorkerMessage(this._qrEnginePromise,"grayscaleWeights",{red:t,green:r,blue:n,useIntegerApproximation:i})}},{key:"setInversionMode",value:function(t){e._postWorkerMessage(this._qrEnginePromise,"inversionMode",t)}},{key:"_onPlay",value:function(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay(),this.$overlay&&(this.$overlay.style.display=""),this._scanFrame()}},{key:"_onLoadedMetaData",value:function(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay()}},{key:"_onVisibilityChange",value:function(){document.hidden?this.pause():this._active&&this.start()}},{key:"_calculateScanRegion",value:function(e){var t=Math.round(2/3*Math.min(e.videoWidth,e.videoHeight));return{x:Math.round((e.videoWidth-t)/2),y:Math.round((e.videoHeight-t)/2),width:t,height:t,downScaledWidth:this._legacyCanvasSize,downScaledHeight:this._legacyCanvasSize}}},{key:"_updateOverlay",value:function(){var e=this;requestAnimationFrame((function(){if(e.$overlay){var t=e.$video,r=t.videoWidth,n=t.videoHeight,i=t.offsetWidth,o=t.offsetHeight,s=t.offsetLeft,a=t.offsetTop,c=window.getComputedStyle(t),l=c.objectFit,u=r/n,d=i/o;switch(l){case"none":var h=r,f=n;break;case"fill":h=i,f=o;break;default:("cover"===l?u>d:u<d)?h=(f=o)*u:f=(h=i)/u,"scale-down"===l&&(h=Math.min(h,r),f=Math.min(f,n))}var p=c.objectPosition.split(" ").map((function(e,t){var r=parseFloat(e);return e.endsWith("%")?(t?o-f:i-h)*r/100:r})),m=_slicedToArray(p,2),v=m[0],g=m[1];c=e._scanRegion.width||r,d=e._scanRegion.height||n,l=e._scanRegion.x||0;var _=e._scanRegion.y||0;(u=e.$overlay.style).width="".concat(c/r*h,"px"),u.height="".concat(d/n*f,"px"),u.top="".concat(a+g+_/n*f,"px"),n=/scaleX\(-1\)/.test(t.style.transform),u.left="".concat(s+(n?i-v-h:v)+(n?r-l-c:l)/r*h,"px"),u.transform=t.style.transform}}))}},{key:"_scanFrame",value:function(){var t=this;!this._active||this.$video.paused||this.$video.ended||("requestVideoFrameCallback"in this.$video?this.$video.requestVideoFrameCallback.bind(this.$video):requestAnimationFrame)(_asyncToGenerator(_regeneratorRuntime().mark((function r(){var n,i,o,s,a,c,l,u,d,h;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(1>=t.$video.readyState){r.next=29;break}if(n=Date.now()-t._lastScanTimestamp,i=1e3/t._maxScansPerSecond,r.t0=n<i,!r.t0){r.next=6;break}return r.next=6,new Promise((function(e){return setTimeout(e,i-n)}));case 6:return t._lastScanTimestamp=Date.now(),r.prev=7,r.next=10,e.scanImage(t.$video,{scanRegion:t._scanRegion,qrEngine:t._qrEnginePromise,canvas:t.$canvas});case 10:o=r.sent,r.next=18;break;case 13:if(r.prev=13,r.t1=r.catch(7),t._active){r.next=17;break}return r.abrupt("return");case 17:t._onDecodeError(r.t1);case 18:if(r.t2=!e._disableBarcodeDetector,r.t2){r.next=25;break}return r.next=22,t._qrEnginePromise;case 22:r.t3=r.sent,r.t4=Worker,r.t2=r.t3 instanceof r.t4;case 25:if(r.t5=r.t2,r.t5){r.next=28;break}t._qrEnginePromise=e.createQrEngine();case 28:o?(t._onDecode?t._onDecode(o):t._legacyOnDecode&&t._legacyOnDecode(o.data),t.$codeOutlineHighlight&&(clearTimeout(t._codeOutlineHighlightRemovalTimeout),t._codeOutlineHighlightRemovalTimeout=void 0,t.$codeOutlineHighlight.setAttribute("viewBox","".concat(t._scanRegion.x||0," ")+"".concat(t._scanRegion.y||0," ")+"".concat(t._scanRegion.width||t.$video.videoWidth," ")+"".concat(t._scanRegion.height||t.$video.videoHeight)),s=o.cornerPoints[0],a=o.cornerPoints[1],c=o.cornerPoints[2],o=o.cornerPoints[3],l=Math.abs(a.x-s.x),u=Math.abs(o.y-s.y),d=0*l,l*=0,h=0*u,u*=0,t.$codeOutlineHighlight.firstElementChild.setAttribute("points",["".concat(s.x-d,",").concat(s.y-h),"".concat(a.x+l,",").concat(a.y-h),"".concat(c.x+l,",").concat(c.y+u),"".concat(o.x-d,",").concat(o.y+u)].join(" ")),t.$codeOutlineHighlight.style.display="")):t.$codeOutlineHighlight&&!t._codeOutlineHighlightRemovalTimeout&&(t._codeOutlineHighlightRemovalTimeout=setTimeout((function(){return t.$codeOutlineHighlight.style.display="none"}),100));case 29:t._scanFrame();case 30:case"end":return r.stop()}}),r,null,[[7,13]])}))))}},{key:"_onDecodeError",value:function(t){t!==e.NO_QR_CODE_FOUND&&console.log(t)}},{key:"_getCameraStream",value:(l=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,r,n,i,o,s,a,c,l,u=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.mediaDevices){e.next=2;break}throw"Camera not found.";case 2:r=/^(environment|user)$/.test(this._preferredCamera)?"facingMode":"deviceId",i=(n=[{width:{min:1024}},{width:{min:768}},{}]).map((function(e){return Object.assign({},e,_defineProperty({},r,{exact:u._preferredCamera}))})),o=0,s=[].concat(_toConsumableArray(i),n);case 4:if(!(o<s.length)){e.next=24;break}if(a=s[o],e.prev=6,null===(t=this._stream)||void 0===t){e.next=11;break}e.t0=t,e.next=14;break;case 11:return e.next=13,navigator.mediaDevices.getUserMedia({video:a,audio:!1});case 13:e.t0=e.sent;case 14:return c=e.t0,l=this._getFacingMode(c)||(a.facingMode?this._preferredCamera:"environment"===this._preferredCamera?"user":"environment"),e.abrupt("return",{stream:c,facingMode:l});case 19:e.prev=19,e.t1=e.catch(6);case 21:o++,e.next=4;break;case 24:throw"Camera not found.";case 25:case"end":return e.stop()}}),e,this,[[6,19]])}))),function(){return l.apply(this,arguments)})},{key:"_restartVideoStream",value:(c=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._paused,e.next=3,this.pause(!0);case 3:if(e.t1=e.sent,!e.t1){e.next=6;break}e.t1=!t;case 6:if(e.t0=e.t1,!e.t0){e.next=9;break}e.t0=this._active;case 9:if(e.t2=e.t0,!e.t2){e.next=13;break}return e.next=13,this.start();case 13:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"_setVideoMirror",value:function(e){this.$video.style.transform="scaleX("+("user"===e?-1:1)+")"}},{key:"_getFacingMode",value:function(e){return(e=e.getVideoTracks()[0])?/rear|back|environment/i.test(e.label)?"environment":/front|user|face/i.test(e.label)?"user":null:null}}],[{key:"WORKER_PATH",set:function(e){console.warn("Setting QrScanner.WORKER_PATH is not required and not supported anymore. Have a look at the README for new setup instructions.")}},{key:"hasCamera",value:(a=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.listCameras(!1);case 3:return t.abrupt("return",!!t.sent.length);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",!1);case 9:case"end":return t.stop()}}),t,null,[[0,6]])}))),function(){return a.apply(this,arguments)})},{key:"listCameras",value:(s=_asyncToGenerator(_regeneratorRuntime().mark((function t(){var r,n,i,o=arguments;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=o.length>0&&void 0!==o[0]&&o[0],navigator.mediaDevices){t.next=3;break}return t.abrupt("return",[]);case 3:if(n=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.enumerateDevices();case 2:return e.abrupt("return",e.sent.filter((function(e){return"videoinput"===e.kind})));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.prev=4,t.t0=r,!t.t0){t.next=10;break}return t.next=9,n();case 9:t.t0=t.sent.every((function(e){return!e.label}));case 10:if(t.t1=t.t0,!t.t1){t.next=15;break}return t.next=14,navigator.mediaDevices.getUserMedia({audio:!1,video:!0});case 14:i=t.sent;case 15:t.next=19;break;case 17:t.prev=17,t.t2=t.catch(4);case 19:return t.prev=19,t.next=22,n();case 22:return t.abrupt("return",t.sent.map((function(e,t){return{id:e.deviceId,label:e.label||(0===t?"Default Camera":"Camera ".concat(t+1))}})));case 23:return t.prev=23,i&&(console.warn("Call listCameras after successfully starting a QR scanner to avoid creating a temporary video stream"),e._stopVideoStream(i)),t.finish(23);case 26:case"end":return t.stop()}}),t,null,[[4,17],[19,,23,26]])}))),function(){return s.apply(this,arguments)})},{key:"scanImage",value:(o=_asyncToGenerator(_regeneratorRuntime().mark((function t(r,n,i,o){var s,a,c,l,u,d,h,f,p,m,v,g,_,y=arguments;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=y.length>4&&void 0!==y[4]&&y[4],a=y.length>5&&void 0!==y[5]&&y[5],l=!1,n&&("scanRegion"in n||"qrEngine"in n||"canvas"in n||"disallowCanvasResizing"in n||"alsoTryWithoutScanRegion"in n||"returnDetailedScanResult"in n)?(c=n.scanRegion,i=n.qrEngine,o=n.canvas,s=n.disallowCanvasResizing||!1,a=n.alsoTryWithoutScanRegion||!1,l=!0):n||i||o||s||a?console.warn("You're using a deprecated api for scanImage which will be removed in the future."):console.warn("Note that the return type of scanImage will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),n=!!i,t.prev=5,t.next=8,Promise.all([i||e.createQrEngine(),e._loadImage(r)]);case 8:if(h=t.sent,f=_slicedToArray(h,2),i=f[0],u=f[1],p=e._drawToCanvas(u,c,o,s),m=_slicedToArray(p,2),o=m[0],d=m[1],!(i instanceof Worker)){t.next=24;break}return g=i,n||e._postWorkerMessageSync(g,"inversionMode","both"),t.next=21,new Promise((function(t,r){var n,i,s,a=-1;i=function(o){o.data.id===a&&(g.removeEventListener("message",i),g.removeEventListener("error",s),clearTimeout(n),null!==o.data.data?t({data:o.data.data,cornerPoints:e._convertPoints(o.data.cornerPoints,c)}):r(e.NO_QR_CODE_FOUND))},s=function(e){g.removeEventListener("message",i),g.removeEventListener("error",s),clearTimeout(n),r("Scanner error: "+(e?e.message||e:"Unknown Error"))},g.addEventListener("message",i),g.addEventListener("error",s),n=setTimeout((function(){return s("timeout")}),1e4);var l=d.getImageData(0,0,o.width,o.height);a=e._postWorkerMessageSync(g,"decode",l,[l.data.buffer])}));case 21:v=t.sent,t.next=27;break;case 24:return t.next=26,Promise.race([new Promise((function(e,t){return window.setTimeout((function(){return t("Scanner error: timeout")}),1e4)})),_asyncToGenerator(_regeneratorRuntime().mark((function t(){var n,l,u;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.detect(o);case 3:if(n=t.sent,l=_slicedToArray(n,1),u=l[0]){t.next=8;break}throw e.NO_QR_CODE_FOUND;case 8:return t.abrupt("return",{data:u.rawValue,cornerPoints:e._convertPoints(u.cornerPoints,c)});case 11:if(t.prev=11,t.t0=t.catch(0),u=t.t0.message||t.t0,!/not implemented|service unavailable/.test(u)){t.next=16;break}return t.abrupt("return",(e._disableBarcodeDetector=!0,e.scanImage(r,{scanRegion:c,canvas:o,disallowCanvasResizing:s,alsoTryWithoutScanRegion:a})));case 16:throw"Scanner error: ".concat(u);case 17:case"end":return t.stop()}}),t,null,[[0,11]])})))()]);case 26:v=t.sent;case 27:return t.abrupt("return",l?v:v.data);case 30:if(t.prev=30,t.t0=t.catch(5),c&&a){t.next=34;break}throw t.t0;case 34:return t.next=36,e.scanImage(r,{qrEngine:i,canvas:o,disallowCanvasResizing:s});case 36:return _=t.sent,t.abrupt("return",l?_:_.data);case 38:return t.prev=38,n||e._postWorkerMessage(i,"close"),t.finish(38);case 41:case"end":return t.stop()}}),t,null,[[5,30,38,41]])}))),function(e,t,r,n){return o.apply(this,arguments)})},{key:"createQrEngine",value:(i=_asyncToGenerator(_regeneratorRuntime().mark((function t(r){var n;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r&&console.warn("Specifying a worker path is not required and not supported anymore."),r=function(){return Promise.resolve().then((function(){return qrScannerWorker_min})).then((function(e){return e.createWorker()}))},t.t0=!e._disableBarcodeDetector&&"BarcodeDetector"in window&&BarcodeDetector.getSupportedFormats,!t.t0){t.next=7;break}return t.next=6,BarcodeDetector.getSupportedFormats();case 6:t.t0=t.sent.includes("qr_code");case 7:if(t.t0){t.next=9;break}return t.abrupt("return",r());case 9:if(n=navigator.userAgentData,t.t1=n&&n.brands.some((function(e){var t=e.brand;return/Chromium/i.test(t)}))&&/mac ?OS/i.test(n.platform),!t.t1){t.next=15;break}return t.next=14,n.getHighEntropyValues(["architecture","platformVersion"]).then((function(e){var t=e.architecture,r=e.platformVersion;return/arm/i.test(t||"arm")&&13<=parseInt(r||"13")})).catch((function(){return!0}));case 14:t.t1=t.sent;case 15:if(!t.t1){t.next=19;break}t.t2=r(),t.next=20;break;case 19:t.t2=new BarcodeDetector({formats:["qr_code"]});case 20:return t.abrupt("return",t.t2);case 21:case"end":return t.stop()}}),t)}))),function(e){return i.apply(this,arguments)})},{key:"_convertPoints",value:function(e,t){if(!t)return e;var r=t.x||0,n=t.y||0,i=t.width&&t.downScaledWidth?t.width/t.downScaledWidth:1;t=t.height&&t.downScaledHeight?t.height/t.downScaledHeight:1;var o,s=_createForOfIteratorHelper(e);try{for(s.s();!(o=s.n()).done;){var a=o.value;a.x=a.x*i+r,a.y=a.y*t+n}}catch(e){s.e(e)}finally{s.f()}return e}},{key:"_stopVideoStream",value:function(e){var t,r=_createForOfIteratorHelper(e.getTracks());try{for(r.s();!(t=r.n()).done;){var n=t.value;n.stop(),e.removeTrack(n)}}catch(e){r.e(e)}finally{r.f()}}},{key:"_drawToCanvas",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];r=r||document.createElement("canvas");var i=t&&t.x?t.x:0,o=t&&t.y?t.y:0,s=t&&t.width?t.width:e.videoWidth||e.width,a=t&&t.height?t.height:e.videoHeight||e.height;return n||(n=t&&t.downScaledWidth?t.downScaledWidth:s,t=t&&t.downScaledHeight?t.downScaledHeight:a,r.width!==n&&(r.width=n),r.height!==t&&(r.height=t)),(t=r.getContext("2d",{alpha:!1})).imageSmoothingEnabled=!1,t.drawImage(e,i,o,s,a,0,0,r.width,r.height),[r,t]}},{key:"_loadImage",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function t(r){var n;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r instanceof Image)){t.next=4;break}return t.next=3,e._awaitImageLoad(r);case 3:return t.abrupt("return",r);case 4:if(!(r instanceof HTMLVideoElement||r instanceof HTMLCanvasElement||r instanceof SVGImageElement||"OffscreenCanvas"in window&&r instanceof OffscreenCanvas||"ImageBitmap"in window&&r instanceof ImageBitmap)){t.next=6;break}return t.abrupt("return",r);case 6:if(!(r instanceof File||r instanceof Blob||r instanceof URL||"string"==typeof r)){t.next=18;break}return(n=new Image).src=r instanceof File||r instanceof Blob?URL.createObjectURL(r):r.toString(),t.prev=9,t.next=12,e._awaitImageLoad(n);case 12:return t.abrupt("return",n);case 13:return t.prev=13,(r instanceof File||r instanceof Blob)&&URL.revokeObjectURL(n.src),t.finish(13);case 16:t.next=19;break;case 18:throw"Unsupported image type.";case 19:case"end":return t.stop()}}),t,null,[[9,,13,16]])}))),function(e){return n.apply(this,arguments)})},{key:"_awaitImageLoad",value:(r=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.complete&&0!==t.naturalWidth,e.t0){e.next=4;break}return e.next=4,new Promise((function(e,r){var n=function n(i){t.removeEventListener("load",n),t.removeEventListener("error",n),i instanceof ErrorEvent?r("Image load error"):e()};t.addEventListener("load",n),t.addEventListener("error",n)}));case 4:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"_postWorkerMessage",value:(t=_asyncToGenerator(_regeneratorRuntime().mark((function t(r,n,i,o){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,r;case 3:return t.t1=t.sent,t.t2=n,t.t3=i,t.t4=o,t.abrupt("return",t.t0._postWorkerMessageSync.call(t.t0,t.t1,t.t2,t.t3,t.t4));case 8:case"end":return t.stop()}}),t)}))),function(e,r,n,i){return t.apply(this,arguments)})},{key:"_postWorkerMessageSync",value:function(t,r,n,i){if(!(t instanceof Worker))return-1;var o=e._workerMessageId++;return t.postMessage({id:o,type:r,data:n},i),o}}]),e}();f$1.DEFAULT_CANVAS_SIZE=400,f$1.NO_QR_CODE_FOUND="No QR code found",f$1._disableBarcodeDetector=!1,f$1._workerMessageId=0;var t="undefined"!=typeof self?self:{};function e(e,r){e=e.split(".");var n,i=t;e[0]in i||void 0===i.execScript||i.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===r?i=i[n]&&i[n]!==Object.prototype[n]?i[n]:i[n]={}:i[n]=r}function n(){throw Error("Invalid UTF8")}function r(e,t){return t=String.fromCharCode.apply(null,t),null==e?t:e+t}let i,s;const o="undefined"!=typeof TextDecoder;let a;const c="undefined"!=typeof TextEncoder;function h(e){if(c)e=(a||=new TextEncoder).encode(e);else{let r=0;const n=new Uint8Array(3*e.length);for(let i=0;i<e.length;i++){var t=e.charCodeAt(i);if(t<128)n[r++]=t;else{if(t<2048)n[r++]=t>>6|192;else{if(t>=55296&&t<=57343){if(t<=56319&&i<e.length){const o=e.charCodeAt(++i);if(o>=56320&&o<=57343){t=1024*(t-55296)+o-56320+65536,n[r++]=t>>18|240,n[r++]=t>>12&63|128,n[r++]=t>>6&63|128,n[r++]=63&t|128;continue}i--}t=65533}n[r++]=t>>12|224,n[r++]=t>>6&63|128}n[r++]=63&t|128}}e=r===n.length?n:n.subarray(0,r)}return e}var u,l;e:{for(var f=["CLOSURE_FLAGS"],d=t,p=0;p<f.length;p++)if(null==(d=d[f[p]])){l=null;break e}l=d}var g,m=l&&l[610401301];u=null!=m&&m;const y=t.navigator;function _(e){return!!u&&!!g&&g.brands.some((({brand:t})=>t&&-1!=t.indexOf(e)))}function v(e){var r;return(r=t.navigator)&&(r=r.userAgent)||(r=""),-1!=r.indexOf(e)}function E(){return!!u&&!!g&&g.brands.length>0}function w(){return E()?_("Chromium"):(v("Chrome")||v("CriOS"))&&!(!E()&&v("Edge"))||v("Silk")}function T(e){return T[" "](e),e}g=y&&y.userAgentData||null,T[" "]=function(){};var b=!E()&&(v("Trident")||v("MSIE"));!v("Android")||w(),w(),v("Safari")&&(w()||!E()&&v("Coast")||!E()&&v("Opera")||!E()&&v("Edge")||(E()?_("Microsoft Edge"):v("Edg/"))||E()&&_("Opera"));var A={},k=null;function S(e){const t=e.length;let r=3*t/4;r%3?r=Math.floor(r):-1!="=.".indexOf(e[t-1])&&(r=-1!="=.".indexOf(e[t-2])?r-2:r-1);const n=new Uint8Array(r);let i=0;return function(e,t){function r(t){for(;n<e.length;){const t=e.charAt(n++),r=k[t];if(null!=r)return r;if(!/^[\s\xa0]*$/.test(t))throw Error("Unknown base64 encoding at char: "+t)}return t}x();let n=0;for(;;){const e=r(-1),n=r(0),i=r(64),o=r(64);if(64===o&&-1===e)break;t(e<<2|n>>4),64!=i&&(t(n<<4&240|i>>2),64!=o&&t(i<<6&192|o))}}(e,(function(e){n[i++]=e})),i!==r?n.subarray(0,i):n}function x(){if(!k){k={};var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"];for(let r=0;r<5;r++){const n=e.concat(t[r].split(""));A[r]=n;for(let e=0;e<n.length;e++){const t=n[e];void 0===k[t]&&(k[t]=e)}}}}var L="undefined"!=typeof Uint8Array,R=!b&&"function"==typeof btoa;function F(e){if(!R){var t;void 0===t&&(t=0),x(),t=A[t];var r=Array(Math.floor(e.length/3)),n=t[64]||"";let c=0,l=0;for(;c<e.length-2;c+=3){var i=e[c],o=e[c+1],s=e[c+2],a=t[i>>2];i=t[(3&i)<<4|o>>4],o=t[(15&o)<<2|s>>6],s=t[63&s],r[l++]=a+i+o+s}switch(a=0,s=n,e.length-c){case 2:s=t[(15&(a=e[c+1]))<<2]||n;case 1:e=e[c],r[l]=t[e>>2]+t[(3&e)<<4|a>>4]+s+n}return r.join("")}for(t="",r=0,n=e.length-10240;r<n;)t+=String.fromCharCode.apply(null,e.subarray(r,r+=10240));return t+=String.fromCharCode.apply(null,r?e.subarray(r):e),btoa(t)}const I=/[-_.]/g,M={"-":"+",_:"/",".":"="};function P(e){return M[e]||""}function O(e){if(!R)return S(e);I.test(e)&&(e=e.replace(I,P)),e=atob(e);const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}function C(e){return L&&null!=e&&e instanceof Uint8Array}var U={};function N(){return G||=new B(null,U)}function D(e){V(U);var t=e.g;return null==(t=null==t||C(t)?t:"string"==typeof t?O(t):null)?t:e.g=t}var B=class{h(){return new Uint8Array(D(this)||0)}constructor(e,t){if(V(t),this.g=e,null!=e&&0===e.length)throw Error("ByteString should be constructed with non-empty values")}};let G,j;function V(e){if(e!==U)throw Error("illegal external caller")}function X(e,t){e.__closure__error__context__984382||(e.__closure__error__context__984382={}),e.__closure__error__context__984382.severity=t}function H(){const e=Error();X(e,"incident"),function(e){t.setTimeout((()=>{throw e}),0)}(e)}function W(e){return X(e=Error(e),"warning"),e}function z(){return"function"==typeof BigInt}function K(e){return Array.prototype.slice.call(e)}var Y="function"==typeof Symbol&&"symbol"==typeof Symbol();function $(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol()?Symbol():e}var q=$(),J=$("0di"),Z=$("2ex"),Q=$("1oa"),tt=Y?(e,t)=>{e[q]|=t}:(e,t)=>{void 0!==e.G?e.G|=t:Object.defineProperties(e,{G:{value:t,configurable:!0,writable:!0,enumerable:!1}})},et=Y?(e,t)=>{e[q]&=~t}:(e,t)=>{void 0!==e.G&&(e.G&=~t)},nt=Y?e=>0|e[q]:e=>0|e.G,rt=Y?e=>e[q]:e=>e.G,it=Y?(e,t)=>{e[q]=t}:(e,t)=>{void 0!==e.G?e.G=t:Object.defineProperties(e,{G:{value:t,configurable:!0,writable:!0,enumerable:!1}})};function st(e){return tt(e,34),e}function ot(e,t){it(t,-30975&(0|e))}function at(e,t){it(t,-30941&(34|e))}var ct,ht={},ut={};function lt(e){return!(!e||"object"!=typeof e||e.Ia!==ut)}function ft(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)&&e.constructor===Object}function dt(e,t){if(null!=e)if("string"==typeof e)e=e?new B(e,U):N();else if(e.constructor!==B)if(C(e))e=e.length?new B(new Uint8Array(e),U):N();else{if(!t)throw Error();e=void 0}return e}function pt(e){return!(!Array.isArray(e)||e.length||!(1&nt(e)))}const gt=[];function mt(e){if(2&e)throw Error()}it(gt,55),ct=Object.freeze(gt);class yt{constructor(e,t,r){this.l=0,this.g=e,this.h=t,this.m=r}next(){if(this.l<this.g.length){const e=this.g[this.l++];return{done:!1,value:this.h?this.h.call(this.m,e):e}}return{done:!0,value:void 0}}[Symbol.iterator](){return new yt(this.g,this.h,this.m)}}let _t;function vt(e,t){(t=_t?t[_t]:void 0)&&(e[_t]=K(t))}var Et=Object.freeze({});function wt(e){return e.Pa=!0,e}var Tt=wt((e=>"number"==typeof e)),bt=wt((e=>"string"==typeof e)),At=wt((e=>"boolean"==typeof e)),kt="function"==typeof t.BigInt&&"bigint"==typeof t.BigInt(0),St=wt((e=>kt?e>=Lt&&e<=Ft:"-"===e[0]?It(e,xt):It(e,Rt)));const xt=Number.MIN_SAFE_INTEGER.toString(),Lt=kt?BigInt(Number.MIN_SAFE_INTEGER):void 0,Rt=Number.MAX_SAFE_INTEGER.toString(),Ft=kt?BigInt(Number.MAX_SAFE_INTEGER):void 0;function It(e,t){if(e.length>t.length)return!1;if(e.length<t.length||e===t)return!0;for(let r=0;r<e.length;r++){const n=e[r],i=t[r];if(n>i)return!1;if(n<i)return!0}}const Mt="function"==typeof Uint8Array.prototype.slice;let Pt,Ot=0,Ct=0;function Ut(e){const t=e>>>0;Ot=t,Ct=(e-t)/4294967296>>>0}function Nt(e){if(e<0){Ut(-e);const[t,r]=Ht(Ot,Ct);Ot=t>>>0,Ct=r>>>0}else Ut(e)}function Dt(e){const t=Pt||=new DataView(new ArrayBuffer(8));t.setFloat32(0,+e,!0),Ct=0,Ot=t.getUint32(0,!0)}function Bt(e,t){const r=4294967296*t+(e>>>0);return Number.isSafeInteger(r)?r:jt(e,t)}function Gt(e,t){const r=2147483648&t;return r&&(t=~t>>>0,0==(e=1+~e>>>0)&&(t=t+1>>>0)),"number"==typeof(e=Bt(e,t))?r?-e:e:r?"-"+e:e}function jt(e,t){if(e>>>=0,(t>>>=0)<=2097151)var r=""+(4294967296*t+e);else z()?r=""+(BigInt(t)<<BigInt(32)|BigInt(e)):(e=(16777215&e)+6777216*(r=16777215&(e>>>24|t<<8))+6710656*(t=t>>16&65535),r+=8147497*t,t*=2,e>=1e7&&(r+=e/1e7>>>0,e%=1e7),r>=1e7&&(t+=r/1e7>>>0,r%=1e7),r=t+Vt(r)+Vt(e));return r}function Vt(e){return e=String(e),"0000000".slice(e.length)+e}function Xt(e){if(e.length<16)Nt(Number(e));else if(z())e=BigInt(e),Ot=Number(e&BigInt(4294967295))>>>0,Ct=Number(e>>BigInt(32)&BigInt(4294967295));else{const t=+("-"===e[0]);Ct=Ot=0;const r=e.length;for(let n=t,i=(r-t)%6+t;i<=r;n=i,i+=6){const t=Number(e.slice(n,i));Ct*=1e6,Ot=1e6*Ot+t,Ot>=4294967296&&(Ct+=Math.trunc(Ot/4294967296),Ct>>>=0,Ot>>>=0)}if(t){const[e,t]=Ht(Ot,Ct);Ot=e,Ct=t}}}function Ht(e,t){return t=~t,e?e=1+~e:t+=1,[e,t]}function Wt(e){return null==e||"number"==typeof e?e:"NaN"===e||"Infinity"===e||"-Infinity"===e?Number(e):void 0}function zt(e){return null==e||"boolean"==typeof e?e:"number"==typeof e?!!e:void 0}const Kt=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function Yt(e){const t=typeof e;switch(t){case"bigint":return!0;case"number":return Number.isFinite(e)}return"string"===t&&Kt.test(e)}function $t(e){if(null==e)return e;if("string"==typeof e){if(!e)return;e=+e}return"number"==typeof e&&Number.isFinite(e)?0|e:void 0}function qt(e){if(null==e)return e;if("string"==typeof e){if(!e)return;e=+e}return"number"==typeof e&&Number.isFinite(e)?e>>>0:void 0}function Jt(e){return"-"!==e[0]&&(e.length<20||20===e.length&&Number(e.substring(0,6))<184467)}function Zt(e){return e=Math.trunc(e),Number.isSafeInteger(e)||(Nt(e),e=Gt(Ot,Ct)),e}function Qt(e){var t=Math.trunc(Number(e));if(Number.isSafeInteger(t))return String(t);if(-1!==(t=e.indexOf("."))&&(e=e.substring(0,t)),!("-"===e[0]?e.length<20||20===e.length&&Number(e.substring(0,7))>-922337:e.length<19||19===e.length&&Number(e.substring(0,6))<922337))if(Xt(e),e=Ot,2147483648&(t=Ct))if(z())e=""+(BigInt(0|t)<<BigInt(32)|BigInt(e>>>0));else{const[r,n]=Ht(e,t);e="-"+jt(r,n)}else e=jt(e,t);return e}function te(e){return null==e?e:"bigint"==typeof e?(St(e)?e=Number(e):(e=BigInt.asIntN(64,e),e=St(e)?Number(e):String(e)),e):Yt(e)?"number"==typeof e?Zt(e):Qt(e):void 0}function ee(e){if(null==e)return e;var t=typeof e;if("bigint"===t)return String(BigInt.asUintN(64,e));if(Yt(e)){if("string"===t)return t=Math.trunc(Number(e)),Number.isSafeInteger(t)&&t>=0?e=String(t):(-1!==(t=e.indexOf("."))&&(e=e.substring(0,t)),Jt(e)||(Xt(e),e=jt(Ot,Ct))),e;if("number"===t)return(e=Math.trunc(e))>=0&&Number.isSafeInteger(e)?e:function(e){if(e<0){Nt(e);var t=jt(Ot,Ct);return e=Number(t),Number.isSafeInteger(e)?e:t}return Jt(t=String(e))?t:(Nt(e),Bt(Ot,Ct))}(e)}}function ne(e){if("string"!=typeof e)throw Error();return e}function re(e){if(null!=e&&"string"!=typeof e)throw Error();return e}function ie(e){return null==e||"string"==typeof e?e:void 0}function se(e,t,r,n){if(null!=e&&"object"==typeof e&&e.X===ht)return e;if(!Array.isArray(e))return r?2&n?(e=t[J])?t=e:(st((e=new t).u),t=t[J]=e):t=new t:t=void 0,t;let i=r=nt(e);return 0===i&&(i|=32&n),i|=2&n,i!==r&&it(e,i),new t(e)}function oe(e,t,r){if(t)e:{if(!Yt(t=e))throw W("int64");switch(typeof t){case"string":t=Qt(t);break e;case"bigint":if(e=t=BigInt.asIntN(64,t),bt(e)){if(!/^\s*(?:-?[1-9]\d*|0)?\s*$/.test(e))throw Error(String(e))}else if(Tt(e)&&!Number.isSafeInteger(e))throw Error(String(e));t=kt?BigInt(t):At(t)?t?"1":"0":bt(t)?t.trim()||"0":String(t);break e;default:t=Zt(t)}}else t=te(e);return"string"==typeof(r=null==(e=t)?r?0:void 0:e)&&(t=+r,Number.isSafeInteger(t))?t:r}function ae(e){var t;return void 0===ue&&(ue="function"==typeof Proxy?me(Proxy):null),(t=!ue)||(void 0===le&&(le="function"==typeof WeakMap?me(WeakMap):null),t=!le),t?e:(t=ce?.get(e))?t:Math.random()>.01?e:(function(e){if(void 0===fe){const e=new ue([],{});fe=1===Array.prototype.concat.call([],e).length}fe&&"function"==typeof Symbol&&Symbol.isConcatSpreadable&&(e[Symbol.isConcatSpreadable]=!0)}(e),function(e,t){(ce||=new le).set(e,t),(he||=new le).set(t,e)}(e,t=new ue(e,{set:(e,t,r)=>(H(),e[t]=r,!0)})),t)}let ce,he,ue,le,fe,de,pe,ge;function me(e){try{return-1!==e.toString().indexOf("[native code]")?e:null}catch{return null}}function ye(e,t,r){return e=_e(e,t[0],t[1],r?1:2),t!==pe&&r&&tt(e,16384),e}function _e(e,t,r,n){if(n=n??0,null==e&&(e=de),de=void 0,null==e){var i=96;r?(e=[r],i|=512):e=[],t&&(i=-33521665&i|(1023&t)<<15)}else{if(!Array.isArray(e))throw Error("narr");if(2048&(i=nt(e)))throw Error("farr");if(64&i)return e;if(1===n||2===n||(i|=64),r&&(i|=512,r!==e[0]))throw Error("mid");e:{if(n=(r=e).length){const e=n-1;if(ft(r[e])){if((t=e-(+!!(512&(i|=256))-1))>=1024)throw Error("pvtlmt");i=-33521665&i|(1023&t)<<15;break e}}if(t){if((t=Math.max(t,n-(+!!(512&i)-1)))>1024)throw Error("spvt");i=-33521665&i|(1023&t)<<15}}}return it(e,i),e}const ve={};let Ee=function(){try{return T(new class extends Map{constructor(){super()}}),!1}catch{return!0}}();class we{constructor(){this.g=new Map}get(e){return this.g.get(e)}set(e,t){return this.g.set(e,t),this.size=this.g.size,this}delete(e){return e=this.g.delete(e),this.size=this.g.size,e}clear(){this.g.clear(),this.size=this.g.size}has(e){return this.g.has(e)}entries(){return this.g.entries()}keys(){return this.g.keys()}values(){return this.g.values()}forEach(e,t){return this.g.forEach(e,t)}[Symbol.iterator](){return this.entries()}}const Te=Ee?(Object.setPrototypeOf(we.prototype,Map.prototype),Object.defineProperties(we.prototype,{size:{value:0,configurable:!0,enumerable:!0,writable:!0}}),we):class extends Map{constructor(){super()}};function be(e){return e}function Ae(e){if(2&e.M)throw Error("Cannot mutate an immutable Map")}var ke=class extends Te{constructor(e,t,r=be,n=be){super();let i=nt(e);i|=64,it(e,i),this.M=i,this.T=t,this.S=r,this.Z=this.T?Se:n;for(let o=0;o<e.length;o++){const s=e[o],a=r(s[0],!1,!0);let c=s[1];t?void 0===c&&(c=null):c=n(s[1],!1,!0,void 0,void 0,i),super.set(a,c)}}oa(e=xe){if(0!==this.size)return this.Y(e)}Y(e=xe){const t=[],r=super.entries();for(var n;!(n=r.next()).done;)(n=n.value)[0]=e(n[0]),n[1]=e(n[1]),t.push(n);return t}clear(){Ae(this),super.clear()}delete(e){return Ae(this),super.delete(this.S(e,!0,!1))}entries(){var e=this.na();return new yt(e,Le,this)}keys(){return this.Ha()}values(){var e=this.na();return new yt(e,ke.prototype.get,this)}forEach(e,t){super.forEach(((r,n)=>{e.call(t,this.get(n),n,this)}))}set(e,t){return Ae(this),null==(e=this.S(e,!0,!1))?this:null==t?(super.delete(e),this):super.set(e,this.Z(t,!0,!0,this.T,!1,this.M))}Na(e){const t=this.S(e[0],!1,!0);e=e[1],e=this.T?void 0===e?null:e:this.Z(e,!1,!0,void 0,!1,this.M),super.set(t,e)}has(e){return super.has(this.S(e,!1,!1))}get(e){e=this.S(e,!1,!1);const t=super.get(e);if(void 0!==t){var r=this.T;return r?((r=this.Z(t,!1,!0,r,this.sa,this.M))!==t&&super.set(e,r),r):t}}na(){return Array.from(super.keys())}Ha(){return super.keys()}[Symbol.iterator](){return this.entries()}};function Se(e,t,r,n,i,o){return e=se(e,n,r,o),i&&(e=De(e)),e}function xe(e){return e}function Le(e){return[e,this.get(e)]}let Re;function Fe(){return Re||=new ke(st([]),void 0,void 0,void 0,ve)}function Ie(e,t,r,n,i){if(null!=e){if(Array.isArray(e))e=pt(e)?void 0:i&&2&nt(e)?e:Me(e,t,r,void 0!==n,i);else if(ft(e)){const o={};for(let s in e)o[s]=Ie(e[s],t,r,n,i);e=o}else e=t(e,n);return e}}function Me(e,t,r,n,i){const o=n||r?nt(e):0;n=n?!!(32&o):void 0;const s=K(e);for(let e=0;e<s.length;e++)s[e]=Ie(s[e],t,r,n,i);return r&&(vt(s,e),r(o,s)),s}function Pe(e){return Ie(e,Oe,void 0,void 0,!1)}function Oe(e){return e.X===ht?e.toJSON():e instanceof ke?e.oa(Pe):function(e){switch(typeof e){case"number":return isFinite(e)?e:String(e);case"bigint":return St(e)?Number(e):String(e);case"boolean":return e?1:0;case"object":if(e)if(Array.isArray(e)){if(pt(e))return}else{if(C(e))return F(e);if(e instanceof B){const t=e.g;return null==t?"":"string"==typeof t?t:e.g=F(t)}if(e instanceof ke)return e.oa()}}return e}(e)}function Ce(e,t,r=at){if(null!=e){if(L&&e instanceof Uint8Array)return t?e:new Uint8Array(e);if(Array.isArray(e)){var n=nt(e);return 2&n?e:(t&&=0===n||!!(32&n)&&!(64&n||!(16&n)),t?(it(e,-12293&(34|n)),e):Me(e,Ce,4&n?at:r,!0,!0))}return e.X===ht?(r=e.u,e=2&(n=rt(r))?e:Ue(e,r,n,!0)):e instanceof ke&&!(2&e.M)&&(r=st(e.Y(Ce)),e=new ke(r,e.T,e.S,e.Z)),e}}function Ue(e,t,r,n){return e=e.constructor,de=t=Ne(t,r,n),t=new e(t),de=void 0,t}function Ne(e,t,r){const n=r||2&t?at:ot,i=!!(32&t);return e=function(e,t,r){const n=K(e);var i=n.length;const o=256&t?n[i-1]:void 0;for(i+=o?-1:0,t=512&t?1:0;t<i;t++)n[t]=r(n[t]);if(o){t=n[t]={};for(const e in o)t[e]=r(o[e])}return vt(n,e),n}(e,t,(e=>Ce(e,i,n))),tt(e,32|(r?2:0)),e}function De(e){const t=e.u,r=rt(t);return 2&r?Ue(e,t,r,!1):e}function Be(e,t){return je(e=e.u,rt(e),t)}function Ge(e,t,r,n){if(!((t=n+(+!!(512&t)-1))<0||t>=e.length||t>=r))return e[t]}function je(e,t,r,n){if(-1===r)return null;const i=t>>15&1023||536870912;if(!(r>=i)){var o=e.length;return n&&256&t&&null!=(n=e[o-1][r])?(Ge(e,t,i,r)&&null!=Z&&((t=(e=j??={})[Z]||0)>=4||(e[Z]=t+1,H())),n):Ge(e,t,i,r)}return 256&t?e[e.length-1][r]:void 0}function Ve(e,t,r){const n=e.u;let i=rt(n);return mt(i),Xe(n,i,t,r),e}function Xe(e,t,r,n){const i=t>>15&1023||536870912;if(r>=i){let o,s=t;if(256&t)o=e[e.length-1];else{if(null==n)return s;o=e[i+(+!!(512&t)-1)]={},s|=256}return o[r]=n,r<i&&(e[r+(+!!(512&t)-1)]=void 0),s!==t&&it(e,s),s}return e[r+(+!!(512&t)-1)]=n,256&t&&r in(e=e[e.length-1])&&delete e[r],t}function He(e,t){e=e.u;let r=rt(e);const n=je(e,r,t),i=Wt(n);return null!=i&&i!==n&&Xe(e,r,t,i),i}function We(e){e=e.u;let t=rt(e);const r=je(e,t,1),n=dt(r,!0);return null!=n&&n!==r&&Xe(e,t,1,n),n}function ze(){return void 0===Et?2:4}function Ke(e,t,r,n,i){const o=e.u,s=2&(e=rt(o))?1:n;i=!!i,n=Ye(o,e,t);var a=nt(n);if(!(4&a)){4&a&&(n=K(n),a=fn(a,e),e=Xe(o,e,t,n));let i=0,s=0;for(;i<n.length;i++){const e=r(n[i]);null!=e&&(n[s++]=e)}s<i&&(n.length=s),a=-4097&(20|(a=$e(a,e))),it(n,a&=-8193),2&a&&Object.freeze(n)}let c;return 1===s||4===s&&32&a?qe(a)||(i=a,(a|=2)!==i&&it(n,a),Object.freeze(n)):(r=5===s&&(!!(32&a)||qe(a)||!!ce?.get(n)),(2===s||r)&&qe(a)&&(n=K(n),a=dn(a=fn(a,e),e,i),it(n,a),e=Xe(o,e,t,n)),qe(a)||(t=a,(a=dn(a,e,i))!==t&&it(n,a)),r?c=ae(n):2!==s||i||ce?.delete(n)),c||n}function Ye(e,t,r,n){return e=je(e,t,r,n),Array.isArray(e)?e:ct}function $e(e,t){return 0===e&&(e=fn(e,t)),1|e}function qe(e){return!!(2&e)&&!!(4&e)||!!(2048&e)}function Je(e){e=K(e);for(let t=0;t<e.length;t++){const r=e[t]=K(e[t]);Array.isArray(r[1])&&(r[1]=st(r[1]))}return e}function Ze(e,t,r,n){e=e.u;let i=rt(e);mt(i),Xe(e,i,t,("0"===n?0===Number(r):r===n)?void 0:r)}function Qe(e,t,r,n,i){mt(t);var o=!(!(64&t)&&16384&t);const s=(i=Ye(e,t,r,i))!==ct;if(o||!s){let a=o=s?nt(i):0;(!s||2&a||qe(a)||4&a&&!(32&a))&&(i=K(i),a=fn(a,t),t=Xe(e,t,r,i)),a=-13&$e(a,t),a=dn(n?-17&a:16|a,t,!0),a!==o&&it(i,a)}return i}function tn(e,t){var r=As;return rn(en(e=e.u),e,rt(e),r)===t?t:-1}function en(e){if(Y)return e[Q]??(e[Q]=new Map);if(Q in e)return e[Q];const t=new Map;return Object.defineProperty(e,Q,{value:t}),t}function nn(e,t,r,n){const i=en(e),o=rn(i,e,t,r);return o!==n&&(o&&(t=Xe(e,t,o)),i.set(r,n)),t}function rn(e,t,r,n){let i=e.get(n);if(null!=i)return i;i=0;for(let e=0;e<n.length;e++){const o=n[e];null!=je(t,r,o)&&(0!==i&&(r=Xe(t,r,i)),i=o)}return e.set(n,i),i}function sn(e,t,r,n){let i,o=rt(e);if(null!=(n=je(e,o,r,n))&&n.X===ht)return(t=De(n))!==n&&Xe(e,o,r,t),t.u;if(Array.isArray(n)){const e=nt(n);i=2&e?ye(Ne(n,e,!1),t,!0):64&e?n:ye(i,t,!0)}else i=ye(void 0,t,!0);return i!==n&&Xe(e,o,r,i),i}function on(e,t,r,n){e=e.u;let i=rt(e);return(t=se(n=je(e,i,r,n),t,!1,i))!==n&&null!=t&&Xe(e,i,r,t),t}function an(e,t,r,n=!1){if(null==(t=on(e,t,r,n)))return t;if(e=e.u,!(2&(n=rt(e)))){const i=De(t);i!==t&&Xe(e,n,r,t=i)}return t}function cn(e,t,r,n,i,o,s){e=e.u;var a=!!(2&t);i=a?1:i,o=!!o,s&&=!a,a=Ye(e,t,n);var c=nt(a),l=!!(4&c);if(!l){var u=a,d=t;const e=!!(2&(c=$e(c,t)));e&&(d|=2);let n=!e,i=!0,o=0,s=0;for(;o<u.length;o++){const t=se(u[o],r,!1,d);if(t instanceof r){if(!e){const e=!!(2&nt(t.u));n&&=!e,i&&=e}u[s++]=t}}s<o&&(u.length=s),c|=4,c=i?16|c:-17&c,it(u,c=n?8|c:-9&c),e&&Object.freeze(u)}if(s&&!(8&c||!a.length&&(1===i||4===i&&32&c))){for(qe(c)&&(a=K(a),c=fn(c,t),t=Xe(e,t,n,a)),r=a,s=c,u=0;u<r.length;u++)(c=r[u])!==(d=De(c))&&(r[u]=d);s|=8,s=r.length?-17&s:16|s,it(r,s),c=s}let h;return 1===i||4===i&&32&c?qe(c)||(t=c,(c|=!a.length||16&c&&(!l||32&c)?2:2048)!==t&&it(a,c),Object.freeze(a)):(l=5===i&&(!!(32&c)||qe(c)||!!ce?.get(a)),(2===i||l)&&qe(c)&&(a=K(a),c=dn(c=fn(c,t),t,o),it(a,c),t=Xe(e,t,n,a)),qe(c)||(n=c,(c=dn(c,t,o))!==n&&it(a,c)),l?h=ae(a):2!==i||o||ce?.delete(a)),h||a}function hn(e,t,r){const n=rt(e.u);return cn(e,n,t,r,ze(),!1,!(2&n))}function un(e,t,r,n){return null==n&&(n=void 0),Ve(e,r,n)}function ln(e,t,r,n){null==n&&(n=void 0);e:{e=e.u;let i=rt(e);if(mt(i),null==n){const n=en(e);if(rn(n,e,i,r)!==t)break e;n.set(r,0)}else i=nn(e,i,r,t);Xe(e,i,t,n)}}function fn(e,t){return-2049&(32|(2&t?2|e:-3&e))}function dn(e,t,r){return 32&t&&r||(e&=-33),e}function pn(e,t,r,n){const i=rt(e.u);mt(i),e=cn(e,i,r,t,2,!0),n=null!=n?n:new r,e.push(n),2&nt(n.u)?et(e,8):et(e,16)}function gn(e,t){return e??t}function mn(e,t){return $t(Be(e,t))}function yn(e,t){return gn(He(e,t),0)}function _n(e,t){return gn(ie(Be(e,t)),"")}function vn(e,t,r){if(null!=r&&"boolean"!=typeof r)throw e=typeof r,Error(`Expected boolean but got ${"object"!=e?e:r?Array.isArray(r)?"array":e:"null"}: ${r}`);Ve(e,t,r)}function En(e,t,r){if(null!=r){if("number"!=typeof r)throw W("int32");if(!Number.isFinite(r))throw W("int32");r|=0}Ve(e,t,r)}function wn(e,t,r){if(null!=r&&"number"!=typeof r)throw Error(`Value of float/double field must be a number, found ${typeof r}: ${r}`);Ve(e,t,r)}function Tn(e,t,r){{const s=e.u;let a=rt(s);if(mt(a),null==r)Xe(s,a,t);else{r=he?.get(r)||r;var n=e=nt(r),i=qe(e),o=i||Object.isFrozen(r);for(i||(e=0),o||(r=K(r),n=0,e=dn(e=fn(e,a),a,!0),o=!1),e|=21,i=0;i<r.length;i++){const t=r[i],s=ne(t);Object.is(t,s)||(o&&(r=K(r),n=0,e=dn(e=fn(e,a),a,!0),o=!1),r[i]=s)}e!==n&&(o&&(r=K(r),e=dn(e=fn(e,a),a,!0)),it(r,e)),Xe(s,a,t,r)}}}function bn(e,t,r){mt(rt(e.u)),Ke(e,t,ie,2,!0).push(ne(r))}function An(e,t){return Error(`Invalid wire type: ${e} (at position ${t})`)}function kn(){return Error("Failed to read varint, encoding is invalid.")}function Sn(e,t){return Error(`Tried to read past the end of the data ${t} > ${e}`)}function xn(e){if("string"==typeof e)return{buffer:O(e),O:!1};if(Array.isArray(e))return{buffer:new Uint8Array(e),O:!1};if(e.constructor===Uint8Array)return{buffer:e,O:!1};if(e.constructor===ArrayBuffer)return{buffer:new Uint8Array(e),O:!1};if(e.constructor===B)return{buffer:D(e)||new Uint8Array(0),O:!0};if(e instanceof Uint8Array)return{buffer:new Uint8Array(e.buffer,e.byteOffset,e.byteLength),O:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function Ln(e,t){let r,n=0,i=0,o=0;const s=e.h;let a=e.g;do{r=s[a++],n|=(127&r)<<o,o+=7}while(o<32&&128&r);for(o>32&&(i|=(127&r)>>4),o=3;o<32&&128&r;o+=7)r=s[a++],i|=(127&r)<<o;if(Un(e,a),r<128)return t(n>>>0,i>>>0);throw kn()}function Rn(e){let t=0,r=e.g;const n=r+10,i=e.h;for(;r<n;){const n=i[r++];if(t|=n,0==(128&n))return Un(e,r),!!(127&t)}throw kn()}function Fn(e){const t=e.h;let r=e.g,n=t[r++],i=127&n;if(128&n&&(n=t[r++],i|=(127&n)<<7,128&n&&(n=t[r++],i|=(127&n)<<14,128&n&&(n=t[r++],i|=(127&n)<<21,128&n&&(n=t[r++],i|=n<<28,128&n&&128&t[r++]&&128&t[r++]&&128&t[r++]&&128&t[r++]&&128&t[r++])))))throw kn();return Un(e,r),i}function In(e){return Fn(e)>>>0}function Mn(e){var t=e.h;const r=e.g,n=t[r],i=t[r+1],o=t[r+2];return t=t[r+3],Un(e,e.g+4),(n<<0|i<<8|o<<16|t<<24)>>>0}function Pn(e){var t=Mn(e);e=2*(t>>31)+1;const r=t>>>23&255;return t&=8388607,255==r?t?NaN:e*(1/0):0==r?1401298464324817e-60*e*t:e*Math.pow(2,r-150)*(t+8388608)}function On(e){return Fn(e)}function Cn(e,t,{ca:r=!1}={}){e.ca=r,t&&(t=xn(t),e.h=t.buffer,e.m=t.O,e.j=0,e.l=e.h.length,e.g=e.j)}function Un(e,t){if(e.g=t,t>e.l)throw Sn(e.l,t)}function Nn(e,t){if(t<0)throw Error(`Tried to read a negative byte length: ${t}`);const r=e.g,n=r+t;if(n>e.l)throw Sn(t,e.l-r);return e.g=n,r}function Dn(e,t){if(0==t)return N();var r=Nn(e,t);return e.ca&&e.m?r=e.h.subarray(r,r+t):(e=e.h,r=r===(t=r+t)?new Uint8Array(0):Mt?e.slice(r,t):new Uint8Array(e.subarray(r,t))),0==r.length?N():new B(r,U)}ke.prototype.toJSON=void 0,ke.prototype.Ia=ut;var Bn=[];function Gn(e){var t=e.g;if(t.g==t.l)return!1;e.l=e.g.g;var r=In(e.g);if(t=r>>>3,!((r&=7)>=0&&r<=5))throw An(r,e.l);if(t<1)throw Error(`Invalid field number: ${t} (at position ${e.l})`);return e.m=t,e.h=r,!0}function jn(e){switch(e.h){case 0:0!=e.h?jn(e):Rn(e.g);break;case 1:Un(e=e.g,e.g+8);break;case 2:if(2!=e.h)jn(e);else{var t=In(e.g);Un(e=e.g,e.g+t)}break;case 5:Un(e=e.g,e.g+4);break;case 3:for(t=e.m;;){if(!Gn(e))throw Error("Unmatched start-group tag: stream EOF");if(4==e.h){if(e.m!=t)throw Error("Unmatched end-group tag");break}jn(e)}break;default:throw An(e.h,e.l)}}function Vn(e,t,r){const n=e.g.l,i=In(e.g),o=e.g.g+i;let s=o-n;if(s<=0&&(e.g.l=o,r(t,e,void 0,void 0,void 0),s=o-e.g.g),s)throw Error(`Message parsing ended unexpectedly. Expected to read ${i} bytes, instead read ${i-s} bytes, either the data ended unexpectedly or the message misreported its own length`);return e.g.g=o,e.g.l=n,t}function Xn(e){var t=In(e.g),a=Nn(e=e.g,t);if(e=e.h,o){var c,l=e;(c=s)||(c=s=new TextDecoder("utf-8",{fatal:!0})),t=a+t,l=0===a&&t===l.length?l:l.subarray(a,t);try{var u=c.decode(l)}catch(e){if(void 0===i){try{c.decode(new Uint8Array([128]))}catch(e){}try{c.decode(new Uint8Array([97])),i=!0}catch(e){i=!1}}throw!i&&(s=void 0),e}}else{t=(u=a)+t,a=[];let i,o=null;for(;u<t;){var d=e[u++];d<128?a.push(d):d<224?u>=t?n():(i=e[u++],d<194||128!=(192&i)?(u--,n()):a.push((31&d)<<6|63&i)):d<240?u>=t-1?n():(i=e[u++],128!=(192&i)||224===d&&i<160||237===d&&i>=160||128!=(192&(c=e[u++]))?(u--,n()):a.push((15&d)<<12|(63&i)<<6|63&c)):d<=244?u>=t-2?n():(i=e[u++],128!=(192&i)||i-144+(d<<28)>>30!=0||128!=(192&(c=e[u++]))||128!=(192&(l=e[u++]))?(u--,n()):(d=(7&d)<<18|(63&i)<<12|(63&c)<<6|63&l,d-=65536,a.push(55296+(d>>10&1023),56320+(1023&d)))):n(),a.length>=8192&&(o=r(o,a),a.length=0)}u=r(o,a)}return u}function Hn(e){const t=In(e.g);return Dn(e.g,t)}function Wn(e,t,r){var n=In(e.g);for(n=e.g.g+n;e.g.g<n;)r.push(t(e.g))}var zn=[];let Kn;function Yn(e,t,r){t.g?t.m(e,t.g,t.h,r,!0):t.m(e,t.h,r,!0)}var $n=class{constructor(e,t){this.u=_e(e,t)}toJSON(){return qn(this)}l(){var e=Eo;return e.g?e.l(this,e.g,e.h,!0):e.l(this,e.h,e.defaultValue,!0)}clone(){const e=this.u;return Ue(this,e,rt(e),!1)}O(){return!!(2&nt(this.u))}};function qn(e){e=e.u,e=Kn?e:Me(e,Oe,void 0,void 0,!1);{var t=!Kn;let l=e.length;if(l){var r=e[l-1],n=ft(r);n?l--:r=void 0;var i=e;if(n){e:{var o,s=r,a=!1;if(s)for(let e in s)isNaN(+e)?(o??={})[e]=s[e]:(n=s[e],Array.isArray(n)&&(pt(n)||lt(n)&&0===n.size)&&(n=null),null==n&&(a=!0),null!=n&&((o??={})[e]=n));if(a||(o=s),o)for(let e in o){a=o;break e}a=null}s=null==a?null!=r:a!==r}for(;l>0&&(null==(o=i[l-1])||pt(o)||lt(o)&&0===o.size);l--)var c=!0;(i!==e||s||c)&&(t?(c||s||a)&&(i.length=l):i=Array.prototype.slice.call(i,0,l),a&&i.push(a)),c=i}else c=e}return c}function Jn(e){return e?/^\d+$/.test(e)?(Xt(e),new Zn(Ot,Ct)):null:Qn||=new Zn(0,0)}$n.prototype.X=ht,$n.prototype.toString=function(){try{return Kn=!0,qn(this).toString()}finally{Kn=!1}};var Zn=class{constructor(e,t){this.h=e>>>0,this.g=t>>>0}};let Qn;function tr(e){return e?/^-?\d+$/.test(e)?(Xt(e),new er(Ot,Ct)):null:nr||=new er(0,0)}var er=class{constructor(e,t){this.h=e>>>0,this.g=t>>>0}};let nr;function rr(e,t,r){for(;r>0||t>127;)e.g.push(127&t|128),t=(t>>>7|r<<25)>>>0,r>>>=7;e.g.push(t)}function ir(e,t){for(;t>127;)e.g.push(127&t|128),t>>>=7;e.g.push(t)}function sr(e,t){if(t>=0)ir(e,t);else{for(let r=0;r<9;r++)e.g.push(127&t|128),t>>=7;e.g.push(1)}}function or(e,t){e.g.push(t>>>0&255),e.g.push(t>>>8&255),e.g.push(t>>>16&255),e.g.push(t>>>24&255)}function ar(e,t){0!==t.length&&(e.l.push(t),e.h+=t.length)}function cr(e,t,r){ir(e.g,8*t+r)}function hr(e,t){return cr(e,t,2),t=e.g.end(),ar(e,t),t.push(e.h),t}function ur(e,t){var r=t.pop();for(r=e.h+e.g.length()-r;r>127;)t.push(127&r|128),r>>>=7,e.h++;t.push(r),e.h++}function lr(e,t,r){cr(e,t,2),ir(e.g,r.length),ar(e,e.g.end()),ar(e,r)}function fr(e,t,r,n){null!=r&&(t=hr(e,t),n(r,e),ur(e,t))}function dr(){const e=class{constructor(){throw Error()}};return Object.setPrototypeOf(e,e.prototype),e}var pr=dr(),gr=dr(),mr=dr(),yr=dr(),_r=dr(),vr=dr(),Er=dr(),wr=dr(),Tr=dr(),br=class{constructor(e,t,r){this.g=e,this.h=t,e=pr,this.l=!!e&&r===e||!1}};function Ar(e,t){return new br(e,t,pr)}function kr(e,t,r,n,i){fr(e,r,Ur(t,n),i)}const Sr=Ar((function(e,t,r,n,i){return 2===e.h&&(Vn(e,sn(t,n,r),i),!0)}),kr),xr=Ar((function(e,t,r,n,i){return 2===e.h&&(Vn(e,sn(t,n,r,!0),i),!0)}),kr);var Lr=Symbol(),Rr=Symbol(),Fr=Symbol(),Ir=Symbol();let Mr,Pr;function Or(e,t,r,n){var i=n[e];if(i)return i;(i={}).W=function(e){switch(typeof e){case"boolean":return pe||=[0,void 0,!0];case"number":return e>0?void 0:0===e?ge||=[0,void 0]:[-e,void 0];case"string":return[0,e];case"object":return e}}(n[0]);var o=n[1];let s=1;o&&o.constructor===Object&&(i.ha=o,"function"==typeof(o=n[++s])&&(i.ma=!0,Mr??=o,Pr??=n[s+1],o=n[s+=2]));const a={};for(;o&&Array.isArray(o)&&o.length&&"number"==typeof o[0]&&o[0]>0;){for(var c=0;c<o.length;c++)a[o[c]]=o;o=n[++s]}for(c=1;void 0!==o;){let e;"number"==typeof o&&(c+=o,o=n[++s]);var l=void 0;if(o instanceof br?e=o:(e=Sr,s--),e?.l){o=n[++s],l=n;var u=s;"function"==typeof o&&(o=o(),l[u]=o),l=o}for(u=c+1,"number"==typeof(o=n[++s])&&o<0&&(u-=o,o=n[++s]);c<u;c++){const n=a[c];l?r(i,c,e,l,n):t(i,c,e,n)}}return n[e]=i}function Cr(e){return Array.isArray(e)?e[0]instanceof br?e:[xr,e]:[e,void 0]}function Ur(e,t){return e instanceof $n?e.u:Array.isArray(e)?ye(e,t,!1):void 0}function Nr(e,t,r,n){const i=r.g;e[t]=n?(e,t,r)=>i(e,t,r,n):i}function Dr(e,t,r,n,i){const o=r.g;let s,a;e[t]=(e,t,r)=>o(e,t,r,a||=Or(Rr,Nr,Dr,n).W,s||=Br(n),i)}function Br(e){let t=e[Fr];if(null!=t)return t;const r=Or(Rr,Nr,Dr,e);return t=r.ma?(e,t)=>Mr(e,t,r):(e,t)=>{const n=rt(e);for(;Gn(t)&&4!=t.h;){var i=t.m,o=r[i];if(null==o){var s=r.ha;s&&(s=s[i])&&null!=(s=Gr(s))&&(o=r[i]=s)}null!=o&&o(t,e,i)||(i=(o=t).l,jn(o),o.ga?o=void 0:(s=o.g.g-i,o.g.g=i,o=Dn(o.g,s)),i=e,o&&(_t||=Symbol(),(s=i[_t])?s.push(o):i[_t]=[o]))}return 16384&n&&st(e),!0},e[Fr]=t}function Gr(e){const t=(e=Cr(e))[0].g;if(e=e[1]){const r=Br(e),n=Or(Rr,Nr,Dr,e).W;return(e,i,o)=>t(e,i,o,n,r)}return t}function jr(e,t,r){e[t]=r.h}function Vr(e,t,r,n){let i,o;const s=r.h;e[t]=(e,t,r)=>s(e,t,r,o||=Or(Lr,jr,Vr,n).W,i||=Xr(n))}function Xr(e){let t=e[Ir];if(!t){const r=Or(Lr,jr,Vr,e);t=(e,t)=>Hr(e,t,r),e[Ir]=t}return t}function Hr(e,t,r){for(var n=nt(e),i=+!!(512&n)-1,o=e.length,s=512&n?1:0,a=o+(256&n?-1:0);s<a;s++){const n=e[s];if(null==n)continue;const o=s-i,a=Wr(r,o);a&&a(t,n,o)}if(256&n){n=e[o-1];for(const e in n)i=+e,Number.isNaN(i)||null!=(o=n[i])&&(a=Wr(r,i))&&a(t,o,i)}if(e=_t?e[_t]:void 0)for(ar(t,t.g.end()),r=0;r<e.length;r++)ar(t,D(e[r])||new Uint8Array(0))}function Wr(e,t){var r=e[t];if(r)return r;if((r=e.ha)&&(r=r[t])){var n=(r=Cr(r))[0].h;if(r=r[1]){const t=Xr(r),i=Or(Lr,jr,Vr,r).W;r=e.ma?Pr(i,t):(e,r,o)=>n(e,r,o,i,t)}else r=n;return e[t]=r}}function zr(e,t){if(Array.isArray(t)){var r=nt(t);if(4&r)return t;for(var n=0,i=0;n<t.length;n++){const r=e(t[n]);null!=r&&(t[i++]=r)}return i<n&&(t.length=i),it(t,-12289&(5|r)),2&r&&Object.freeze(t),t}}function Kr(e,t,r){return new br(e,t,r)}function Yr(e,t,r){return new br(e,t,r)}function $r(e,t,r){Xe(e,rt(e),t,r)}var qr=Ar((function(e,t,r,n,i){return 2===e.h&&(e=Vn(e,ye([void 0,void 0],n,!0),i),mt(n=rt(t)),(i=je(t,n,r))instanceof ke?0!=(2&i.M)?((i=i.Y()).push(e),Xe(t,n,r,i)):i.Na(e):Array.isArray(i)?(2&nt(i)&&Xe(t,n,r,i=Je(i)),i.push(e)):Xe(t,n,r,[e]),!0)}),(function(e,t,r,n,i){if(t instanceof ke)t.forEach(((t,o)=>{fr(e,r,ye([o,t],n,!1),i)}));else if(Array.isArray(t))for(let o=0;o<t.length;o++){const s=t[o];Array.isArray(s)&&fr(e,r,ye(s,n,!1),i)}}));function Jr(e,t,r){if(t=function(e){if(null==e)return e;const t=typeof e;if("bigint"===t)return String(BigInt.asIntN(64,e));if(Yt(e)){if("string"===t)return Qt(e);if("number"===t)return Zt(e)}}(t),null!=t&&("string"==typeof t&&tr(t),null!=t))switch(cr(e,r,0),typeof t){case"number":e=e.g,Nt(t),rr(e,Ot,Ct);break;case"bigint":r=BigInt.asUintN(64,t),r=new er(Number(r&BigInt(4294967295)),Number(r>>BigInt(32))),rr(e.g,r.h,r.g);break;default:r=tr(t),rr(e.g,r.h,r.g)}}function Zr(e,t,r){null!=(t=$t(t))&&null!=t&&(cr(e,r,0),sr(e.g,t))}function Qr(e,t,r){null!=(t=zt(t))&&(cr(e,r,0),e.g.g.push(t?1:0))}function ti(e,t,r){null!=(t=ie(t))&&lr(e,r,h(t))}function ei(e,t,r,n,i){fr(e,r,Ur(t,n),i)}function ni(e,t,r){null!=(t=null==t||"string"==typeof t||C(t)||t instanceof B?t:void 0)&&lr(e,r,xn(t).buffer)}function ri(e,t,r){return(5===e.h||2===e.h)&&(t=Qe(t,rt(t),r,!1,!1),2==e.h?Wn(e,Pn,t):t.push(Pn(e.g)),!0)}var ii=Kr((function(e,t,r){if(1!==e.h)return!1;var n=e.g;e=Mn(n);const i=Mn(n);n=2*(i>>31)+1;const o=i>>>20&2047;return e=4294967296*(1048575&i)+e,$r(t,r,2047==o?e?NaN:n*(1/0):0==o?5e-324*n*e:n*Math.pow(2,o-1075)*(e+4503599627370496)),!0}),(function(e,t,r){null!=(t=Wt(t))&&(cr(e,r,1),e=e.g,(r=Pt||=new DataView(new ArrayBuffer(8))).setFloat64(0,+t,!0),Ot=r.getUint32(0,!0),Ct=r.getUint32(4,!0),or(e,Ot),or(e,Ct))}),dr()),si=Kr((function(e,t,r){return 5===e.h&&($r(t,r,Pn(e.g)),!0)}),(function(e,t,r){null!=(t=Wt(t))&&(cr(e,r,5),e=e.g,Dt(t),or(e,Ot))}),Er),oi=Yr(ri,(function(e,t,r){if(null!=(t=zr(Wt,t)))for(let s=0;s<t.length;s++){var n=e,i=r,o=t[s];null!=o&&(cr(n,i,5),n=n.g,Dt(o),or(n,Ot))}}),Er),ai=Yr(ri,(function(e,t,r){if(null!=(t=zr(Wt,t))&&t.length){cr(e,r,2),ir(e.g,4*t.length);for(let n=0;n<t.length;n++)r=e.g,Dt(t[n]),or(r,Ot)}}),Er),ci=Kr((function(e,t,r){return 0===e.h&&($r(t,r,Ln(e.g,Gt)),!0)}),Jr,vr),hi=Kr((function(e,t,r){return 0===e.h&&($r(t,r,0===(e=Ln(e.g,Gt))?void 0:e),!0)}),Jr,vr),ui=Kr((function(e,t,r){return 0===e.h&&($r(t,r,Ln(e.g,Bt)),!0)}),(function(e,t,r){if(null!=(t=ee(t))&&("string"==typeof t&&Jn(t),null!=t))switch(cr(e,r,0),typeof t){case"number":e=e.g,Nt(t),rr(e,Ot,Ct);break;case"bigint":r=BigInt.asUintN(64,t),r=new Zn(Number(r&BigInt(4294967295)),Number(r>>BigInt(32))),rr(e.g,r.h,r.g);break;default:r=Jn(t),rr(e.g,r.h,r.g)}}),dr()),li=Kr((function(e,t,r){return 0===e.h&&($r(t,r,Fn(e.g)),!0)}),Zr,yr),fi=Yr((function(e,t,r){return(0===e.h||2===e.h)&&(t=Qe(t,rt(t),r,!1,!1),2==e.h?Wn(e,Fn,t):t.push(Fn(e.g)),!0)}),(function(e,t,r){if(null!=(t=zr($t,t))&&t.length){r=hr(e,r);for(let r=0;r<t.length;r++)sr(e.g,t[r]);ur(e,r)}}),yr),di=Kr((function(e,t,r){return 0===e.h&&($r(t,r,0===(e=Fn(e.g))?void 0:e),!0)}),Zr,yr),pi=Kr((function(e,t,r){return 0===e.h&&($r(t,r,Rn(e.g)),!0)}),Qr,gr),gi=Kr((function(e,t,r){return 0===e.h&&($r(t,r,!1===(e=Rn(e.g))?void 0:e),!0)}),Qr,gr),mi=Yr((function(e,t,r){return 2===e.h&&(e=Xn(e),Qe(t,rt(t),r,!1).push(e),!0)}),(function(e,t,r){if(null!=(t=zr(ie,t)))for(let s=0;s<t.length;s++){var n=e,i=r,o=t[s];null!=o&&lr(n,i,h(o))}}),mr),yi=Kr((function(e,t,r){return 2===e.h&&($r(t,r,""===(e=Xn(e))?void 0:e),!0)}),ti,mr),_i=Kr((function(e,t,r){return 2===e.h&&($r(t,r,Xn(e)),!0)}),ti,mr),vi=function(e,t,r=pr){return new br(e,t,r)}((function(e,t,r,n,i){return 2===e.h&&(n=ye(void 0,n,!0),Qe(t,rt(t),r,!0).push(n),Vn(e,n,i),!0)}),(function(e,t,r,n,i){if(Array.isArray(t))for(let o=0;o<t.length;o++)ei(e,t[o],r,n,i)})),Ei=Ar((function(e,t,r,n,i,o){return 2===e.h&&(nn(t,nt(t),o,r),Vn(e,t=sn(t,n,r),i),!0)}),ei),wi=Kr((function(e,t,r){return 2===e.h&&($r(t,r,Hn(e)),!0)}),ni,wr),Ti=Yr((function(e,t,r){return(0===e.h||2===e.h)&&(t=Qe(t,rt(t),r,!1,!1),2==e.h?Wn(e,In,t):t.push(In(e.g)),!0)}),(function(e,t,r){if(null!=(t=zr(qt,t)))for(let s=0;s<t.length;s++){var n=e,i=r,o=t[s];null!=o&&(cr(n,i,0),ir(n.g,o))}}),_r),bi=Kr((function(e,t,r){return 0===e.h&&($r(t,r,0===(e=In(e.g))?void 0:e),!0)}),(function(e,t,r){null!=(t=qt(t))&&null!=t&&(cr(e,r,0),ir(e.g,t))}),_r),Ai=Kr((function(e,t,r){return 0===e.h&&($r(t,r,Fn(e.g)),!0)}),(function(e,t,r){null!=(t=$t(t))&&(t=parseInt(t,10),cr(e,r,0),sr(e.g,t))}),Tr);class ki{constructor(e,t){this.h=e,this.g=t,this.l=an,this.m=un,this.defaultValue=void 0}}function Si(e,t){return new ki(e,t)}function xi(e,t){return(r,n)=>{if(zn.length){const e=zn.pop();e.o(n),Cn(e.g,r,n),r=e}else r=new class{constructor(e,t){if(Bn.length){const r=Bn.pop();Cn(r,e,t),e=r}else e=new class{constructor(e,t){this.h=null,this.m=!1,this.g=this.l=this.j=0,Cn(this,e,t)}clear(){this.h=null,this.m=!1,this.g=this.l=this.j=0,this.ca=!1}}(e,t);this.g=e,this.l=this.g.g,this.h=this.m=-1,this.o(t)}o({ga:e=!1}={}){this.ga=e}}(r,n);try{const n=new e,o=n.u;Br(t)(o,r);var i=n}finally{r.g.clear(),r.m=-1,r.h=-1,zn.length<100&&zn.push(r)}return i}}function Li(e){return function(){const t=new class{constructor(){this.l=[],this.h=0,this.g=new class{constructor(){this.g=[]}length(){return this.g.length}end(){const e=this.g;return this.g=[],e}}}};Hr(this.u,t,Or(Lr,jr,Vr,e)),ar(t,t.g.end());const r=new Uint8Array(t.h),n=t.l,i=n.length;let o=0;for(let e=0;e<i;e++){const t=n[e];r.set(t,o),o+=t.length}return t.l=[r],r}}var Ri=class extends $n{constructor(e){super(e)}},Fi=[0,yi,Kr((function(e,t,r){return 2===e.h&&($r(t,r,(e=Hn(e))===N()?void 0:e),!0)}),(function(e,t,r){if(null!=t){if(t instanceof $n){const n=t.Qa;return void(n&&(t=n(t),null!=t&&lr(e,r,xn(t).buffer)))}if(Array.isArray(t))return}ni(e,t,r)}),wr)];let Ii,Mi=globalThis.trustedTypes;function Pi(e){void 0===Ii&&(Ii=function(){let e=null;if(!Mi)return e;try{const t=e=>e;e=Mi.createPolicy("goog#html",{createHTML:t,createScript:t,createScriptURL:t})}catch(e){}return e}());var t=Ii;return new class{constructor(e){this.g=e}toString(){return this.g+""}}(t?t.createScriptURL(e):e)}function Oi(e,...t){if(0===t.length)return Pi(e[0]);let r=e[0];for(let n=0;n<t.length;n++)r+=encodeURIComponent(t[n])+e[n+1];return Pi(r)}var Ci=[0,li,Ai,pi,-1,fi,Ai,-1],Ui=class extends $n{constructor(){super()}},Ni=[0,pi,_i,pi,Ai,-1,Yr((function(e,t,r){return(0===e.h||2===e.h)&&(t=Qe(t,rt(t),r,!1,!1),2==e.h?Wn(e,On,t):t.push(Fn(e.g)),!0)}),(function(e,t,r){if(null!=(t=zr($t,t))&&t.length){r=hr(e,r);for(let r=0;r<t.length;r++)sr(e.g,t[r]);ur(e,r)}}),Tr),_i,-1,[0,pi,-1],Ai,pi,-1],Di=[0,_i,-2],Bi=class extends $n{constructor(){super()}},Gi=[0],ji=[0,li,pi,1,pi,-3],Vi=class extends $n{constructor(e){super(e,2)}},Xi={};Xi[336783863]=[0,_i,pi,-1,li,[0,[1,2,3,4,5,6,7],Ei,Gi,Ei,Ni,Ei,Di,Ei,ji,Ei,Ci,Ei,[0,_i,-2],Ei,[0,_i,Ai]],[0,_i],pi,[0,[1,3],[2,4],Ei,[0,fi],-1,Ei,[0,mi],-1,vi,[0,_i,-1]],_i];var Hi=[0,hi,-1,gi,-3,hi,fi,yi,di,hi,-1,gi,di,gi,-2,yi];function Wi(e,t){Ze(e,2,re(t),"")}function zi(e,t){bn(e,3,t)}function Ki(e,t){bn(e,4,t)}var Yi=class extends $n{constructor(e){super(e,500)}o(e){return un(this,0,7,e)}},$i=[-1,{}],qi=[0,_i,1,$i],Ji=[0,_i,mi,$i];function Zi(e,t){pn(e,1,Yi,t)}function Qi(e,t){bn(e,10,t)}function ts(e,t){bn(e,15,t)}var es=class extends $n{constructor(e){super(e,500)}o(e){return un(this,0,1001,e)}},ns=[-500,vi,[-500,yi,-1,mi,-3,[-2,Xi,pi],vi,Fi,di,-1,qi,Ji,vi,[0,yi,gi],yi,Hi,di,mi,987,mi],4,vi,[-500,_i,-1,[-1,{}],998,_i],vi,[-500,_i,mi,-1,[-2,{},pi],997,mi,-1],di,vi,[-500,_i,mi,$i,998,mi],mi,di,qi,Ji,vi,[0,yi,-1,$i],mi,-2,Hi,yi,-1,gi,[0,gi,bi],978,$i,vi,Fi];es.prototype.g=Li(ns);var rs=xi(es,ns),is=class extends $n{constructor(e){super(e)}},ss=class extends $n{constructor(e){super(e)}g(){return hn(this,is,1)}},os=[0,vi,[0,li,si,_i,-1]],as=xi(ss,os),cs=class extends $n{constructor(e){super(e)}},hs=class extends $n{constructor(e){super(e)}},us=class extends $n{constructor(e){super(e)}h(){return an(this,cs,2)}g(){return hn(this,hs,5)}},ls=xi(class extends $n{constructor(e){super(e)}},[0,mi,fi,ai,[0,Ai,[0,li,-3],[0,si,-3],[0,li,-1,[0,vi,[0,li,-2]]],vi,[0,si,-1,_i,si]],_i,-1,ci,vi,[0,li,si],mi,ci]),fs=class extends $n{constructor(e){super(e)}},ds=xi(class extends $n{constructor(e){super(e)}},[0,vi,[0,si,-4]]),ps=class extends $n{constructor(e){super(e)}},gs=xi(class extends $n{constructor(e){super(e)}},[0,vi,[0,si,-4]]),ms=class extends $n{constructor(e){super(e)}},ys=[0,li,-1,ai,Ai],_s=class extends $n{constructor(){super()}};_s.prototype.g=Li([0,si,-4,ci]);var vs=class extends $n{constructor(e){super(e)}},Es=xi(class extends $n{constructor(e){super(e)}},[0,vi,[0,1,li,_i,os],ci]),ws=class extends $n{constructor(e){super(e)}},Ts=class extends $n{constructor(e){super(e)}pa(){const e=We(this);return null==e?N():e}},bs=class extends $n{constructor(e){super(e)}},As=[1,2],ks=xi(class extends $n{constructor(e){super(e)}},[0,vi,[0,As,Ei,[0,ai],Ei,[0,wi],li,_i],ci]),Ss=class extends $n{constructor(e){super(e)}},xs=[0,_i,li,si,mi,-1],Ls=class extends $n{constructor(e){super(e)}},Rs=[0,pi,-1],Fs=class extends $n{constructor(e){super(e)}},Is=[1,2,3,4,5],Ms=class extends $n{constructor(e){super(e)}g(){return null!=We(this)}h(){return null!=ie(Be(this,2))}},Ps=class extends $n{constructor(e){super(e)}g(){return zt(Be(this,2))??!1}},Os=[0,wi,_i,[0,li,ci,-1],[0,ui,ci]],Cs=[0,Os,pi,[0,Is,Ei,ji,Ei,Ni,Ei,Ci,Ei,Gi,Ei,Di],Ai],Us=class extends $n{constructor(e){super(e)}},Ns=[0,Cs,si,-1,li],Ds=Si(502141897,Us);Xi[502141897]=Ns;var Bs=xi(class extends $n{constructor(e){super(e)}},[0,[0,Ai,-1,oi,Ti],ys]),Gs=class extends $n{constructor(e){super(e)}},js=class extends $n{constructor(e){super(e)}},Vs=[0,Cs,si,[0,Cs],pi],Xs=[0,Cs,Ns,Vs,si,[0,[0,Os]]],Hs=Si(508968150,js);Xi[508968150]=Xs,Xi[508968149]=Vs;var Ws=class extends $n{constructor(e){super(e)}},zs=Si(513916220,Ws);Xi[513916220]=[0,Cs,Xs,li];var Ks=class extends $n{constructor(e){super(e)}h(){return an(this,Ss,2)}g(){Ve(this,2)}},Ys=[0,Cs,xs];Xi[478825465]=Ys;var $s=class extends $n{constructor(e){super(e)}},qs=class extends $n{constructor(e){super(e)}},Js=class extends $n{constructor(e){super(e)}},Zs=class extends $n{constructor(e){super(e)}},Qs=class extends $n{constructor(e){super(e)}},to=[0,Cs,[0,Cs],Ys,-1],eo=[0,Cs,si,li],no=[0,Cs,si],ro=[0,Cs,eo,no,si],io=Si(479097054,Qs);Xi[479097054]=[0,Cs,ro,to],Xi[463370452]=to,Xi[464864288]=eo;var so=Si(462713202,Zs);Xi[462713202]=ro,Xi[474472470]=no;var oo=class extends $n{constructor(e){super(e)}},ao=class extends $n{constructor(e){super(e)}},co=class extends $n{constructor(e){super(e)}},ho=class extends $n{constructor(){super()}},uo=[0,Cs,si,-1,li],lo=[0,Cs,si,pi];ho.prototype.g=Li([0,Cs,no,[0,Cs],Ns,Vs,uo,lo]);var fo=class extends $n{constructor(e){super(e)}},po=Si(456383383,fo);Xi[456383383]=[0,Cs,xs];var go=class extends $n{constructor(e){super(e)}},mo=Si(476348187,go);Xi[476348187]=[0,Cs,Rs];var yo=class extends $n{constructor(e){super(e)}},_o=class extends $n{constructor(e){super(e)}},vo=[0,Ai,-1],Eo=Si(458105876,class extends $n{constructor(e){super(e)}g(){var e=this.u;const t=rt(e),r=2&t;return e=function(e,t,r){var n=_o;const i=2&t;let o=!1;if(null==r){if(i)return Fe();r=[]}else if(r.constructor===ke){if(0==(2&r.M)||i)return r;r=r.Y()}else Array.isArray(r)?o=!!(2&nt(r)):r=[];if(i){if(!r.length)return Fe();o||(o=!0,st(r))}else o&&(o=!1,r=Je(r));return o||(64&nt(r)?et(r,32):32&t&&tt(r,32)),Xe(e,t,2,n=new ke(r,n,oe,void 0)),n}(e,t,je(e,t,2)),!r&&_o&&(e.sa=!0),e}});Xi[458105876]=[0,vo,qr,[!0,ci,[0,_i,-1,mi]]];var wo=class extends $n{constructor(e){super(e)}},To=Si(458105758,wo);Xi[458105758]=[0,Cs,_i,vo];var bo=class extends $n{constructor(e){super(e)}},Ao=Si(443442058,bo);Xi[443442058]=[0,Cs,_i,li,si,mi,-1],Xi[514774813]=uo;var ko=class extends $n{constructor(e){super(e)}},So=Si(516587230,ko);function xo(e,t){return t=t?t.clone():new Ss,void 0!==e.displayNamesLocale?Ve(t,1,re(e.displayNamesLocale)):void 0===e.displayNamesLocale&&Ve(t,1),void 0!==e.maxResults?En(t,2,e.maxResults):"maxResults"in e&&Ve(t,2),void 0!==e.scoreThreshold?wn(t,3,e.scoreThreshold):"scoreThreshold"in e&&Ve(t,3),void 0!==e.categoryAllowlist?Tn(t,4,e.categoryAllowlist):"categoryAllowlist"in e&&Ve(t,4),void 0!==e.categoryDenylist?Tn(t,5,e.categoryDenylist):"categoryDenylist"in e&&Ve(t,5),t}function Lo(e,t=-1,r=""){return{categories:e.map((e=>({index:gn(mn(e,1),0)??-1,score:yn(e,2)??0,categoryName:_n(e,3)??"",displayName:_n(e,4)??""}))),headIndex:t,headName:r}}function Ro(e){var t=Ke(e,3,Wt,ze()),r=Ke(e,2,$t,ze()),n=Ke(e,1,ie,ze()),i=Ke(e,9,ie,ze());const o={categories:[],keypoints:[]};for(let e=0;e<t.length;e++)o.categories.push({score:t[e],index:r[e]??-1,categoryName:n[e]??"",displayName:i[e]??""});if((t=an(e,us,4)?.h())&&(o.boundingBox={originX:mn(t,1)??0,originY:mn(t,2)??0,width:mn(t,3)??0,height:mn(t,4)??0,angle:0}),an(e,us,4)?.g().length)for(const t of an(e,us,4).g())o.keypoints.push({x:He(t,1)??0,y:He(t,2)??0,score:He(t,4)??0,label:ie(Be(t,3))??""});return o}function Fo(e){const t=[];for(const r of hn(e,ps,1))t.push({x:yn(r,1)??0,y:yn(r,2)??0,z:yn(r,3)??0,visibility:yn(r,4)??0});return t}function Io(e){const t=[];for(const r of hn(e,fs,1))t.push({x:yn(r,1)??0,y:yn(r,2)??0,z:yn(r,3)??0,visibility:yn(r,4)??0});return t}function Mo(e){return Array.from(e,(e=>e>127?e-256:e))}function Po(e,t){if(e.length!==t.length)throw Error(`Cannot compute cosine similarity between embeddings of different sizes (${e.length} vs. ${t.length}).`);let r=0,n=0,i=0;for(let o=0;o<e.length;o++)r+=e[o]*t[o],n+=e[o]*e[o],i+=t[o]*t[o];if(n<=0||i<=0)throw Error("Cannot compute cosine similarity on embedding with 0 norm.");return r/Math.sqrt(n*i)}let Oo;Xi[516587230]=[0,Cs,uo,lo,si],Xi[518928384]=lo;const Co=new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]);async function Uo(){if(void 0===Oo)try{await WebAssembly.instantiate(Co),Oo=!0}catch{Oo=!1}return Oo}async function No(e,t=Oi``){const r=await Uo()?"wasm_internal":"wasm_nosimd_internal";return{wasmLoaderPath:`${t}/${e}_${r}.js`,wasmBinaryPath:`${t}/${e}_${r}.wasm`}}var Do=class{};function Bo(){var e=navigator;return!("undefined"==typeof OffscreenCanvas||function(e=navigator){return(e=e.userAgent).includes("Safari")&&!e.includes("Chrome")}(e)&&!((e=e.userAgent.match(/Version\/([\d]+).*Safari/))&&e.length>=1&&Number(e[1])>=17))}async function Go(e){if("function"!=typeof importScripts){const t=document.createElement("script");return t.src=e.toString(),t.crossOrigin="anonymous",new Promise(((e,r)=>{t.addEventListener("load",(()=>{e()}),!1),t.addEventListener("error",(e=>{r(e)}),!1),document.body.appendChild(t)}))}importScripts(e.toString())}function jo(e){return void 0!==e.videoWidth?[e.videoWidth,e.videoHeight]:void 0!==e.naturalWidth?[e.naturalWidth,e.naturalHeight]:void 0!==e.displayWidth?[e.displayWidth,e.displayHeight]:[e.width,e.height]}function Vo(e,t,r){e.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target"),r(t=e.i.stringToNewUTF8(t)),e.i._free(t)}function Xo(e,t,r){if(!e.i.canvas)throw Error("No OpenGL canvas configured.");if(r?e.i._bindTextureToStream(r):e.i._bindTextureToCanvas(),!(r=e.i.canvas.getContext("webgl2")||e.i.canvas.getContext("webgl")))throw Error("Failed to obtain WebGL context from the provided canvas. `getContext()` should only be invoked with `webgl` or `webgl2`.");e.i.gpuOriginForWebTexturesIsBottomLeft&&r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t),e.i.gpuOriginForWebTexturesIsBottomLeft&&r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1);const[n,i]=jo(t);return!e.l||n===e.i.canvas.width&&i===e.i.canvas.height||(e.i.canvas.width=n,e.i.canvas.height=i),[n,i]}function Ho(e,t,r){e.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target");const n=new Uint32Array(t.length);for(let r=0;r<t.length;r++)n[r]=e.i.stringToNewUTF8(t[r]);t=e.i._malloc(4*n.length),e.i.HEAPU32.set(n,t>>2),r(t);for(const t of n)e.i._free(t);e.i._free(t)}function Wo(e,t,r){e.i.simpleListeners=e.i.simpleListeners||{},e.i.simpleListeners[t]=r}function zo(e,t,r){let n=[];e.i.simpleListeners=e.i.simpleListeners||{},e.i.simpleListeners[t]=(e,t,i)=>{t?(r(n,i),n=[]):n.push(e)}}async function Ko(e,t,r,n){return e=await(async(e,t,r,n,i)=>{if(t&&await Go(t),!self.ModuleFactory)throw Error("ModuleFactory not set.");if(r&&(await Go(r),!self.ModuleFactory))throw Error("ModuleFactory not set.");return self.Module&&i&&((t=self.Module).locateFile=i.locateFile,i.mainScriptUrlOrBlob&&(t.mainScriptUrlOrBlob=i.mainScriptUrlOrBlob)),i=await self.ModuleFactory(self.Module||i),self.ModuleFactory=self.Module=void 0,new e(i,n)})(e,r.wasmLoaderPath,r.assetLoaderPath,t,{locateFile:e=>e.endsWith(".wasm")?r.wasmBinaryPath.toString():r.assetBinaryPath&&e.endsWith(".data")?r.assetBinaryPath.toString():e}),await e.o(n),e}function Yo(e,t){const r=an(e.baseOptions,Ms,1)||new Ms;"string"==typeof t?(Ve(r,2,re(t)),Ve(r,1)):t instanceof Uint8Array&&(Ve(r,1,dt(t,!1)),Ve(r,2)),un(e.baseOptions,0,1,r)}function $o(e){try{const t=e.H.length;if(1===t)throw Error(e.H[0].message);if(t>1)throw Error("Encountered multiple errors: "+e.H.map((e=>e.message)).join(", "))}finally{e.H=[]}}function qo(e,t){e.B=Math.max(e.B,t)}function Jo(e,t){e.A=new Yi,Wi(e.A,"PassThroughCalculator"),zi(e.A,"free_memory"),Ki(e.A,"free_memory_unused_out"),Qi(t,"free_memory"),Zi(t,e.A)}function Zo(e,t){zi(e.A,t),Ki(e.A,t+"_unused_out")}function Qo(e){e.g.addBoolToStream(!0,"free_memory",e.B)}Do.forVisionTasks=function(e){return No("vision",e)},Do.forTextTasks=function(e){return No("text",e)},Do.forGenAiExperimentalTasks=function(e){return No("genai_experimental",e)},Do.forGenAiTasks=function(e){return No("genai",e)},Do.forAudioTasks=function(e){return No("audio",e)},Do.isSimdSupported=function(){return Uo()};var ta=class{constructor(e){this.g=e,this.H=[],this.B=0,this.g.setAutoRenderToScreen(!1)}l(e,t=!0){if(t){const t=e.baseOptions||{};if(e.baseOptions?.modelAssetBuffer&&e.baseOptions?.modelAssetPath)throw Error("Cannot set both baseOptions.modelAssetPath and baseOptions.modelAssetBuffer");if(!(an(this.baseOptions,Ms,1)?.g()||an(this.baseOptions,Ms,1)?.h()||e.baseOptions?.modelAssetBuffer||e.baseOptions?.modelAssetPath))throw Error("Either baseOptions.modelAssetPath or baseOptions.modelAssetBuffer must be set");if(function(e,t){let r=an(e.baseOptions,Fs,3);if(!r){var n=r=new Fs,i=new Bi;ln(n,4,Is,i)}"delegate"in t&&("GPU"===t.delegate?(t=r,n=new Ui,ln(t,2,Is,n)):(t=r,n=new Bi,ln(t,4,Is,n))),un(e.baseOptions,0,3,r)}(this,t),t.modelAssetPath)return fetch(t.modelAssetPath.toString()).then((e=>{if(e.ok)return e.arrayBuffer();throw Error(`Failed to fetch model: ${t.modelAssetPath} (${e.status})`)})).then((e=>{try{this.g.i.FS_unlink("/model.dat")}catch{}this.g.i.FS_createDataFile("/","model.dat",new Uint8Array(e),!0,!1,!1),Yo(this,"/model.dat"),this.m(),this.J()}));if(t.modelAssetBuffer instanceof Uint8Array)Yo(this,t.modelAssetBuffer);else if(t.modelAssetBuffer)return async function(e){const t=[];for(var r=0;;){const{done:n,value:i}=await e.read();if(n)break;t.push(i),r+=i.length}if(0===t.length)return new Uint8Array(0);if(1===t.length)return t[0];e=new Uint8Array(r),r=0;for(const n of t)e.set(n,r),r+=n.length;return e}(t.modelAssetBuffer).then((e=>{Yo(this,e),this.m(),this.J()}))}return this.m(),this.J(),Promise.resolve()}J(){}ea(){let e;if(this.g.ea((t=>{e=rs(t)})),!e)throw Error("Failed to retrieve CalculatorGraphConfig");return e}setGraph(e,t){this.g.attachErrorListener(((e,t)=>{this.H.push(Error(t))})),this.g.La(),this.g.setGraph(e,t),this.A=void 0,$o(this)}finishProcessing(){this.g.finishProcessing(),$o(this)}close(){this.A=void 0,this.g.closeGraph()}};function ea(e,t){if(!e)throw Error(`Unable to obtain required WebGL resource: ${t}`);return e}ta.prototype.close=ta.prototype.close,e("TaskRunner",ta);class na{constructor(e,t,r,n){this.g=e,this.h=t,this.m=r,this.l=n}bind(){this.g.bindVertexArray(this.h)}close(){this.g.deleteVertexArray(this.h),this.g.deleteBuffer(this.m),this.g.deleteBuffer(this.l)}}function ra(e,t,r){const n=e.g;if(r=ea(n.createShader(r),"Failed to create WebGL shader"),n.shaderSource(r,t),n.compileShader(r),!n.getShaderParameter(r,n.COMPILE_STATUS))throw Error(`Could not compile WebGL shader: ${n.getShaderInfoLog(r)}`);return n.attachShader(e.h,r),r}function ia(e,t){const r=e.g,n=ea(r.createVertexArray(),"Failed to create vertex array");r.bindVertexArray(n);const i=ea(r.createBuffer(),"Failed to create buffer");r.bindBuffer(r.ARRAY_BUFFER,i),r.enableVertexAttribArray(e.P),r.vertexAttribPointer(e.P,2,r.FLOAT,!1,0,0),r.bufferData(r.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),r.STATIC_DRAW);const o=ea(r.createBuffer(),"Failed to create buffer");return r.bindBuffer(r.ARRAY_BUFFER,o),r.enableVertexAttribArray(e.J),r.vertexAttribPointer(e.J,2,r.FLOAT,!1,0,0),r.bufferData(r.ARRAY_BUFFER,new Float32Array(t?[0,1,0,0,1,0,1,1]:[0,0,0,1,1,1,1,0]),r.STATIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,null),r.bindVertexArray(null),new na(r,n,i,o)}function sa(e,t){if(e.g){if(t!==e.g)throw Error("Cannot change GL context once initialized")}else e.g=t}function oa(e,t,r,n){return sa(e,t),e.h||(e.m(),e.C()),r?(e.s||(e.s=ia(e,!0)),r=e.s):(e.v||(e.v=ia(e,!1)),r=e.v),t.useProgram(e.h),r.bind(),e.l(),e=n(),r.g.bindVertexArray(null),e}function aa(e,t,r){return sa(e,t),e=ea(t.createTexture(),"Failed to create texture"),t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,r??t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,r??t.LINEAR),t.bindTexture(t.TEXTURE_2D,null),e}function ca(e,t,r){sa(e,t),e.A||(e.A=ea(t.createFramebuffer(),"Failed to create framebuffe.")),t.bindFramebuffer(t.FRAMEBUFFER,e.A),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0)}function ha(e){e.g?.bindFramebuffer(e.g.FRAMEBUFFER,null)}var ua=class{H(){return"\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D inputTexture;\n  void main() {\n    gl_FragColor = texture2D(inputTexture, vTex);\n  }\n "}m(){const e=this.g;if(this.h=ea(e.createProgram(),"Failed to create WebGL program"),this.ba=ra(this,"\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",e.VERTEX_SHADER),this.aa=ra(this,this.H(),e.FRAGMENT_SHADER),e.linkProgram(this.h),!e.getProgramParameter(this.h,e.LINK_STATUS))throw Error(`Error during program linking: ${e.getProgramInfoLog(this.h)}`);this.P=e.getAttribLocation(this.h,"aVertex"),this.J=e.getAttribLocation(this.h,"aTex")}C(){}l(){}close(){if(this.h){const e=this.g;e.deleteProgram(this.h),e.deleteShader(this.ba),e.deleteShader(this.aa)}this.A&&this.g.deleteFramebuffer(this.A),this.v&&this.v.close(),this.s&&this.s.close()}},la=class extends ua{H(){return"\n  precision mediump float;\n  uniform sampler2D backgroundTexture;\n  uniform sampler2D maskTexture;\n  uniform sampler2D colorMappingTexture;\n  varying vec2 vTex;\n  void main() {\n    vec4 backgroundColor = texture2D(backgroundTexture, vTex);\n    float category = texture2D(maskTexture, vTex).r;\n    vec4 categoryColor = texture2D(colorMappingTexture, vec2(category, 0.0));\n    gl_FragColor = mix(backgroundColor, categoryColor, categoryColor.a);\n  }\n "}C(){const e=this.g;e.activeTexture(e.TEXTURE1),this.B=aa(this,e,e.LINEAR),e.activeTexture(e.TEXTURE2),this.j=aa(this,e,e.NEAREST)}m(){super.m();const e=this.g;this.L=ea(e.getUniformLocation(this.h,"backgroundTexture"),"Uniform location"),this.U=ea(e.getUniformLocation(this.h,"colorMappingTexture"),"Uniform location"),this.K=ea(e.getUniformLocation(this.h,"maskTexture"),"Uniform location")}l(){super.l();const e=this.g;e.uniform1i(this.K,0),e.uniform1i(this.L,1),e.uniform1i(this.U,2)}close(){this.B&&this.g.deleteTexture(this.B),this.j&&this.g.deleteTexture(this.j),super.close()}},fa=class extends ua{H(){return"\n  precision mediump float;\n  uniform sampler2D maskTexture;\n  uniform sampler2D defaultTexture;\n  uniform sampler2D overlayTexture;\n  varying vec2 vTex;\n  void main() {\n    float confidence = texture2D(maskTexture, vTex).r;\n    vec4 defaultColor = texture2D(defaultTexture, vTex);\n    vec4 overlayColor = texture2D(overlayTexture, vTex);\n    // Apply the alpha from the overlay and merge in the default color\n    overlayColor = mix(defaultColor, overlayColor, overlayColor.a);\n    gl_FragColor = mix(defaultColor, overlayColor, confidence);\n  }\n "}C(){const e=this.g;e.activeTexture(e.TEXTURE1),this.j=aa(this,e),e.activeTexture(e.TEXTURE2),this.B=aa(this,e)}m(){super.m();const e=this.g;this.K=ea(e.getUniformLocation(this.h,"defaultTexture"),"Uniform location"),this.L=ea(e.getUniformLocation(this.h,"overlayTexture"),"Uniform location"),this.I=ea(e.getUniformLocation(this.h,"maskTexture"),"Uniform location")}l(){super.l();const e=this.g;e.uniform1i(this.I,0),e.uniform1i(this.K,1),e.uniform1i(this.L,2)}close(){this.j&&this.g.deleteTexture(this.j),this.B&&this.g.deleteTexture(this.B),super.close()}};function da(e,t){switch(t){case 0:return e.g.find((e=>e instanceof Uint8Array));case 1:return e.g.find((e=>e instanceof Float32Array));case 2:return e.g.find((e=>"undefined"!=typeof WebGLTexture&&e instanceof WebGLTexture));default:throw Error(`Type is not supported: ${t}`)}}function pa(e){var t=da(e,1);if(!t){if(t=da(e,0))t=new Float32Array(t).map((e=>e/255));else{t=new Float32Array(e.width*e.height);const n=ma(e);var r=_a(e);if(ca(r,n,ga(e)),"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"document"in self&&"ontouchend"in self.document){r=new Float32Array(e.width*e.height*4),n.readPixels(0,0,e.width,e.height,n.RGBA,n.FLOAT,r);for(let e=0,n=0;e<t.length;++e,n+=4)t[e]=r[n]}else n.readPixels(0,0,e.width,e.height,n.RED,n.FLOAT,t)}e.g.push(t)}return t}function ga(e){let t=da(e,2);if(!t){const r=ma(e);t=va(e);const n=pa(e),i=ya(e);r.texImage2D(r.TEXTURE_2D,0,i,e.width,e.height,0,r.RED,r.FLOAT,n),Ea(e)}return t}function ma(e){if(!e.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return e.h||(e.h=ea(e.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),e.h}function ya(e){if(e=ma(e),!wa)if(e.getExtension("EXT_color_buffer_float")&&e.getExtension("OES_texture_float_linear")&&e.getExtension("EXT_float_blend"))wa=e.R32F;else{if(!e.getExtension("EXT_color_buffer_half_float"))throw Error("GPU does not fully support 4-channel float32 or float16 formats");wa=e.R16F}return wa}function _a(e){return e.l||(e.l=new ua),e.l}function va(e){const t=ma(e);t.viewport(0,0,e.width,e.height),t.activeTexture(t.TEXTURE0);let r=da(e,2);return r||(r=aa(_a(e),t,e.m?t.LINEAR:t.NEAREST),e.g.push(r),e.j=!0),t.bindTexture(t.TEXTURE_2D,r),r}function Ea(e){e.h.bindTexture(e.h.TEXTURE_2D,null)}var wa,Ta=class{constructor(e,t,r,n,i,o,s){this.g=e,this.m=t,this.j=r,this.canvas=n,this.l=i,this.width=o,this.height=s,this.j&&0==--ba&&console.error("You seem to be creating MPMask instances without invoking .close(). This leaks resources.")}Ga(){return!!da(this,0)}ka(){return!!da(this,1)}R(){return!!da(this,2)}ja(){return(e=da(this,0))||(e=pa(this),e=new Uint8Array(e.map((e=>255*e))),this.g.push(e)),e;var e}ia(){return pa(this)}N(){return ga(this)}clone(){const e=[];for(const t of this.g){let r;if(t instanceof Uint8Array)r=new Uint8Array(t);else if(t instanceof Float32Array)r=new Float32Array(t);else{if(!(t instanceof WebGLTexture))throw Error(`Type is not supported: ${t}`);{const e=ma(this),t=_a(this);e.activeTexture(e.TEXTURE1),r=aa(t,e,this.m?e.LINEAR:e.NEAREST),e.bindTexture(e.TEXTURE_2D,r);const n=ya(this);e.texImage2D(e.TEXTURE_2D,0,n,this.width,this.height,0,e.RED,e.FLOAT,null),e.bindTexture(e.TEXTURE_2D,null),ca(t,e,r),oa(t,e,!1,(()=>{va(this),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.drawArrays(e.TRIANGLE_FAN,0,4),Ea(this)})),ha(t),Ea(this)}}e.push(r)}return new Ta(e,this.m,this.R(),this.canvas,this.l,this.width,this.height)}close(){this.j&&ma(this).deleteTexture(da(this,2)),ba=-1}};Ta.prototype.close=Ta.prototype.close,Ta.prototype.clone=Ta.prototype.clone,Ta.prototype.getAsWebGLTexture=Ta.prototype.N,Ta.prototype.getAsFloat32Array=Ta.prototype.ia,Ta.prototype.getAsUint8Array=Ta.prototype.ja,Ta.prototype.hasWebGLTexture=Ta.prototype.R,Ta.prototype.hasFloat32Array=Ta.prototype.ka,Ta.prototype.hasUint8Array=Ta.prototype.Ga;var ba=250;const Aa={color:"white",lineWidth:4,radius:6};function ka(e){return{...Aa,fillColor:(e=e||{}).color,...e}}function Sa(e,t){return e instanceof Function?e(t):e}function xa(e,t,r){return Math.max(Math.min(t,r),Math.min(Math.max(t,r),e))}function La(e){if(!e.l)throw Error("CPU rendering requested but CanvasRenderingContext2D not provided.");return e.l}function Ra(e){if(!e.j)throw Error("GPU rendering requested but WebGL2RenderingContext not provided.");return e.j}function Fa(e,t,r){if(t.R())r(t.N());else{const n=t.ka()?t.ia():t.ja();e.m=e.m??new ua;const i=Ra(e);r((e=new Ta([n],t.m,!1,i.canvas,e.m,t.width,t.height)).N()),e.close()}}function Ia(e,t,r,n){const i=function(e){return e.g||(e.g=new la),e.g}(e),o=Ra(e),s=Array.isArray(r)?new ImageData(new Uint8ClampedArray(r),1,1):r;oa(i,o,!0,(()=>{!function(e,t,r,n){const i=e.g;if(i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,t),i.activeTexture(i.TEXTURE1),i.bindTexture(i.TEXTURE_2D,e.B),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,r),e.I&&function(e,t){if(e!==t)return!1;e=e.entries(),t=t.entries();for(const[n,i]of e){e=n;const o=i;var r=t.next();if(r.done)return!1;const[s,a]=r.value;if(r=a,e!==s||o[0]!==r[0]||o[1]!==r[1]||o[2]!==r[2]||o[3]!==r[3])return!1}return!!t.next().done}(e.I,n))i.activeTexture(i.TEXTURE2),i.bindTexture(i.TEXTURE_2D,e.j);else{e.I=n;const t=Array(1024).fill(0);n.forEach(((e,r)=>{if(4!==e.length)throw Error(`Color at index ${r} is not a four-channel value.`);t[4*r]=e[0],t[4*r+1]=e[1],t[4*r+2]=e[2],t[4*r+3]=e[3]})),i.activeTexture(i.TEXTURE2),i.bindTexture(i.TEXTURE_2D,e.j),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,256,1,0,i.RGBA,i.UNSIGNED_BYTE,new Uint8Array(t))}}(i,t,s,n),o.clearColor(0,0,0,0),o.clear(o.COLOR_BUFFER_BIT),o.drawArrays(o.TRIANGLE_FAN,0,4);const e=i.g;e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,null)}))}function Ma(e,t,r,n){const i=Ra(e),o=function(e){return e.h||(e.h=new fa),e.h}(e),s=Array.isArray(r)?new ImageData(new Uint8ClampedArray(r),1,1):r,a=Array.isArray(n)?new ImageData(new Uint8ClampedArray(n),1,1):n;oa(o,i,!0,(()=>{var e=o.g;e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,o.j),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,s),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,o.B),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,a),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),i.drawArrays(i.TRIANGLE_FAN,0,4),i.bindTexture(i.TEXTURE_2D,null),(e=o.g).activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,null)}))}var Pa=class{constructor(e,t){e instanceof CanvasRenderingContext2D||e instanceof OffscreenCanvasRenderingContext2D?(this.l=e,this.j=t):this.j=e}za(e,t){if(e){var r=La(this);t=ka(t),r.save();var n=r.canvas,i=0;for(const o of e)r.fillStyle=Sa(t.fillColor,{index:i,from:o}),r.strokeStyle=Sa(t.color,{index:i,from:o}),r.lineWidth=Sa(t.lineWidth,{index:i,from:o}),(e=new Path2D).arc(o.x*n.width,o.y*n.height,Sa(t.radius,{index:i,from:o}),0,2*Math.PI),r.fill(e),r.stroke(e),++i;r.restore()}}ya(e,t,r){if(e&&t){var n=La(this);r=ka(r),n.save();var i=n.canvas,o=0;for(const s of t){n.beginPath(),t=e[s.start];const a=e[s.end];t&&a&&(n.strokeStyle=Sa(r.color,{index:o,from:t,to:a}),n.lineWidth=Sa(r.lineWidth,{index:o,from:t,to:a}),n.moveTo(t.x*i.width,t.y*i.height),n.lineTo(a.x*i.width,a.y*i.height)),++o,n.stroke()}n.restore()}}va(e,t){const r=La(this);t=ka(t),r.save(),r.beginPath(),r.lineWidth=Sa(t.lineWidth,{}),r.strokeStyle=Sa(t.color,{}),r.fillStyle=Sa(t.fillColor,{}),r.moveTo(e.originX,e.originY),r.lineTo(e.originX+e.width,e.originY),r.lineTo(e.originX+e.width,e.originY+e.height),r.lineTo(e.originX,e.originY+e.height),r.lineTo(e.originX,e.originY),r.stroke(),r.fill(),r.restore()}wa(e,t,r=[0,0,0,255]){this.l?function(e,t,r,n){const i=Ra(e);Fa(e,t,(t=>{Ia(e,t,r,n),(t=La(e)).drawImage(i.canvas,0,0,t.canvas.width,t.canvas.height)}))}(this,e,r,t):Ia(this,e.N(),r,t)}xa(e,t,r){this.l?function(e,t,r,n){const i=Ra(e);Fa(e,t,(t=>{Ma(e,t,r,n),(t=La(e)).drawImage(i.canvas,0,0,t.canvas.width,t.canvas.height)}))}(this,e,t,r):Ma(this,e.N(),t,r)}close(){this.g?.close(),this.g=void 0,this.h?.close(),this.h=void 0,this.m?.close(),this.m=void 0}};function Oa(e,t){switch(t){case 0:return e.g.find((e=>e instanceof ImageData));case 1:return e.g.find((e=>"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap));case 2:return e.g.find((e=>"undefined"!=typeof WebGLTexture&&e instanceof WebGLTexture));default:throw Error(`Type is not supported: ${t}`)}}function Ca(e){var t=Oa(e,0);if(!t){t=Na(e);const r=Da(e),n=new Uint8Array(e.width*e.height*4);ca(r,t,Ua(e)),t.readPixels(0,0,e.width,e.height,t.RGBA,t.UNSIGNED_BYTE,n),ha(r),t=new ImageData(new Uint8ClampedArray(n.buffer),e.width,e.height),e.g.push(t)}return t}function Ua(e){let t=Oa(e,2);if(!t){const r=Na(e);t=Ba(e);const n=Oa(e,1)||Ca(e);r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,n),Ga(e)}return t}function Na(e){if(!e.canvas)throw Error("Conversion to different image formats require that a canvas is passed when iniitializing the image.");return e.h||(e.h=ea(e.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),e.h}function Da(e){return e.l||(e.l=new ua),e.l}function Ba(e){const t=Na(e);t.viewport(0,0,e.width,e.height),t.activeTexture(t.TEXTURE0);let r=Oa(e,2);return r||(r=aa(Da(e),t),e.g.push(r),e.m=!0),t.bindTexture(t.TEXTURE_2D,r),r}function Ga(e){e.h.bindTexture(e.h.TEXTURE_2D,null)}function ja(e){const t=Na(e);return oa(Da(e),t,!0,(()=>function(e,t){const r=e.canvas;if(r.width===e.width&&r.height===e.height)return t();const n=r.width,i=r.height;return r.width=e.width,r.height=e.height,e=t(),r.width=n,r.height=i,e}(e,(()=>{if(t.bindFramebuffer(t.FRAMEBUFFER,null),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLE_FAN,0,4),!(e.canvas instanceof OffscreenCanvas))throw Error("Conversion to ImageBitmap requires that the MediaPipe Tasks is initialized with an OffscreenCanvas");return e.canvas.transferToImageBitmap()}))))}Pa.prototype.close=Pa.prototype.close,Pa.prototype.drawConfidenceMask=Pa.prototype.xa,Pa.prototype.drawCategoryMask=Pa.prototype.wa,Pa.prototype.drawBoundingBox=Pa.prototype.va,Pa.prototype.drawConnectors=Pa.prototype.ya,Pa.prototype.drawLandmarks=Pa.prototype.za,Pa.lerp=function(e,t,r,n,i){return xa(n*(1-(e-t)/(r-t))+i*(1-(r-e)/(r-t)),n,i)},Pa.clamp=xa,e("DrawingUtils",Pa);var Va=class{constructor(e,t,r,n,i,o,s){this.g=e,this.j=t,this.m=r,this.canvas=n,this.l=i,this.width=o,this.height=s,(this.j||this.m)&&0==--Xa&&console.error("You seem to be creating MPImage instances without invoking .close(). This leaks resources.")}Fa(){return!!Oa(this,0)}la(){return!!Oa(this,1)}R(){return!!Oa(this,2)}Da(){return Ca(this)}Ca(){var e=Oa(this,1);return e||(Ua(this),Ba(this),e=ja(this),Ga(this),this.g.push(e),this.j=!0),e}N(){return Ua(this)}clone(){const e=[];for(const t of this.g){let r;if(t instanceof ImageData)r=new ImageData(t.data,this.width,this.height);else if(t instanceof WebGLTexture){const e=Na(this),t=Da(this);e.activeTexture(e.TEXTURE1),r=aa(t,e),e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.width,this.height,0,e.RGBA,e.UNSIGNED_BYTE,null),e.bindTexture(e.TEXTURE_2D,null),ca(t,e,r),oa(t,e,!1,(()=>{Ba(this),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.drawArrays(e.TRIANGLE_FAN,0,4),Ga(this)})),ha(t),Ga(this)}else{if(!(t instanceof ImageBitmap))throw Error(`Type is not supported: ${t}`);Ua(this),Ba(this),r=ja(this),Ga(this)}e.push(r)}return new Va(e,this.la(),this.R(),this.canvas,this.l,this.width,this.height)}close(){this.j&&Oa(this,1).close(),this.m&&Na(this).deleteTexture(Oa(this,2)),Xa=-1}};Va.prototype.close=Va.prototype.close,Va.prototype.clone=Va.prototype.clone,Va.prototype.getAsWebGLTexture=Va.prototype.N,Va.prototype.getAsImageBitmap=Va.prototype.Ca,Va.prototype.getAsImageData=Va.prototype.Da,Va.prototype.hasWebGLTexture=Va.prototype.R,Va.prototype.hasImageBitmap=Va.prototype.la,Va.prototype.hasImageData=Va.prototype.Fa;var Xa=250;function Ha(...e){return e.map((([e,t])=>({start:e,end:t})))}const Wa=function(e){return class extends e{La(){this.i._registerModelResourcesGraphService()}}}((za=class{constructor(e,t){this.l=!0,this.i=e,this.g=null,this.h=0,this.m="function"==typeof this.i._addIntToInputStream,void 0!==t?this.i.canvas=t:Bo()?this.i.canvas=new OffscreenCanvas(1,1):(console.warn("OffscreenCanvas not supported and GraphRunner constructor glCanvas parameter is undefined. Creating backup canvas."),this.i.canvas=document.createElement("canvas"))}async initializeGraph(e){const t=await(await fetch(e)).arrayBuffer();e=!(e.endsWith(".pbtxt")||e.endsWith(".textproto")),this.setGraph(new Uint8Array(t),e)}setGraphFromString(e){this.setGraph((new TextEncoder).encode(e),!1)}setGraph(e,t){const r=e.length,n=this.i._malloc(r);this.i.HEAPU8.set(e,n),t?this.i._changeBinaryGraph(r,n):this.i._changeTextGraph(r,n),this.i._free(n)}configureAudio(e,t,r,n,i){this.i._configureAudio||console.warn('Attempting to use configureAudio without support for input audio. Is build dep ":gl_graph_runner_audio" missing?'),Vo(this,n||"input_audio",(n=>{Vo(this,i=i||"audio_header",(i=>{this.i._configureAudio(n,i,e,t??0,r)}))}))}setAutoResizeCanvas(e){this.l=e}setAutoRenderToScreen(e){this.i._setAutoRenderToScreen(e)}setGpuBufferVerticalFlip(e){this.i.gpuOriginForWebTexturesIsBottomLeft=e}ea(e){Wo(this,"__graph_config__",(t=>{e(t)})),Vo(this,"__graph_config__",(e=>{this.i._getGraphConfig(e,void 0)})),delete this.i.simpleListeners.__graph_config__}attachErrorListener(e){this.i.errorListener=e}attachEmptyPacketListener(e,t){this.i.emptyPacketListeners=this.i.emptyPacketListeners||{},this.i.emptyPacketListeners[e]=t}addAudioToStream(e,t,r){this.addAudioToStreamWithShape(e,0,0,t,r)}addAudioToStreamWithShape(e,t,r,n,i){const o=4*e.length;this.h!==o&&(this.g&&this.i._free(this.g),this.g=this.i._malloc(o),this.h=o),this.i.HEAPF32.set(e,this.g/4),Vo(this,n,(e=>{this.i._addAudioToInputStream(this.g,t,r,e,i)}))}addGpuBufferToStream(e,t,r){Vo(this,t,(t=>{const[n,i]=Xo(this,e,t);this.i._addBoundTextureToStream(t,n,i,r)}))}addBoolToStream(e,t,r){Vo(this,t,(t=>{this.i._addBoolToInputStream(e,t,r)}))}addDoubleToStream(e,t,r){Vo(this,t,(t=>{this.i._addDoubleToInputStream(e,t,r)}))}addFloatToStream(e,t,r){Vo(this,t,(t=>{this.i._addFloatToInputStream(e,t,r)}))}addIntToStream(e,t,r){Vo(this,t,(t=>{this.i._addIntToInputStream(e,t,r)}))}addUintToStream(e,t,r){Vo(this,t,(t=>{this.i._addUintToInputStream(e,t,r)}))}addStringToStream(e,t,r){Vo(this,t,(t=>{Vo(this,e,(e=>{this.i._addStringToInputStream(e,t,r)}))}))}addStringRecordToStream(e,t,r){Vo(this,t,(t=>{Ho(this,Object.keys(e),(n=>{Ho(this,Object.values(e),(i=>{this.i._addFlatHashMapToInputStream(n,i,Object.keys(e).length,t,r)}))}))}))}addProtoToStream(e,t,r,n){Vo(this,r,(r=>{Vo(this,t,(t=>{const i=this.i._malloc(e.length);this.i.HEAPU8.set(e,i),this.i._addProtoToInputStream(i,e.length,t,r,n),this.i._free(i)}))}))}addEmptyPacketToStream(e,t){Vo(this,e,(e=>{this.i._addEmptyPacketToInputStream(e,t)}))}addBoolVectorToStream(e,t,r){Vo(this,t,(t=>{const n=this.i._allocateBoolVector(e.length);if(!n)throw Error("Unable to allocate new bool vector on heap.");for(const t of e)this.i._addBoolVectorEntry(n,t);this.i._addBoolVectorToInputStream(n,t,r)}))}addDoubleVectorToStream(e,t,r){Vo(this,t,(t=>{const n=this.i._allocateDoubleVector(e.length);if(!n)throw Error("Unable to allocate new double vector on heap.");for(const t of e)this.i._addDoubleVectorEntry(n,t);this.i._addDoubleVectorToInputStream(n,t,r)}))}addFloatVectorToStream(e,t,r){Vo(this,t,(t=>{const n=this.i._allocateFloatVector(e.length);if(!n)throw Error("Unable to allocate new float vector on heap.");for(const t of e)this.i._addFloatVectorEntry(n,t);this.i._addFloatVectorToInputStream(n,t,r)}))}addIntVectorToStream(e,t,r){Vo(this,t,(t=>{const n=this.i._allocateIntVector(e.length);if(!n)throw Error("Unable to allocate new int vector on heap.");for(const t of e)this.i._addIntVectorEntry(n,t);this.i._addIntVectorToInputStream(n,t,r)}))}addUintVectorToStream(e,t,r){Vo(this,t,(t=>{const n=this.i._allocateUintVector(e.length);if(!n)throw Error("Unable to allocate new unsigned int vector on heap.");for(const t of e)this.i._addUintVectorEntry(n,t);this.i._addUintVectorToInputStream(n,t,r)}))}addStringVectorToStream(e,t,r){Vo(this,t,(t=>{const n=this.i._allocateStringVector(e.length);if(!n)throw Error("Unable to allocate new string vector on heap.");for(const t of e)Vo(this,t,(e=>{this.i._addStringVectorEntry(n,e)}));this.i._addStringVectorToInputStream(n,t,r)}))}addBoolToInputSidePacket(e,t){Vo(this,t,(t=>{this.i._addBoolToInputSidePacket(e,t)}))}addDoubleToInputSidePacket(e,t){Vo(this,t,(t=>{this.i._addDoubleToInputSidePacket(e,t)}))}addFloatToInputSidePacket(e,t){Vo(this,t,(t=>{this.i._addFloatToInputSidePacket(e,t)}))}addIntToInputSidePacket(e,t){Vo(this,t,(t=>{this.i._addIntToInputSidePacket(e,t)}))}addUintToInputSidePacket(e,t){Vo(this,t,(t=>{this.i._addUintToInputSidePacket(e,t)}))}addStringToInputSidePacket(e,t){Vo(this,t,(t=>{Vo(this,e,(e=>{this.i._addStringToInputSidePacket(e,t)}))}))}addProtoToInputSidePacket(e,t,r){Vo(this,r,(r=>{Vo(this,t,(t=>{const n=this.i._malloc(e.length);this.i.HEAPU8.set(e,n),this.i._addProtoToInputSidePacket(n,e.length,t,r),this.i._free(n)}))}))}addBoolVectorToInputSidePacket(e,t){Vo(this,t,(t=>{const r=this.i._allocateBoolVector(e.length);if(!r)throw Error("Unable to allocate new bool vector on heap.");for(const t of e)this.i._addBoolVectorEntry(r,t);this.i._addBoolVectorToInputSidePacket(r,t)}))}addDoubleVectorToInputSidePacket(e,t){Vo(this,t,(t=>{const r=this.i._allocateDoubleVector(e.length);if(!r)throw Error("Unable to allocate new double vector on heap.");for(const t of e)this.i._addDoubleVectorEntry(r,t);this.i._addDoubleVectorToInputSidePacket(r,t)}))}addFloatVectorToInputSidePacket(e,t){Vo(this,t,(t=>{const r=this.i._allocateFloatVector(e.length);if(!r)throw Error("Unable to allocate new float vector on heap.");for(const t of e)this.i._addFloatVectorEntry(r,t);this.i._addFloatVectorToInputSidePacket(r,t)}))}addIntVectorToInputSidePacket(e,t){Vo(this,t,(t=>{const r=this.i._allocateIntVector(e.length);if(!r)throw Error("Unable to allocate new int vector on heap.");for(const t of e)this.i._addIntVectorEntry(r,t);this.i._addIntVectorToInputSidePacket(r,t)}))}addUintVectorToInputSidePacket(e,t){Vo(this,t,(t=>{const r=this.i._allocateUintVector(e.length);if(!r)throw Error("Unable to allocate new unsigned int vector on heap.");for(const t of e)this.i._addUintVectorEntry(r,t);this.i._addUintVectorToInputSidePacket(r,t)}))}addStringVectorToInputSidePacket(e,t){Vo(this,t,(t=>{const r=this.i._allocateStringVector(e.length);if(!r)throw Error("Unable to allocate new string vector on heap.");for(const t of e)Vo(this,t,(e=>{this.i._addStringVectorEntry(r,e)}));this.i._addStringVectorToInputSidePacket(r,t)}))}attachBoolListener(e,t){Wo(this,e,t),Vo(this,e,(e=>{this.i._attachBoolListener(e)}))}attachBoolVectorListener(e,t){zo(this,e,t),Vo(this,e,(e=>{this.i._attachBoolVectorListener(e)}))}attachIntListener(e,t){Wo(this,e,t),Vo(this,e,(e=>{this.i._attachIntListener(e)}))}attachIntVectorListener(e,t){zo(this,e,t),Vo(this,e,(e=>{this.i._attachIntVectorListener(e)}))}attachUintListener(e,t){Wo(this,e,t),Vo(this,e,(e=>{this.i._attachUintListener(e)}))}attachUintVectorListener(e,t){zo(this,e,t),Vo(this,e,(e=>{this.i._attachUintVectorListener(e)}))}attachDoubleListener(e,t){Wo(this,e,t),Vo(this,e,(e=>{this.i._attachDoubleListener(e)}))}attachDoubleVectorListener(e,t){zo(this,e,t),Vo(this,e,(e=>{this.i._attachDoubleVectorListener(e)}))}attachFloatListener(e,t){Wo(this,e,t),Vo(this,e,(e=>{this.i._attachFloatListener(e)}))}attachFloatVectorListener(e,t){zo(this,e,t),Vo(this,e,(e=>{this.i._attachFloatVectorListener(e)}))}attachStringListener(e,t){Wo(this,e,t),Vo(this,e,(e=>{this.i._attachStringListener(e)}))}attachStringVectorListener(e,t){zo(this,e,t),Vo(this,e,(e=>{this.i._attachStringVectorListener(e)}))}attachProtoListener(e,t,r){Wo(this,e,t),Vo(this,e,(e=>{this.i._attachProtoListener(e,r||!1)}))}attachProtoVectorListener(e,t,r){zo(this,e,t),Vo(this,e,(e=>{this.i._attachProtoVectorListener(e,r||!1)}))}attachAudioListener(e,t,r){this.i._attachAudioListener||console.warn('Attempting to use attachAudioListener without support for output audio. Is build dep ":gl_graph_runner_audio_out" missing?'),Wo(this,e,((e,r)=>{e=new Float32Array(e.buffer,e.byteOffset,e.length/4),t(e,r)})),Vo(this,e,(e=>{this.i._attachAudioListener(e,r||!1)}))}finishProcessing(){this.i._waitUntilIdle()}closeGraph(){this.i._closeGraph(),this.i.simpleListeners=void 0,this.i.emptyPacketListeners=void 0}},class extends za{get fa(){return this.i}ra(e,t,r){Vo(this,t,(t=>{const[n,i]=Xo(this,e,t);this.fa._addBoundTextureAsImageToStream(t,n,i,r)}))}V(e,t){Wo(this,e,t),Vo(this,e,(e=>{this.fa._attachImageListener(e)}))}da(e,t){zo(this,e,t),Vo(this,e,(e=>{this.fa._attachImageVectorListener(e)}))}}));var za,Ka=class extends Wa{};async function Ya(e,t,r){return async function(e,t,r,n){return Ko(e,t,r,n)}(e,r.canvas??(Bo()?void 0:document.createElement("canvas")),t,r)}function $a(e,t,r,n){if(e.U){const o=new _s;if(r?.regionOfInterest){if(!e.qa)throw Error("This task doesn't support region-of-interest.");var i=r.regionOfInterest;if(i.left>=i.right||i.top>=i.bottom)throw Error("Expected RectF with left < right and top < bottom.");if(i.left<0||i.top<0||i.right>1||i.bottom>1)throw Error("Expected RectF values to be in [0,1].");wn(o,1,(i.left+i.right)/2),wn(o,2,(i.top+i.bottom)/2),wn(o,4,i.right-i.left),wn(o,3,i.bottom-i.top)}else wn(o,1,.5),wn(o,2,.5),wn(o,4,1),wn(o,3,1);if(r?.rotationDegrees){if(r?.rotationDegrees%90!=0)throw Error("Expected rotation to be a multiple of 90.");if(wn(o,5,-Math.PI*r.rotationDegrees/180),r?.rotationDegrees%180!=0){const[e,n]=jo(t);r=yn(o,3)*n/e,i=yn(o,4)*e/n,wn(o,4,r),wn(o,3,i)}}e.g.addProtoToStream(o.g(),"mediapipe.NormalizedRect",e.U,n)}e.g.ra(t,e.ba,n??performance.now()),e.finishProcessing()}function qa(e,t,r){if(e.baseOptions?.g())throw Error("Task is not initialized with image mode. 'runningMode' must be set to 'IMAGE'.");$a(e,t,r,e.B+1)}function Ja(e,t,r,n){if(!e.baseOptions?.g())throw Error("Task is not initialized with video mode. 'runningMode' must be set to 'VIDEO'.");$a(e,t,r,n)}function Za(e,t,r,n){var i=t.data;const o=t.width,s=o*(t=t.height);if((i instanceof Uint8Array||i instanceof Float32Array)&&i.length!==s)throw Error("Unsupported channel count: "+i.length/s);return e=new Ta([i],r,!1,e.g.i.canvas,e.P,o,t),n?e.clone():e}var Qa=class extends ta{constructor(e,t,r,n){super(e),this.g=e,this.ba=t,this.U=r,this.qa=n,this.P=new ua}l(e,t=!0){if("runningMode"in e&&vn(this.baseOptions,2,!!e.runningMode&&"IMAGE"!==e.runningMode),void 0!==e.canvas&&this.g.i.canvas!==e.canvas)throw Error("You must create a new task to reset the canvas.");return super.l(e,t)}close(){this.P.close(),super.close()}};Qa.prototype.close=Qa.prototype.close;var tc=class extends Qa{constructor(e,t){super(new Ka(e,t),"image_in","norm_rect_in",!1),this.j={detections:[]},un(e=this.h=new Us,0,1,t=new Ps),wn(this.h,2,.5),wn(this.h,3,.3)}get baseOptions(){return an(this.h,Ps,1)}set baseOptions(e){un(this.h,0,1,e)}o(e){return"minDetectionConfidence"in e&&wn(this.h,2,e.minDetectionConfidence??.5),"minSuppressionThreshold"in e&&wn(this.h,3,e.minSuppressionThreshold??.3),this.l(e)}D(e,t){return this.j={detections:[]},qa(this,e,t),this.j}F(e,t,r){return this.j={detections:[]},Ja(this,e,r,t),this.j}m(){var e=new es;Qi(e,"image_in"),Qi(e,"norm_rect_in"),ts(e,"detections");const t=new Vi;Yn(t,Ds,this.h);const r=new Yi;Wi(r,"mediapipe.tasks.vision.face_detector.FaceDetectorGraph"),zi(r,"IMAGE:image_in"),zi(r,"NORM_RECT:norm_rect_in"),Ki(r,"DETECTIONS:detections"),r.o(t),Zi(e,r),this.g.attachProtoVectorListener("detections",((e,t)=>{for(const t of e)e=ls(t),this.j.detections.push(Ro(e));qo(this,t)})),this.g.attachEmptyPacketListener("detections",(e=>{qo(this,e)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};tc.prototype.detectForVideo=tc.prototype.F,tc.prototype.detect=tc.prototype.D,tc.prototype.setOptions=tc.prototype.o,tc.createFromModelPath=async function(e,t){return Ya(tc,e,{baseOptions:{modelAssetPath:t}})},tc.createFromModelBuffer=function(e,t){return Ya(tc,e,{baseOptions:{modelAssetBuffer:t}})},tc.createFromOptions=function(e,t){return Ya(tc,e,t)};var ec=Ha([61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]),nc=Ha([263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]),rc=Ha([276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]),ic=Ha([474,475],[475,476],[476,477],[477,474]),sc=Ha([33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]),oc=Ha([46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]),ac=Ha([469,470],[470,471],[471,472],[472,469]),cc=Ha([10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]),hc=[...ec,...nc,...rc,...sc,...oc,...cc],uc=Ha([127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]);function lc(e){e.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]}}var fc=class extends Qa{constructor(e,t){super(new Ka(e,t),"image_in","norm_rect",!1),this.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]},this.outputFacialTransformationMatrixes=this.outputFaceBlendshapes=!1,un(e=this.h=new js,0,1,t=new Ps),this.v=new Gs,un(this.h,0,3,this.v),this.s=new Us,un(this.h,0,2,this.s),En(this.s,4,1),wn(this.s,2,.5),wn(this.v,2,.5),wn(this.h,4,.5)}get baseOptions(){return an(this.h,Ps,1)}set baseOptions(e){un(this.h,0,1,e)}o(e){return"numFaces"in e&&En(this.s,4,e.numFaces??1),"minFaceDetectionConfidence"in e&&wn(this.s,2,e.minFaceDetectionConfidence??.5),"minTrackingConfidence"in e&&wn(this.h,4,e.minTrackingConfidence??.5),"minFacePresenceConfidence"in e&&wn(this.v,2,e.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"outputFacialTransformationMatrixes"in e&&(this.outputFacialTransformationMatrixes=!!e.outputFacialTransformationMatrixes),this.l(e)}D(e,t){return lc(this),qa(this,e,t),this.j}F(e,t,r){return lc(this),Ja(this,e,r,t),this.j}m(){var e=new es;Qi(e,"image_in"),Qi(e,"norm_rect"),ts(e,"face_landmarks");const t=new Vi;Yn(t,Hs,this.h);const r=new Yi;Wi(r,"mediapipe.tasks.vision.face_landmarker.FaceLandmarkerGraph"),zi(r,"IMAGE:image_in"),zi(r,"NORM_RECT:norm_rect"),Ki(r,"NORM_LANDMARKS:face_landmarks"),r.o(t),Zi(e,r),this.g.attachProtoVectorListener("face_landmarks",((e,t)=>{for(const t of e)e=gs(t),this.j.faceLandmarks.push(Fo(e));qo(this,t)})),this.g.attachEmptyPacketListener("face_landmarks",(e=>{qo(this,e)})),this.outputFaceBlendshapes&&(ts(e,"blendshapes"),Ki(r,"BLENDSHAPES:blendshapes"),this.g.attachProtoVectorListener("blendshapes",((e,t)=>{if(this.outputFaceBlendshapes)for(const t of e)e=as(t),this.j.faceBlendshapes.push(Lo(e.g()??[]));qo(this,t)})),this.g.attachEmptyPacketListener("blendshapes",(e=>{qo(this,e)}))),this.outputFacialTransformationMatrixes&&(ts(e,"face_geometry"),Ki(r,"FACE_GEOMETRY:face_geometry"),this.g.attachProtoVectorListener("face_geometry",((e,t)=>{if(this.outputFacialTransformationMatrixes)for(const t of e)(e=an(Bs(t),ms,2))&&this.j.facialTransformationMatrixes.push({rows:gn(mn(e,1),0)??0,columns:gn(mn(e,2),0)??0,data:Ke(e,3,Wt,ze()).slice()??[]});qo(this,t)})),this.g.attachEmptyPacketListener("face_geometry",(e=>{qo(this,e)}))),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};fc.prototype.detectForVideo=fc.prototype.F,fc.prototype.detect=fc.prototype.D,fc.prototype.setOptions=fc.prototype.o,fc.createFromModelPath=function(e,t){return Ya(fc,e,{baseOptions:{modelAssetPath:t}})},fc.createFromModelBuffer=function(e,t){return Ya(fc,e,{baseOptions:{modelAssetBuffer:t}})},fc.createFromOptions=function(e,t){return Ya(fc,e,t)},fc.FACE_LANDMARKS_LIPS=ec,fc.FACE_LANDMARKS_LEFT_EYE=nc,fc.FACE_LANDMARKS_LEFT_EYEBROW=rc,fc.FACE_LANDMARKS_LEFT_IRIS=ic,fc.FACE_LANDMARKS_RIGHT_EYE=sc,fc.FACE_LANDMARKS_RIGHT_EYEBROW=oc,fc.FACE_LANDMARKS_RIGHT_IRIS=ac,fc.FACE_LANDMARKS_FACE_OVAL=cc,fc.FACE_LANDMARKS_CONTOURS=hc,fc.FACE_LANDMARKS_TESSELATION=uc;var dc=class extends Qa{constructor(e,t){super(new Ka(e,t),"image_in","norm_rect",!0),un(e=this.j=new Ws,0,1,t=new Ps)}get baseOptions(){return an(this.j,Ps,1)}set baseOptions(e){un(this.j,0,1,e)}o(e){return super.l(e)}Oa(e,t,r){const n="function"!=typeof t?t:{};if(this.h="function"==typeof t?t:r,qa(this,e,n??{}),!this.h)return this.s}m(){var e=new es;Qi(e,"image_in"),Qi(e,"norm_rect"),ts(e,"stylized_image");const t=new Vi;Yn(t,zs,this.j);const r=new Yi;Wi(r,"mediapipe.tasks.vision.face_stylizer.FaceStylizerGraph"),zi(r,"IMAGE:image_in"),zi(r,"NORM_RECT:norm_rect"),Ki(r,"STYLIZED_IMAGE:stylized_image"),r.o(t),Zi(e,r),this.g.V("stylized_image",((e,t)=>{var r=!this.h,n=e.data,i=e.width;const o=i*(e=e.height);if(n instanceof Uint8Array)if(n.length===3*o){const t=new Uint8ClampedArray(4*o);for(let e=0;e<o;++e)t[4*e]=n[3*e],t[4*e+1]=n[3*e+1],t[4*e+2]=n[3*e+2],t[4*e+3]=255;n=new ImageData(t,i,e)}else{if(n.length!==4*o)throw Error("Unsupported channel count: "+n.length/o);n=new ImageData(new Uint8ClampedArray(n.buffer,n.byteOffset,n.length),i,e)}else if(!(n instanceof WebGLTexture))throw Error(`Unsupported format: ${n.constructor.name}`);i=new Va([n],!1,!1,this.g.i.canvas,this.P,i,e),this.s=r=r?i.clone():i,this.h&&this.h(r),qo(this,t)})),this.g.attachEmptyPacketListener("stylized_image",(e=>{this.s=null,this.h&&this.h(null),qo(this,e)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};dc.prototype.stylize=dc.prototype.Oa,dc.prototype.setOptions=dc.prototype.o,dc.createFromModelPath=function(e,t){return Ya(dc,e,{baseOptions:{modelAssetPath:t}})},dc.createFromModelBuffer=function(e,t){return Ya(dc,e,{baseOptions:{modelAssetBuffer:t}})},dc.createFromOptions=function(e,t){return Ya(dc,e,t)};var pc=Ha([0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]);function gc(e){e.gestures=[],e.landmarks=[],e.worldLandmarks=[],e.handedness=[]}function mc(e){return 0===e.gestures.length?{gestures:[],landmarks:[],worldLandmarks:[],handedness:[],handednesses:[]}:{gestures:e.gestures,landmarks:e.landmarks,worldLandmarks:e.worldLandmarks,handedness:e.handedness,handednesses:e.handedness}}function yc(e,t=!0){const r=[];for(const i of e){var n=as(i);e=[];for(const r of n.g())n=t&&null!=mn(r,1)?gn(mn(r,1),0):-1,e.push({score:yn(r,2)??0,index:n,categoryName:_n(r,3)??"",displayName:_n(r,4)??""});r.push(e)}return r}var _c=class extends Qa{constructor(e,t){super(new Ka(e,t),"image_in","norm_rect",!1),this.gestures=[],this.landmarks=[],this.worldLandmarks=[],this.handedness=[],un(e=this.j=new Qs,0,1,t=new Ps),this.s=new Zs,un(this.j,0,2,this.s),this.C=new Js,un(this.s,0,3,this.C),this.v=new qs,un(this.s,0,2,this.v),this.h=new $s,un(this.j,0,3,this.h),wn(this.v,2,.5),wn(this.s,4,.5),wn(this.C,2,.5)}get baseOptions(){return an(this.j,Ps,1)}set baseOptions(e){un(this.j,0,1,e)}o(e){if(En(this.v,3,e.numHands??1),"minHandDetectionConfidence"in e&&wn(this.v,2,e.minHandDetectionConfidence??.5),"minTrackingConfidence"in e&&wn(this.s,4,e.minTrackingConfidence??.5),"minHandPresenceConfidence"in e&&wn(this.C,2,e.minHandPresenceConfidence??.5),e.cannedGesturesClassifierOptions){var t=new Ks,r=t,n=xo(e.cannedGesturesClassifierOptions,an(this.h,Ks,3)?.h());un(r,0,2,n),un(this.h,0,3,t)}else void 0===e.cannedGesturesClassifierOptions&&an(this.h,Ks,3)?.g();return e.customGesturesClassifierOptions?(un(r=t=new Ks,0,2,n=xo(e.customGesturesClassifierOptions,an(this.h,Ks,4)?.h())),un(this.h,0,4,t)):void 0===e.customGesturesClassifierOptions&&an(this.h,Ks,4)?.g(),this.l(e)}Ja(e,t){return gc(this),qa(this,e,t),mc(this)}Ka(e,t,r){return gc(this),Ja(this,e,r,t),mc(this)}m(){var e=new es;Qi(e,"image_in"),Qi(e,"norm_rect"),ts(e,"hand_gestures"),ts(e,"hand_landmarks"),ts(e,"world_hand_landmarks"),ts(e,"handedness");const t=new Vi;Yn(t,io,this.j);const r=new Yi;Wi(r,"mediapipe.tasks.vision.gesture_recognizer.GestureRecognizerGraph"),zi(r,"IMAGE:image_in"),zi(r,"NORM_RECT:norm_rect"),Ki(r,"HAND_GESTURES:hand_gestures"),Ki(r,"LANDMARKS:hand_landmarks"),Ki(r,"WORLD_LANDMARKS:world_hand_landmarks"),Ki(r,"HANDEDNESS:handedness"),r.o(t),Zi(e,r),this.g.attachProtoVectorListener("hand_landmarks",((e,t)=>{for(const t of e){e=gs(t);const r=[];for(const t of hn(e,ps,1))r.push({x:yn(t,1)??0,y:yn(t,2)??0,z:yn(t,3)??0,visibility:yn(t,4)??0});this.landmarks.push(r)}qo(this,t)})),this.g.attachEmptyPacketListener("hand_landmarks",(e=>{qo(this,e)})),this.g.attachProtoVectorListener("world_hand_landmarks",((e,t)=>{for(const t of e){e=ds(t);const r=[];for(const t of hn(e,fs,1))r.push({x:yn(t,1)??0,y:yn(t,2)??0,z:yn(t,3)??0,visibility:yn(t,4)??0});this.worldLandmarks.push(r)}qo(this,t)})),this.g.attachEmptyPacketListener("world_hand_landmarks",(e=>{qo(this,e)})),this.g.attachProtoVectorListener("hand_gestures",((e,t)=>{this.gestures.push(...yc(e,!1)),qo(this,t)})),this.g.attachEmptyPacketListener("hand_gestures",(e=>{qo(this,e)})),this.g.attachProtoVectorListener("handedness",((e,t)=>{this.handedness.push(...yc(e)),qo(this,t)})),this.g.attachEmptyPacketListener("handedness",(e=>{qo(this,e)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};function vc(e){return{landmarks:e.landmarks,worldLandmarks:e.worldLandmarks,handednesses:e.handedness,handedness:e.handedness}}_c.prototype.recognizeForVideo=_c.prototype.Ka,_c.prototype.recognize=_c.prototype.Ja,_c.prototype.setOptions=_c.prototype.o,_c.createFromModelPath=function(e,t){return Ya(_c,e,{baseOptions:{modelAssetPath:t}})},_c.createFromModelBuffer=function(e,t){return Ya(_c,e,{baseOptions:{modelAssetBuffer:t}})},_c.createFromOptions=function(e,t){return Ya(_c,e,t)},_c.HAND_CONNECTIONS=pc;var Ec=class extends Qa{constructor(e,t){super(new Ka(e,t),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.handedness=[],un(e=this.h=new Zs,0,1,t=new Ps),this.s=new Js,un(this.h,0,3,this.s),this.j=new qs,un(this.h,0,2,this.j),En(this.j,3,1),wn(this.j,2,.5),wn(this.s,2,.5),wn(this.h,4,.5)}get baseOptions(){return an(this.h,Ps,1)}set baseOptions(e){un(this.h,0,1,e)}o(e){return"numHands"in e&&En(this.j,3,e.numHands??1),"minHandDetectionConfidence"in e&&wn(this.j,2,e.minHandDetectionConfidence??.5),"minTrackingConfidence"in e&&wn(this.h,4,e.minTrackingConfidence??.5),"minHandPresenceConfidence"in e&&wn(this.s,2,e.minHandPresenceConfidence??.5),this.l(e)}D(e,t){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],qa(this,e,t),vc(this)}F(e,t,r){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Ja(this,e,r,t),vc(this)}m(){var e=new es;Qi(e,"image_in"),Qi(e,"norm_rect"),ts(e,"hand_landmarks"),ts(e,"world_hand_landmarks"),ts(e,"handedness");const t=new Vi;Yn(t,so,this.h);const r=new Yi;Wi(r,"mediapipe.tasks.vision.hand_landmarker.HandLandmarkerGraph"),zi(r,"IMAGE:image_in"),zi(r,"NORM_RECT:norm_rect"),Ki(r,"LANDMARKS:hand_landmarks"),Ki(r,"WORLD_LANDMARKS:world_hand_landmarks"),Ki(r,"HANDEDNESS:handedness"),r.o(t),Zi(e,r),this.g.attachProtoVectorListener("hand_landmarks",((e,t)=>{for(const t of e)e=gs(t),this.landmarks.push(Fo(e));qo(this,t)})),this.g.attachEmptyPacketListener("hand_landmarks",(e=>{qo(this,e)})),this.g.attachProtoVectorListener("world_hand_landmarks",((e,t)=>{for(const t of e)e=ds(t),this.worldLandmarks.push(Io(e));qo(this,t)})),this.g.attachEmptyPacketListener("world_hand_landmarks",(e=>{qo(this,e)})),this.g.attachProtoVectorListener("handedness",((e,t)=>{var r=this.handedness,n=r.push;const i=[];for(const t of e){e=as(t);const r=[];for(const t of e.g())r.push({score:yn(t,2)??0,index:gn(mn(t,1),0)??-1,categoryName:_n(t,3)??"",displayName:_n(t,4)??""});i.push(r)}n.call(r,...i),qo(this,t)})),this.g.attachEmptyPacketListener("handedness",(e=>{qo(this,e)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Ec.prototype.detectForVideo=Ec.prototype.F,Ec.prototype.detect=Ec.prototype.D,Ec.prototype.setOptions=Ec.prototype.o,Ec.createFromModelPath=function(e,t){return Ya(Ec,e,{baseOptions:{modelAssetPath:t}})},Ec.createFromModelBuffer=function(e,t){return Ya(Ec,e,{baseOptions:{modelAssetBuffer:t}})},Ec.createFromOptions=function(e,t){return Ya(Ec,e,t)},Ec.HAND_CONNECTIONS=pc;var wc=Ha([0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]);function Tc(e){e.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]}}function bc(e){try{if(!e.C)return e.h;e.C(e.h)}finally{Qo(e)}}function Ac(e,t){e=gs(e),t.push(Fo(e))}var kc=class extends Qa{constructor(e,t){super(new Ka(e,t),"input_frames_image",null,!1),this.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]},this.outputPoseSegmentationMasks=this.outputFaceBlendshapes=!1,un(e=this.j=new ho,0,1,t=new Ps),this.K=new Js,un(this.j,0,2,this.K),this.aa=new oo,un(this.j,0,3,this.aa),this.s=new Us,un(this.j,0,4,this.s),this.I=new Gs,un(this.j,0,5,this.I),this.v=new ao,un(this.j,0,6,this.v),this.L=new co,un(this.j,0,7,this.L),wn(this.s,2,.5),wn(this.s,3,.3),wn(this.I,2,.5),wn(this.v,2,.5),wn(this.v,3,.3),wn(this.L,2,.5),wn(this.K,2,.5)}get baseOptions(){return an(this.j,Ps,1)}set baseOptions(e){un(this.j,0,1,e)}o(e){return"minFaceDetectionConfidence"in e&&wn(this.s,2,e.minFaceDetectionConfidence??.5),"minFaceSuppressionThreshold"in e&&wn(this.s,3,e.minFaceSuppressionThreshold??.3),"minFacePresenceConfidence"in e&&wn(this.I,2,e.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"minPoseDetectionConfidence"in e&&wn(this.v,2,e.minPoseDetectionConfidence??.5),"minPoseSuppressionThreshold"in e&&wn(this.v,3,e.minPoseSuppressionThreshold??.3),"minPosePresenceConfidence"in e&&wn(this.L,2,e.minPosePresenceConfidence??.5),"outputPoseSegmentationMasks"in e&&(this.outputPoseSegmentationMasks=!!e.outputPoseSegmentationMasks),"minHandLandmarksConfidence"in e&&wn(this.K,2,e.minHandLandmarksConfidence??.5),this.l(e)}D(e,t,r){const n="function"!=typeof t?t:{};return this.C="function"==typeof t?t:r,Tc(this),qa(this,e,n),bc(this)}F(e,t,r,n){const i="function"!=typeof r?r:{};return this.C="function"==typeof r?r:n,Tc(this),Ja(this,e,i,t),bc(this)}m(){var e=new es;Qi(e,"input_frames_image"),ts(e,"pose_landmarks"),ts(e,"pose_world_landmarks"),ts(e,"face_landmarks"),ts(e,"left_hand_landmarks"),ts(e,"left_hand_world_landmarks"),ts(e,"right_hand_landmarks"),ts(e,"right_hand_world_landmarks");const t=new Vi,r=new Ri;Ze(r,1,re("type.googleapis.com/mediapipe.tasks.vision.holistic_landmarker.proto.HolisticLandmarkerGraphOptions"),""),function(e,t){if(null!=t)if(Array.isArray(t))Ve(e,2,Me(t,Oe,void 0,void 0,!1));else{if(!("string"==typeof t||t instanceof B||C(t)))throw Error("invalid value in Any.value field: "+t+" expected a ByteString, a base64 encoded string, a Uint8Array or a jspb array");Ze(e,2,dt(t,!1),N())}}(r,this.j.g());const n=new Yi;Wi(n,"mediapipe.tasks.vision.holistic_landmarker.HolisticLandmarkerGraph"),pn(n,8,Ri,r),zi(n,"IMAGE:input_frames_image"),Ki(n,"POSE_LANDMARKS:pose_landmarks"),Ki(n,"POSE_WORLD_LANDMARKS:pose_world_landmarks"),Ki(n,"FACE_LANDMARKS:face_landmarks"),Ki(n,"LEFT_HAND_LANDMARKS:left_hand_landmarks"),Ki(n,"LEFT_HAND_WORLD_LANDMARKS:left_hand_world_landmarks"),Ki(n,"RIGHT_HAND_LANDMARKS:right_hand_landmarks"),Ki(n,"RIGHT_HAND_WORLD_LANDMARKS:right_hand_world_landmarks"),n.o(t),Zi(e,n),Jo(this,e),this.g.attachProtoListener("pose_landmarks",((e,t)=>{Ac(e,this.h.poseLandmarks),qo(this,t)})),this.g.attachEmptyPacketListener("pose_landmarks",(e=>{qo(this,e)})),this.g.attachProtoListener("pose_world_landmarks",((e,t)=>{var r=this.h.poseWorldLandmarks;e=ds(e),r.push(Io(e)),qo(this,t)})),this.g.attachEmptyPacketListener("pose_world_landmarks",(e=>{qo(this,e)})),this.outputPoseSegmentationMasks&&(Ki(n,"POSE_SEGMENTATION_MASK:pose_segmentation_mask"),Zo(this,"pose_segmentation_mask"),this.g.V("pose_segmentation_mask",((e,t)=>{this.h.poseSegmentationMasks=[Za(this,e,!0,!this.C)],qo(this,t)})),this.g.attachEmptyPacketListener("pose_segmentation_mask",(e=>{this.h.poseSegmentationMasks=[],qo(this,e)}))),this.g.attachProtoListener("face_landmarks",((e,t)=>{Ac(e,this.h.faceLandmarks),qo(this,t)})),this.g.attachEmptyPacketListener("face_landmarks",(e=>{qo(this,e)})),this.outputFaceBlendshapes&&(ts(e,"extra_blendshapes"),Ki(n,"FACE_BLENDSHAPES:extra_blendshapes"),this.g.attachProtoListener("extra_blendshapes",((e,t)=>{var r=this.h.faceBlendshapes;this.outputFaceBlendshapes&&(e=as(e),r.push(Lo(e.g()??[]))),qo(this,t)})),this.g.attachEmptyPacketListener("extra_blendshapes",(e=>{qo(this,e)}))),this.g.attachProtoListener("left_hand_landmarks",((e,t)=>{Ac(e,this.h.leftHandLandmarks),qo(this,t)})),this.g.attachEmptyPacketListener("left_hand_landmarks",(e=>{qo(this,e)})),this.g.attachProtoListener("left_hand_world_landmarks",((e,t)=>{var r=this.h.leftHandWorldLandmarks;e=ds(e),r.push(Io(e)),qo(this,t)})),this.g.attachEmptyPacketListener("left_hand_world_landmarks",(e=>{qo(this,e)})),this.g.attachProtoListener("right_hand_landmarks",((e,t)=>{Ac(e,this.h.rightHandLandmarks),qo(this,t)})),this.g.attachEmptyPacketListener("right_hand_landmarks",(e=>{qo(this,e)})),this.g.attachProtoListener("right_hand_world_landmarks",((e,t)=>{var r=this.h.rightHandWorldLandmarks;e=ds(e),r.push(Io(e)),qo(this,t)})),this.g.attachEmptyPacketListener("right_hand_world_landmarks",(e=>{qo(this,e)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};kc.prototype.detectForVideo=kc.prototype.F,kc.prototype.detect=kc.prototype.D,kc.prototype.setOptions=kc.prototype.o,kc.createFromModelPath=function(e,t){return Ya(kc,e,{baseOptions:{modelAssetPath:t}})},kc.createFromModelBuffer=function(e,t){return Ya(kc,e,{baseOptions:{modelAssetBuffer:t}})},kc.createFromOptions=function(e,t){return Ya(kc,e,t)},kc.HAND_CONNECTIONS=pc,kc.POSE_CONNECTIONS=wc,kc.FACE_LANDMARKS_LIPS=ec,kc.FACE_LANDMARKS_LEFT_EYE=nc,kc.FACE_LANDMARKS_LEFT_EYEBROW=rc,kc.FACE_LANDMARKS_LEFT_IRIS=ic,kc.FACE_LANDMARKS_RIGHT_EYE=sc,kc.FACE_LANDMARKS_RIGHT_EYEBROW=oc,kc.FACE_LANDMARKS_RIGHT_IRIS=ac,kc.FACE_LANDMARKS_FACE_OVAL=cc,kc.FACE_LANDMARKS_CONTOURS=hc,kc.FACE_LANDMARKS_TESSELATION=uc;var Sc=class extends Qa{constructor(e,t){super(new Ka(e,t),"input_image","norm_rect",!0),this.j={classifications:[]},un(e=this.h=new fo,0,1,t=new Ps)}get baseOptions(){return an(this.h,Ps,1)}set baseOptions(e){un(this.h,0,1,e)}o(e){return un(this.h,0,2,xo(e,an(this.h,Ss,2))),this.l(e)}ta(e,t){return this.j={classifications:[]},qa(this,e,t),this.j}ua(e,t,r){return this.j={classifications:[]},Ja(this,e,r,t),this.j}m(){var e=new es;Qi(e,"input_image"),Qi(e,"norm_rect"),ts(e,"classifications");const t=new Vi;Yn(t,po,this.h);const r=new Yi;Wi(r,"mediapipe.tasks.vision.image_classifier.ImageClassifierGraph"),zi(r,"IMAGE:input_image"),zi(r,"NORM_RECT:norm_rect"),Ki(r,"CLASSIFICATIONS:classifications"),r.o(t),Zi(e,r),this.g.attachProtoListener("classifications",((e,t)=>{this.j=function(e){const t={classifications:hn(e,vs,1).map((e=>Lo(an(e,ss,4)?.g()??[],gn(mn(e,2),0),_n(e,3))))};return null!=te(Be(e,2))&&(t.timestampMs=gn(te(Be(e,2)),0)),t}(Es(e)),qo(this,t)})),this.g.attachEmptyPacketListener("classifications",(e=>{qo(this,e)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Sc.prototype.classifyForVideo=Sc.prototype.ua,Sc.prototype.classify=Sc.prototype.ta,Sc.prototype.setOptions=Sc.prototype.o,Sc.createFromModelPath=function(e,t){return Ya(Sc,e,{baseOptions:{modelAssetPath:t}})},Sc.createFromModelBuffer=function(e,t){return Ya(Sc,e,{baseOptions:{modelAssetBuffer:t}})},Sc.createFromOptions=function(e,t){return Ya(Sc,e,t)};var xc=class extends Qa{constructor(e,t){super(new Ka(e,t),"image_in","norm_rect",!0),this.h=new go,this.embeddings={embeddings:[]},un(e=this.h,0,1,t=new Ps)}get baseOptions(){return an(this.h,Ps,1)}set baseOptions(e){un(this.h,0,1,e)}o(e){var t=this.h,r=an(this.h,Ls,2);return r=r?r.clone():new Ls,void 0!==e.l2Normalize?vn(r,1,e.l2Normalize):"l2Normalize"in e&&Ve(r,1),void 0!==e.quantize?vn(r,2,e.quantize):"quantize"in e&&Ve(r,2),un(t,0,2,r),this.l(e)}Aa(e,t){return qa(this,e,t),this.embeddings}Ba(e,t,r){return Ja(this,e,r,t),this.embeddings}m(){var e=new es;Qi(e,"image_in"),Qi(e,"norm_rect"),ts(e,"embeddings_out");const t=new Vi;Yn(t,mo,this.h);const r=new Yi;Wi(r,"mediapipe.tasks.vision.image_embedder.ImageEmbedderGraph"),zi(r,"IMAGE:image_in"),zi(r,"NORM_RECT:norm_rect"),Ki(r,"EMBEDDINGS:embeddings_out"),r.o(t),Zi(e,r),this.g.attachProtoListener("embeddings_out",((e,t)=>{e=ks(e),this.embeddings=function(e){return{embeddings:hn(e,bs,1).map((e=>{const t={headIndex:gn(mn(e,3),0)??-1,headName:_n(e,4)??""};if(void 0!==on(e,ws,tn(e,1)))e=Ke(e=an(e,ws,tn(e,1)),1,Wt,ze()),t.floatEmbedding=e.slice();else{const r=new Uint8Array(0);t.quantizedEmbedding=an(e,Ts,tn(e,2))?.pa()?.h()??r}return t})),timestampMs:gn(te(Be(e,2)),0)}}(e),qo(this,t)})),this.g.attachEmptyPacketListener("embeddings_out",(e=>{qo(this,e)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};xc.cosineSimilarity=function(e,t){if(e.floatEmbedding&&t.floatEmbedding)e=Po(e.floatEmbedding,t.floatEmbedding);else{if(!e.quantizedEmbedding||!t.quantizedEmbedding)throw Error("Cannot compute cosine similarity between quantized and float embeddings.");e=Po(Mo(e.quantizedEmbedding),Mo(t.quantizedEmbedding))}return e},xc.prototype.embedForVideo=xc.prototype.Ba,xc.prototype.embed=xc.prototype.Aa,xc.prototype.setOptions=xc.prototype.o,xc.createFromModelPath=function(e,t){return Ya(xc,e,{baseOptions:{modelAssetPath:t}})},xc.createFromModelBuffer=function(e,t){return Ya(xc,e,{baseOptions:{modelAssetBuffer:t}})},xc.createFromOptions=function(e,t){return Ya(xc,e,t)};var Lc=class{constructor(e,t,r){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=r}close(){this.confidenceMasks?.forEach((e=>{e.close()})),this.categoryMask?.close()}};function Rc(e){e.categoryMask=void 0,e.confidenceMasks=void 0,e.qualityScores=void 0}function Fc(e){try{const t=new Lc(e.confidenceMasks,e.categoryMask,e.qualityScores);if(!e.j)return t;e.j(t)}finally{Qo(e)}}Lc.prototype.close=Lc.prototype.close;var Ic=class extends Qa{constructor(e,t){super(new Ka(e,t),"image_in","norm_rect",!1),this.s=[],this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new wo,this.v=new yo,un(this.h,0,3,this.v),un(e=this.h,0,1,t=new Ps)}get baseOptions(){return an(this.h,Ps,1)}set baseOptions(e){un(this.h,0,1,e)}o(e){return void 0!==e.displayNamesLocale?Ve(this.h,2,re(e.displayNamesLocale)):"displayNamesLocale"in e&&Ve(this.h,2),"outputCategoryMask"in e&&(this.outputCategoryMask=e.outputCategoryMask??!1),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=e.outputConfidenceMasks??!0),super.l(e)}J(){!function(e){const t=hn(e.ea(),Yi,1).filter((e=>_n(e,1).includes("mediapipe.tasks.TensorsToSegmentationCalculator")));if(e.s=[],t.length>1)throw Error("The graph has more than one mediapipe.tasks.TensorsToSegmentationCalculator.");1===t.length&&(an(t[0],Vi,7)?.l()?.g()??new Map).forEach(((t,r)=>{e.s[Number(r)]=_n(t,1)}))}(this)}segment(e,t,r){const n="function"!=typeof t?t:{};return this.j="function"==typeof t?t:r,Rc(this),qa(this,e,n),Fc(this)}Ma(e,t,r,n){const i="function"!=typeof r?r:{};return this.j="function"==typeof r?r:n,Rc(this),Ja(this,e,i,t),Fc(this)}Ea(){return this.s}m(){var e=new es;Qi(e,"image_in"),Qi(e,"norm_rect");const t=new Vi;Yn(t,To,this.h);const r=new Yi;Wi(r,"mediapipe.tasks.vision.image_segmenter.ImageSegmenterGraph"),zi(r,"IMAGE:image_in"),zi(r,"NORM_RECT:norm_rect"),r.o(t),Zi(e,r),Jo(this,e),this.outputConfidenceMasks&&(ts(e,"confidence_masks"),Ki(r,"CONFIDENCE_MASKS:confidence_masks"),Zo(this,"confidence_masks"),this.g.da("confidence_masks",((e,t)=>{this.confidenceMasks=e.map((e=>Za(this,e,!0,!this.j))),qo(this,t)})),this.g.attachEmptyPacketListener("confidence_masks",(e=>{this.confidenceMasks=[],qo(this,e)}))),this.outputCategoryMask&&(ts(e,"category_mask"),Ki(r,"CATEGORY_MASK:category_mask"),Zo(this,"category_mask"),this.g.V("category_mask",((e,t)=>{this.categoryMask=Za(this,e,!1,!this.j),qo(this,t)})),this.g.attachEmptyPacketListener("category_mask",(e=>{this.categoryMask=void 0,qo(this,e)}))),ts(e,"quality_scores"),Ki(r,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",((e,t)=>{this.qualityScores=e,qo(this,t)})),this.g.attachEmptyPacketListener("quality_scores",(e=>{this.categoryMask=void 0,qo(this,e)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Ic.prototype.getLabels=Ic.prototype.Ea,Ic.prototype.segmentForVideo=Ic.prototype.Ma,Ic.prototype.segment=Ic.prototype.segment,Ic.prototype.setOptions=Ic.prototype.o,Ic.createFromModelPath=function(e,t){return Ya(Ic,e,{baseOptions:{modelAssetPath:t}})},Ic.createFromModelBuffer=function(e,t){return Ya(Ic,e,{baseOptions:{modelAssetBuffer:t}})},Ic.createFromOptions=function(e,t){return Ya(Ic,e,t)};var Mc=class{constructor(e,t,r){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=r}close(){this.confidenceMasks?.forEach((e=>{e.close()})),this.categoryMask?.close()}};Mc.prototype.close=Mc.prototype.close;var Pc=class extends $n{constructor(e){super(e)}},Oc=[0,li,-2],Cc=[0,ii,-3,pi,ii,-1],Uc=[0,Cc],Nc=[0,Cc,li,-1],Dc=class extends $n{constructor(e){super(e)}},Bc=[0,ii,-1,pi],Gc=class extends $n{constructor(){super()}},jc=class extends $n{constructor(e){super(e)}},Vc=[1,2,3,4,5,6,7,8,9,10,14,15],Xc=class extends $n{constructor(){super()}};Xc.prototype.g=Li([0,vi,[0,Vc,Ei,Cc,Ei,[0,Cc,Oc],Ei,Uc,Ei,[0,Uc,Oc],Ei,Bc,Ei,[0,ii,-3,pi,Ai],Ei,[0,ii,-3,pi],Ei,[0,_i,ii,-2,pi,li,pi,-1,2,ii,Oc],Ei,Nc,Ei,[0,Nc,Oc],ii,Oc,_i,Ei,[0,ii,-3,pi,Oc,-1],Ei,[0,vi,Bc]],_i,[0,_i,li,-1,pi]]);var Hc=class extends Qa{constructor(e,t){super(new Ka(e,t),"image_in","norm_rect_in",!1),this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new wo,this.s=new yo,un(this.h,0,3,this.s),un(e=this.h,0,1,t=new Ps)}get baseOptions(){return an(this.h,Ps,1)}set baseOptions(e){un(this.h,0,1,e)}o(e){return"outputCategoryMask"in e&&(this.outputCategoryMask=e.outputCategoryMask??!1),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=e.outputConfidenceMasks??!0),super.l(e)}segment(e,t,r,n){const i="function"!=typeof r?r:{};this.j="function"==typeof r?r:n,this.qualityScores=this.categoryMask=this.confidenceMasks=void 0,r=this.B+1,n=new Xc;const o=new jc;var s=new Pc;if(En(s,1,255),un(o,0,12,s),t.keypoint&&t.scribble)throw Error("Cannot provide both keypoint and scribble.");if(t.keypoint){var a=new Dc;vn(a,3,!0),wn(a,1,t.keypoint.x),wn(a,2,t.keypoint.y),ln(o,5,Vc,a)}else{if(!t.scribble)throw Error("Must provide either a keypoint or a scribble.");for(a of(s=new Gc,t.scribble))vn(t=new Dc,3,!0),wn(t,1,a.x),wn(t,2,a.y),pn(s,1,Dc,t);ln(o,15,Vc,s)}pn(n,1,jc,o),this.g.addProtoToStream(n.g(),"drishti.RenderData","roi_in",r),qa(this,e,i);e:{try{const e=new Mc(this.confidenceMasks,this.categoryMask,this.qualityScores);if(!this.j){var c=e;break e}this.j(e)}finally{Qo(this)}c=void 0}return c}m(){var e=new es;Qi(e,"image_in"),Qi(e,"roi_in"),Qi(e,"norm_rect_in");const t=new Vi;Yn(t,To,this.h);const r=new Yi;Wi(r,"mediapipe.tasks.vision.interactive_segmenter.InteractiveSegmenterGraph"),zi(r,"IMAGE:image_in"),zi(r,"ROI:roi_in"),zi(r,"NORM_RECT:norm_rect_in"),r.o(t),Zi(e,r),Jo(this,e),this.outputConfidenceMasks&&(ts(e,"confidence_masks"),Ki(r,"CONFIDENCE_MASKS:confidence_masks"),Zo(this,"confidence_masks"),this.g.da("confidence_masks",((e,t)=>{this.confidenceMasks=e.map((e=>Za(this,e,!0,!this.j))),qo(this,t)})),this.g.attachEmptyPacketListener("confidence_masks",(e=>{this.confidenceMasks=[],qo(this,e)}))),this.outputCategoryMask&&(ts(e,"category_mask"),Ki(r,"CATEGORY_MASK:category_mask"),Zo(this,"category_mask"),this.g.V("category_mask",((e,t)=>{this.categoryMask=Za(this,e,!1,!this.j),qo(this,t)})),this.g.attachEmptyPacketListener("category_mask",(e=>{this.categoryMask=void 0,qo(this,e)}))),ts(e,"quality_scores"),Ki(r,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",((e,t)=>{this.qualityScores=e,qo(this,t)})),this.g.attachEmptyPacketListener("quality_scores",(e=>{this.categoryMask=void 0,qo(this,e)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Hc.prototype.segment=Hc.prototype.segment,Hc.prototype.setOptions=Hc.prototype.o,Hc.createFromModelPath=function(e,t){return Ya(Hc,e,{baseOptions:{modelAssetPath:t}})},Hc.createFromModelBuffer=function(e,t){return Ya(Hc,e,{baseOptions:{modelAssetBuffer:t}})},Hc.createFromOptions=function(e,t){return Ya(Hc,e,t)};var Wc=class extends Qa{constructor(e,t){super(new Ka(e,t),"input_frame_gpu","norm_rect",!1),this.j={detections:[]},un(e=this.h=new bo,0,1,t=new Ps)}get baseOptions(){return an(this.h,Ps,1)}set baseOptions(e){un(this.h,0,1,e)}o(e){return void 0!==e.displayNamesLocale?Ve(this.h,2,re(e.displayNamesLocale)):"displayNamesLocale"in e&&Ve(this.h,2),void 0!==e.maxResults?En(this.h,3,e.maxResults):"maxResults"in e&&Ve(this.h,3),void 0!==e.scoreThreshold?wn(this.h,4,e.scoreThreshold):"scoreThreshold"in e&&Ve(this.h,4),void 0!==e.categoryAllowlist?Tn(this.h,5,e.categoryAllowlist):"categoryAllowlist"in e&&Ve(this.h,5),void 0!==e.categoryDenylist?Tn(this.h,6,e.categoryDenylist):"categoryDenylist"in e&&Ve(this.h,6),this.l(e)}D(e,t){return this.j={detections:[]},qa(this,e,t),this.j}F(e,t,r){return this.j={detections:[]},Ja(this,e,r,t),this.j}m(){var e=new es;Qi(e,"input_frame_gpu"),Qi(e,"norm_rect"),ts(e,"detections");const t=new Vi;Yn(t,Ao,this.h);const r=new Yi;Wi(r,"mediapipe.tasks.vision.ObjectDetectorGraph"),zi(r,"IMAGE:input_frame_gpu"),zi(r,"NORM_RECT:norm_rect"),Ki(r,"DETECTIONS:detections"),r.o(t),Zi(e,r),this.g.attachProtoVectorListener("detections",((e,t)=>{for(const t of e)e=ls(t),this.j.detections.push(Ro(e));qo(this,t)})),this.g.attachEmptyPacketListener("detections",(e=>{qo(this,e)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Wc.prototype.detectForVideo=Wc.prototype.F,Wc.prototype.detect=Wc.prototype.D,Wc.prototype.setOptions=Wc.prototype.o,Wc.createFromModelPath=async function(e,t){return Ya(Wc,e,{baseOptions:{modelAssetPath:t}})},Wc.createFromModelBuffer=function(e,t){return Ya(Wc,e,{baseOptions:{modelAssetBuffer:t}})},Wc.createFromOptions=function(e,t){return Ya(Wc,e,t)};var zc=class{constructor(e,t,r){this.landmarks=e,this.worldLandmarks=t,this.segmentationMasks=r}close(){this.segmentationMasks?.forEach((e=>{e.close()}))}};function Kc(e){e.landmarks=[],e.worldLandmarks=[],e.segmentationMasks=void 0}function Yc(e){try{const t=new zc(e.landmarks,e.worldLandmarks,e.segmentationMasks);if(!e.s)return t;e.s(t)}finally{Qo(e)}}zc.prototype.close=zc.prototype.close;var $c=class extends Qa{constructor(e,t){super(new Ka(e,t),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.outputSegmentationMasks=!1,un(e=this.h=new ko,0,1,t=new Ps),this.v=new co,un(this.h,0,3,this.v),this.j=new ao,un(this.h,0,2,this.j),En(this.j,4,1),wn(this.j,2,.5),wn(this.v,2,.5),wn(this.h,4,.5)}get baseOptions(){return an(this.h,Ps,1)}set baseOptions(e){un(this.h,0,1,e)}o(e){return"numPoses"in e&&En(this.j,4,e.numPoses??1),"minPoseDetectionConfidence"in e&&wn(this.j,2,e.minPoseDetectionConfidence??.5),"minTrackingConfidence"in e&&wn(this.h,4,e.minTrackingConfidence??.5),"minPosePresenceConfidence"in e&&wn(this.v,2,e.minPosePresenceConfidence??.5),"outputSegmentationMasks"in e&&(this.outputSegmentationMasks=e.outputSegmentationMasks??!1),this.l(e)}D(e,t,r){const n="function"!=typeof t?t:{};return this.s="function"==typeof t?t:r,Kc(this),qa(this,e,n),Yc(this)}F(e,t,r,n){const i="function"!=typeof r?r:{};return this.s="function"==typeof r?r:n,Kc(this),Ja(this,e,i,t),Yc(this)}m(){var e=new es;Qi(e,"image_in"),Qi(e,"norm_rect"),ts(e,"normalized_landmarks"),ts(e,"world_landmarks"),ts(e,"segmentation_masks");const t=new Vi;Yn(t,So,this.h);const r=new Yi;Wi(r,"mediapipe.tasks.vision.pose_landmarker.PoseLandmarkerGraph"),zi(r,"IMAGE:image_in"),zi(r,"NORM_RECT:norm_rect"),Ki(r,"NORM_LANDMARKS:normalized_landmarks"),Ki(r,"WORLD_LANDMARKS:world_landmarks"),r.o(t),Zi(e,r),Jo(this,e),this.g.attachProtoVectorListener("normalized_landmarks",((e,t)=>{this.landmarks=[];for(const t of e)e=gs(t),this.landmarks.push(Fo(e));qo(this,t)})),this.g.attachEmptyPacketListener("normalized_landmarks",(e=>{this.landmarks=[],qo(this,e)})),this.g.attachProtoVectorListener("world_landmarks",((e,t)=>{this.worldLandmarks=[];for(const t of e)e=ds(t),this.worldLandmarks.push(Io(e));qo(this,t)})),this.g.attachEmptyPacketListener("world_landmarks",(e=>{this.worldLandmarks=[],qo(this,e)})),this.outputSegmentationMasks&&(Ki(r,"SEGMENTATION_MASK:segmentation_masks"),Zo(this,"segmentation_masks"),this.g.da("segmentation_masks",((e,t)=>{this.segmentationMasks=e.map((e=>Za(this,e,!0,!this.s))),qo(this,t)})),this.g.attachEmptyPacketListener("segmentation_masks",(e=>{this.segmentationMasks=[],qo(this,e)}))),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};$c.prototype.detectForVideo=$c.prototype.F,$c.prototype.detect=$c.prototype.D,$c.prototype.setOptions=$c.prototype.o,$c.createFromModelPath=function(e,t){return Ya($c,e,{baseOptions:{modelAssetPath:t}})},$c.createFromModelBuffer=function(e,t){return Ya($c,e,{baseOptions:{modelAssetBuffer:t}})},$c.createFromOptions=function(e,t){return Ya($c,e,t)},$c.POSE_CONNECTIONS=wc;var uaParser$2={exports:{}},uaParser=uaParser$2.exports;!function(e,t){!function(r,n){var i="function",o="undefined",s="object",a="string",c="major",l="model",u="name",d="type",h="vendor",f="version",p="architecture",m="console",v="mobile",g="tablet",_="smarttv",y="wearable",b="embedded",w="Amazon",k="Apple",S="ASUS",E="BlackBerry",C="Browser",T="Chrome",P="Firefox",A="Google",x="Huawei",B="LG",I="Microsoft",R="Motorola",O="Opera",M="Samsung",L="Sharp",D="Sony",N="Xiaomi",F="Zebra",$="Facebook",U="Chromium OS",j="Mac OS",q=function(e){for(var t={},r=0;r<e.length;r++)t[e[r].toUpperCase()]=e[r];return t},G=function(e,t){return _typeof(e)===a&&-1!==V(t).indexOf(V(e))},V=function(e){return e.toLowerCase()},z=function(e,t){if(_typeof(e)===a)return e=e.replace(/^\s\s*/,""),_typeof(t)===o?e:e.substring(0,500)},H=function(e,t){for(var r,o,a,c,l,u,d=0;d<t.length&&!l;){var h=t[d],f=t[d+1];for(r=o=0;r<h.length&&!l&&h[r];)if(l=h[r++].exec(e))for(a=0;a<f.length;a++)u=l[++o],_typeof(c=f[a])===s&&c.length>0?2===c.length?_typeof(c[1])==i?this[c[0]]=c[1].call(this,u):this[c[0]]=c[1]:3===c.length?_typeof(c[1])!==i||c[1].exec&&c[1].test?this[c[0]]=u?u.replace(c[1],c[2]):n:this[c[0]]=u?c[1].call(this,u,c[2]):n:4===c.length&&(this[c[0]]=u?c[3].call(this,u.replace(c[1],c[2])):n):this[c]=u||n;d+=2}},W=function(e,t){for(var r in t)if(_typeof(t[r])===s&&t[r].length>0){for(var i=0;i<t[r].length;i++)if(G(t[r][i],e))return"?"===r?n:r}else if(G(t[r],e))return"?"===r?n:r;return e},K={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Z={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[f,[u,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[f,[u,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[u,f],[/opios[\/ ]+([\w\.]+)/i],[f,[u,O+" Mini"]],[/\bopr\/([\w\.]+)/i],[f,[u,O]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[f,[u,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[u,f],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[f,[u,"UC"+C]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[f,[u,"WeChat"]],[/konqueror\/([\w\.]+)/i],[f,[u,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[f,[u,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[f,[u,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[f,[u,"Smart Lenovo "+C]],[/(avast|avg)\/([\w\.]+)/i],[[u,/(.+)/,"$1 Secure "+C],f],[/\bfocus\/([\w\.]+)/i],[f,[u,P+" Focus"]],[/\bopt\/([\w\.]+)/i],[f,[u,O+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[f,[u,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[f,[u,"Dolphin"]],[/coast\/([\w\.]+)/i],[f,[u,O+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[f,[u,"MIUI "+C]],[/fxios\/([-\w\.]+)/i],[f,[u,P]],[/\bqihu|(qi?ho?o?|360)browser/i],[[u,"360 "+C]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[u,/(.+)/,"$1 "+C],f],[/samsungbrowser\/([\w\.]+)/i],[f,[u,M+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[u,/_/g," "],f],[/metasr[\/ ]?([\d\.]+)/i],[f,[u,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[u,"Sogou Mobile"],f],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[u,f],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[u],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[u,$],f],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[u,f],[/\bgsa\/([\w\.]+) .*safari\//i],[f,[u,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[f,[u,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[f,[u,T+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[u,T+" WebView"],f],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[f,[u,"Android "+C]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[u,f],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[f,[u,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[f,u],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[u,[f,W,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[u,f],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[u,"Netscape"],f],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[f,[u,P+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[u,f],[/(cobalt)\/([\w\.]+)/i],[u,[f,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[p,"amd64"]],[/(ia32(?=;))/i],[[p,V]],[/((?:i[346]|x)86)[;\)]/i],[[p,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[p,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[p,"armhf"]],[/windows (ce|mobile); ppc;/i],[[p,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[p,/ower/,"",V]],[/(sun4\w)[;\)]/i],[[p,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[p,V]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[l,[h,M],[d,g]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[l,[h,M],[d,v]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[l,[h,k],[d,v]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[l,[h,k],[d,g]],[/(macintosh);/i],[l,[h,k]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[l,[h,L],[d,v]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[l,[h,x],[d,g]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[l,[h,x],[d,v]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[l,/_/g," "],[h,N],[d,v]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[l,/_/g," "],[h,N],[d,g]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[l,[h,"OPPO"],[d,v]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[l,[h,"Vivo"],[d,v]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[l,[h,"Realme"],[d,v]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[l,[h,R],[d,v]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[l,[h,R],[d,g]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[l,[h,B],[d,g]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[l,[h,B],[d,v]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[l,[h,"Lenovo"],[d,g]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[l,/_/g," "],[h,"Nokia"],[d,v]],[/(pixel c)\b/i],[l,[h,A],[d,g]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[l,[h,A],[d,v]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[l,[h,D],[d,v]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[l,"Xperia Tablet"],[h,D],[d,g]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[l,[h,"OnePlus"],[d,v]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[l,[h,w],[d,g]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[l,/(.+)/g,"Fire Phone $1"],[h,w],[d,v]],[/(playbook);[-\w\),; ]+(rim)/i],[l,h,[d,g]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[l,[h,E],[d,v]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[l,[h,S],[d,g]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[l,[h,S],[d,v]],[/(nexus 9)/i],[l,[h,"HTC"],[d,g]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[h,[l,/_/g," "],[d,v]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[l,[h,"Acer"],[d,g]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[l,[h,"Meizu"],[d,v]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[l,[h,"Ulefone"],[d,v]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[h,l,[d,v]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[h,l,[d,g]],[/(surface duo)/i],[l,[h,I],[d,g]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[l,[h,"Fairphone"],[d,v]],[/(u304aa)/i],[l,[h,"AT&T"],[d,v]],[/\bsie-(\w*)/i],[l,[h,"Siemens"],[d,v]],[/\b(rct\w+) b/i],[l,[h,"RCA"],[d,g]],[/\b(venue[\d ]{2,7}) b/i],[l,[h,"Dell"],[d,g]],[/\b(q(?:mv|ta)\w+) b/i],[l,[h,"Verizon"],[d,g]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[l,[h,"Barnes & Noble"],[d,g]],[/\b(tm\d{3}\w+) b/i],[l,[h,"NuVision"],[d,g]],[/\b(k88) b/i],[l,[h,"ZTE"],[d,g]],[/\b(nx\d{3}j) b/i],[l,[h,"ZTE"],[d,v]],[/\b(gen\d{3}) b.+49h/i],[l,[h,"Swiss"],[d,v]],[/\b(zur\d{3}) b/i],[l,[h,"Swiss"],[d,g]],[/\b((zeki)?tb.*\b) b/i],[l,[h,"Zeki"],[d,g]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[h,"Dragon Touch"],l,[d,g]],[/\b(ns-?\w{0,9}) b/i],[l,[h,"Insignia"],[d,g]],[/\b((nxa|next)-?\w{0,9}) b/i],[l,[h,"NextBook"],[d,g]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[h,"Voice"],l,[d,v]],[/\b(lvtel\-)?(v1[12]) b/i],[[h,"LvTel"],l,[d,v]],[/\b(ph-1) /i],[l,[h,"Essential"],[d,v]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[l,[h,"Envizen"],[d,g]],[/\b(trio[-\w\. ]+) b/i],[l,[h,"MachSpeed"],[d,g]],[/\btu_(1491) b/i],[l,[h,"Rotor"],[d,g]],[/(shield[\w ]+) b/i],[l,[h,"Nvidia"],[d,g]],[/(sprint) (\w+)/i],[h,l,[d,v]],[/(kin\.[onetw]{3})/i],[[l,/\./g," "],[h,I],[d,v]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[l,[h,F],[d,g]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[l,[h,F],[d,v]],[/smart-tv.+(samsung)/i],[h,[d,_]],[/hbbtv.+maple;(\d+)/i],[[l,/^/,"SmartTV"],[h,M],[d,_]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[h,B],[d,_]],[/(apple) ?tv/i],[h,[l,k+" TV"],[d,_]],[/crkey/i],[[l,T+"cast"],[h,A],[d,_]],[/droid.+aft(\w+)( bui|\))/i],[l,[h,w],[d,_]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[l,[h,L],[d,_]],[/(bravia[\w ]+)( bui|\))/i],[l,[h,D],[d,_]],[/(mitv-\w{5}) bui/i],[l,[h,N],[d,_]],[/Hbbtv.*(technisat) (.*);/i],[h,l,[d,_]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[h,z],[l,z],[d,_]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[d,_]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[h,l,[d,m]],[/droid.+; (shield) bui/i],[l,[h,"Nvidia"],[d,m]],[/(playstation [345portablevi]+)/i],[l,[h,D],[d,m]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[l,[h,I],[d,m]],[/((pebble))app/i],[h,l,[d,y]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[l,[h,k],[d,y]],[/droid.+; (glass) \d/i],[l,[h,A],[d,y]],[/droid.+; (wt63?0{2,3})\)/i],[l,[h,F],[d,y]],[/(quest( 2| pro)?)/i],[l,[h,$],[d,y]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[h,[d,b]],[/(aeobc)\b/i],[l,[h,w],[d,b]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[l,[d,v]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[l,[d,g]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[d,g]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[d,v]],[/(android[-\w\. ]{0,9});.+buil/i],[l,[h,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[f,[u,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[f,[u,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[u,f],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[f,u]],os:[[/microsoft (windows) (vista|xp)/i],[u,f],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[u,[f,W,K]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[f,W,K],[u,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[f,/_/g,"."],[u,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[u,j],[f,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[f,u],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[u,f],[/\(bb(10);/i],[f,[u,E]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[f,[u,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[f,[u,P+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[f,[u,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[f,[u,"watchOS"]],[/crkey\/([\d\.]+)/i],[f,[u,T+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[u,U],f],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[u,f],[/(sunos) ?([\w\.\d]*)/i],[[u,"Solaris"],f],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[u,f]]},Y=function e(t,m){if(_typeof(t)===s&&(m=t,t=n),!(this instanceof e))return new e(t,m).getResult();var _=_typeof(r)!==o&&r.navigator?r.navigator:n,y=t||(_&&_.userAgent?_.userAgent:""),b=_&&_.userAgentData?_.userAgentData:n,w=m?function(e,t){var r={};for(var n in e)t[n]&&t[n].length%2==0?r[n]=t[n].concat(e[n]):r[n]=e[n];return r}(Z,m):Z,k=_&&_.userAgent==y;return this.getBrowser=function(){var e={};return e[u]=n,e[f]=n,H.call(e,y,w.browser),e[c]=function(e){return _typeof(e)===a?e.replace(/[^\d\.]/g,"").split(".")[0]:n}(e[f]),k&&_&&_.brave&&_typeof(_.brave.isBrave)==i&&(e[u]="Brave"),e},this.getCPU=function(){var e={};return e[p]=n,H.call(e,y,w.cpu),e},this.getDevice=function(){var e={};return e[h]=n,e[l]=n,e[d]=n,H.call(e,y,w.device),k&&!e[d]&&b&&b.mobile&&(e[d]=v),k&&"Macintosh"==e[l]&&_&&_typeof(_.standalone)!==o&&_.maxTouchPoints&&_.maxTouchPoints>2&&(e[l]="iPad",e[d]=g),e},this.getEngine=function(){var e={};return e[u]=n,e[f]=n,H.call(e,y,w.engine),e},this.getOS=function(){var e={};return e[u]=n,e[f]=n,H.call(e,y,w.os),k&&!e[u]&&b&&"Unknown"!=b.platform&&(e[u]=b.platform.replace(/chrome os/i,U).replace(/macos/i,j)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return y},this.setUA=function(e){return y=_typeof(e)===a&&e.length>500?z(e,500):e,this},this.setUA(y),this};Y.VERSION="1.0.37",Y.BROWSER=q([u,f,c]),Y.CPU=q([p]),Y.DEVICE=q([l,h,d,m,v,_,g,y,b]),Y.ENGINE=Y.OS=q([u,f]),e.exports&&(t=e.exports=Y),t.UAParser=Y;var X=_typeof(r)!==o&&(r.jQuery||r.Zepto);if(X&&!X.ua){var Q=new Y;X.ua=Q.getResult(),X.ua.get=function(){return Q.getUA()},X.ua.set=function(e){Q.setUA(e);var t=Q.getResult();for(var r in t)X.ua[r]=t[r]}}}("object"===("undefined"==typeof window?"undefined":_typeof(window))?window:commonjsGlobal)}(uaParser$2,uaParser$2.exports);var uaParserExports=uaParser$2.exports,uaParser$1=getDefaultExportFromCjs(uaParserExports),customFetch=function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function r(){var i,o,s,a;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n[0],o=n[1],void 0===i||!Boolean(null==i?void 0:i.includes(t))){r.next=9;break}return(s=Object.assign({},o)).headers=void 0!==(null==s?void 0:s.headers)?null==s?void 0:s.headers:{},s.headers.SdkVersion=void 0,r.next=7,e(i,s);case 7:return a=r.sent,r.abrupt("return",a);case 9:case"end":return r.stop()}}),r)})))},fetchProductList=function(e){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[{id:"democarton_1",name:"Democarton"},{id:"prod2",name:"Product 2"},{id:"prod3",name:"Product 3"}]);case 1:case"end":return e.stop()}}),e)})))},login=function(e,t,r,n){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function i(){var o;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,fetch("".concat(e,"/auth/login"),{method:"POST",headers:{accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({api_key:t})});case 3:if(o=i.sent,!(200===o.status)){i.next=9;break}return i.next=8,o.json();case 8:return i.abrupt("return",i.sent);case 9:throw new Error("loginFailed | status: ".concat(o.status));case 12:throw i.prev=12,i.t0=i.catch(0),null==n||n.error("Error during login",{apiUrl:e,error:i.t0}),i.t0;case 16:case"end":return i.stop()}}),i,null,[[0,12]])})))},startSession=function(e,t,r){var n=t.product_config_id,i=t.access_token,o=t.geo_location,s=t.metadata;return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function t(){var a,c,l;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=new uaParserExports.UAParser,c=a.getResult(),t.next=5,fetch("".concat(e,"/verify/start-session"),{method:"POST",headers:{Authorization:"Bearer ".concat(i),accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({product_config_id:n,geo_location:o,session_metadata:Object.assign(Object.assign({},s),{sdkVersion:void 0,device_details:c})})});case 5:if(l=t.sent,!(200===l.status)){t.next=11;break}return t.next=10,l.json();case 10:return t.abrupt("return",t.sent);case 11:throw new Error("startSessionFailed | status: ".concat(l.status));case 14:throw t.prev=14,t.t0=t.catch(0),null==r||r.error("Error starting session",{apiUrl:e,productConfigId:n,error:t.t0}),t.t0;case 18:case"end":return t.stop()}}),t,null,[[0,14]])})))},fetchExperience=function(e,t,r){var n=arguments.length>4?arguments[4]:void 0;return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function i(){var o,s;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,fetch("".concat(e,"/fetch-experience?qr_short_url=").concat(t),{headers:{Authorization:"Bearer ".concat(r),accept:"application/json","Content-Type":"application/json"}});case 3:if(o=i.sent,!(200===o.status)){i.next=11;break}return i.next=8,o.json();case 8:case 18:return i.abrupt("return",i.sent);case 11:return i.next=13,fetch("".concat(e,"/fetch-experience?product_scan_id=").concat(t),{headers:{Authorization:"Bearer ".concat(r),accept:"application/json","Content-Type":"application/json"}});case 13:if(s=i.sent,!(200===s.status)){i.next=19;break}return i.next=18,s.json();case 19:throw new Error("fetchExperienceFailed | status: ".concat(s.status));case 20:i.next=26;break;case 22:throw i.prev=22,i.t0=i.catch(0),null==n||n.error("Error fetching experience",{apiUrl:e,scanId:t,error:i.t0}),i.t0;case 26:case"end":return i.stop()}}),i,null,[[0,22]])})))},uploadImage=function(e,t,r,n,i){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function o(){var s,a,c;return _regeneratorRuntime().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,fetch("".concat(e,"/verify/upload-image?session_id=").concat(t),{method:"POST",body:r,headers:{Authorization:"Bearer ".concat(n)}});case 3:if(!(s=o.sent).ok){o.next=13;break}return o.next=7,s.json();case 7:if(a=o.sent,!(202===s.status&&"OK"===a.msg&&void 0!==a.task_id)){o.next=11;break}return o.abrupt("return",{status:"uploaded",taskId:a.task_id});case 11:o.next=20;break;case 13:if(400!==s.status){o.next=20;break}return o.next=16,s.json();case 16:if(c=o.sent,!("Session completed and result already generated. Check result."===c.msg)){o.next=20;break}return o.abrupt("return",{status:"completed"});case 20:return o.abrupt("return",{status:"failed"});case 23:return o.prev=23,o.t0=o.catch(0),null==i||i.error("Error uploading image",{apiUrl:e,sessionId:t,error:o.t0}),o.abrupt("return",{status:"failed"});case 27:case"end":return o.stop()}}),o,null,[[0,23]])})))},verifyProduct=function(e,t,r,n){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function i(){var o,s;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,fetch("".concat(e,"/verify/session-result?session_id=").concat(t),{headers:{Authorization:"Bearer ".concat(r),accept:"application/json","Content-Type":"application/json"}});case 3:if(!(o=i.sent).ok){i.next=9;break}return i.next=7,o.json();case 7:return s=i.sent,i.abrupt("return",s);case 9:throw new Error("verificationFailed | status: ".concat(o.status));case 12:throw i.prev=12,i.t0=i.catch(0),null==n||n.error("Error during product verification",{apiUrl:e,sessionId:t,error:i.t0}),i.t0;case 16:case"end":return i.stop()}}),i,null,[[0,12]])})))},abortSession=function(e,t,r,n){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function i(){var o,s;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(["NONE_IMGS_CLICKED","NONE_IMGS_UPLOADED","PARTIAL_IMGS_UPLOADED","BROWSER_TAB_CLOSED","MOBILE_APP_MOVED_BACKGROUND","BACKEND_API_FAILURE","FRONTEND_GLOBAL_TIMEOUT"].includes(n)){i.next=3;break}throw new Error("Invalid session abort reason.");case 3:return i.prev=3,i.next=6,fetch("".concat(e,"/verify/abort-session?session_id=").concat(t,"&session_abort_reason=").concat(n),{method:"POST",headers:{Authorization:"Bearer ".concat(r)},body:JSON.stringify({})});case 6:if(!(o=i.sent).ok){i.next=14;break}return i.next=10,o.json();case 10:return s=i.sent,i.abrupt("return",s);case 14:throw new Error("Network response was not ok.");case 15:i.next=21;break;case 17:throw i.prev=17,i.t0=i.catch(3),console.error("Error:",i.t0),i.t0;case 21:case"end":return i.stop()}}),i,null,[[3,17]])})))},updateQRScan=function(e,t,r,n,i,o,s,a){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function c(){var l,u;return _regeneratorRuntime().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,fetch("".concat(e,"/api/starlink/v1/qr/serial"),{method:"POST",headers:{Authorization:"Bearer ".concat(t),accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({data:Object.assign(Object.assign({},i),{sessionId:r,shortId:n,limitCounter:s,generalCounter:o})})});case 3:if(!(l=c.sent).ok){c.next=11;break}return c.next=7,l.json();case 7:return u=c.sent,c.abrupt("return",u);case 11:return c.abrupt("return",null);case 12:c.next=18;break;case 14:return c.prev=14,c.t0=c.catch(0),null==a||a.error("Error updating QR scan",{apiUrl:e,sessionId:r,shortId:n,generalCounter:o,limitCounter:s,error:c.t0}),c.abrupt("return",null);case 18:case"end":return c.stop()}}),c,null,[[0,14]])})))},fetchExperienceV2=function(e,t,r,n){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function i(){var o,s;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,fetch("".concat(e,"/api/config/v1/StaticCapture/").concat(r,"/").concat(t));case 3:if(!(o=i.sent).ok){i.next=11;break}return i.next=7,o.json();case 7:return s=i.sent,i.abrupt("return",s.data);case 11:throw new Error("Network response was not ok.");case 12:i.next=19;break;case 14:throw i.prev=14,i.t0=i.catch(0),console.error("Error: failed to fetch config  ".concat(t),i.t0),null==n||n.error("Error fetching config",{apiV2Url:e,productScanId:t,env:r,error:i.t0}),i.t0;case 19:case"end":return i.stop()}}),i,null,[[0,14]])})))},fetchSDKConfig=function(e,t,r){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function n(){var i,o;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,fetch("".concat(e,"/api/config/v1/StaticCapture/").concat(t,"/sdkConfig"));case 3:if(!(i=n.sent).ok){n.next=11;break}return n.next=7,i.json();case 7:return o=n.sent,n.abrupt("return",o.data);case 11:throw new Error("Network response was not ok.");case 12:n.next=19;break;case 14:throw n.prev=14,n.t0=n.catch(0),console.error("Error: failed to fetch sdk config",n.t0),null==r||r.error("Error fetching sdk config",{apiV2Url:e,env:t,error:n.t0}),n.t0;case 19:case"end":return n.stop()}}),n,null,[[0,14]])})))},style=___$insertStyle('/* Fonts */\n@font-face {\n  font-family: "Carnas-Regular";\n  src: url("https://vyu-web-sdk.enncrypto.com/v1_sdk_assets/fonts/Carnas+Regular.woff");\n}\n@font-face {\n  font-family: "Carnas-Bold";\n  src: url("https://vyu-web-sdk.enncrypto.com/v1_sdk_assets/fonts/Carnas+Bold.woff");\n}\nhtml {\n  font-size: 4vw;\n}\n\n/* Class */\n.vyu {\n  margin: unset;\n  background: black;\n  height: 100dvh;\n  position: relative;\n  overflow: hidden .vyu -root;\n  overflow-display: flex;\n  overflow-flex-direction: column;\n  overflow-align-items: center;\n}\n.vyu-scanner {\n  position: relative;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n}\n.vyu-scanner video {\n  width: 100%;\n  height: 100%;\n  aspect-ratio: 1;\n  border-radius: 15px;\n  object-fit: cover;\n}\n.vyu-scanner__preview {\n  width: 100%;\n  height: 100%;\n  opacity: 0.4;\n  aspect-ratio: 1;\n  object-fit: cover;\n  z-index: 1;\n}\n.vyu-scanner__loading {\n  position: absolute;\n}\n.vyu-scanner__new {\n  width: 100%;\n  height: 100dvh;\n  position: absolute;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n}\n.vyu-scanner__new video {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n.vyu-scanner__new-preview {\n  width: 100%;\n  height: 100%;\n  aspect-ratio: 1;\n  border-radius: 15px;\n  object-fit: cover;\n  z-index: 1;\n}\n.vyu-scanner__placeholder {\n  background: white;\n  position: absolute;\n  height: 80dvh;\n  width: 90%;\n  border-radius: 20px;\n  z-index: 3;\n  justify-content: center;\n  align-items: center;\n  flex-direction: column;\n  left: 50%;\n  transform: translate(-50%, 10dvh);\n}\n.vyu-scanner__placeholder-heading {\n  font-family: "Carnas-Regular";\n  position: absolute;\n  top: 0%;\n  margin: 1rem 0;\n  font-size: 1.2rem;\n}\n.vyu-scanner__placeholder-content {\n  height: 75%;\n  position: relative;\n  bottom: 3%;\n  overflow: hidden;\n  display: flex;\n  align-items: center;\n}\n.vyu-scanner__placeholder-content img {\n  max-width: 100%;\n  max-height: 90%;\n}\n.vyu-scanner__placeholder-btn {\n  position: absolute;\n  bottom: 15px;\n  background: #343739;\n  color: #ffffff;\n  width: 80%;\n  height: 50px;\n  border-radius: 5px;\n  font-family: "Carnas-Regular";\n  font-size: 1.2rem;\n}\n.vyu-scanner__placeholder-close-icon {\n  position: absolute;\n  z-index: 23;\n  top: 4%;\n  right: 5%;\n}\n.vyu-scanner__placeholder-icon {\n  position: absolute;\n  top: 4%;\n  right: 4%;\n  height: 9.5%;\n  flex-direction: column;\n  justify-content: space-between;\n}\n.vyu-scanner__placeholder-question {\n  width: 25px;\n  height: 25px;\n  z-index: 2;\n}\n.vyu-scanner__placeholder-exclamation {\n  width: 25px;\n  height: 25px;\n  z-index: 2;\n}\n.vyu-capture {\n  position: absolute;\n  height: 16%;\n  width: 100%;\n  bottom: 0;\n  z-index: 1;\n  background-color: black;\n  background-image: url("https://vyu-web-sdk.enncrypto.com/v1_sdk_assets/Icons/capture.png");\n  background-size: contain;\n  background-position: center;\n  background-repeat: no-repeat;\n  border: 20px solid transparent;\n}\n.vyu-loader__start {\n  position: absolute;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: black;\n  height: 100%;\n  width: 100%;\n  z-index: 2;\n}\n.vyu-loader__start img {\n  max-width: 100%;\n}\n.vyu-loader__start span {\n  color: white;\n  position: absolute;\n  font-family: "Carnas-Regular";\n  text-align: center;\n  top: 80%;\n  max-width: 80%;\n}\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n    transform: scale(0.8);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1);\n  }\n}\n.media-container__video {\n  max-height: 70dvh;\n}\n\n.warning-prompt div {\n  width: 100%;\n}\n.warning-prompt img {\n  position: absolute;\n  left: 5px;\n  height: 25px;\n}\n\n.guide-prompt div {\n  width: 100%;\n}\n.guide-prompt img {\n  position: absolute;\n  left: 5px;\n  height: 25px;\n}\n\n.scan-region-highlight {\n  height: 24% !important;\n  top: 35% !important;\n  left: 0 !important;\n  width: 100% !important;\n}\n.scan-region-highlight svg {\n  stroke: #64a2f3;\n  width: 100% !important;\n}\n\n.code-outline-highlight polygon {\n  stroke: rgb(129, 237, 131) !important;\n  stroke-width: 20 !important;\n  stroke-dasharray: 50 !important;\n}\n\n#wrong-qr-code {\n  position: absolute;\n  width: 30%;\n  left: 35%;\n  top: 24%;\n  z-index: 2;\n}\n\n.slider:before {\n  position: absolute;\n  content: "";\n  height: 26px;\n  width: 26px;\n  left: 4px;\n  bottom: 4px;\n  background-color: white;\n  transition: 0.4s;\n  border-radius: 50%;\n}\n\ninput:checked + .slider {\n  background-color: #2196F3;\n}\n\ninput:checked + .slider:before {\n  transform: translateX(26px);\n}'),lottie_svg_min$2={exports:{}},lottie_svg_min=lottie_svg_min$2.exports;(function(module){var root,factory;"undefined"!=typeof navigator&&(root=window||{},factory=function(window){var svgNS="http://www.w3.org/2000/svg",locationHref="",initialDefaultFrame=-999999,subframeEnabled=!0,expressionsPlugin,isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),cachedColors={},bm_rounder=Math.round,bm_rnd,bm_pow=Math.pow,bm_sqrt=Math.sqrt,bm_abs=Math.abs,bm_floor=Math.floor,bm_max=Math.max,bm_min=Math.min,blitter=10,BMMath={};function ProjectInterface(){return{}}!function(){for(var e=["abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","cbrt","expm1","clz32","cos","cosh","exp","floor","fround","hypot","imul","log","log1p","log2","log10","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc","E","LN10","LN2","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],t=e.length,r=0;r<t;r+=1)BMMath[e[r]]=Math[e[r]]}(),BMMath.random=Math.random,BMMath.abs=function(e){if("object"==_typeof(e)&&e.length){for(var t=createSizedArray(e.length),r=e.length,n=0;n<r;n+=1)t[n]=Math.abs(e[n]);return t}return Math.abs(e)};var defaultCurveSegments=150,degToRads=Math.PI/180,roundCorner=.5519;function roundValues(e){bm_rnd=e?Math.round:function(e){return e}}function styleDiv(e){e.style.position="absolute",e.style.top=0,e.style.left=0,e.style.display="block",e.style.transformOrigin=e.style.webkitTransformOrigin="0 0",e.style.backfaceVisibility=e.style.webkitBackfaceVisibility="visible",e.style.transformStyle=e.style.webkitTransformStyle=e.style.mozTransformStyle="preserve-3d"}function BMEnterFrameEvent(e,t,r,n){this.type=e,this.currentTime=t,this.totalTime=r,this.direction=n<0?-1:1}function BMCompleteEvent(e,t){this.type=e,this.direction=t<0?-1:1}function BMCompleteLoopEvent(e,t,r,n){this.type=e,this.currentLoop=r,this.totalLoops=t,this.direction=n<0?-1:1}function BMSegmentStartEvent(e,t,r){this.type=e,this.firstFrame=t,this.totalFrames=r}function BMDestroyEvent(e,t){this.type=e,this.target=t}function BMRenderFrameErrorEvent(e,t){this.type="renderFrameError",this.nativeError=e,this.currentTime=t}function BMConfigErrorEvent(e){this.type="configError",this.nativeError=e}function BMAnimationConfigErrorEvent(e,t){this.type=e,this.nativeError=t,this.currentTime=currentTime}roundValues(!1);var createElementID=(G=0,function(){return"__lottie_element_"+ ++G}),G;function HSVtoRGB(e,t,r){var n,i,o,s=Math.floor(6*e),a=6*e-s,c=r*(1-t),l=r*(1-a*t),u=r*(1-(1-a)*t);switch(s%6){case 0:n=r,i=u,o=c;break;case 1:n=l,i=r,o=c;break;case 2:n=c,i=r,o=u;break;case 3:n=c,i=l,o=r;break;case 4:n=u,i=c,o=r;break;case 5:n=r,i=c,o=l}return[n,i,o]}function RGBtoHSV(e,t,r){var n,i=Math.max(e,t,r),o=Math.min(e,t,r),s=i-o,a=0===i?0:s/i,c=i/255;switch(i){case o:n=0;break;case e:n=t-r+s*(t<r?6:0),n/=6*s;break;case t:n=r-e+2*s,n/=6*s;break;case r:n=e-t+4*s,n/=6*s}return[n,a,c]}function addSaturationToRGB(e,t){var r=RGBtoHSV(255*e[0],255*e[1],255*e[2]);return r[1]+=t,1<r[1]?r[1]=1:r[1]<=0&&(r[1]=0),HSVtoRGB(r[0],r[1],r[2])}function addBrightnessToRGB(e,t){var r=RGBtoHSV(255*e[0],255*e[1],255*e[2]);return r[2]+=t,1<r[2]?r[2]=1:r[2]<0&&(r[2]=0),HSVtoRGB(r[0],r[1],r[2])}function addHueToRGB(e,t){var r=RGBtoHSV(255*e[0],255*e[1],255*e[2]);return r[0]+=t/360,1<r[0]?--r[0]:r[0]<0&&(r[0]+=1),HSVtoRGB(r[0],r[1],r[2])}var rgbToHex=function(){for(var e,t=[],r=0;r<256;r+=1)e=r.toString(16),t[r]=1==e.length?"0"+e:e;return function(e,r,n){return e<0&&(e=0),r<0&&(r=0),n<0&&(n=0),"#"+t[e]+t[r]+t[n]}}();function BaseEvent(){}BaseEvent.prototype={triggerEvent:function(e,t){if(this._cbs[e])for(var r=this._cbs[e].length,n=0;n<r;n++)this._cbs[e][n](t)},addEventListener:function(e,t){return this._cbs[e]||(this._cbs[e]=[]),this._cbs[e].push(t),function(){this.removeEventListener(e,t)}.bind(this)},removeEventListener:function(e,t){if(t){if(this._cbs[e]){for(var r=0,n=this._cbs[e].length;r<n;)this._cbs[e][r]===t&&(this._cbs[e].splice(r,1),--r,--n),r+=1;this._cbs[e].length||(this._cbs[e]=null)}}else this._cbs[e]=null}};var createTypedArray="function"==typeof Uint8ClampedArray&&"function"==typeof Float32Array?function(e,t){return"float32"===e?new Float32Array(t):"int16"===e?new Int16Array(t):"uint8c"===e?new Uint8ClampedArray(t):void 0}:function(e,t){var r,n=0,i=[];switch(e){case"int16":case"uint8c":r=1;break;default:r=1.1}for(n=0;n<t;n+=1)i.push(r);return i};function createSizedArray(e){return Array.apply(null,{length:e})}function createNS(e){return document.createElementNS(svgNS,e)}function createTag(e){return document.createElement(e)}function DynamicPropertyContainer(){}DynamicPropertyContainer.prototype={addDynamicProperty:function(e){-1===this.dynamicProperties.indexOf(e)&&(this.dynamicProperties.push(e),this.container.addDynamicProperty(this),this._isAnimated=!0)},iterateDynamicProperties:function(){this._mdf=!1;for(var e=this.dynamicProperties.length,t=0;t<e;t+=1)this.dynamicProperties[t].getValue(),this.dynamicProperties[t]._mdf&&(this._mdf=!0)},initDynamicPropertyContainer:function(e){this.container=e,this.dynamicProperties=[],this._mdf=!1,this._isAnimated=!1}};var getBlendMode=(Pa={0:"source-over",1:"multiply",2:"screen",3:"overlay",4:"darken",5:"lighten",6:"color-dodge",7:"color-burn",8:"hard-light",9:"soft-light",10:"difference",11:"exclusion",12:"hue",13:"saturation",14:"color",15:"luminosity"},function(e){return Pa[e]||""}),Pa,Matrix=(Ra=Math.cos,Sa=Math.sin,Ta=Math.tan,Ua=Math.round,function(){this.reset=Va,this.rotate=Wa,this.rotateX=Xa,this.rotateY=Ya,this.rotateZ=Za,this.skew=_a,this.skewFromAxis=ab,this.shear=$a,this.scale=bb,this.setTransform=cb,this.translate=db,this.transform=eb,this.applyToPoint=jb,this.applyToX=kb,this.applyToY=lb,this.applyToZ=mb,this.applyToPointArray=sb,this.applyToTriplePoints=rb,this.applyToPointStringified=tb,this.toCSS=ub,this.to2dCSS=wb,this.clone=hb,this.cloneFromProps=ib,this.equals=gb,this.inversePoints=qb,this.inversePoint=pb,this.getInverseMatrix=nb,this._t=this.transform,this.isIdentity=fb,this._identity=!0,this._identityCalculated=!1,this.props=createTypedArray("float32",16),this.reset()}),Ra,Sa,Ta,Ua;function Va(){return this.props[0]=1,this.props[1]=0,this.props[2]=0,this.props[3]=0,this.props[4]=0,this.props[5]=1,this.props[6]=0,this.props[7]=0,this.props[8]=0,this.props[9]=0,this.props[10]=1,this.props[11]=0,this.props[12]=0,this.props[13]=0,this.props[14]=0,this.props[15]=1,this}function Wa(e){if(0===e)return this;var t=Ra(e),r=Sa(e);return this._t(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1)}function Xa(e){if(0===e)return this;var t=Ra(e),r=Sa(e);return this._t(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1)}function Ya(e){if(0===e)return this;var t=Ra(e),r=Sa(e);return this._t(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1)}function Za(e){if(0===e)return this;var t=Ra(e),r=Sa(e);return this._t(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1)}function $a(e,t){return this._t(1,t,e,1,0,0)}function _a(e,t){return this.shear(Ta(e),Ta(t))}function ab(e,t){var r=Ra(t),n=Sa(t);return this._t(r,n,0,0,-n,r,0,0,0,0,1,0,0,0,0,1)._t(1,0,0,0,Ta(e),1,0,0,0,0,1,0,0,0,0,1)._t(r,-n,0,0,n,r,0,0,0,0,1,0,0,0,0,1)}function bb(e,t,r){return r||0===r||(r=1),1===e&&1===t&&1===r?this:this._t(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1)}function cb(e,t,r,n,i,o,s,a,c,l,u,d,h,f,p,m){return this.props[0]=e,this.props[1]=t,this.props[2]=r,this.props[3]=n,this.props[4]=i,this.props[5]=o,this.props[6]=s,this.props[7]=a,this.props[8]=c,this.props[9]=l,this.props[10]=u,this.props[11]=d,this.props[12]=h,this.props[13]=f,this.props[14]=p,this.props[15]=m,this}function db(e,t,r){return r=r||0,0!==e||0!==t||0!==r?this._t(1,0,0,0,0,1,0,0,0,0,1,0,e,t,r,1):this}function eb(e,t,r,n,i,o,s,a,c,l,u,d,h,f,p,m){var v=this.props;if(1===e&&0===t&&0===r&&0===n&&0===i&&1===o&&0===s&&0===a&&0===c&&0===l&&1===u&&0===d)return v[12]=v[12]*e+v[15]*h,v[13]=v[13]*o+v[15]*f,v[14]=v[14]*u+v[15]*p,v[15]=v[15]*m,this._identityCalculated=!1,this;var g=v[0],_=v[1],y=v[2],b=v[3],w=v[4],k=v[5],S=v[6],E=v[7],C=v[8],T=v[9],P=v[10],A=v[11],x=v[12],B=v[13],I=v[14],R=v[15];return v[0]=g*e+_*i+y*c+b*h,v[1]=g*t+_*o+y*l+b*f,v[2]=g*r+_*s+y*u+b*p,v[3]=g*n+_*a+y*d+b*m,v[4]=w*e+k*i+S*c+E*h,v[5]=w*t+k*o+S*l+E*f,v[6]=w*r+k*s+S*u+E*p,v[7]=w*n+k*a+S*d+E*m,v[8]=C*e+T*i+P*c+A*h,v[9]=C*t+T*o+P*l+A*f,v[10]=C*r+T*s+P*u+A*p,v[11]=C*n+T*a+P*d+A*m,v[12]=x*e+B*i+I*c+R*h,v[13]=x*t+B*o+I*l+R*f,v[14]=x*r+B*s+I*u+R*p,v[15]=x*n+B*a+I*d+R*m,this._identityCalculated=!1,this}function fb(){return this._identityCalculated||(this._identity=!(1!==this.props[0]||0!==this.props[1]||0!==this.props[2]||0!==this.props[3]||0!==this.props[4]||1!==this.props[5]||0!==this.props[6]||0!==this.props[7]||0!==this.props[8]||0!==this.props[9]||1!==this.props[10]||0!==this.props[11]||0!==this.props[12]||0!==this.props[13]||0!==this.props[14]||1!==this.props[15]),this._identityCalculated=!0),this._identity}function gb(e){for(var t=0;t<16;){if(e.props[t]!==this.props[t])return!1;t+=1}return!0}function hb(e){for(var t=0;t<16;t+=1)e.props[t]=this.props[t]}function ib(e){for(var t=0;t<16;t+=1)this.props[t]=e[t]}function jb(e,t,r){return{x:e*this.props[0]+t*this.props[4]+r*this.props[8]+this.props[12],y:e*this.props[1]+t*this.props[5]+r*this.props[9]+this.props[13],z:e*this.props[2]+t*this.props[6]+r*this.props[10]+this.props[14]}}function kb(e,t,r){return e*this.props[0]+t*this.props[4]+r*this.props[8]+this.props[12]}function lb(e,t,r){return e*this.props[1]+t*this.props[5]+r*this.props[9]+this.props[13]}function mb(e,t,r){return e*this.props[2]+t*this.props[6]+r*this.props[10]+this.props[14]}function nb(){var e=this.props[0]*this.props[5]-this.props[1]*this.props[4],t=this.props[5]/e,r=-this.props[1]/e,n=-this.props[4]/e,i=this.props[0]/e,o=(this.props[4]*this.props[13]-this.props[5]*this.props[12])/e,s=-(this.props[0]*this.props[13]-this.props[1]*this.props[12])/e,a=new Matrix;return a.props[0]=t,a.props[1]=r,a.props[4]=n,a.props[5]=i,a.props[12]=o,a.props[13]=s,a}function pb(e){return this.getInverseMatrix().applyToPointArray(e[0],e[1],e[2]||0)}function qb(e){for(var t=e.length,r=[],n=0;n<t;n+=1)r[n]=pb(e[n]);return r}function rb(e,t,r){var n,i,o,s,a,c,l=createTypedArray("float32",6);return this.isIdentity()?(l[0]=e[0],l[1]=e[1],l[2]=t[0],l[3]=t[1],l[4]=r[0],l[5]=r[1]):(n=this.props[0],i=this.props[1],o=this.props[4],s=this.props[5],a=this.props[12],c=this.props[13],l[0]=e[0]*n+e[1]*o+a,l[1]=e[0]*i+e[1]*s+c,l[2]=t[0]*n+t[1]*o+a,l[3]=t[0]*i+t[1]*s+c,l[4]=r[0]*n+r[1]*o+a,l[5]=r[0]*i+r[1]*s+c),l}function sb(e,t,r){return this.isIdentity()?[e,t,r]:[e*this.props[0]+t*this.props[4]+r*this.props[8]+this.props[12],e*this.props[1]+t*this.props[5]+r*this.props[9]+this.props[13],e*this.props[2]+t*this.props[6]+r*this.props[10]+this.props[14]]}function tb(e,t){if(this.isIdentity())return e+","+t;var r=this.props;return Math.round(100*(e*r[0]+t*r[4]+r[12]))/100+","+Math.round(100*(e*r[1]+t*r[5]+r[13]))/100}function ub(){for(var e=0,t=this.props,r="matrix3d(";e<16;)r+=Ua(1e4*t[e])/1e4,r+=15===e?")":",",e+=1;return r}function vb(e){return e<1e-6&&0<e||-1e-6<e&&e<0?Ua(1e4*e)/1e4:e}function wb(){var e=this.props;return"matrix("+vb(e[0])+","+vb(e[1])+","+vb(e[4])+","+vb(e[5])+","+vb(e[12])+","+vb(e[13])+")"}!function(e,t){var r=this,n=256,i="random",o=t.pow(n,6),s=t.pow(2,52),a=2*s,c=255;function l(e){var t,r=e.length,i=this,o=0,s=i.i=i.j=0,a=i.S=[];for(r||(e=[r++]);o<n;)a[o]=o++;for(o=0;o<n;o++)a[o]=a[s=c&s+e[o%r]+(t=a[o])],a[s]=t;i.g=function(e){for(var t,r=0,o=i.i,s=i.j,a=i.S;e--;)t=a[o=c&o+1],r=r*n+a[c&(a[o]=a[s=c&s+t])+(a[s]=t)];return i.i=o,i.j=s,r}}function u(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function d(e,t){for(var r,n=e+"",i=0;i<n.length;)t[c&i]=c&(r^=19*t[c&i])+n.charCodeAt(i++);return h(t)}function h(e){return String.fromCharCode.apply(0,e)}t["seed"+i]=function(c,f,p){function m(){for(var e=_.g(6),t=o,r=0;e<s;)e=(e+r)*n,t*=n,r=_.g(1);for(;a<=e;)e/=2,t/=2,r>>>=1;return(e+r)/t}var v=[],g=d(function e(t,r){var n,i=[],o=_typeof(t);if(r&&"object"==o)for(n in t)try{i.push(e(t[n],r-1))}catch(e){}return i.length?i:"string"==o?t:t+"\0"}((f=!0===f?{entropy:!0}:f||{}).entropy?[c,h(e)]:null===c?function(){try{var t=new Uint8Array(n);return(r.crypto||r.msCrypto).getRandomValues(t),h(t)}catch(t){var i=r.navigator,o=i&&i.plugins;return[+new Date,r,o,r.screen,h(e)]}}():c,3),v),_=new l(v);return m.int32=function(){return 0|_.g(4)},m.quick=function(){return _.g(4)/4294967296},m.double=m,d(h(_.S),e),(f.pass||p||function(e,r,n,o){return o&&(o.S&&u(o,_),e.state=function(){return u(_,{})}),n?(t[i]=e,r):e})(m,g,"global"in f?f.global:this==t,f.state)},d(t.random(),e)}([],BMMath);var BezierFactory=(jf={getBezierEasing:function(e,t,r,n,i){var o=i||("bez_"+e+"_"+t+"_"+r+"_"+n).replace(/\./g,"p");if(kf[o])return kf[o];var s=new Af([e,t,r,n]);return kf[o]=s}},kf={},qf=11,rf=1/(qf-1),sf="function"==typeof Float32Array,Af.prototype={get:function(e){var t=this._p[0],r=this._p[1],n=this._p[2],i=this._p[3];return this._precomputed||this._precompute(),t===r&&n===i?e:0===e?0:1===e?1:wf(this._getTForX(e),r,i)},_precompute:function(){var e=this._p[0],t=this._p[1],r=this._p[2],n=this._p[3];this._precomputed=!0,e===t&&r===n||this._calcSampleValues()},_calcSampleValues:function(){for(var e=this._p[0],t=this._p[2],r=0;r<qf;++r)this._mSampleValues[r]=wf(r*rf,e,t)},_getTForX:function(e){for(var t=this._p[0],r=this._p[2],n=this._mSampleValues,i=0,o=1,s=qf-1;o!==s&&n[o]<=e;++o)i+=rf;var a=i+(e-n[--o])/(n[o+1]-n[o])*rf,c=xf(a,t,r);return.001<=c?function(e,t,r,n){for(var i=0;i<4;++i){var o=xf(t,r,n);if(0===o)return t;t-=(wf(t,r,n)-e)/o}return t}(e,a,t,r):0===c?a:function(e,t,r,n,i){for(var o,s,a=0;0<(o=wf(s=t+(r-t)/2,n,i)-e)?r=s:t=s,1e-7<Math.abs(o)&&++a<10;);return s}(e,i,i+rf,t,r)}},jf),jf,kf,qf,rf,sf;function tf(e,t){return 1-3*t+3*e}function uf(e,t){return 3*t-6*e}function wf(e,t,r){return((tf(t,r)*e+uf(t,r))*e+3*t)*e}function xf(e,t,r){return 3*tf(t,r)*e*e+2*uf(t,r)*e+3*t}function Af(e){this._p=e,this._mSampleValues=new(sf?Float32Array:Array)(qf),this._precomputed=!1,this.get=this.get.bind(this)}function extendPrototype(e,t){for(var r,n=e.length,i=0;i<n;i+=1)for(var o in r=e[i].prototype)r.hasOwnProperty(o)&&(t.prototype[o]=r[o])}function getDescriptor(e,t){return Object.getOwnPropertyDescriptor(e,t)}function createProxyFunction(e){function t(){}return t.prototype=e,t}function bezFunction(){function e(e,t,r,n,i,o){var s=e*n+t*i+r*o-i*n-o*e-r*t;return-.001<s&&s<.001}Math;var t=function(e,t,r,n){for(var i,o,s,a,c=defaultCurveSegments,l=0,u=[],d=[],h=bezier_length_pool.newElement(),f=r.length,p=0;p<c;p+=1){for(s=p/(c-1),i=a=0;i<f;i+=1)o=bm_pow(1-s,3)*e[i]+3*bm_pow(1-s,2)*s*r[i]+3*(1-s)*bm_pow(s,2)*n[i]+bm_pow(s,3)*t[i],u[i]=o,null!==d[i]&&(a+=bm_pow(u[i]-d[i],2)),d[i]=u[i];a&&(l+=a=bm_sqrt(a)),h.percents[p]=s,h.lengths[p]=l}return h.addedLength=l,h};function r(e){this.segmentLength=0,this.points=new Array(e)}function n(e,t){this.partialLength=e,this.point=t}var i,o=(i={},function(t,o,s,a){var c=(t[0]+"_"+t[1]+"_"+o[0]+"_"+o[1]+"_"+s[0]+"_"+s[1]+"_"+a[0]+"_"+a[1]).replace(/\./g,"p");if(!i[c]){var l,u,d,h,f,p=defaultCurveSegments,m=0,v=null;2===t.length&&(t[0]!=o[0]||t[1]!=o[1])&&e(t[0],t[1],o[0],o[1],t[0]+s[0],t[1]+s[1])&&e(t[0],t[1],o[0],o[1],o[0]+a[0],o[1]+a[1])&&(p=2);for(var g=new r(p),_=s.length,y=0;y<p;y+=1){for(f=createSizedArray(_),d=y/(p-1),l=h=0;l<_;l+=1)u=bm_pow(1-d,3)*t[l]+3*bm_pow(1-d,2)*d*(t[l]+s[l])+3*(1-d)*bm_pow(d,2)*(o[l]+a[l])+bm_pow(d,3)*o[l],f[l]=u,null!==v&&(h+=bm_pow(f[l]-v[l],2));m+=h=bm_sqrt(h),g.points[y]=new n(h,f),v=f}g.segmentLength=m,i[c]=g}return i[c]});function s(e,t){var r=t.percents,n=t.lengths,i=r.length,o=bm_floor((i-1)*e),s=e*t.addedLength,a=0;if(o===i-1||0===o||s===n[o])return r[o];for(var c=n[o]>s?-1:1,l=!0;l;)if(n[o]<=s&&n[o+1]>s?(a=(s-n[o])/(n[o+1]-n[o]),l=!1):o+=c,o<0||i-1<=o){if(o===i-1)return r[o];l=!1}return r[o]+(r[o+1]-r[o])*a}var a=createTypedArray("float32",8);return{getSegmentsLength:function(e){for(var r=segments_length_pool.newElement(),n=e.c,i=e.v,o=e.o,s=e.i,a=e._length,c=r.lengths,l=0,u=0;u<a-1;u+=1)c[u]=t(i[u],i[u+1],o[u],s[u+1]),l+=c[u].addedLength;return n&&a&&(c[u]=t(i[u],i[0],o[u],s[0]),l+=c[u].addedLength),r.totalLength=l,r},getNewSegment:function(e,t,r,n,i,o,c){for(var l=s(i=i<0?0:1<i?1:i,c),u=s(o=1<o?1:o,c),d=e.length,h=1-l,f=1-u,p=h*h*h,m=l*h*h*3,v=l*l*h*3,g=l*l*l,_=h*h*f,y=l*h*f+h*l*f+h*h*u,b=l*l*f+h*l*u+l*h*u,w=l*l*u,k=h*f*f,S=l*f*f+h*u*f+h*f*u,E=l*u*f+h*u*u+l*f*u,C=l*u*u,T=f*f*f,P=u*f*f+f*u*f+f*f*u,A=u*u*f+f*u*u+u*f*u,x=u*u*u,B=0;B<d;B+=1)a[4*B]=Math.round(1e3*(p*e[B]+m*r[B]+v*n[B]+g*t[B]))/1e3,a[4*B+1]=Math.round(1e3*(_*e[B]+y*r[B]+b*n[B]+w*t[B]))/1e3,a[4*B+2]=Math.round(1e3*(k*e[B]+S*r[B]+E*n[B]+C*t[B]))/1e3,a[4*B+3]=Math.round(1e3*(T*e[B]+P*r[B]+A*n[B]+x*t[B]))/1e3;return a},getPointInSegment:function(e,t,r,n,i,o){var a=s(i,o),c=1-a;return[Math.round(1e3*(c*c*c*e[0]+(a*c*c+c*a*c+c*c*a)*r[0]+(a*a*c+c*a*a+a*c*a)*n[0]+a*a*a*t[0]))/1e3,Math.round(1e3*(c*c*c*e[1]+(a*c*c+c*a*c+c*c*a)*r[1]+(a*a*c+c*a*a+a*c*a)*n[1]+a*a*a*t[1]))/1e3]},buildBezierData:o,pointOnLine2D:e,pointOnLine3D:function(t,r,n,i,o,s,a,c,l){if(0===n&&0===s&&0===l)return e(t,r,i,o,a,c);var u=Math.sqrt(Math.pow(i-t,2)+Math.pow(o-r,2)+Math.pow(s-n,2)),d=Math.sqrt(Math.pow(a-t,2)+Math.pow(c-r,2)+Math.pow(l-n,2)),h=Math.sqrt(Math.pow(a-i,2)+Math.pow(c-o,2)+Math.pow(l-s,2)),f=d<u?h<u?u-d-h:h-d-u:d<h?h-d-u:d-u-h;return-1e-4<f&&f<1e-4}}}!function(){for(var e=0,t=["ms","moz","webkit","o"],r=0;r<t.length&&!window.requestAnimationFrame;++r)window.requestAnimationFrame=window[t[r]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[r]+"CancelAnimationFrame"]||window[t[r]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,r){var n=(new Date).getTime(),i=Math.max(0,16-(n-e)),o=setTimeout((function(){t(n+i)}),i);return e=n+i,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}();var bez=bezFunction();function dataFunctionManager(){function e(r,n,i){for(var o,s,a,c,l=r.length,u=0;u<l;u+=1)if("ks"in(o=r[u])&&!o.completed){if(o.completed=!0,o.tt&&(r[u-1].td=o.tt),o.hasMask)for(var d=o.masksProperties,h=d.length,f=0;f<h;f+=1)if(d[f].pt.k.i)t(d[f].pt.k);else for(a=d[f].pt.k.length,s=0;s<a;s+=1)d[f].pt.k[s].s&&t(d[f].pt.k[s].s[0]),d[f].pt.k[s].e&&t(d[f].pt.k[s].e[0]);0===o.ty?(o.layers=function(e,t){for(var r=0,n=t.length;r<n;){if(t[r].id===e)return t[r].layers.__used?JSON.parse(JSON.stringify(t[r].layers)):(t[r].layers.__used=!0,t[r].layers);r+=1}}(o.refId,n),e(o.layers,n,i)):4===o.ty?function e(r){var n,i,o;for(n=r.length-1;0<=n;--n)if("sh"==r[n].ty)if(r[n].ks.k.i)t(r[n].ks.k);else for(o=r[n].ks.k.length,i=0;i<o;i+=1)r[n].ks.k[i].s&&t(r[n].ks.k[i].s[0]),r[n].ks.k[i].e&&t(r[n].ks.k[i].e[0]);else"gr"==r[n].ty&&e(r[n].it)}(o.shapes):5==o.ty&&(0!==(c=o).t.a.length||"m"in c.t.p||(c.singleShape=!0))}}function t(e){for(var t=e.i.length,r=0;r<t;r+=1)e.i[r][0]+=e.v[r][0],e.i[r][1]+=e.v[r][1],e.o[r][0]+=e.v[r][0],e.o[r][1]+=e.v[r][1]}function r(e,t){var r=t?t.split("."):[100,100,100];if(e[0]>r[0])return 1;if(!(r[0]>e[0])){if(e[1]>r[1])return 1;if(!(r[1]>e[1]))return e[2]>r[2]||(r[2],void e[2])}}var n,i=(n=[4,4,14],function(e){if(r(n,e.v)&&(o(e.layers),e.assets))for(var t=e.assets.length,i=0;i<t;i+=1)e.assets[i].layers&&o(e.assets[i].layers)});function o(e){for(var t,r,n=e.length,i=0;i<n;i+=1)5===e[i].ty&&(r=(t=e[i]).t.d,t.t.d={k:[{s:r,t:0}]})}var s,a,c=(s=[4,7,99],function(e){if(e.chars&&!r(s,e.v))for(var n,i,o,a,c=e.chars.length,l=0;l<c;l+=1)if(e.chars[l].data&&e.chars[l].data.shapes)for(i=(a=e.chars[l].data.shapes[0].it).length,n=0;n<i;n+=1)(o=a[n].ks.k).__converted||(t(a[n].ks.k),o.__converted=!0)}),l=(a=[4,1,9],function(e){if(r(a,e.v)&&(u(e.layers),e.assets))for(var t=e.assets.length,n=0;n<t;n+=1)e.assets[n].layers&&u(e.assets[n].layers)});function u(e){for(var t=e.length,r=0;r<t;r+=1)4===e[r].ty&&function e(t){for(var r,n,i=t.length,o=0;o<i;o+=1)if("gr"===t[o].ty)e(t[o].it);else if("fl"===t[o].ty||"st"===t[o].ty)if(t[o].c.k&&t[o].c.k[0].i)for(n=t[o].c.k.length,r=0;r<n;r+=1)t[o].c.k[r].s&&(t[o].c.k[r].s[0]/=255,t[o].c.k[r].s[1]/=255,t[o].c.k[r].s[2]/=255,t[o].c.k[r].s[3]/=255),t[o].c.k[r].e&&(t[o].c.k[r].e[0]/=255,t[o].c.k[r].e[1]/=255,t[o].c.k[r].e[2]/=255,t[o].c.k[r].e[3]/=255);else t[o].c.k[0]/=255,t[o].c.k[1]/=255,t[o].c.k[2]/=255,t[o].c.k[3]/=255}(e[r].shapes)}var d,h=(d=[4,4,18],function(e){if(r(d,e.v)&&(f(e.layers),e.assets))for(var t=e.assets.length,n=0;n<t;n+=1)e.assets[n].layers&&f(e.assets[n].layers)});function f(e){for(var t,r,n,i=e.length,o=0;o<i;o+=1){if((t=e[o]).hasMask)for(var s=t.masksProperties,a=s.length,c=0;c<a;c+=1)if(s[c].pt.k.i)s[c].pt.k.c=s[c].cl;else for(n=s[c].pt.k.length,r=0;r<n;r+=1)s[c].pt.k[r].s&&(s[c].pt.k[r].s[0].c=s[c].cl),s[c].pt.k[r].e&&(s[c].pt.k[r].e[0].c=s[c].cl);4===t.ty&&function e(t){for(var r,n,i=t.length-1;0<=i;--i)if("sh"==t[i].ty)if(t[i].ks.k.i)t[i].ks.k.c=t[i].closed;else for(n=t[i].ks.k.length,r=0;r<n;r+=1)t[i].ks.k[r].s&&(t[i].ks.k[r].s[0].c=t[i].closed),t[i].ks.k[r].e&&(t[i].ks.k[r].e[0].c=t[i].closed);else"gr"==t[i].ty&&e(t[i].it)}(t.shapes)}}var p={completeData:function(t,r){t.__complete||(l(t),i(t),c(t),h(t),e(t.layers,t.assets,r),t.__complete=!0)}};return p.checkColors=l,p.checkChars=c,p.checkShapes=h,p.completeLayers=e,p}var dataManager=dataFunctionManager(),FontManager=function(){var e={w:0,size:0,shapes:[]},t=[];function r(e,t){var r=createTag("span");r.style.fontFamily=t;var n=createTag("span");n.innerHTML="giItT1WQy@!-/#",r.style.position="absolute",r.style.left="-10000px",r.style.top="-10000px",r.style.fontSize="300px",r.style.fontVariant="normal",r.style.fontStyle="normal",r.style.fontWeight="normal",r.style.letterSpacing="0",r.appendChild(n),document.body.appendChild(r);var i=n.offsetWidth;return n.style.fontFamily=function(e){for(var t=e.split(","),r=t.length,n=[],i=0;i<r;i+=1)"sans-serif"!==t[i]&&"monospace"!==t[i]&&n.push(t[i]);return n.join(",")}(e)+", "+t,{node:n,w:i,parent:r}}function n(){this.fonts=[],this.chars=null,this.typekitLoaded=0,this.isLoaded=!1,this.initTime=Date.now(),this.setIsLoadedBinded=this.setIsLoaded.bind(this),this.checkLoadedFontsBinded=this.checkLoadedFonts.bind(this)}return t=t.concat([2304,2305,2306,2307,2362,2363,2364,2364,2366,2367,2368,2369,2370,2371,2372,2373,2374,2375,2376,2377,2378,2379,2380,2381,2382,2383,2387,2388,2389,2390,2391,2402,2403]),n.getCombinedCharacterCodes=function(){return t},n.prototype={addChars:function(e){if(e){this.chars||(this.chars=[]);for(var t,r,n=e.length,i=this.chars.length,o=0;o<n;o+=1){for(t=0,r=!1;t<i;)this.chars[t].style===e[o].style&&this.chars[t].fFamily===e[o].fFamily&&this.chars[t].ch===e[o].ch&&(r=!0),t+=1;r||(this.chars.push(e[o]),i+=1)}}},addFonts:function(e,t){if(e){if(this.chars)return this.isLoaded=!0,void(this.fonts=e.list);for(var n,i,o,s=e.list,a=s.length,c=a,l=0;l<a;l+=1){var u,d,h,f,p,m=!0;if(s[l].loaded=!1,s[l].monoCase=r(s[l].fFamily,"monospace"),s[l].sansCase=r(s[l].fFamily,"sans-serif"),s[l].fPath){if("p"===s[l].fOrigin||3===s[l].origin)0<(h=document.querySelectorAll('style[f-forigin="p"][f-family="'+s[l].fFamily+'"], style[f-origin="3"][f-family="'+s[l].fFamily+'"]')).length&&(m=!1),m&&((d=createTag("style")).setAttribute("f-forigin",s[l].fOrigin),d.setAttribute("f-origin",s[l].origin),d.setAttribute("f-family",s[l].fFamily),d.type="text/css",d.innerHTML="@font-face {font-family: "+s[l].fFamily+"; font-style: normal; src: url('"+s[l].fPath+"');}",t.appendChild(d));else if("g"===s[l].fOrigin||1===s[l].origin){for(h=document.querySelectorAll('link[f-forigin="g"], link[f-origin="1"]'),u=0;u<h.length;u++)-1!==h[u].href.indexOf(s[l].fPath)&&(m=!1);m&&((f=createTag("link")).setAttribute("f-forigin",s[l].fOrigin),f.setAttribute("f-origin",s[l].origin),f.type="text/css",f.rel="stylesheet",f.href=s[l].fPath,document.body.appendChild(f))}else if("t"===s[l].fOrigin||2===s[l].origin){for(h=document.querySelectorAll('script[f-forigin="t"], script[f-origin="2"]'),u=0;u<h.length;u++)s[l].fPath===h[u].src&&(m=!1);m&&((p=createTag("link")).setAttribute("f-forigin",s[l].fOrigin),p.setAttribute("f-origin",s[l].origin),p.setAttribute("rel","stylesheet"),p.setAttribute("href",s[l].fPath),t.appendChild(p))}}else s[l].loaded=!0,--c;s[l].helper=(n=t,i=s[l],o=void 0,(o=createNS("text")).style.fontSize="100px",o.setAttribute("font-family",i.fFamily),o.setAttribute("font-style",i.fStyle),o.setAttribute("font-weight",i.fWeight),o.textContent="1",i.fClass?(o.style.fontFamily="inherit",o.setAttribute("class",i.fClass)):o.style.fontFamily=i.fFamily,n.appendChild(o),createTag("canvas").getContext("2d").font=i.fWeight+" "+i.fStyle+" 100px "+i.fFamily,o),s[l].cache={},this.fonts.push(s[l])}0===c?this.isLoaded=!0:setTimeout(this.checkLoadedFonts.bind(this),100)}else this.isLoaded=!0},getCharData:function(t,r,n){for(var i=0,o=this.chars.length;i<o;){if(this.chars[i].ch===t&&this.chars[i].style===r&&this.chars[i].fFamily===n)return this.chars[i];i+=1}return("string"==typeof t&&13!==t.charCodeAt(0)||!t)&&console&&console.warn&&console.warn("Missing character from exported characters list: ",t,r,n),e},getFontByName:function(e){for(var t=0,r=this.fonts.length;t<r;){if(this.fonts[t].fName===e)return this.fonts[t];t+=1}return this.fonts[0]},measureText:function(e,t,r){var n,i,o,s=this.getFontByName(t),a=e.charCodeAt(0);return s.cache[a+1]||(n=s.helper," "===e?(n.textContent="|"+e+"|",i=n.getComputedTextLength(),n.textContent="||",o=n.getComputedTextLength(),s.cache[a+1]=(i-o)/100):(n.textContent=e,s.cache[a+1]=n.getComputedTextLength()/100)),s.cache[a+1]*r},checkLoadedFonts:function(){for(var e,t,r=this.fonts.length,n=r,i=0;i<r;i+=1)this.fonts[i].loaded?--n:"n"===this.fonts[i].fOrigin||0===this.fonts[i].origin?this.fonts[i].loaded=!0:(e=this.fonts[i].monoCase.node,t=this.fonts[i].monoCase.w,e.offsetWidth!==t?(--n,this.fonts[i].loaded=!0):(e=this.fonts[i].sansCase.node,t=this.fonts[i].sansCase.w,e.offsetWidth!==t&&(--n,this.fonts[i].loaded=!0)),this.fonts[i].loaded&&(this.fonts[i].sansCase.parent.parentNode.removeChild(this.fonts[i].sansCase.parent),this.fonts[i].monoCase.parent.parentNode.removeChild(this.fonts[i].monoCase.parent)));0!==n&&Date.now()-this.initTime<5e3?setTimeout(this.checkLoadedFontsBinded,20):setTimeout(this.setIsLoadedBinded,10)},setIsLoaded:function(){this.isLoaded=!0}},n}(),PropertyFactory=(xm=initialDefaultFrame,ym=Math.abs,{getProp:function(e,t,r,n,i){var o;if(t.k.length)if("number"==typeof t.k[0])o=new Im(e,t,n,i);else switch(r){case 0:o=new Jm(e,t,n,i);break;case 1:o=new Km(e,t,n,i)}else o=new Hm(e,t,n,i);return o.effectsSequence.length&&i.addDynamicProperty(o),o}}),xm,ym;function zm(e,t){var r,n=this.offsetTime;"multidimensional"===this.propType&&(r=createTypedArray("float32",this.pv.length));for(var i,o,s,a,c=t.lastIndex,l=c,u=this.keyframes.length-1,d=!0;d;){if(i=this.keyframes[l],o=this.keyframes[l+1],l===u-1&&e>=o.t-n){i.h&&(i=o),c=0;break}if(o.t-n>e){c=l;break}l<u-1?l+=1:(c=0,d=!1)}var h,f,p,m,v,g,_,y,b,w=o.t-n,k=i.t-n;if(i.to){i.bezierData||(i.bezierData=bez.buildBezierData(i.s,o.s||i.e,i.to,i.ti));var S=i.bezierData;if(w<=e||e<k)for(var E=w<=e?S.points.length-1:0,C=S.points[E].point.length,T=0;T<C;T+=1)r[T]=S.points[E].point[T];else{i.__fnct?a=i.__fnct:(a=BezierFactory.getBezierEasing(i.o.x,i.o.y,i.i.x,i.i.y,i.n).get,i.__fnct=a),s=a((e-k)/(w-k));for(var P,A=S.segmentLength*s,x=t.lastFrame<e&&t._lastKeyframeIndex===l?t._lastAddedLength:0,B=t.lastFrame<e&&t._lastKeyframeIndex===l?t._lastPoint:0,I=(d=!0,S.points.length);d;){if(x+=S.points[B].partialLength,0==A||0===s||B===S.points.length-1){for(C=S.points[B].point.length,T=0;T<C;T+=1)r[T]=S.points[B].point[T];break}if(x<=A&&A<x+S.points[B+1].partialLength){for(P=(A-x)/S.points[B+1].partialLength,C=S.points[B].point.length,T=0;T<C;T+=1)r[T]=S.points[B].point[T]+(S.points[B+1].point[T]-S.points[B].point[T])*P;break}B<I-1?B+=1:d=!1}t._lastPoint=B,t._lastAddedLength=x-S.points[B].partialLength,t._lastKeyframeIndex=l}}else{u=i.s.length;var R,O,M,L,D,N=o.s||i.e;if(this.sh&&1!==i.h)w<=e?(r[0]=N[0],r[1]=N[1],r[2]=N[2]):e<=k?(r[0]=i.s[0],r[1]=i.s[1],r[2]=i.s[2]):(h=r,f=function(e,t,r){var n,i,o,s,a,c=[],l=e[0],u=e[1],d=e[2],h=e[3],f=t[0],p=t[1],m=t[2],v=t[3];return(i=l*f+u*p+d*m+h*v)<0&&(i=-i,f=-f,p=-p,m=-m,v=-v),a=1e-6<1-i?(n=Math.acos(i),o=Math.sin(n),s=Math.sin((1-r)*n)/o,Math.sin(r*n)/o):(s=1-r,r),c[0]=s*l+a*f,c[1]=s*u+a*p,c[2]=s*d+a*m,c[3]=s*h+a*v,c}(Cm(i.s),Cm(N),(e-k)/(w-k)),p=f[0],m=f[1],v=f[2],g=f[3],_=Math.atan2(2*m*g-2*p*v,1-2*m*m-2*v*v),y=Math.asin(2*p*m+2*v*g),b=Math.atan2(2*p*g-2*m*v,1-2*p*p-2*v*v),h[0]=_/degToRads,h[1]=y/degToRads,h[2]=b/degToRads);else for(l=0;l<u;l+=1)1!==i.h&&(s=w<=e?1:e<k?0:(i.o.x.constructor===Array?(i.__fnct||(i.__fnct=[]),i.__fnct[l]?a=i.__fnct[l]:(R=void 0===i.o.x[l]?i.o.x[0]:i.o.x[l],O=void 0===i.o.y[l]?i.o.y[0]:i.o.y[l],M=void 0===i.i.x[l]?i.i.x[0]:i.i.x[l],L=void 0===i.i.y[l]?i.i.y[0]:i.i.y[l],a=BezierFactory.getBezierEasing(R,O,M,L).get,i.__fnct[l]=a)):i.__fnct?a=i.__fnct:(R=i.o.x,O=i.o.y,M=i.i.x,L=i.i.y,a=BezierFactory.getBezierEasing(R,O,M,L).get,i.__fnct=a),a((e-k)/(w-k)))),N=o.s||i.e,D=1===i.h?i.s[l]:i.s[l]+(N[l]-i.s[l])*s,"multidimensional"===this.propType?r[l]=D:r=D}return t.lastIndex=c,r}function Cm(e){var t=e[0]*degToRads,r=e[1]*degToRads,n=e[2]*degToRads,i=Math.cos(t/2),o=Math.cos(r/2),s=Math.cos(n/2),a=Math.sin(t/2),c=Math.sin(r/2),l=Math.sin(n/2);return[a*c*s+i*o*l,a*o*s+i*c*l,i*c*s-a*o*l,i*o*s-a*c*l]}function Dm(){var e,t=this.comp.renderedFrame-this.offsetTime,r=this.keyframes[0].t-this.offsetTime,n=this.keyframes[this.keyframes.length-1].t-this.offsetTime;return t===this._caching.lastFrame||this._caching.lastFrame!==xm&&(this._caching.lastFrame>=n&&n<=t||this._caching.lastFrame<r&&t<r)||(this._caching.lastFrame>=t&&(this._caching._lastKeyframeIndex=-1,this._caching.lastIndex=0),e=this.interpolateValue(t,this._caching),this.pv=e),this._caching.lastFrame=t,this.pv}function Em(e){var t;if("unidimensional"===this.propType)t=e*this.mult,1e-5<ym(this.v-t)&&(this.v=t,this._mdf=!0);else for(var r=0,n=this.v.length;r<n;)t=e[r]*this.mult,1e-5<ym(this.v[r]-t)&&(this.v[r]=t,this._mdf=!0),r+=1}function Fm(){if(this.elem.globalData.frameId!==this.frameId&&this.effectsSequence.length)if(this.lock)this.setVValue(this.pv);else{this.lock=!0,this._mdf=this._isFirstFrame;for(var e=this.effectsSequence.length,t=this.kf?this.pv:this.data.k,r=0;r<e;r+=1)t=this.effectsSequence[r](t);this.setVValue(t),this._isFirstFrame=!1,this.lock=!1,this.frameId=this.elem.globalData.frameId}}function Gm(e){this.effectsSequence.push(e),this.container.addDynamicProperty(this)}function Hm(e,t,r,n){this.propType="unidimensional",this.mult=r||1,this.data=t,this.v=r?t.k*r:t.k,this.pv=t.k,this._mdf=!1,this.elem=e,this.container=n,this.comp=e.comp,this.k=!1,this.kf=!1,this.vel=0,this.effectsSequence=[],this._isFirstFrame=!0,this.getValue=Fm,this.setVValue=Em,this.addEffect=Gm}function Im(e,t,r,n){this.propType="multidimensional",this.mult=r||1,this.data=t,this._mdf=!1,this.elem=e,this.container=n,this.comp=e.comp,this.k=!1,this.kf=!1,this.frameId=-1;var i,o=t.k.length;for(this.v=createTypedArray("float32",o),this.pv=createTypedArray("float32",o),createTypedArray("float32",o),this.vel=createTypedArray("float32",o),i=0;i<o;i+=1)this.v[i]=t.k[i]*this.mult,this.pv[i]=t.k[i];this._isFirstFrame=!0,this.effectsSequence=[],this.getValue=Fm,this.setVValue=Em,this.addEffect=Gm}function Jm(e,t,r,n){this.propType="unidimensional",this.keyframes=t.k,this.offsetTime=e.data.st,this.frameId=-1,this._caching={lastFrame:xm,lastIndex:0,value:0,_lastKeyframeIndex:-1},this.k=!0,this.kf=!0,this.data=t,this.mult=r||1,this.elem=e,this.container=n,this.comp=e.comp,this.v=xm,this.pv=xm,this._isFirstFrame=!0,this.getValue=Fm,this.setVValue=Em,this.interpolateValue=zm,this.effectsSequence=[Dm.bind(this)],this.addEffect=Gm}function Km(e,t,r,n){this.propType="multidimensional";for(var i,o,s,a,c=t.k.length,l=0;l<c-1;l+=1)t.k[l].to&&t.k[l].s&&t.k[l+1]&&t.k[l+1].s&&(i=t.k[l].s,o=t.k[l+1].s,s=t.k[l].to,a=t.k[l].ti,(2===i.length&&(i[0]!==o[0]||i[1]!==o[1])&&bez.pointOnLine2D(i[0],i[1],o[0],o[1],i[0]+s[0],i[1]+s[1])&&bez.pointOnLine2D(i[0],i[1],o[0],o[1],o[0]+a[0],o[1]+a[1])||3===i.length&&(i[0]!==o[0]||i[1]!==o[1]||i[2]!==o[2])&&bez.pointOnLine3D(i[0],i[1],i[2],o[0],o[1],o[2],i[0]+s[0],i[1]+s[1],i[2]+s[2])&&bez.pointOnLine3D(i[0],i[1],i[2],o[0],o[1],o[2],o[0]+a[0],o[1]+a[1],o[2]+a[2]))&&(t.k[l].to=null,t.k[l].ti=null),i[0]===o[0]&&i[1]===o[1]&&0===s[0]&&0===s[1]&&0===a[0]&&0===a[1]&&(2===i.length||i[2]===o[2]&&0===s[2]&&0===a[2])&&(t.k[l].to=null,t.k[l].ti=null));this.effectsSequence=[Dm.bind(this)],this.keyframes=t.k,this.offsetTime=e.data.st,this.k=!0,this.kf=!0,this._isFirstFrame=!0,this.mult=r||1,this.elem=e,this.container=n,this.comp=e.comp,this.getValue=Fm,this.setVValue=Em,this.interpolateValue=zm,this.frameId=-1;var u=t.k[0].s.length;for(this.v=createTypedArray("float32",u),this.pv=createTypedArray("float32",u),l=0;l<u;l+=1)this.v[l]=xm,this.pv[l]=xm;this._caching={lastFrame:xm,lastIndex:0,value:createTypedArray("float32",u)},this.addEffect=Gm}var TransformPropertyFactory=(Yo=[0,0],cp.prototype={applyToMatrix:function(e){var t=this._mdf;this.iterateDynamicProperties(),this._mdf=this._mdf||t,this.a&&e.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.s&&e.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&e.skewFromAxis(-this.sk.v,this.sa.v),this.r?e.rotate(-this.r.v):e.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.data.p.s?this.data.p.z?e.translate(this.px.v,this.py.v,-this.pz.v):e.translate(this.px.v,this.py.v,0):e.translate(this.p.v[0],this.p.v[1],-this.p.v[2])},getValue:function(e){var t,r,n,i,o;this.elem.globalData.frameId!==this.frameId&&(this._isDirty&&(this.precalculateMatrix(),this._isDirty=!1),this.iterateDynamicProperties(),(this._mdf||e)&&(this.v.cloneFromProps(this.pre.props),this.appliedTransformations<1&&this.v.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations<2&&this.v.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&this.appliedTransformations<3&&this.v.skewFromAxis(-this.sk.v,this.sa.v),this.r&&this.appliedTransformations<4?this.v.rotate(-this.r.v):!this.r&&this.appliedTransformations<4&&this.v.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.autoOriented&&(o=this.elem.globalData.frameRate,this.p&&this.p.keyframes&&this.p.getValueAtTime?r=this.p._caching.lastFrame+this.p.offsetTime<=this.p.keyframes[0].t?(t=this.p.getValueAtTime((this.p.keyframes[0].t+.01)/o,0),this.p.getValueAtTime(this.p.keyframes[0].t/o,0)):this.p._caching.lastFrame+this.p.offsetTime>=this.p.keyframes[this.p.keyframes.length-1].t?(t=this.p.getValueAtTime(this.p.keyframes[this.p.keyframes.length-1].t/o,0),this.p.getValueAtTime((this.p.keyframes[this.p.keyframes.length-1].t-.05)/o,0)):(t=this.p.pv,this.p.getValueAtTime((this.p._caching.lastFrame+this.p.offsetTime-.01)/o,this.p.offsetTime)):this.px&&this.px.keyframes&&this.py.keyframes&&this.px.getValueAtTime&&this.py.getValueAtTime?(t=[],r=[],n=this.px,i=this.py,n._caching.lastFrame+n.offsetTime<=n.keyframes[0].t?(t[0]=n.getValueAtTime((n.keyframes[0].t+.01)/o,0),t[1]=i.getValueAtTime((i.keyframes[0].t+.01)/o,0),r[0]=n.getValueAtTime(n.keyframes[0].t/o,0),r[1]=i.getValueAtTime(i.keyframes[0].t/o,0)):n._caching.lastFrame+n.offsetTime>=n.keyframes[n.keyframes.length-1].t?(t[0]=n.getValueAtTime(n.keyframes[n.keyframes.length-1].t/o,0),t[1]=i.getValueAtTime(i.keyframes[i.keyframes.length-1].t/o,0),r[0]=n.getValueAtTime((n.keyframes[n.keyframes.length-1].t-.01)/o,0),r[1]=i.getValueAtTime((i.keyframes[i.keyframes.length-1].t-.01)/o,0)):(t=[n.pv,i.pv],r[0]=n.getValueAtTime((n._caching.lastFrame+n.offsetTime-.01)/o,n.offsetTime),r[1]=i.getValueAtTime((i._caching.lastFrame+i.offsetTime-.01)/o,i.offsetTime))):t=r=Yo,this.v.rotate(-Math.atan2(t[1]-r[1],t[0]-r[0]))),this.data.p&&this.data.p.s?this.data.p.z?this.v.translate(this.px.v,this.py.v,-this.pz.v):this.v.translate(this.px.v,this.py.v,0):this.v.translate(this.p.v[0],this.p.v[1],-this.p.v[2])),this.frameId=this.elem.globalData.frameId)},precalculateMatrix:function(){if(!this.a.k&&(this.pre.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations=1,!this.s.effectsSequence.length)){if(this.pre.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.appliedTransformations=2,this.sk){if(this.sk.effectsSequence.length||this.sa.effectsSequence.length)return;this.pre.skewFromAxis(-this.sk.v,this.sa.v),this.appliedTransformations=3}if(this.r){if(this.r.effectsSequence.length)return;this.pre.rotate(-this.r.v),this.appliedTransformations=4}else this.rz.effectsSequence.length||this.ry.effectsSequence.length||this.rx.effectsSequence.length||this.or.effectsSequence.length||(this.pre.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.appliedTransformations=4)}},autoOrient:function(){}},extendPrototype([DynamicPropertyContainer],cp),cp.prototype.addDynamicProperty=function(e){this._addDynamicProperty(e),this.elem.addDynamicProperty(e),this._isDirty=!0},cp.prototype._addDynamicProperty=DynamicPropertyContainer.prototype.addDynamicProperty,{getTransformProperty:function(e,t,r){return new cp(e,t,r)}}),Yo;function cp(e,t,r){if(this.elem=e,this.frameId=-1,this.propType="transform",this.data=t,this.v=new Matrix,this.pre=new Matrix,this.appliedTransformations=0,this.initDynamicPropertyContainer(r||e),t.p&&t.p.s?(this.px=PropertyFactory.getProp(e,t.p.x,0,0,this),this.py=PropertyFactory.getProp(e,t.p.y,0,0,this),t.p.z&&(this.pz=PropertyFactory.getProp(e,t.p.z,0,0,this))):this.p=PropertyFactory.getProp(e,t.p||{k:[0,0,0]},1,0,this),t.rx){if(this.rx=PropertyFactory.getProp(e,t.rx,0,degToRads,this),this.ry=PropertyFactory.getProp(e,t.ry,0,degToRads,this),this.rz=PropertyFactory.getProp(e,t.rz,0,degToRads,this),t.or.k[0].ti)for(var n=t.or.k.length,i=0;i<n;i+=1)t.or.k[i].to=t.or.k[i].ti=null;this.or=PropertyFactory.getProp(e,t.or,1,degToRads,this),this.or.sh=!0}else this.r=PropertyFactory.getProp(e,t.r||{k:0},0,degToRads,this);t.sk&&(this.sk=PropertyFactory.getProp(e,t.sk,0,degToRads,this),this.sa=PropertyFactory.getProp(e,t.sa,0,degToRads,this)),this.a=PropertyFactory.getProp(e,t.a||{k:[0,0,0]},1,0,this),this.s=PropertyFactory.getProp(e,t.s||{k:[100,100,100]},1,.01,this),t.o?this.o=PropertyFactory.getProp(e,t.o,0,.01,e):this.o={_mdf:!1,v:1},this._isDirty=!0,this.dynamicProperties.length||this.getValue(!0)}function ShapePath(){this.c=!1,this._length=0,this._maxLength=8,this.v=createSizedArray(this._maxLength),this.o=createSizedArray(this._maxLength),this.i=createSizedArray(this._maxLength)}ShapePath.prototype.setPathData=function(e,t){this.c=e,this.setLength(t);for(var r=0;r<t;)this.v[r]=point_pool.newElement(),this.o[r]=point_pool.newElement(),this.i[r]=point_pool.newElement(),r+=1},ShapePath.prototype.setLength=function(e){for(;this._maxLength<e;)this.doubleArrayLength();this._length=e},ShapePath.prototype.doubleArrayLength=function(){this.v=this.v.concat(createSizedArray(this._maxLength)),this.i=this.i.concat(createSizedArray(this._maxLength)),this.o=this.o.concat(createSizedArray(this._maxLength)),this._maxLength*=2},ShapePath.prototype.setXYAt=function(e,t,r,n,i){var o;switch(this._length=Math.max(this._length,n+1),this._length>=this._maxLength&&this.doubleArrayLength(),r){case"v":o=this.v;break;case"i":o=this.i;break;case"o":o=this.o}o[n]&&(!o[n]||i)||(o[n]=point_pool.newElement()),o[n][0]=e,o[n][1]=t},ShapePath.prototype.setTripleAt=function(e,t,r,n,i,o,s,a){this.setXYAt(e,t,"v",s,a),this.setXYAt(r,n,"o",s,a),this.setXYAt(i,o,"i",s,a)},ShapePath.prototype.reverse=function(){var e=new ShapePath;e.setPathData(this.c,this._length);var t=this.v,r=this.o,n=this.i,i=0;this.c&&(e.setTripleAt(t[0][0],t[0][1],n[0][0],n[0][1],r[0][0],r[0][1],0,!1),i=1);for(var o=this._length-1,s=this._length,a=i;a<s;a+=1)e.setTripleAt(t[o][0],t[o][1],n[o][0],n[o][1],r[o][0],r[o][1],a,!1),--o;return e};var ShapePropertyFactory=function(){var e=-999999;function t(e,t,r){var n,i,o,s,a,c,l,u=r.lastIndex,d=this.keyframes;if(e<d[0].t-this.offsetTime)n=d[0].s[0],i=!0,u=0;else if(e>=d[d.length-1].t-this.offsetTime)n=d[d.length-1].s?d[d.length-1].s[0]:d[d.length-2].e[0],i=!0;else{for(var h,f,p,m,v,g=u,_=d.length-1,y=!0;y&&(h=d[g],!((f=d[g+1]).t-this.offsetTime>e));)g<_-1?g+=1:y=!1;u=g,(i=1===h.h)||(m=e>=f.t-this.offsetTime?1:e<h.t-this.offsetTime?0:(h.__fnct?p=h.__fnct:(p=BezierFactory.getBezierEasing(h.o.x,h.o.y,h.i.x,h.i.y).get,h.__fnct=p),p((e-(h.t-this.offsetTime))/(f.t-this.offsetTime-(h.t-this.offsetTime)))),v=f.s?f.s[0]:h.e[0]),n=h.s[0]}for(a=t._length,c=n.i[0].length,r.lastIndex=u,o=0;o<a;o+=1)for(s=0;s<c;s+=1)l=i?n.i[o][s]:n.i[o][s]+(v.i[o][s]-n.i[o][s])*m,t.i[o][s]=l,l=i?n.o[o][s]:n.o[o][s]+(v.o[o][s]-n.o[o][s])*m,t.o[o][s]=l,l=i?n.v[o][s]:n.v[o][s]+(v.v[o][s]-n.v[o][s])*m,t.v[o][s]=l}function r(){this.paths=this.localShapeCollection}function n(e){!function(e,t){if(e._length===t._length&&e.c===t.c){for(var r=e._length,n=0;n<r;n+=1)if(e.v[n][0]!==t.v[n][0]||e.v[n][1]!==t.v[n][1]||e.o[n][0]!==t.o[n][0]||e.o[n][1]!==t.o[n][1]||e.i[n][0]!==t.i[n][0]||e.i[n][1]!==t.i[n][1])return;return 1}}(this.v,e)&&(this.v=shape_pool.clone(e),this.localShapeCollection.releaseShapes(),this.localShapeCollection.addShape(this.v),this._mdf=!0,this.paths=this.localShapeCollection)}function i(){if(this.elem.globalData.frameId!==this.frameId)if(this.effectsSequence.length)if(this.lock)this.setVValue(this.pv);else{this.lock=!0,this._mdf=!1;for(var e=this.kf?this.pv:this.data.ks?this.data.ks.k:this.data.pt.k,t=this.effectsSequence.length,r=0;r<t;r+=1)e=this.effectsSequence[r](e);this.setVValue(e),this.lock=!1,this.frameId=this.elem.globalData.frameId}else this._mdf=!1}function o(e,t,n){this.propType="shape",this.comp=e.comp,this.container=e,this.elem=e,this.data=t,this.k=!1,this.kf=!1,this._mdf=!1;var i=3===n?t.pt.k:t.ks.k;this.v=shape_pool.clone(i),this.pv=shape_pool.clone(this.v),this.localShapeCollection=shapeCollection_pool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.reset=r,this.effectsSequence=[]}function s(e){this.effectsSequence.push(e),this.container.addDynamicProperty(this)}function a(t,n,i){this.propType="shape",this.comp=t.comp,this.elem=t,this.container=t,this.offsetTime=t.data.st,this.keyframes=3===i?n.pt.k:n.ks.k,this.k=!0,this.kf=!0;var o=this.keyframes[0].s[0].i.length;this.keyframes[0].s[0].i[0].length,this.v=shape_pool.newElement(),this.v.setPathData(this.keyframes[0].s[0].c,o),this.pv=shape_pool.clone(this.v),this.localShapeCollection=shapeCollection_pool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.lastFrame=e,this.reset=r,this._caching={lastFrame:e,lastIndex:0},this.effectsSequence=[function(){var t=this.comp.renderedFrame-this.offsetTime,r=this.keyframes[0].t-this.offsetTime,n=this.keyframes[this.keyframes.length-1].t-this.offsetTime,i=this._caching.lastFrame;return i!==e&&(i<r&&t<r||n<i&&n<t)||(this._caching.lastIndex=i<t?this._caching.lastIndex:0,this.interpolateShape(t,this.pv,this._caching)),this._caching.lastFrame=t,this.pv}.bind(this)]}o.prototype.interpolateShape=t,o.prototype.getValue=i,o.prototype.setVValue=n,o.prototype.addEffect=s,a.prototype.getValue=i,a.prototype.interpolateShape=t,a.prototype.setVValue=n,a.prototype.addEffect=s;var c,l=(c=roundCorner,u.prototype={reset:r,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertEllToPath())},convertEllToPath:function(){var e=this.p.v[0],t=this.p.v[1],r=this.s.v[0]/2,n=this.s.v[1]/2,i=3!==this.d,o=this.v;o.v[0][0]=e,o.v[0][1]=t-n,o.v[1][0]=i?e+r:e-r,o.v[1][1]=t,o.v[2][0]=e,o.v[2][1]=t+n,o.v[3][0]=i?e-r:e+r,o.v[3][1]=t,o.i[0][0]=i?e-r*c:e+r*c,o.i[0][1]=t-n,o.i[1][0]=i?e+r:e-r,o.i[1][1]=t-n*c,o.i[2][0]=i?e+r*c:e-r*c,o.i[2][1]=t+n,o.i[3][0]=i?e-r:e+r,o.i[3][1]=t+n*c,o.o[0][0]=i?e+r*c:e-r*c,o.o[0][1]=t-n,o.o[1][0]=i?e+r:e-r,o.o[1][1]=t+n*c,o.o[2][0]=i?e-r*c:e+r*c,o.o[2][1]=t+n,o.o[3][0]=i?e-r:e+r,o.o[3][1]=t-n*c}},extendPrototype([DynamicPropertyContainer],u),u);function u(e,t){this.v=shape_pool.newElement(),this.v.setPathData(!0,4),this.localShapeCollection=shapeCollection_pool.newShapeCollection(),this.paths=this.localShapeCollection,this.localShapeCollection.addShape(this.v),this.d=t.d,this.elem=e,this.comp=e.comp,this.frameId=-1,this.initDynamicPropertyContainer(e),this.p=PropertyFactory.getProp(e,t.p,1,0,this),this.s=PropertyFactory.getProp(e,t.s,1,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertEllToPath())}var d=(h.prototype={reset:r,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertToPath())},convertStarToPath:function(){var e,t,r,n=2*Math.floor(this.pt.v),i=2*Math.PI/n,o=!0,s=this.or.v,a=this.ir.v,c=this.os.v,l=this.is.v,u=2*Math.PI*s/(2*n),d=2*Math.PI*a/(2*n),h=-Math.PI/2;h+=this.r.v;for(var f=3===this.data.d?-1:1,p=this.v._length=0;p<n;p+=1){t=o?c:l,r=o?u:d;var m=(e=o?s:a)*Math.cos(h),v=e*Math.sin(h),g=0===m&&0===v?0:v/Math.sqrt(m*m+v*v),_=0===m&&0===v?0:-m/Math.sqrt(m*m+v*v);m+=+this.p.v[0],v+=+this.p.v[1],this.v.setTripleAt(m,v,m-g*r*t*f,v-_*r*t*f,m+g*r*t*f,v+_*r*t*f,p,!0),o=!o,h+=i*f}},convertPolygonToPath:function(){var e,t=Math.floor(this.pt.v),r=2*Math.PI/t,n=this.or.v,i=this.os.v,o=2*Math.PI*n/(4*t),s=-Math.PI/2,a=3===this.data.d?-1:1;for(s+=this.r.v,e=this.v._length=0;e<t;e+=1){var c=n*Math.cos(s),l=n*Math.sin(s),u=0===c&&0===l?0:l/Math.sqrt(c*c+l*l),d=0===c&&0===l?0:-c/Math.sqrt(c*c+l*l);c+=+this.p.v[0],l+=+this.p.v[1],this.v.setTripleAt(c,l,c-u*o*i*a,l-d*o*i*a,c+u*o*i*a,l+d*o*i*a,e,!0),s+=r*a}this.paths.length=0,this.paths[0]=this.v}},extendPrototype([DynamicPropertyContainer],h),h);function h(e,t){this.v=shape_pool.newElement(),this.v.setPathData(!0,0),this.elem=e,this.comp=e.comp,this.data=t,this.frameId=-1,this.d=t.d,this.initDynamicPropertyContainer(e),1===t.sy?(this.ir=PropertyFactory.getProp(e,t.ir,0,0,this),this.is=PropertyFactory.getProp(e,t.is,0,.01,this),this.convertToPath=this.convertStarToPath):this.convertToPath=this.convertPolygonToPath,this.pt=PropertyFactory.getProp(e,t.pt,0,0,this),this.p=PropertyFactory.getProp(e,t.p,1,0,this),this.r=PropertyFactory.getProp(e,t.r,0,degToRads,this),this.or=PropertyFactory.getProp(e,t.or,0,0,this),this.os=PropertyFactory.getProp(e,t.os,0,.01,this),this.localShapeCollection=shapeCollection_pool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertToPath())}var f=(p.prototype={convertRectToPath:function(){var e=this.p.v[0],t=this.p.v[1],r=this.s.v[0]/2,n=this.s.v[1]/2,i=bm_min(r,n,this.r.v),o=i*(1-roundCorner);this.v._length=0,2===this.d||1===this.d?(this.v.setTripleAt(e+r,t-n+i,e+r,t-n+i,e+r,t-n+o,0,!0),this.v.setTripleAt(e+r,t+n-i,e+r,t+n-o,e+r,t+n-i,1,!0),0!==i?(this.v.setTripleAt(e+r-i,t+n,e+r-i,t+n,e+r-o,t+n,2,!0),this.v.setTripleAt(e-r+i,t+n,e-r+o,t+n,e-r+i,t+n,3,!0),this.v.setTripleAt(e-r,t+n-i,e-r,t+n-i,e-r,t+n-o,4,!0),this.v.setTripleAt(e-r,t-n+i,e-r,t-n+o,e-r,t-n+i,5,!0),this.v.setTripleAt(e-r+i,t-n,e-r+i,t-n,e-r+o,t-n,6,!0),this.v.setTripleAt(e+r-i,t-n,e+r-o,t-n,e+r-i,t-n,7,!0)):(this.v.setTripleAt(e-r,t+n,e-r+o,t+n,e-r,t+n,2),this.v.setTripleAt(e-r,t-n,e-r,t-n+o,e-r,t-n,3))):(this.v.setTripleAt(e+r,t-n+i,e+r,t-n+o,e+r,t-n+i,0,!0),0!==i?(this.v.setTripleAt(e+r-i,t-n,e+r-i,t-n,e+r-o,t-n,1,!0),this.v.setTripleAt(e-r+i,t-n,e-r+o,t-n,e-r+i,t-n,2,!0),this.v.setTripleAt(e-r,t-n+i,e-r,t-n+i,e-r,t-n+o,3,!0),this.v.setTripleAt(e-r,t+n-i,e-r,t+n-o,e-r,t+n-i,4,!0),this.v.setTripleAt(e-r+i,t+n,e-r+i,t+n,e-r+o,t+n,5,!0),this.v.setTripleAt(e+r-i,t+n,e+r-o,t+n,e+r-i,t+n,6,!0),this.v.setTripleAt(e+r,t+n-i,e+r,t+n-i,e+r,t+n-o,7,!0)):(this.v.setTripleAt(e-r,t-n,e-r+o,t-n,e-r,t-n,1,!0),this.v.setTripleAt(e-r,t+n,e-r,t+n-o,e-r,t+n,2,!0),this.v.setTripleAt(e+r,t+n,e+r-o,t+n,e+r,t+n,3,!0)))},getValue:function(e){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertRectToPath())},reset:r},extendPrototype([DynamicPropertyContainer],p),p);function p(e,t){this.v=shape_pool.newElement(),this.v.c=!0,this.localShapeCollection=shapeCollection_pool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.elem=e,this.comp=e.comp,this.frameId=-1,this.d=t.d,this.initDynamicPropertyContainer(e),this.p=PropertyFactory.getProp(e,t.p,1,0,this),this.s=PropertyFactory.getProp(e,t.s,1,0,this),this.r=PropertyFactory.getProp(e,t.r,0,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertRectToPath())}var m={getShapeProp:function(e,t,r){var n;return 3===r||4===r?n=new((3===r?t.pt:t.ks).k.length?a:o)(e,t,r):5===r?n=new f(e,t):6===r?n=new l(e,t):7===r&&(n=new d(e,t)),n.k&&e.addDynamicProperty(n),n},getConstructorFunction:function(){return o},getKeyframedConstructorFunction:function(){return a}};return m}(),ShapeModifiers=(fs={},gs={},fs.registerModifier=function(e,t){gs[e]||(gs[e]=t)},fs.getModifier=function(e,t,r){return new gs[e](t,r)},fs),fs,gs;function ShapeModifier(){}function TrimModifier(){}function RoundCornersModifier(){}function RepeaterModifier(){}function ShapeCollection(){this._length=0,this._maxLength=4,this.shapes=createSizedArray(this._maxLength)}function DashProperty(e,t,r,n){this.elem=e,this.frameId=-1,this.dataProps=createSizedArray(t.length),this.renderer=r,this.k=!1,this.dashStr="",this.dashArray=createTypedArray("float32",t.length?t.length-1:0),this.dashoffset=createTypedArray("float32",1),this.initDynamicPropertyContainer(n);for(var i,o=t.length||0,s=0;s<o;s+=1)i=PropertyFactory.getProp(e,t[s].v,0,0,this),this.k=i.k||this.k,this.dataProps[s]={n:t[s].n,p:i};this.k||this.getValue(!0),this._isAnimated=this.k}function GradientProperty(e,t,r){this.data=t,this.c=createTypedArray("uint8c",4*t.p);var n=t.k.k[0].s?t.k.k[0].s.length-4*t.p:t.k.k.length-4*t.p;this.o=createTypedArray("float32",n),this._cmdf=!1,this._omdf=!1,this._collapsable=this.checkCollapsable(),this._hasOpacity=n,this.initDynamicPropertyContainer(r),this.prop=PropertyFactory.getProp(e,t.k,1,null,this),this.k=this.prop.k,this.getValue(!0)}ShapeModifier.prototype.initModifierProperties=function(){},ShapeModifier.prototype.addShapeToModifier=function(){},ShapeModifier.prototype.addShape=function(e){var t;this.closed||(e.sh.container.addDynamicProperty(e.sh),t={shape:e.sh,data:e,localShapeCollection:shapeCollection_pool.newShapeCollection()},this.shapes.push(t),this.addShapeToModifier(t),this._isAnimated&&e.setAsAnimated())},ShapeModifier.prototype.init=function(e,t){this.shapes=[],this.elem=e,this.initDynamicPropertyContainer(e),this.initModifierProperties(e,t),this.frameId=initialDefaultFrame,this.closed=!1,this.k=!1,this.dynamicProperties.length?this.k=!0:this.getValue(!0)},ShapeModifier.prototype.processKeys=function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties())},extendPrototype([DynamicPropertyContainer],ShapeModifier),extendPrototype([ShapeModifier],TrimModifier),TrimModifier.prototype.initModifierProperties=function(e,t){this.s=PropertyFactory.getProp(e,t.s,0,.01,this),this.e=PropertyFactory.getProp(e,t.e,0,.01,this),this.o=PropertyFactory.getProp(e,t.o,0,0,this),this.sValue=0,this.eValue=0,this.getValue=this.processKeys,this.m=t.m,this._isAnimated=!!this.s.effectsSequence.length||!!this.e.effectsSequence.length||!!this.o.effectsSequence.length},TrimModifier.prototype.addShapeToModifier=function(e){e.pathsData=[]},TrimModifier.prototype.calculateShapeEdges=function(e,t,r,n,i){var o=[];t<=1?o.push({s:e,e:t}):1<=e?o.push({s:e-1,e:t-1}):(o.push({s:e,e:1}),o.push({s:0,e:t-1}));for(var s,a,c,l=[],u=o.length,d=0;d<u;d+=1)(c=o[d]).e*i<n||c.s*i>n+r||(s=c.s*i<=n?0:(c.s*i-n)/r,a=c.e*i>=n+r?1:(c.e*i-n)/r,l.push([s,a]));return l.length||l.push([0,0]),l},TrimModifier.prototype.releasePathsData=function(e){for(var t=e.length,r=0;r<t;r+=1)segments_length_pool.release(e[r]);return e.length=0,e},TrimModifier.prototype.processShapes=function(e){var t,r,n,i,o;this._mdf||e?((t=this.o.v%360/360)<0&&(t+=1),n=(1<this.s.v?1:this.s.v<0?0:this.s.v)+t,(i=(1<this.e.v?1:this.e.v<0?0:this.e.v)+t)<n&&(r=n,n=i,i=r),n=1e-4*Math.round(1e4*n),i=1e-4*Math.round(1e4*i),this.sValue=n,this.eValue=i):(n=this.sValue,i=this.eValue);var s,a,c,l,u,d=this.shapes.length,h=0;if(i===n)for(v=0;v<d;v+=1)this.shapes[v].localShapeCollection.releaseShapes(),this.shapes[v].shape._mdf=!0,this.shapes[v].shape.paths=this.shapes[v].localShapeCollection;else if(1===i&&0===n||0===i&&1===n){if(this._mdf)for(v=0;v<d;v+=1)this.shapes[v].pathsData.length=0,this.shapes[v].shape._mdf=!0}else{for(var f,p,m=[],v=0;v<d;v+=1)if((f=this.shapes[v]).shape._mdf||this._mdf||e||2===this.m){if(a=(o=f.shape.paths)._length,u=0,!f.shape._mdf&&f.pathsData.length)u=f.totalShapeLength;else{for(c=this.releasePathsData(f.pathsData),s=0;s<a;s+=1)l=bez.getSegmentsLength(o.shapes[s]),c.push(l),u+=l.totalLength;f.totalShapeLength=u,f.pathsData=c}h+=u,f.shape._mdf=!0}else f.shape.paths=f.localShapeCollection;var g,_=n,y=i,b=0;for(v=d-1;0<=v;--v)if((f=this.shapes[v]).shape._mdf){for((p=f.localShapeCollection).releaseShapes(),2===this.m&&1<d?(g=this.calculateShapeEdges(n,i,f.totalShapeLength,b,h),b+=f.totalShapeLength):g=[[_,y]],a=g.length,s=0;s<a;s+=1){_=g[s][0],y=g[s][1],m.length=0,y<=1?m.push({s:f.totalShapeLength*_,e:f.totalShapeLength*y}):1<=_?m.push({s:f.totalShapeLength*(_-1),e:f.totalShapeLength*(y-1)}):(m.push({s:f.totalShapeLength*_,e:f.totalShapeLength}),m.push({s:0,e:f.totalShapeLength*(y-1)}));var w,k=this.addShapes(f,m[0]);m[0].s!==m[0].e&&(1<m.length&&(k=f.shape.paths.shapes[f.shape.paths._length-1].c?(w=k.pop(),this.addPaths(k,p),this.addShapes(f,m[1],w)):(this.addPaths(k,p),this.addShapes(f,m[1]))),this.addPaths(k,p))}f.shape.paths=p}}},TrimModifier.prototype.addPaths=function(e,t){for(var r=e.length,n=0;n<r;n+=1)t.addShape(e[n])},TrimModifier.prototype.addSegment=function(e,t,r,n,i,o,s){i.setXYAt(t[0],t[1],"o",o),i.setXYAt(r[0],r[1],"i",o+1),s&&i.setXYAt(e[0],e[1],"v",o),i.setXYAt(n[0],n[1],"v",o+1)},TrimModifier.prototype.addSegmentFromArray=function(e,t,r,n){t.setXYAt(e[1],e[5],"o",r),t.setXYAt(e[2],e[6],"i",r+1),n&&t.setXYAt(e[0],e[4],"v",r),t.setXYAt(e[3],e[7],"v",r+1)},TrimModifier.prototype.addShapes=function(e,t,r){var n,i,o,s,a,c,l,u,d=e.pathsData,h=e.shape.paths.shapes,f=e.shape.paths._length,p=0,m=[],v=!0,g=r?(s=r._length,r._length):(r=shape_pool.newElement(),s=0);for(m.push(r),n=0;n<f;n+=1){for(a=d[n].lengths,r.c=h[n].c,o=h[n].c?a.length:a.length+1,i=1;i<o;i+=1)if(p+(u=a[i-1]).addedLength<t.s)p+=u.addedLength,r.c=!1;else{if(p>t.e){r.c=!1;break}t.s<=p&&t.e>=p+u.addedLength?(this.addSegment(h[n].v[i-1],h[n].o[i-1],h[n].i[i],h[n].v[i],r,s,v),v=!1):(c=bez.getNewSegment(h[n].v[i-1],h[n].v[i],h[n].o[i-1],h[n].i[i],(t.s-p)/u.addedLength,(t.e-p)/u.addedLength,a[i-1]),this.addSegmentFromArray(c,r,s,v),v=!1,r.c=!1),p+=u.addedLength,s+=1}if(h[n].c&&a.length&&(u=a[i-1],p<=t.e?(l=a[i-1].addedLength,t.s<=p&&t.e>=p+l?(this.addSegment(h[n].v[i-1],h[n].o[i-1],h[n].i[0],h[n].v[0],r,s,v),v=!1):(c=bez.getNewSegment(h[n].v[i-1],h[n].v[0],h[n].o[i-1],h[n].i[0],(t.s-p)/l,(t.e-p)/l,a[i-1]),this.addSegmentFromArray(c,r,s,v),v=!1,r.c=!1)):r.c=!1,p+=u.addedLength,s+=1),r._length&&(r.setXYAt(r.v[g][0],r.v[g][1],"i",g),r.setXYAt(r.v[r._length-1][0],r.v[r._length-1][1],"o",r._length-1)),p>t.e)break;n<f-1&&(r=shape_pool.newElement(),v=!0,m.push(r),s=0)}return m},ShapeModifiers.registerModifier("tm",TrimModifier),extendPrototype([ShapeModifier],RoundCornersModifier),RoundCornersModifier.prototype.initModifierProperties=function(e,t){this.getValue=this.processKeys,this.rd=PropertyFactory.getProp(e,t.r,0,null,this),this._isAnimated=!!this.rd.effectsSequence.length},RoundCornersModifier.prototype.processPath=function(e,t){var r=shape_pool.newElement();r.c=e.c;for(var n,i,o,s,a,c,l,u,d,h,f,p,m=e._length,v=0,g=0;g<m;g+=1)n=e.v[g],o=e.o[g],i=e.i[g],n[0]===o[0]&&n[1]===o[1]&&n[0]===i[0]&&n[1]===i[1]?0!==g&&g!==m-1||e.c?(s=0===g?e.v[m-1]:e.v[g-1],c=(a=Math.sqrt(Math.pow(n[0]-s[0],2)+Math.pow(n[1]-s[1],2)))?Math.min(a/2,t)/a:0,l=f=n[0]+(s[0]-n[0])*c,u=p=n[1]-(n[1]-s[1])*c,d=l-(l-n[0])*roundCorner,h=u-(u-n[1])*roundCorner,r.setTripleAt(l,u,d,h,f,p,v),v+=1,s=g===m-1?e.v[0]:e.v[g+1],c=(a=Math.sqrt(Math.pow(n[0]-s[0],2)+Math.pow(n[1]-s[1],2)))?Math.min(a/2,t)/a:0,l=d=n[0]+(s[0]-n[0])*c,u=h=n[1]+(s[1]-n[1])*c,f=l-(l-n[0])*roundCorner,p=u-(u-n[1])*roundCorner,r.setTripleAt(l,u,d,h,f,p,v)):r.setTripleAt(n[0],n[1],o[0],o[1],i[0],i[1],v):r.setTripleAt(e.v[g][0],e.v[g][1],e.o[g][0],e.o[g][1],e.i[g][0],e.i[g][1],v),v+=1;return r},RoundCornersModifier.prototype.processShapes=function(e){var t,r,n,i=this.shapes.length,o=this.rd.v;if(0!==o)for(var s,a,c=0;c<i;c+=1){if((s=this.shapes[c]).shape.paths,a=s.localShapeCollection,s.shape._mdf||this._mdf||e)for(a.releaseShapes(),s.shape._mdf=!0,t=s.shape.paths.shapes,n=s.shape.paths._length,r=0;r<n;r+=1)a.addShape(this.processPath(t[r],o));s.shape.paths=s.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)},ShapeModifiers.registerModifier("rd",RoundCornersModifier),extendPrototype([ShapeModifier],RepeaterModifier),RepeaterModifier.prototype.initModifierProperties=function(e,t){this.getValue=this.processKeys,this.c=PropertyFactory.getProp(e,t.c,0,null,this),this.o=PropertyFactory.getProp(e,t.o,0,null,this),this.tr=TransformPropertyFactory.getTransformProperty(e,t.tr,this),this.so=PropertyFactory.getProp(e,t.tr.so,0,.01,this),this.eo=PropertyFactory.getProp(e,t.tr.eo,0,.01,this),this.data=t,this.dynamicProperties.length||this.getValue(!0),this._isAnimated=!!this.dynamicProperties.length,this.pMatrix=new Matrix,this.rMatrix=new Matrix,this.sMatrix=new Matrix,this.tMatrix=new Matrix,this.matrix=new Matrix},RepeaterModifier.prototype.applyTransforms=function(e,t,r,n,i,o){var s=o?-1:1,a=n.s.v[0]+(1-n.s.v[0])*(1-i),c=n.s.v[1]+(1-n.s.v[1])*(1-i);e.translate(n.p.v[0]*s*i,n.p.v[1]*s*i,n.p.v[2]),t.translate(-n.a.v[0],-n.a.v[1],n.a.v[2]),t.rotate(-n.r.v*s*i),t.translate(n.a.v[0],n.a.v[1],n.a.v[2]),r.translate(-n.a.v[0],-n.a.v[1],n.a.v[2]),r.scale(o?1/a:a,o?1/c:c),r.translate(n.a.v[0],n.a.v[1],n.a.v[2])},RepeaterModifier.prototype.init=function(e,t,r,n){for(this.elem=e,this.arr=t,this.pos=r,this.elemsData=n,this._currentCopies=0,this._elements=[],this._groups=[],this.frameId=-1,this.initDynamicPropertyContainer(e),this.initModifierProperties(e,t[r]);0<r;)--r,this._elements.unshift(t[r]);this.dynamicProperties.length?this.k=!0:this.getValue(!0)},RepeaterModifier.prototype.resetElements=function(e){for(var t=e.length,r=0;r<t;r+=1)e[r]._processed=!1,"gr"===e[r].ty&&this.resetElements(e[r].it)},RepeaterModifier.prototype.cloneElements=function(e){e.length;var t=JSON.parse(JSON.stringify(e));return this.resetElements(t),t},RepeaterModifier.prototype.changeGroupRender=function(e,t){for(var r=e.length,n=0;n<r;n+=1)e[n]._render=t,"gr"===e[n].ty&&this.changeGroupRender(e[n].it,t)},RepeaterModifier.prototype.processShapes=function(e){var t,r,n,i,o;if(this._mdf||e){var s,a=Math.ceil(this.c.v);if(this._groups.length<a){for(;this._groups.length<a;){var c={it:this.cloneElements(this._elements),ty:"gr"};c.it.push({a:{a:0,ix:1,k:[0,0]},nm:"Transform",o:{a:0,ix:7,k:100},p:{a:0,ix:2,k:[0,0]},r:{a:1,ix:6,k:[{s:0,e:0,t:0},{s:0,e:0,t:1}]},s:{a:0,ix:3,k:[100,100]},sa:{a:0,ix:5,k:0},sk:{a:0,ix:4,k:0},ty:"tr"}),this.arr.splice(0,0,c),this._groups.splice(0,0,c),this._currentCopies+=1}this.elem.reloadShapes()}for(n=o=0;n<=this._groups.length-1;n+=1)s=o<a,this._groups[n]._render=s,this.changeGroupRender(this._groups[n].it,s),o+=1;this._currentCopies=a;var l=this.o.v,u=l%1,d=0<l?Math.floor(l):Math.ceil(l),h=(this.tr.v.props,this.pMatrix.props),f=this.rMatrix.props,p=this.sMatrix.props;this.pMatrix.reset(),this.rMatrix.reset(),this.sMatrix.reset(),this.tMatrix.reset(),this.matrix.reset();var m,v,g=0;if(0<l){for(;g<d;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),g+=1;u&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,u,!1),g+=u)}else if(l<0){for(;d<g;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!0),--g;u&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,-u,!0),g-=u)}for(n=1===this.data.m?0:this._currentCopies-1,i=1===this.data.m?1:-1,o=this._currentCopies;o;){if(v=(r=(t=this.elemsData[n].it)[t.length-1].transform.mProps.v.props).length,t[t.length-1].transform.mProps._mdf=!0,t[t.length-1].transform.op._mdf=!0,t[t.length-1].transform.op.v=this.so.v+(this.eo.v-this.so.v)*(n/(this._currentCopies-1)),0!==g){for((0!==n&&1===i||n!==this._currentCopies-1&&-1===i)&&this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),this.matrix.transform(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],f[9],f[10],f[11],f[12],f[13],f[14],f[15]),this.matrix.transform(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7],p[8],p[9],p[10],p[11],p[12],p[13],p[14],p[15]),this.matrix.transform(h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],h[8],h[9],h[10],h[11],h[12],h[13],h[14],h[15]),m=0;m<v;m+=1)r[m]=this.matrix.props[m];this.matrix.reset()}else for(this.matrix.reset(),m=0;m<v;m+=1)r[m]=this.matrix.props[m];g+=1,--o,n+=i}}else for(o=this._currentCopies,n=0,i=1;o;)r=(t=this.elemsData[n].it)[t.length-1].transform.mProps.v.props,t[t.length-1].transform.mProps._mdf=!1,t[t.length-1].transform.op._mdf=!1,--o,n+=i},RepeaterModifier.prototype.addShape=function(){},ShapeModifiers.registerModifier("rp",RepeaterModifier),ShapeCollection.prototype.addShape=function(e){this._length===this._maxLength&&(this.shapes=this.shapes.concat(createSizedArray(this._maxLength)),this._maxLength*=2),this.shapes[this._length]=e,this._length+=1},ShapeCollection.prototype.releaseShapes=function(){for(var e=0;e<this._length;e+=1)shape_pool.release(this.shapes[e]);this._length=0},DashProperty.prototype.getValue=function(e){if((this.elem.globalData.frameId!==this.frameId||e)&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf=this._mdf||e,this._mdf)){var t=0,r=this.dataProps.length;for("svg"===this.renderer&&(this.dashStr=""),t=0;t<r;t+=1)"o"!=this.dataProps[t].n?"svg"===this.renderer?this.dashStr+=" "+this.dataProps[t].p.v:this.dashArray[t]=this.dataProps[t].p.v:this.dashoffset[0]=this.dataProps[t].p.v}},extendPrototype([DynamicPropertyContainer],DashProperty),GradientProperty.prototype.comparePoints=function(e,t){for(var r=0,n=this.o.length/2;r<n;){if(.01<Math.abs(e[4*r]-e[4*t+2*r]))return!1;r+=1}return!0},GradientProperty.prototype.checkCollapsable=function(){if(this.o.length/2!=this.c.length/4)return!1;if(this.data.k.k[0].s)for(var e=0,t=this.data.k.k.length;e<t;){if(!this.comparePoints(this.data.k.k[e].s,this.data.p))return!1;e+=1}else if(!this.comparePoints(this.data.k.k,this.data.p))return!1;return!0},GradientProperty.prototype.getValue=function(e){if(this.prop.getValue(),this._mdf=!1,this._cmdf=!1,this._omdf=!1,this.prop._mdf||e){for(var t,r,n=4*this.data.p,i=0;i<n;i+=1)t=i%4==0?100:255,r=Math.round(this.prop.v[i]*t),this.c[i]!==r&&(this.c[i]=r,this._cmdf=!e);if(this.o.length)for(n=this.prop.v.length,i=4*this.data.p;i<n;i+=1)t=i%2==0?100:1,r=i%2==0?Math.round(100*this.prop.v[i]):this.prop.v[i],this.o[i-4*this.data.p]!==r&&(this.o[i-4*this.data.p]=r,this._omdf=!e);this._mdf=!e}},extendPrototype([DynamicPropertyContainer],GradientProperty);var buildShapeString=function(e,t,r,n){if(0===t)return"";for(var i=e.o,o=e.i,s=e.v,a=" M"+n.applyToPointStringified(s[0][0],s[0][1]),c=1;c<t;c+=1)a+=" C"+n.applyToPointStringified(i[c-1][0],i[c-1][1])+" "+n.applyToPointStringified(o[c][0],o[c][1])+" "+n.applyToPointStringified(s[c][0],s[c][1]);return r&&t&&(a+=" C"+n.applyToPointStringified(i[c-1][0],i[c-1][1])+" "+n.applyToPointStringified(o[0][0],o[0][1])+" "+n.applyToPointStringified(s[0][0],s[0][1]),a+="z"),a},ImagePreloader=(Wv=function(){var e=createTag("canvas");e.width=1,e.height=1;var t=e.getContext("2d");return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),e}(),gw.prototype={loadAssets:function(e,t){this.imagesLoadedCb=t;for(var r=e.length,n=0;n<r;n+=1)e[n].layers||(this.totalImages+=1,this.images.push(this._createImageData(e[n])))},setAssetsPath:function(e){this.assetsPath=e||""},setPath:function(e){this.path=e||""},loaded:function(){return this.totalImages===this.loadedAssets},destroy:function(){this.imagesLoadedCb=null,this.images.length=0},getImage:function(e){for(var t=0,r=this.images.length;t<r;){if(this.images[t].assetData===e)return this.images[t].img;t+=1}},createImgData:function(e){var t=Yv(e,this.assetsPath,this.path),r=createTag("img");r.crossOrigin="anonymous",r.addEventListener("load",this._imageLoaded,!1),r.addEventListener("error",function(){n.img=Wv,this._imageLoaded()}.bind(this),!1),r.src=t;var n={img:r,assetData:e};return n},createImageData:function(e){var t=Yv(e,this.assetsPath,this.path),r=createNS("image");r.addEventListener("load",this._imageLoaded,!1),r.addEventListener("error",function(){n.img=Wv,this._imageLoaded()}.bind(this),!1),r.setAttributeNS("http://www.w3.org/1999/xlink","href",t);var n={img:r,assetData:e};return n},imageLoaded:Xv,setCacheType:function(e){this._createImageData="svg"===e?this.createImageData.bind(this):this.createImgData.bind(this)}},gw),Wv;function Xv(){this.loadedAssets+=1,this.loadedAssets===this.totalImages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function Yv(e,t,r){var n,i="";return e.e?i=e.p:t?(-1!==(n=e.p).indexOf("images/")&&(n=n.split("/")[1]),i=t+n):(i=r,i+=e.u?e.u:"",i+=e.p),i}function gw(e){this._imageLoaded=Xv.bind(this),this.assetsPath="",this.path="",this.totalImages=0,this.loadedAssets=0,this.imagesLoadedCb=null,this.images=[]}var featureSupport=(Hw={maskType:!0},(/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge\/\d./i.test(navigator.userAgent))&&(Hw.maskType=!1),Hw),Hw,filtersFactory=(Iw={},Iw.createFilter=function(e){var t=createNS("filter");return t.setAttribute("id",e),t.setAttribute("filterUnits","objectBoundingBox"),t.setAttribute("x","0%"),t.setAttribute("y","0%"),t.setAttribute("width","100%"),t.setAttribute("height","100%"),t},Iw.createAlphaToLuminanceFilter=function(){var e=createNS("feColorMatrix");return e.setAttribute("type","matrix"),e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("values","0 0 0 1 0  0 0 0 1 0  0 0 0 1 0  0 0 0 1 1"),e},Iw),Iw,assetLoader={load:function(e,t,r){var n,i=new XMLHttpRequest;i.open("GET",e,!0);try{i.responseType="json"}catch(e){}i.send(),i.onreadystatechange=function(){if(4==i.readyState)if(200==i.status)n=Ow(i),t(n);else try{n=Ow(i),t(n)}catch(e){r&&r(e)}}}};function Ow(e){return e.response&&"object"==_typeof(e.response)?e.response:e.response&&"string"==typeof e.response?JSON.parse(e.response):e.responseText?JSON.parse(e.responseText):void 0}function TextAnimatorProperty(e,t,r){this._isFirstFrame=!0,this._hasMaskedPath=!1,this._frameId=-1,this._textData=e,this._renderType=t,this._elem=r,this._animatorsData=createSizedArray(this._textData.a.length),this._pathData={},this._moreOptions={alignment:{}},this.renderedLetters=[],this.lettersChangedFlag=!1,this.initDynamicPropertyContainer(r)}function TextAnimatorDataProperty(e,t,r){var n={propType:!1},i=PropertyFactory.getProp,o=t.a;this.a={r:o.r?i(e,o.r,0,degToRads,r):n,rx:o.rx?i(e,o.rx,0,degToRads,r):n,ry:o.ry?i(e,o.ry,0,degToRads,r):n,sk:o.sk?i(e,o.sk,0,degToRads,r):n,sa:o.sa?i(e,o.sa,0,degToRads,r):n,s:o.s?i(e,o.s,1,.01,r):n,a:o.a?i(e,o.a,1,0,r):n,o:o.o?i(e,o.o,0,.01,r):n,p:o.p?i(e,o.p,1,0,r):n,sw:o.sw?i(e,o.sw,0,0,r):n,sc:o.sc?i(e,o.sc,1,0,r):n,fc:o.fc?i(e,o.fc,1,0,r):n,fh:o.fh?i(e,o.fh,0,0,r):n,fs:o.fs?i(e,o.fs,0,.01,r):n,fb:o.fb?i(e,o.fb,0,.01,r):n,t:o.t?i(e,o.t,0,0,r):n},this.s=TextSelectorProp.getTextSelectorProp(e,t.s,r),this.s.t=t.s.t}function LetterProps(e,t,r,n,i,o){this.o=e,this.sw=t,this.sc=r,this.fc=n,this.m=i,this.p=o,this._mdf={o:!0,sw:!!t,sc:!!r,fc:!!n,m:!0,p:!0}}function TextProperty(e,t){this._frameId=initialDefaultFrame,this.pv="",this.v="",this.kf=!1,this._isFirstFrame=!0,this._mdf=!1,this.data=t,this.elem=e,this.comp=this.elem.comp,this.keysIndex=0,this.canResize=!1,this.minimumFontSize=1,this.effectsSequence=[],this.currentData={ascent:0,boxWidth:this.defaultBoxWidth,f:"",fStyle:"",fWeight:"",fc:"",j:"",justifyOffset:"",l:[],lh:0,lineWidths:[],ls:"",of:"",s:"",sc:"",sw:0,t:0,tr:0,sz:0,ps:null,fillColorAnim:!1,strokeColorAnim:!1,strokeWidthAnim:!1,yOffset:0,finalSize:0,finalText:[],finalLineHeight:0,__complete:!1},this.copyData(this.currentData,this.data.d.k[0].s),this.searchProperty()||this.completeTextData(this.currentData)}TextAnimatorProperty.prototype.searchProperties=function(){for(var e,t=this._textData.a.length,r=PropertyFactory.getProp,n=0;n<t;n+=1)e=this._textData.a[n],this._animatorsData[n]=new TextAnimatorDataProperty(this._elem,e,this);this._textData.p&&"m"in this._textData.p?(this._pathData={f:r(this._elem,this._textData.p.f,0,0,this),l:r(this._elem,this._textData.p.l,0,0,this),r:this._textData.p.r,m:this._elem.maskManager.getMaskProperty(this._textData.p.m)},this._hasMaskedPath=!0):this._hasMaskedPath=!1,this._moreOptions.alignment=r(this._elem,this._textData.m.a,1,0,this)},TextAnimatorProperty.prototype.getMeasures=function(e,t){if(this.lettersChangedFlag=t,this._mdf||this._isFirstFrame||t||this._hasMaskedPath&&this._pathData.m._mdf){this._isFirstFrame=!1;var r,n,i,o,s,a,c,l,u,d,h,f,p,m,v,g,_,y,b=this._moreOptions.alignment.v,w=this._animatorsData,k=this._textData,S=this.mHelper,E=this._renderType,C=this.renderedLetters.length,T=(this.data,e.l);if(this._hasMaskedPath){if(y=this._pathData.m,!this._pathData.n||this._pathData._mdf){var P,A=y.v;for(this._pathData.r&&(A=A.reverse()),o={tLength:0,segments:[]},i=A._length-1,se=v=0;se<i;se+=1)P=bez.buildBezierData(A.v[se],A.v[se+1],[A.o[se][0]-A.v[se][0],A.o[se][1]-A.v[se][1]],[A.i[se+1][0]-A.v[se+1][0],A.i[se+1][1]-A.v[se+1][1]]),o.tLength+=P.segmentLength,o.segments.push(P),v+=P.segmentLength;se=i,y.v.c&&(P=bez.buildBezierData(A.v[se],A.v[0],[A.o[se][0]-A.v[se][0],A.o[se][1]-A.v[se][1]],[A.i[0][0]-A.v[0][0],A.i[0][1]-A.v[0][1]]),o.tLength+=P.segmentLength,o.segments.push(P),v+=P.segmentLength),this._pathData.pi=o}if(o=this._pathData.pi,s=this._pathData.f.v,u=1,l=!(c=d=0),p=o.segments,s<0&&y.v.c)for(o.tLength<Math.abs(s)&&(s=-Math.abs(s)%o.tLength),u=(f=p[d=p.length-1].points).length-1;s<0;)s+=f[u].partialLength,--u<0&&(u=(f=p[--d].points).length-1);h=(f=p[d].points)[u-1],m=(a=f[u]).partialLength}i=T.length,n=r=0;var x,B,I,R,O,M,L,D,N,F,$,U,j,q,G,V,z=1.2*e.finalSize*.714,H=!0,W=w.length,K=-1,Z=s,Y=d,X=u,Q=-1,J="",ee=this.defaultPropsArray;if(2===e.j||1===e.j){for(var te=0,re=0,ne=2===e.j?-.5:-1,ie=0,oe=!0,se=0;se<i;se+=1)if(T[se].n){for(te&&(te+=re);ie<se;)T[ie].animatorJustifyOffset=te,ie+=1;oe=!(te=0)}else{for(ce=0;ce<W;ce+=1)(x=w[ce].a).t.propType&&(oe&&2===e.j&&(re+=x.t.v*ne),(I=w[ce].s.getMult(T[se].anIndexes[ce],k.a[ce].s.totalChars)).length?te+=x.t.v*I[0]*ne:te+=x.t.v*I*ne);oe=!1}for(te&&(te+=re);ie<se;)T[ie].animatorJustifyOffset=te,ie+=1}for(se=0;se<i;se+=1){if(S.reset(),L=1,T[se].n)r=0,n+=e.yOffset,n+=H?1:0,s=Z,H=!1,this._hasMaskedPath&&(u=X,h=(f=p[d=Y].points)[u-1],m=(a=f[u]).partialLength,c=0),G=U=q=J="",ee=this.defaultPropsArray;else{if(this._hasMaskedPath){if(Q!==T[se].line){switch(e.j){case 1:s+=v-e.lineWidths[T[se].line];break;case 2:s+=(v-e.lineWidths[T[se].line])/2}Q=T[se].line}K!==T[se].ind&&(T[K]&&(s+=T[K].extra),s+=T[se].an/2,K=T[se].ind),s+=b[0]*T[se].an/200;for(var ae=0,ce=0;ce<W;ce+=1)(x=w[ce].a).p.propType&&((I=w[ce].s.getMult(T[se].anIndexes[ce],k.a[ce].s.totalChars)).length?ae+=x.p.v[0]*I[0]:ae+=x.p.v[0]*I),x.a.propType&&((I=w[ce].s.getMult(T[se].anIndexes[ce],k.a[ce].s.totalChars)).length?ae+=x.a.v[0]*I[0]:ae+=x.a.v[0]*I);for(l=!0;l;)s+ae<=c+m||!f?(g=(s+ae-c)/a.partialLength,O=h.point[0]+(a.point[0]-h.point[0])*g,M=h.point[1]+(a.point[1]-h.point[1])*g,S.translate(-b[0]*T[se].an/200,-b[1]*z/100),l=!1):f&&(c+=a.partialLength,(u+=1)>=f.length&&(u=0,f=p[d+=1]?p[d].points:y.v.c?p[d=u=0].points:(c-=a.partialLength,null)),f&&(h=a,m=(a=f[u]).partialLength));R=T[se].an/2-T[se].add,S.translate(-R,0,0)}else R=T[se].an/2-T[se].add,S.translate(-R,0,0),S.translate(-b[0]*T[se].an/200,-b[1]*z/100,0);for(T[se].l,ce=0;ce<W;ce+=1)(x=w[ce].a).t.propType&&(I=w[ce].s.getMult(T[se].anIndexes[ce],k.a[ce].s.totalChars),0===r&&0===e.j||(this._hasMaskedPath?I.length?s+=x.t.v*I[0]:s+=x.t.v*I:I.length?r+=x.t.v*I[0]:r+=x.t.v*I));for(T[se].l,e.strokeWidthAnim&&(N=e.sw||0),e.strokeColorAnim&&(D=e.sc?[e.sc[0],e.sc[1],e.sc[2]]:[0,0,0]),e.fillColorAnim&&e.fc&&(F=[e.fc[0],e.fc[1],e.fc[2]]),ce=0;ce<W;ce+=1)(x=w[ce].a).a.propType&&((I=w[ce].s.getMult(T[se].anIndexes[ce],k.a[ce].s.totalChars)).length?S.translate(-x.a.v[0]*I[0],-x.a.v[1]*I[1],x.a.v[2]*I[2]):S.translate(-x.a.v[0]*I,-x.a.v[1]*I,x.a.v[2]*I));for(ce=0;ce<W;ce+=1)(x=w[ce].a).s.propType&&((I=w[ce].s.getMult(T[se].anIndexes[ce],k.a[ce].s.totalChars)).length?S.scale(1+(x.s.v[0]-1)*I[0],1+(x.s.v[1]-1)*I[1],1):S.scale(1+(x.s.v[0]-1)*I,1+(x.s.v[1]-1)*I,1));for(ce=0;ce<W;ce+=1){if(x=w[ce].a,I=w[ce].s.getMult(T[se].anIndexes[ce],k.a[ce].s.totalChars),x.sk.propType&&(I.length?S.skewFromAxis(-x.sk.v*I[0],x.sa.v*I[1]):S.skewFromAxis(-x.sk.v*I,x.sa.v*I)),x.r.propType&&(I.length?S.rotateZ(-x.r.v*I[2]):S.rotateZ(-x.r.v*I)),x.ry.propType&&(I.length?S.rotateY(x.ry.v*I[1]):S.rotateY(x.ry.v*I)),x.rx.propType&&(I.length?S.rotateX(x.rx.v*I[0]):S.rotateX(x.rx.v*I)),x.o.propType&&(I.length?L+=(x.o.v*I[0]-L)*I[0]:L+=(x.o.v*I-L)*I),e.strokeWidthAnim&&x.sw.propType&&(I.length?N+=x.sw.v*I[0]:N+=x.sw.v*I),e.strokeColorAnim&&x.sc.propType)for($=0;$<3;$+=1)I.length?D[$]=D[$]+(x.sc.v[$]-D[$])*I[0]:D[$]=D[$]+(x.sc.v[$]-D[$])*I;if(e.fillColorAnim&&e.fc){if(x.fc.propType)for($=0;$<3;$+=1)I.length?F[$]=F[$]+(x.fc.v[$]-F[$])*I[0]:F[$]=F[$]+(x.fc.v[$]-F[$])*I;x.fh.propType&&(F=I.length?addHueToRGB(F,x.fh.v*I[0]):addHueToRGB(F,x.fh.v*I)),x.fs.propType&&(F=I.length?addSaturationToRGB(F,x.fs.v*I[0]):addSaturationToRGB(F,x.fs.v*I)),x.fb.propType&&(F=I.length?addBrightnessToRGB(F,x.fb.v*I[0]):addBrightnessToRGB(F,x.fb.v*I))}}for(ce=0;ce<W;ce+=1)(x=w[ce].a).p.propType&&(I=w[ce].s.getMult(T[se].anIndexes[ce],k.a[ce].s.totalChars),this._hasMaskedPath?I.length?S.translate(0,x.p.v[1]*I[0],-x.p.v[2]*I[1]):S.translate(0,x.p.v[1]*I,-x.p.v[2]*I):I.length?S.translate(x.p.v[0]*I[0],x.p.v[1]*I[1],-x.p.v[2]*I[2]):S.translate(x.p.v[0]*I,x.p.v[1]*I,-x.p.v[2]*I));if(e.strokeWidthAnim&&(U=N<0?0:N),e.strokeColorAnim&&(j="rgb("+Math.round(255*D[0])+","+Math.round(255*D[1])+","+Math.round(255*D[2])+")"),e.fillColorAnim&&e.fc&&(q="rgb("+Math.round(255*F[0])+","+Math.round(255*F[1])+","+Math.round(255*F[2])+")"),this._hasMaskedPath)S.translate(0,-e.ls),S.translate(0,b[1]*z/100+n,0),k.p.p&&(_=(a.point[1]-h.point[1])/(a.point[0]-h.point[0]),V=180*Math.atan(_)/Math.PI,a.point[0]<h.point[0]&&(V+=180),S.rotate(-V*Math.PI/180)),S.translate(O,M,0),s-=b[0]*T[se].an/200,T[se+1]&&K!==T[se+1].ind&&(s+=T[se].an/2,s+=e.tr/1e3*e.finalSize);else{switch(S.translate(r,n,0),e.ps&&S.translate(e.ps[0],e.ps[1]+e.ascent,0),e.j){case 1:S.translate(T[se].animatorJustifyOffset+e.justifyOffset+(e.boxWidth-e.lineWidths[T[se].line]),0,0);break;case 2:S.translate(T[se].animatorJustifyOffset+e.justifyOffset+(e.boxWidth-e.lineWidths[T[se].line])/2,0,0)}S.translate(0,-e.ls),S.translate(R,0,0),S.translate(b[0]*T[se].an/200,b[1]*z/100,0),r+=T[se].l+e.tr/1e3*e.finalSize}"html"===E?J=S.toCSS():"svg"===E?J=S.to2dCSS():ee=[S.props[0],S.props[1],S.props[2],S.props[3],S.props[4],S.props[5],S.props[6],S.props[7],S.props[8],S.props[9],S.props[10],S.props[11],S.props[12],S.props[13],S.props[14],S.props[15]],G=L}C<=se?(B=new LetterProps(G,U,j,q,J,ee),this.renderedLetters.push(B),C+=1,this.lettersChangedFlag=!0):(B=this.renderedLetters[se],this.lettersChangedFlag=B.update(G,U,j,q,J,ee)||this.lettersChangedFlag)}}},TextAnimatorProperty.prototype.getValue=function(){this._elem.globalData.frameId!==this._frameId&&(this._frameId=this._elem.globalData.frameId,this.iterateDynamicProperties())},TextAnimatorProperty.prototype.mHelper=new Matrix,TextAnimatorProperty.prototype.defaultPropsArray=[],extendPrototype([DynamicPropertyContainer],TextAnimatorProperty),LetterProps.prototype.update=function(e,t,r,n,i,o){this._mdf.o=!1,this._mdf.sw=!1,this._mdf.sc=!1,this._mdf.fc=!1,this._mdf.m=!1;var s=this._mdf.p=!1;return this.o!==e&&(this.o=e,s=this._mdf.o=!0),this.sw!==t&&(this.sw=t,s=this._mdf.sw=!0),this.sc!==r&&(this.sc=r,s=this._mdf.sc=!0),this.fc!==n&&(this.fc=n,s=this._mdf.fc=!0),this.m!==i&&(this.m=i,s=this._mdf.m=!0),!o.length||this.p[0]===o[0]&&this.p[1]===o[1]&&this.p[4]===o[4]&&this.p[5]===o[5]&&this.p[12]===o[12]&&this.p[13]===o[13]||(this.p=o,s=this._mdf.p=!0),s},TextProperty.prototype.defaultBoxWidth=[0,0],TextProperty.prototype.copyData=function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},TextProperty.prototype.setCurrentData=function(e){e.__complete||this.completeTextData(e),this.currentData=e,this.currentData.boxWidth=this.currentData.boxWidth||this.defaultBoxWidth,this._mdf=!0},TextProperty.prototype.searchProperty=function(){return this.searchKeyframes()},TextProperty.prototype.searchKeyframes=function(){return this.kf=1<this.data.d.k.length,this.kf&&this.addEffect(this.getKeyframeValue.bind(this)),this.kf},TextProperty.prototype.addEffect=function(e){this.effectsSequence.push(e),this.elem.addDynamicProperty(this)},TextProperty.prototype.getValue=function(e){if(this.elem.globalData.frameId!==this.frameId&&this.effectsSequence.length||e){this.currentData.t=this.data.d.k[this.keysIndex].s.t;var t=this.currentData,r=this.keysIndex;if(this.lock)this.setCurrentData(this.currentData);else{this.lock=!0,this._mdf=!1;for(var n=this.effectsSequence.length,i=e||this.data.d.k[this.keysIndex].s,o=0;o<n;o+=1)i=r!==this.keysIndex?this.effectsSequence[o](i,i.t):this.effectsSequence[o](this.currentData,i.t);t!==i&&this.setCurrentData(i),this.pv=this.v=this.currentData,this.lock=!1,this.frameId=this.elem.globalData.frameId}}},TextProperty.prototype.getKeyframeValue=function(){for(var e=this.data.d.k,t=this.elem.comp.renderedFrame,r=0,n=e.length;r<=n-1&&(e[r].s,!(r===n-1||e[r+1].t>t));)r+=1;return this.keysIndex!==r&&(this.keysIndex=r),this.data.d.k[this.keysIndex].s},TextProperty.prototype.buildFinalText=function(e){for(var t,r=FontManager.getCombinedCharacterCodes(),n=[],i=0,o=e.length;i<o;)t=e.charCodeAt(i),-1!==r.indexOf(t)?n[n.length-1]+=e.charAt(i):55296<=t&&t<=56319&&56320<=(t=e.charCodeAt(i+1))&&t<=57343?(n.push(e.substr(i,2)),++i):n.push(e.charAt(i)),i+=1;return n},TextProperty.prototype.completeTextData=function(e){e.__complete=!0;var t,r,n,i=this.elem.globalData.fontManager,o=this.data,s=[],a=0,c=o.m.g,l=0,u=0,d=0,h=[],f=0,p=0,m=i.getFontByName(e.f),v=0,g=m.fStyle?m.fStyle.split(" "):[],_="normal",y="normal",b=g.length;for(x=0;x<b;x+=1)switch(g[x].toLowerCase()){case"italic":y="italic";break;case"bold":_="700";break;case"black":_="900";break;case"medium":_="500";break;case"regular":case"normal":_="400";break;case"light":case"thin":_="200"}e.fWeight=m.fWeight||_,e.fStyle=y,e.finalSize=e.s,e.finalText=this.buildFinalText(e.t),b=e.finalText.length,e.finalLineHeight=e.lh;var w,k=e.tr/1e3*e.finalSize;if(e.sz)for(var S,E,C=!0,T=e.sz[0],P=e.sz[1];C;){f=S=0,b=(E=this.buildFinalText(e.t)).length,k=e.tr/1e3*e.finalSize;for(var A=-1,x=0;x<b;x+=1)w=E[x].charCodeAt(0),t=!1," "===E[x]?A=x:13!==w&&3!==w||(t=!(f=0),S+=e.finalLineHeight||1.2*e.finalSize),T<f+(v=i.chars?(n=i.getCharData(E[x],m.fStyle,m.fFamily),t?0:n.w*e.finalSize/100):i.measureText(E[x],e.f,e.finalSize))&&" "!==E[x]?(-1===A?b+=1:x=A,S+=e.finalLineHeight||1.2*e.finalSize,E.splice(x,A===x?1:0,"\r"),A=-1,f=0):(f+=v,f+=k);S+=m.ascent*e.finalSize/100,this.canResize&&e.finalSize>this.minimumFontSize&&P<S?(--e.finalSize,e.finalLineHeight=e.finalSize*e.lh/e.s):(e.finalText=E,b=e.finalText.length,C=!1)}f=-k;var B,I=v=0;for(x=0;x<b;x+=1)if(t=!1,13===(w=(B=e.finalText[x]).charCodeAt(0))||3===w?(I=0,h.push(f),p=p<f?f:p,f=-2*k,t=!(r=""),d+=1):r=B,v=i.chars?(n=i.getCharData(B,m.fStyle,i.getFontByName(e.f).fFamily),t?0:n.w*e.finalSize/100):i.measureText(r,e.f,e.finalSize)," "===B?I+=v+k:(f+=v+k+I,I=0),s.push({l:v,an:v,add:l,n:t,anIndexes:[],val:r,line:d,animatorJustifyOffset:0}),2==c){if(l+=v,""===r||" "===r||x===b-1){for(""!==r&&" "!==r||(l-=v);u<=x;)s[u].an=l,s[u].ind=a,s[u].extra=v,u+=1;a+=1,l=0}}else if(3==c){if(l+=v,""===r||x===b-1){for(""===r&&(l-=v);u<=x;)s[u].an=l,s[u].ind=a,s[u].extra=v,u+=1;l=0,a+=1}}else s[a].ind=a,s[a].extra=0,a+=1;if(e.l=s,p=p<f?f:p,h.push(f),e.sz)e.boxWidth=e.sz[0],e.justifyOffset=0;else switch(e.boxWidth=p,e.j){case 1:e.justifyOffset=-e.boxWidth;break;case 2:e.justifyOffset=-e.boxWidth/2;break;default:e.justifyOffset=0}e.lineWidths=h;for(var R,O,M,L,D=o.a,N=D.length,F=[],$=0;$<N;$+=1){for((R=D[$]).a.sc&&(e.strokeColorAnim=!0),R.a.sw&&(e.strokeWidthAnim=!0),(R.a.fc||R.a.fh||R.a.fs||R.a.fb)&&(e.fillColorAnim=!0),L=0,M=R.s.b,x=0;x<b;x+=1)(O=s[x]).anIndexes[$]=L,(1==M&&""!==O.val||2==M&&""!==O.val&&" "!==O.val||3==M&&(O.n||" "==O.val||x==b-1)||4==M&&(O.n||x==b-1))&&(1===R.s.rn&&F.push(L),L+=1);o.a[$].s.totalChars=L;var U,j=-1;if(1===R.s.rn)for(x=0;x<b;x+=1)j!=(O=s[x]).anIndexes[$]&&(j=O.anIndexes[$],U=F.splice(Math.floor(Math.random()*F.length),1)[0]),O.anIndexes[$]=U}e.yOffset=e.finalLineHeight||1.2*e.finalSize,e.ls=e.ls||0,e.ascent=m.ascent*e.finalSize/100},TextProperty.prototype.updateDocumentData=function(e,t){t=void 0===t?this.keysIndex:t;var r=this.copyData({},this.data.d.k[t].s);r=this.copyData(r,e),this.data.d.k[t].s=r,this.recalculate(t),this.elem.addDynamicProperty(this)},TextProperty.prototype.recalculate=function(e){var t=this.data.d.k[e].s;t.__complete=!1,this.keysIndex=0,this._isFirstFrame=!0,this.getValue(t)},TextProperty.prototype.canResizeFont=function(e){this.canResize=e,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)},TextProperty.prototype.setMinimumFontSize=function(e){this.minimumFontSize=Math.floor(e)||1,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)};var TextSelectorProp=(cA=Math.max,dA=Math.min,eA=Math.floor,fA.prototype={getMult:function(e){this._currentTextLength!==this.elem.textProperty.currentData.l.length&&this.getValue();var t=0,r=0,n=1,i=1;0<this.ne.v?t=this.ne.v/100:r=-this.ne.v/100,0<this.xe.v?n=1-this.xe.v/100:i=1+this.xe.v/100;var o,s,a,c=BezierFactory.getBezierEasing(t,r,n,i).get,l=0,u=this.finalS,d=this.finalE,h=this.data.sh;return(l=2===h?c(l=d===u?d<=e?1:0:cA(0,dA(.5/(d-u)+(e-u)/(d-u),1))):3===h?c(l=d===u?d<=e?0:1:1-cA(0,dA(.5/(d-u)+(e-u)/(d-u),1))):4===h?(d===u?l=0:(l=cA(0,dA(.5/(d-u)+(e-u)/(d-u),1)))<.5?l*=2:l=1-2*(l-.5),c(l)):5===h?c(l=d===u?0:(s=-(o=d-u)/2+(e=dA(cA(0,e+.5-u),d-u)),a=o/2,Math.sqrt(1-s*s/(a*a)))):6===h?c(l=d===u?0:(e=dA(cA(0,e+.5-u),d-u),(1+Math.cos(Math.PI+2*Math.PI*e/(d-u)))/2)):(e>=eA(u)&&(l=cA(0,dA(e-u<0?dA(d,1)-(u-e):d-e,1))),c(l)))*this.a.v},getValue:function(e){this.iterateDynamicProperties(),this._mdf=e||this._mdf,this._currentTextLength=this.elem.textProperty.currentData.l.length||0,e&&2===this.data.r&&(this.e.v=this._currentTextLength);var t,r=2===this.data.r?1:100/this.data.totalChars,n=this.o.v/r,i=this.s.v/r+n,o=this.e.v/r+n;o<i&&(t=i,i=o,o=t),this.finalS=i,this.finalE=o}},extendPrototype([DynamicPropertyContainer],fA),{getTextSelectorProp:function(e,t,r){return new fA(e,t)}}),cA,dA,eA;function fA(e,t){this._currentTextLength=-1,this.k=!1,this.data=t,this.elem=e,this.comp=e.comp,this.finalS=0,this.finalE=0,this.initDynamicPropertyContainer(e),this.s=PropertyFactory.getProp(e,t.s||{k:0},0,0,this),this.e="e"in t?PropertyFactory.getProp(e,t.e,0,0,this):{v:100},this.o=PropertyFactory.getProp(e,t.o||{k:0},0,0,this),this.xe=PropertyFactory.getProp(e,t.xe||{k:0},0,0,this),this.ne=PropertyFactory.getProp(e,t.ne||{k:0},0,0,this),this.a=PropertyFactory.getProp(e,t.a,0,.01,this),this.dynamicProperties.length||this.getValue()}var pool_factory=function(e,t,r,n){var i=0,o=e,s=createSizedArray(o);return{newElement:function(){return i?s[--i]:t()},release:function(e){i===o&&(s=pooling.double(s),o*=2),r&&r(e),s[i]=e,i+=1}}},pooling={double:function(e){return e.concat(createSizedArray(e.length))}},point_pool=pool_factory(8,(function(){return createTypedArray("float32",2)})),shape_pool=(ZA=pool_factory(4,(function(){return new ShapePath}),(function(e){for(var t=e._length,r=0;r<t;r+=1)point_pool.release(e.v[r]),point_pool.release(e.i[r]),point_pool.release(e.o[r]),e.v[r]=null,e.i[r]=null,e.o[r]=null;e._length=0,e.c=!1})),ZA.clone=function(e){var t,r=ZA.newElement(),n=void 0===e._length?e.v.length:e._length;for(r.setLength(n),r.c=e.c,t=0;t<n;t+=1)r.setTripleAt(e.v[t][0],e.v[t][1],e.o[t][0],e.o[t][1],e.i[t][0],e.i[t][1],t);return r},ZA),ZA,shapeCollection_pool=(gB={newShapeCollection:function(){return hB?jB[--hB]:new ShapeCollection},release:function(e){var t,r=e._length;for(t=0;t<r;t+=1)shape_pool.release(e.shapes[t]);e._length=0,hB===iB&&(jB=pooling.double(jB),iB*=2),jB[hB]=e,hB+=1}},hB=0,iB=4,jB=createSizedArray(iB),gB),gB,hB,iB,jB,segments_length_pool=pool_factory(8,(function(){return{lengths:[],totalLength:0}}),(function(e){for(var t=e.lengths.length,r=0;r<t;r+=1)bezier_length_pool.release(e.lengths[r]);e.lengths.length=0})),bezier_length_pool=pool_factory(8,(function(){return{addedLength:0,percents:createTypedArray("float32",defaultCurveSegments),lengths:createTypedArray("float32",defaultCurveSegments)}}));function BaseRenderer(){}function SVGRenderer(e,t){this.animationItem=e,this.layers=null,this.renderedFrame=-1,this.svgElement=createNS("svg");var r,n,i,o,s="";t&&t.title&&(r=createNS("title"),n=createElementID(),r.setAttribute("id",n),r.textContent=t.title,this.svgElement.appendChild(r),s+=n),t&&t.description&&(i=createNS("desc"),o=createElementID(),i.setAttribute("id",o),i.textContent=t.description,this.svgElement.appendChild(i),s+=" "+o),s&&this.svgElement.setAttribute("aria-labelledby",s);var a=createNS("defs");this.svgElement.appendChild(a);var c=createNS("g");this.svgElement.appendChild(c),this.layerElement=c,this.renderConfig={preserveAspectRatio:t&&t.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:t&&t.imagePreserveAspectRatio||"xMidYMid slice",progressiveLoad:t&&t.progressiveLoad||!1,hideOnTransparent:!t||!1!==t.hideOnTransparent,viewBoxOnly:t&&t.viewBoxOnly||!1,viewBoxSize:t&&t.viewBoxSize||!1,className:t&&t.className||"",id:t&&t.id||"",focusable:t&&t.focusable,filterSize:{width:t&&t.filterSize&&t.filterSize.width||"100%",height:t&&t.filterSize&&t.filterSize.height||"100%",x:t&&t.filterSize&&t.filterSize.x||"0%",y:t&&t.filterSize&&t.filterSize.y||"0%"}},this.globalData={_mdf:!1,frameNum:-1,defs:a,renderConfig:this.renderConfig},this.elements=[],this.pendingElements=[],this.destroyed=!1,this.rendererType="svg"}function MaskElement(e,t,r){this.data=e,this.element=t,this.globalData=r,this.storedData=[],this.masksProperties=this.data.masksProperties||[],this.maskElement=null;var n=this.globalData.defs,i=this.masksProperties?this.masksProperties.length:0;this.viewData=createSizedArray(i),this.solidPath="";for(var o,s,a,c,l,u,d,h=this.masksProperties,f=0,p=[],m=createElementID(),v="clipPath",g="clip-path",_=0;_<i;_++)if(("a"!==h[_].mode&&"n"!==h[_].mode||h[_].inv||100!==h[_].o.k||h[_].o.x)&&(g=v="mask"),"s"!=h[_].mode&&"i"!=h[_].mode||0!==f?a=null:((a=createNS("rect")).setAttribute("fill","#ffffff"),a.setAttribute("width",this.element.comp.data.w||0),a.setAttribute("height",this.element.comp.data.h||0),p.push(a)),o=createNS("path"),"n"!=h[_].mode){if(f+=1,o.setAttribute("fill","s"===h[_].mode?"#000000":"#ffffff"),o.setAttribute("clip-rule","nonzero"),0!==h[_].x.k?(g=v="mask",u=PropertyFactory.getProp(this.element,h[_].x,0,null,this.element),d=createElementID(),(c=createNS("filter")).setAttribute("id",d),(l=createNS("feMorphology")).setAttribute("operator","erode"),l.setAttribute("in","SourceGraphic"),l.setAttribute("radius","0"),c.appendChild(l),n.appendChild(c),o.setAttribute("stroke","s"===h[_].mode?"#000000":"#ffffff")):u=l=null,this.storedData[_]={elem:o,x:u,expan:l,lastPath:"",lastOperator:"",filterId:d,lastRadius:0},"i"==h[_].mode){s=p.length;for(var y=createNS("g"),b=0;b<s;b+=1)y.appendChild(p[b]);var w=createNS("mask");w.setAttribute("mask-type","alpha"),w.setAttribute("id",m+"_"+f),w.appendChild(o),n.appendChild(w),y.setAttribute("mask","url("+locationHref+"#"+m+"_"+f+")"),p.length=0,p.push(y)}else p.push(o);h[_].inv&&!this.solidPath&&(this.solidPath=this.createLayerSolidPath()),this.viewData[_]={elem:o,lastPath:"",op:PropertyFactory.getProp(this.element,h[_].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,h[_],3),invRect:a},this.viewData[_].prop.k||this.drawPath(h[_],this.viewData[_].prop.v,this.viewData[_])}else this.viewData[_]={op:PropertyFactory.getProp(this.element,h[_].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,h[_],3),elem:o,lastPath:""},n.appendChild(o);for(this.maskElement=createNS(v),i=p.length,_=0;_<i;_+=1)this.maskElement.appendChild(p[_]);0<f&&(this.maskElement.setAttribute("id",m),this.element.maskedElement.setAttribute(g,"url("+locationHref+"#"+m+")"),n.appendChild(this.maskElement)),this.viewData.length&&this.element.addRenderableComponent(this)}function HierarchyElement(){}function FrameElement(){}function TransformElement(){}function RenderableElement(){}function RenderableDOMElement(){}function ProcessedElement(e,t){this.elem=e,this.pos=t}function SVGStyleData(e,t){this.data=e,this.type=e.ty,this.d="",this.lvl=t,this._mdf=!1,this.closed=!0===e.hd,this.pElem=createNS("path"),this.msElem=null}function SVGShapeData(e,t,r){this.caches=[],this.styles=[],this.transformers=e,this.lStr="",this.sh=r,this.lvl=t,this._isAnimated=!!r.k;for(var n=0,i=e.length;n<i;){if(e[n].mProps.dynamicProperties.length){this._isAnimated=!0;break}n+=1}}function SVGTransformData(e,t,r){this.transform={mProps:e,op:t,container:r},this.elements=[],this._isAnimated=this.transform.mProps.dynamicProperties.length||this.transform.op.effectsSequence.length}function SVGStrokeStyleData(e,t,r){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(e,t.o,0,.01,this),this.w=PropertyFactory.getProp(e,t.w,0,null,this),this.d=new DashProperty(e,t.d||{},"svg",this),this.c=PropertyFactory.getProp(e,t.c,1,255,this),this.style=r,this._isAnimated=!!this._isAnimated}function SVGFillStyleData(e,t,r){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(e,t.o,0,.01,this),this.c=PropertyFactory.getProp(e,t.c,1,255,this),this.style=r}function SVGGradientFillStyleData(e,t,r){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.initGradientData(e,t,r)}function SVGGradientStrokeStyleData(e,t,r){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.w=PropertyFactory.getProp(e,t.w,0,null,this),this.d=new DashProperty(e,t.d||{},"svg",this),this.initGradientData(e,t,r),this._isAnimated=!!this._isAnimated}function ShapeGroupData(){this.it=[],this.prevViewData=[],this.gr=createNS("g")}BaseRenderer.prototype.checkLayers=function(e){var t,r,n=this.layers.length;for(this.completeLayers=!0,t=n-1;0<=t;t--)this.elements[t]||(r=this.layers[t]).ip-r.st<=e-this.layers[t].st&&r.op-r.st>e-this.layers[t].st&&this.buildItem(t),this.completeLayers=!!this.elements[t]&&this.completeLayers;this.checkPendingElements()},BaseRenderer.prototype.createItem=function(e){switch(e.ty){case 2:return this.createImage(e);case 0:return this.createComp(e);case 1:return this.createSolid(e);case 3:return this.createNull(e);case 4:return this.createShape(e);case 5:return this.createText(e);case 13:return this.createCamera(e)}return this.createNull(e)},BaseRenderer.prototype.createCamera=function(){throw new Error("You're using a 3d camera. Try the html renderer.")},BaseRenderer.prototype.buildAllItems=function(){for(var e=this.layers.length,t=0;t<e;t+=1)this.buildItem(t);this.checkPendingElements()},BaseRenderer.prototype.includeLayers=function(e){this.completeLayers=!1;for(var t,r=e.length,n=this.layers.length,i=0;i<r;i+=1)for(t=0;t<n;){if(this.layers[t].id==e[i].id){this.layers[t]=e[i];break}t+=1}},BaseRenderer.prototype.setProjectInterface=function(e){this.globalData.projectInterface=e},BaseRenderer.prototype.initItems=function(){this.globalData.progressiveLoad||this.buildAllItems()},BaseRenderer.prototype.buildElementParenting=function(e,t,r){for(var n=this.elements,i=this.layers,o=0,s=i.length;o<s;)i[o].ind==t&&(n[o]&&!0!==n[o]?(r.push(n[o]),n[o].setAsParent(),void 0!==i[o].parent?this.buildElementParenting(e,i[o].parent,r):e.setHierarchy(r)):(this.buildItem(o),this.addPendingElement(e))),o+=1},BaseRenderer.prototype.addPendingElement=function(e){this.pendingElements.push(e)},BaseRenderer.prototype.searchExtraCompositions=function(e){for(var t,r=e.length,n=0;n<r;n+=1)e[n].xt&&((t=this.createComp(e[n])).initExpressions(),this.globalData.projectInterface.registerComposition(t))},BaseRenderer.prototype.setupGlobalData=function(e,t){this.globalData.fontManager=new FontManager,this.globalData.fontManager.addChars(e.chars),this.globalData.fontManager.addFonts(e.fonts,t),this.globalData.getAssetData=this.animationItem.getAssetData.bind(this.animationItem),this.globalData.getAssetsPath=this.animationItem.getAssetsPath.bind(this.animationItem),this.globalData.imageLoader=this.animationItem.imagePreloader,this.globalData.frameId=0,this.globalData.frameRate=e.fr,this.globalData.nm=e.nm,this.globalData.compSize={w:e.w,h:e.h}},extendPrototype([BaseRenderer],SVGRenderer),SVGRenderer.prototype.createNull=function(e){return new NullElement(e,this.globalData,this)},SVGRenderer.prototype.createShape=function(e){return new SVGShapeElement(e,this.globalData,this)},SVGRenderer.prototype.createText=function(e){return new SVGTextElement(e,this.globalData,this)},SVGRenderer.prototype.createImage=function(e){return new IImageElement(e,this.globalData,this)},SVGRenderer.prototype.createComp=function(e){return new SVGCompElement(e,this.globalData,this)},SVGRenderer.prototype.createSolid=function(e){return new ISolidElement(e,this.globalData,this)},SVGRenderer.prototype.configAnimation=function(e){this.svgElement.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.renderConfig.viewBoxSize?this.svgElement.setAttribute("viewBox",this.renderConfig.viewBoxSize):this.svgElement.setAttribute("viewBox","0 0 "+e.w+" "+e.h),this.renderConfig.viewBoxOnly||(this.svgElement.setAttribute("width",e.w),this.svgElement.setAttribute("height",e.h),this.svgElement.style.width="100%",this.svgElement.style.height="100%",this.svgElement.style.transform="translate3d(0,0,0)"),this.renderConfig.className&&this.svgElement.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.svgElement.setAttribute("id",this.renderConfig.id),void 0!==this.renderConfig.focusable&&this.svgElement.setAttribute("focusable",this.renderConfig.focusable),this.svgElement.setAttribute("preserveAspectRatio",this.renderConfig.preserveAspectRatio),this.animationItem.wrapper.appendChild(this.svgElement);var t=this.globalData.defs;this.setupGlobalData(e,t),this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.data=e;var r=createNS("clipPath"),n=createNS("rect");n.setAttribute("width",e.w),n.setAttribute("height",e.h),n.setAttribute("x",0),n.setAttribute("y",0);var i=createElementID();r.setAttribute("id",i),r.appendChild(n),this.layerElement.setAttribute("clip-path","url("+locationHref+"#"+i+")"),t.appendChild(r),this.layers=e.layers,this.elements=createSizedArray(e.layers.length)},SVGRenderer.prototype.destroy=function(){this.animationItem.wrapper.innerHTML="",this.layerElement=null,this.globalData.defs=null;for(var e=this.layers?this.layers.length:0,t=0;t<e;t++)this.elements[t]&&this.elements[t].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},SVGRenderer.prototype.updateContainerSize=function(){},SVGRenderer.prototype.buildItem=function(e){var t,r=this.elements;r[e]||99==this.layers[e].ty||(r[e]=!0,t=this.createItem(this.layers[e]),r[e]=t,expressionsPlugin&&(0===this.layers[e].ty&&this.globalData.projectInterface.registerComposition(t),t.initExpressions()),this.appendElementInPos(t,e),this.layers[e].tt&&(this.elements[e-1]&&!0!==this.elements[e-1]?t.setMatte(r[e-1].layerId):(this.buildItem(e-1),this.addPendingElement(t))))},SVGRenderer.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var e=this.pendingElements.pop();if(e.checkParenting(),e.data.tt)for(var t=0,r=this.elements.length;t<r;){if(this.elements[t]===e){e.setMatte(this.elements[t-1].layerId);break}t+=1}}},SVGRenderer.prototype.renderFrame=function(e){if(this.renderedFrame!==e&&!this.destroyed){null===e?e=this.renderedFrame:this.renderedFrame=e,this.globalData.frameNum=e,this.globalData.frameId+=1,this.globalData.projectInterface.currentFrame=e,this.globalData._mdf=!1;var t,r=this.layers.length;for(this.completeLayers||this.checkLayers(e),t=r-1;0<=t;t--)(this.completeLayers||this.elements[t])&&this.elements[t].prepareFrame(e-this.layers[t].st);if(this.globalData._mdf)for(t=0;t<r;t+=1)(this.completeLayers||this.elements[t])&&this.elements[t].renderFrame()}},SVGRenderer.prototype.appendElementInPos=function(e,t){var r=e.getBaseElement();if(r){for(var n,i=0;i<t;)this.elements[i]&&!0!==this.elements[i]&&this.elements[i].getBaseElement()&&(n=this.elements[i].getBaseElement()),i+=1;n?this.layerElement.insertBefore(r,n):this.layerElement.appendChild(r)}},SVGRenderer.prototype.hide=function(){this.layerElement.style.display="none"},SVGRenderer.prototype.show=function(){this.layerElement.style.display="block"},MaskElement.prototype.getMaskProperty=function(e){return this.viewData[e].prop},MaskElement.prototype.renderFrame=function(e){for(var t,r=this.element.finalTransform.mat,n=this.masksProperties.length,i=0;i<n;i++)(this.viewData[i].prop._mdf||e)&&this.drawPath(this.masksProperties[i],this.viewData[i].prop.v,this.viewData[i]),(this.viewData[i].op._mdf||e)&&this.viewData[i].elem.setAttribute("fill-opacity",this.viewData[i].op.v),"n"!==this.masksProperties[i].mode&&(this.viewData[i].invRect&&(this.element.finalTransform.mProp._mdf||e)&&this.viewData[i].invRect.setAttribute("transform",r.getInverseMatrix().to2dCSS()),this.storedData[i].x&&(this.storedData[i].x._mdf||e)&&(t=this.storedData[i].expan,this.storedData[i].x.v<0?("erode"!==this.storedData[i].lastOperator&&(this.storedData[i].lastOperator="erode",this.storedData[i].elem.setAttribute("filter","url("+locationHref+"#"+this.storedData[i].filterId+")")),t.setAttribute("radius",-this.storedData[i].x.v)):("dilate"!==this.storedData[i].lastOperator&&(this.storedData[i].lastOperator="dilate",this.storedData[i].elem.setAttribute("filter",null)),this.storedData[i].elem.setAttribute("stroke-width",2*this.storedData[i].x.v))))},MaskElement.prototype.getMaskelement=function(){return this.maskElement},MaskElement.prototype.createLayerSolidPath=function(){var e="M0,0 ";return e+=" h"+this.globalData.compSize.w,e+=" v"+this.globalData.compSize.h,(e+=" h-"+this.globalData.compSize.w)+" v-"+this.globalData.compSize.h+" "},MaskElement.prototype.drawPath=function(e,t,r){for(var n,i=" M"+t.v[0][0]+","+t.v[0][1],o=t._length,s=1;s<o;s+=1)i+=" C"+t.o[s-1][0]+","+t.o[s-1][1]+" "+t.i[s][0]+","+t.i[s][1]+" "+t.v[s][0]+","+t.v[s][1];t.c&&1<o&&(i+=" C"+t.o[s-1][0]+","+t.o[s-1][1]+" "+t.i[0][0]+","+t.i[0][1]+" "+t.v[0][0]+","+t.v[0][1]),r.lastPath!==i&&(n="",r.elem&&(t.c&&(n=e.inv?this.solidPath+i:i),r.elem.setAttribute("d",n)),r.lastPath=i)},MaskElement.prototype.destroy=function(){this.element=null,this.globalData=null,this.maskElement=null,this.data=null,this.masksProperties=null},HierarchyElement.prototype={initHierarchy:function(){this.hierarchy=[],this._isParent=!1,this.checkParenting()},setHierarchy:function(e){this.hierarchy=e},setAsParent:function(){this._isParent=!0},checkParenting:function(){void 0!==this.data.parent&&this.comp.buildElementParenting(this,this.data.parent,[])}},FrameElement.prototype={initFrame:function(){this._isFirstFrame=!1,this.dynamicProperties=[],this._mdf=!1},prepareProperties:function(e,t){for(var r=this.dynamicProperties.length,n=0;n<r;n+=1)(t||this._isParent&&"transform"===this.dynamicProperties[n].propType)&&(this.dynamicProperties[n].getValue(),this.dynamicProperties[n]._mdf&&(this.globalData._mdf=!0,this._mdf=!0))},addDynamicProperty:function(e){-1===this.dynamicProperties.indexOf(e)&&this.dynamicProperties.push(e)}},TransformElement.prototype={initTransform:function(){this.finalTransform={mProp:this.data.ks?TransformPropertyFactory.getTransformProperty(this,this.data.ks,this):{o:0},_matMdf:!1,_opMdf:!1,mat:new Matrix},this.data.ao&&(this.finalTransform.mProp.autoOriented=!0),this.data.ty},renderTransform:function(){if(this.finalTransform._opMdf=this.finalTransform.mProp.o._mdf||this._isFirstFrame,this.finalTransform._matMdf=this.finalTransform.mProp._mdf||this._isFirstFrame,this.hierarchy){var e,t=this.finalTransform.mat,r=0,n=this.hierarchy.length;if(!this.finalTransform._matMdf)for(;r<n;){if(this.hierarchy[r].finalTransform.mProp._mdf){this.finalTransform._matMdf=!0;break}r+=1}if(this.finalTransform._matMdf)for(e=this.finalTransform.mProp.v.props,t.cloneFromProps(e),r=0;r<n;r+=1)e=this.hierarchy[r].finalTransform.mProp.v.props,t.transform(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}},globalToLocal:function(e){var t=[];t.push(this.finalTransform);for(var r=!0,n=this.comp;r;)n.finalTransform?(n.data.hasMask&&t.splice(0,0,n.finalTransform),n=n.comp):r=!1;for(var i,o=t.length,s=0;s<o;s+=1)i=t[s].mat.applyToPointArray(0,0,0),e=[e[0]-i[0],e[1]-i[1],0];return e},mHelper:new Matrix},RenderableElement.prototype={initRenderable:function(){this.isInRange=!1,this.hidden=!1,this.isTransparent=!1,this.renderableComponents=[]},addRenderableComponent:function(e){-1===this.renderableComponents.indexOf(e)&&this.renderableComponents.push(e)},removeRenderableComponent:function(e){-1!==this.renderableComponents.indexOf(e)&&this.renderableComponents.splice(this.renderableComponents.indexOf(e),1)},prepareRenderableFrame:function(e){this.checkLayerLimits(e)},checkTransparency:function(){this.finalTransform.mProp.o.v<=0?!this.isTransparent&&this.globalData.renderConfig.hideOnTransparent&&(this.isTransparent=!0,this.hide()):this.isTransparent&&(this.isTransparent=!1,this.show())},checkLayerLimits:function(e){this.data.ip-this.data.st<=e&&this.data.op-this.data.st>e?!0!==this.isInRange&&(this.globalData._mdf=!0,this._mdf=!0,this.isInRange=!0,this.show()):!1!==this.isInRange&&(this.globalData._mdf=!0,this.isInRange=!1,this.hide())},renderRenderable:function(){for(var e=this.renderableComponents.length,t=0;t<e;t+=1)this.renderableComponents[t].renderFrame(this._isFirstFrame)},sourceRectAtTime:function(){return{top:0,left:0,width:100,height:100}},getLayerSize:function(){return 5===this.data.ty?{w:this.data.textData.width,h:this.data.textData.height}:{w:this.data.width,h:this.data.height}}},extendPrototype([RenderableElement,createProxyFunction({initElement:function(e,t,r){this.initFrame(),this.initBaseData(e,t,r),this.initTransform(e,t,r),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide()},hide:function(){this.hidden||this.isInRange&&!this.isTransparent||((this.baseElement||this.layerElement).style.display="none",this.hidden=!0)},show:function(){this.isInRange&&!this.isTransparent&&(this.data.hd||((this.baseElement||this.layerElement).style.display="block"),this.hidden=!1,this._isFirstFrame=!0)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},renderInnerContent:function(){},prepareFrame:function(e){this._mdf=!1,this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange),this.checkTransparency()},destroy:function(){this.innerElem=null,this.destroyBaseElement()}})],RenderableDOMElement),SVGStyleData.prototype.reset=function(){this.d="",this._mdf=!1},SVGShapeData.prototype.setAsAnimated=function(){this._isAnimated=!0},extendPrototype([DynamicPropertyContainer],SVGStrokeStyleData),extendPrototype([DynamicPropertyContainer],SVGFillStyleData),SVGGradientFillStyleData.prototype.initGradientData=function(e,t,r){this.o=PropertyFactory.getProp(e,t.o,0,.01,this),this.s=PropertyFactory.getProp(e,t.s,1,null,this),this.e=PropertyFactory.getProp(e,t.e,1,null,this),this.h=PropertyFactory.getProp(e,t.h||{k:0},0,.01,this),this.a=PropertyFactory.getProp(e,t.a||{k:0},0,degToRads,this),this.g=new GradientProperty(e,t.g,this),this.style=r,this.stops=[],this.setGradientData(r.pElem,t),this.setGradientOpacity(t,r),this._isAnimated=!!this._isAnimated},SVGGradientFillStyleData.prototype.setGradientData=function(e,t){var r=createElementID(),n=createNS(1===t.t?"linearGradient":"radialGradient");n.setAttribute("id",r),n.setAttribute("spreadMethod","pad"),n.setAttribute("gradientUnits","userSpaceOnUse");for(var i,o=[],s=4*t.g.p,a=0;a<s;a+=4)i=createNS("stop"),n.appendChild(i),o.push(i);e.setAttribute("gf"===t.ty?"fill":"stroke","url("+locationHref+"#"+r+")"),this.gf=n,this.cst=o},SVGGradientFillStyleData.prototype.setGradientOpacity=function(e,t){if(this.g._hasOpacity&&!this.g._collapsable){var r,n,i=createNS("mask"),o=createNS("path");i.appendChild(o);var s=createElementID(),a=createElementID();i.setAttribute("id",a);var c=createNS(1===e.t?"linearGradient":"radialGradient");c.setAttribute("id",s),c.setAttribute("spreadMethod","pad"),c.setAttribute("gradientUnits","userSpaceOnUse"),n=e.g.k.k[0].s?e.g.k.k[0].s.length:e.g.k.k.length;for(var l=this.stops,u=4*e.g.p;u<n;u+=2)(r=createNS("stop")).setAttribute("stop-color","rgb(255,255,255)"),c.appendChild(r),l.push(r);o.setAttribute("gf"===e.ty?"fill":"stroke","url("+locationHref+"#"+s+")"),this.of=c,this.ms=i,this.ost=l,this.maskId=a,t.msElem=o}},extendPrototype([DynamicPropertyContainer],SVGGradientFillStyleData),extendPrototype([SVGGradientFillStyleData,DynamicPropertyContainer],SVGGradientStrokeStyleData);var SVGElementsRenderer=(JE=new Matrix,KE=new Matrix,{createRenderFunction:function(e){switch(e.ty,e.ty){case"fl":return PE;case"gf":return RE;case"gs":return QE;case"st":return SE;case"sh":case"el":case"rc":case"sr":return OE;case"tr":return NE}}}),JE,KE;function NE(e,t,r){(r||t.transform.op._mdf)&&t.transform.container.setAttribute("opacity",t.transform.op.v),(r||t.transform.mProps._mdf)&&t.transform.container.setAttribute("transform",t.transform.mProps.v.to2dCSS())}function OE(e,t,r){for(var n,i,o,s,a,c,l,u,d,h,f=t.styles.length,p=t.lvl,m=0;m<f;m+=1){if(s=t.sh._mdf||r,t.styles[m].lvl<p){for(l=KE.reset(),d=p-t.styles[m].lvl,h=t.transformers.length-1;!s&&0<d;)s=t.transformers[h].mProps._mdf||s,d--,h--;if(s)for(d=p-t.styles[m].lvl,h=t.transformers.length-1;0<d;)u=t.transformers[h].mProps.v.props,l.transform(u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],u[8],u[9],u[10],u[11],u[12],u[13],u[14],u[15]),d--,h--}else l=JE;if(i=(c=t.sh.paths)._length,s){for(o="",n=0;n<i;n+=1)(a=c.shapes[n])&&a._length&&(o+=buildShapeString(a,a._length,a.c,l));t.caches[m]=o}else o=t.caches[m];t.styles[m].d+=!0===e.hd?"":o,t.styles[m]._mdf=s||t.styles[m]._mdf}}function PE(e,t,r){var n=t.style;(t.c._mdf||r)&&n.pElem.setAttribute("fill","rgb("+bm_floor(t.c.v[0])+","+bm_floor(t.c.v[1])+","+bm_floor(t.c.v[2])+")"),(t.o._mdf||r)&&n.pElem.setAttribute("fill-opacity",t.o.v)}function QE(e,t,r){RE(e,t,r),SE(0,t,r)}function RE(e,t,r){var n,i,o,s,a,c,l,u,d,h=t.gf,f=t.g._hasOpacity,p=t.s.v,m=t.e.v;if((t.o._mdf||r)&&(n="gf"===e.ty?"fill-opacity":"stroke-opacity",t.style.pElem.setAttribute(n,t.o.v)),(t.s._mdf||r)&&(o="x1"==(i=1===e.t?"x1":"cx")?"y1":"cy",h.setAttribute(i,p[0]),h.setAttribute(o,p[1]),f&&!t.g._collapsable&&(t.of.setAttribute(i,p[0]),t.of.setAttribute(o,p[1]))),t.g._cmdf||r){y=t.cst;for(var v=t.g.c,g=y.length,_=0;_<g;_+=1)(s=y[_]).setAttribute("offset",v[4*_]+"%"),s.setAttribute("stop-color","rgb("+v[4*_+1]+","+v[4*_+2]+","+v[4*_+3]+")")}if(f&&(t.g._omdf||r)){var y,b=t.g.o;for(g=(y=t.g._collapsable?t.cst:t.ost).length,_=0;_<g;_+=1)s=y[_],t.g._collapsable||s.setAttribute("offset",b[2*_]+"%"),s.setAttribute("stop-opacity",b[2*_+1])}1===e.t?(t.e._mdf||r)&&(h.setAttribute("x2",m[0]),h.setAttribute("y2",m[1]),f&&!t.g._collapsable&&(t.of.setAttribute("x2",m[0]),t.of.setAttribute("y2",m[1]))):((t.s._mdf||t.e._mdf||r)&&(a=Math.sqrt(Math.pow(p[0]-m[0],2)+Math.pow(p[1]-m[1],2)),h.setAttribute("r",a),f&&!t.g._collapsable&&t.of.setAttribute("r",a)),(t.e._mdf||t.h._mdf||t.a._mdf||r)&&(a=a||Math.sqrt(Math.pow(p[0]-m[0],2)+Math.pow(p[1]-m[1],2)),c=Math.atan2(m[1]-p[1],m[0]-p[0]),l=a*(1<=t.h.v?.99:t.h.v<=-1?-.99:t.h.v),u=Math.cos(c+t.a.v)*l+p[0],d=Math.sin(c+t.a.v)*l+p[1],h.setAttribute("fx",u),h.setAttribute("fy",d),f&&!t.g._collapsable&&(t.of.setAttribute("fx",u),t.of.setAttribute("fy",d))))}function SE(e,t,r){var n=t.style,i=t.d;i&&(i._mdf||r)&&i.dashStr&&(n.pElem.setAttribute("stroke-dasharray",i.dashStr),n.pElem.setAttribute("stroke-dashoffset",i.dashoffset[0])),t.c&&(t.c._mdf||r)&&n.pElem.setAttribute("stroke","rgb("+bm_floor(t.c.v[0])+","+bm_floor(t.c.v[1])+","+bm_floor(t.c.v[2])+")"),(t.o._mdf||r)&&n.pElem.setAttribute("stroke-opacity",t.o.v),(t.w._mdf||r)&&(n.pElem.setAttribute("stroke-width",t.w.v),n.msElem&&n.msElem.setAttribute("stroke-width",t.w.v))}function ShapeTransformManager(){this.sequences={},this.sequenceList=[],this.transform_key_count=0}function BaseElement(){}function NullElement(e,t,r){this.initFrame(),this.initBaseData(e,t,r),this.initFrame(),this.initTransform(e,t,r),this.initHierarchy()}function SVGBaseElement(){}function IShapeElement(){}function ITextElement(){}function ICompElement(){}function IImageElement(e,t,r){this.assetData=t.getAssetData(e.refId),this.initElement(e,t,r),this.sourceRect={top:0,left:0,width:this.assetData.w,height:this.assetData.h}}function ISolidElement(e,t,r){this.initElement(e,t,r)}function SVGCompElement(e,t,r){this.layers=e.layers,this.supports3d=!0,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(e,t,r),this.tm=e.tm?PropertyFactory.getProp(this,e.tm,0,t.frameRate,this):{_placeholder:!0}}function SVGTextElement(e,t,r){this.textSpans=[],this.renderType="svg",this.initElement(e,t,r)}function SVGShapeElement(e,t,r){this.shapes=[],this.shapesData=e.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.initElement(e,t,r),this.prevViewData=[]}function SVGTintFilter(e,t){this.filterManager=t;var r,n,i=createNS("feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("color-interpolation-filters","linearRGB"),i.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),i.setAttribute("result","f1"),e.appendChild(i),(i=createNS("feColorMatrix")).setAttribute("type","matrix"),i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),i.setAttribute("result","f2"),e.appendChild(i),this.matrixFilter=i,100===t.effectElements[2].p.v&&!t.effectElements[2].p.k||(r=createNS("feMerge"),e.appendChild(r),(n=createNS("feMergeNode")).setAttribute("in","SourceGraphic"),r.appendChild(n),(n=createNS("feMergeNode")).setAttribute("in","f2"),r.appendChild(n))}function SVGFillFilter(e,t){this.filterManager=t;var r=createNS("feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("color-interpolation-filters","sRGB"),r.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),e.appendChild(r),this.matrixFilter=r}function SVGGaussianBlurEffect(e,t){e.setAttribute("x","-100%"),e.setAttribute("y","-100%"),e.setAttribute("width","300%"),e.setAttribute("height","300%"),this.filterManager=t;var r=createNS("feGaussianBlur");e.appendChild(r),this.feGaussianBlur=r}function SVGStrokeEffect(e,t){this.initialized=!1,this.filterManager=t,this.elem=e,this.paths=[]}function SVGTritoneFilter(e,t){this.filterManager=t;var r=createNS("feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("color-interpolation-filters","linearRGB"),r.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),r.setAttribute("result","f1"),e.appendChild(r);var n=createNS("feComponentTransfer");n.setAttribute("color-interpolation-filters","sRGB"),e.appendChild(n),this.matrixFilter=n;var i=createNS("feFuncR");i.setAttribute("type","table"),n.appendChild(i),this.feFuncR=i;var o=createNS("feFuncG");o.setAttribute("type","table"),n.appendChild(o),this.feFuncG=o;var s=createNS("feFuncB");s.setAttribute("type","table"),n.appendChild(s),this.feFuncB=s}function SVGProLevelsFilter(e,t){this.filterManager=t;var r=this.filterManager.effectElements,n=createNS("feComponentTransfer");(r[10].p.k||0!==r[10].p.v||r[11].p.k||1!==r[11].p.v||r[12].p.k||1!==r[12].p.v||r[13].p.k||0!==r[13].p.v||r[14].p.k||1!==r[14].p.v)&&(this.feFuncR=this.createFeFunc("feFuncR",n)),(r[17].p.k||0!==r[17].p.v||r[18].p.k||1!==r[18].p.v||r[19].p.k||1!==r[19].p.v||r[20].p.k||0!==r[20].p.v||r[21].p.k||1!==r[21].p.v)&&(this.feFuncG=this.createFeFunc("feFuncG",n)),(r[24].p.k||0!==r[24].p.v||r[25].p.k||1!==r[25].p.v||r[26].p.k||1!==r[26].p.v||r[27].p.k||0!==r[27].p.v||r[28].p.k||1!==r[28].p.v)&&(this.feFuncB=this.createFeFunc("feFuncB",n)),(r[31].p.k||0!==r[31].p.v||r[32].p.k||1!==r[32].p.v||r[33].p.k||1!==r[33].p.v||r[34].p.k||0!==r[34].p.v||r[35].p.k||1!==r[35].p.v)&&(this.feFuncA=this.createFeFunc("feFuncA",n)),(this.feFuncR||this.feFuncG||this.feFuncB||this.feFuncA)&&(n.setAttribute("color-interpolation-filters","sRGB"),e.appendChild(n),n=createNS("feComponentTransfer")),(r[3].p.k||0!==r[3].p.v||r[4].p.k||1!==r[4].p.v||r[5].p.k||1!==r[5].p.v||r[6].p.k||0!==r[6].p.v||r[7].p.k||1!==r[7].p.v)&&(n.setAttribute("color-interpolation-filters","sRGB"),e.appendChild(n),this.feFuncRComposed=this.createFeFunc("feFuncR",n),this.feFuncGComposed=this.createFeFunc("feFuncG",n),this.feFuncBComposed=this.createFeFunc("feFuncB",n))}function SVGDropShadowEffect(e,t){var r=t.container.globalData.renderConfig.filterSize;e.setAttribute("x",r.x),e.setAttribute("y",r.y),e.setAttribute("width",r.width),e.setAttribute("height",r.height),this.filterManager=t;var n=createNS("feGaussianBlur");n.setAttribute("in","SourceAlpha"),n.setAttribute("result","drop_shadow_1"),n.setAttribute("stdDeviation","0"),this.feGaussianBlur=n,e.appendChild(n);var i=createNS("feOffset");i.setAttribute("dx","25"),i.setAttribute("dy","0"),i.setAttribute("in","drop_shadow_1"),i.setAttribute("result","drop_shadow_2"),this.feOffset=i,e.appendChild(i);var o=createNS("feFlood");o.setAttribute("flood-color","#00ff00"),o.setAttribute("flood-opacity","1"),o.setAttribute("result","drop_shadow_3"),this.feFlood=o,e.appendChild(o);var s=createNS("feComposite");s.setAttribute("in","drop_shadow_3"),s.setAttribute("in2","drop_shadow_2"),s.setAttribute("operator","in"),s.setAttribute("result","drop_shadow_4"),e.appendChild(s);var a,c=createNS("feMerge");e.appendChild(c),a=createNS("feMergeNode"),c.appendChild(a),(a=createNS("feMergeNode")).setAttribute("in","SourceGraphic"),this.feMergeNode=a,this.feMerge=c,this.originalNodeAdded=!1,c.appendChild(a)}ShapeTransformManager.prototype={addTransformSequence:function(e){for(var t=e.length,r="_",n=0;n<t;n+=1)r+=e[n].transform.key+"_";var i=this.sequences[r];return i||(i={transforms:[].concat(e),finalTransform:new Matrix,_mdf:!1},this.sequences[r]=i,this.sequenceList.push(i)),i},processSequence:function(e,t){for(var r,n=0,i=e.transforms.length,o=t;n<i&&!t;){if(e.transforms[n].transform.mProps._mdf){o=!0;break}n+=1}if(o)for(e.finalTransform.reset(),n=i-1;0<=n;--n)r=e.transforms[n].transform.mProps.v.props,e.finalTransform.transform(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15]);e._mdf=o},processSequences:function(e){for(var t=this.sequenceList.length,r=0;r<t;r+=1)this.processSequence(this.sequenceList[r],e)},getNewKey:function(){return"_"+this.transform_key_count++}},BaseElement.prototype={checkMasks:function(){if(!this.data.hasMask)return!1;for(var e=0,t=this.data.masksProperties.length;e<t;){if("n"!==this.data.masksProperties[e].mode&&!1!==this.data.masksProperties[e].cl)return!0;e+=1}return!1},initExpressions:function(){this.layerInterface=LayerExpressionInterface(this),this.data.hasMask&&this.maskManager&&this.layerInterface.registerMaskInterface(this.maskManager);var e=EffectsExpressionInterface.createEffectsInterface(this,this.layerInterface);this.layerInterface.registerEffectsInterface(e),0===this.data.ty||this.data.xt?this.compInterface=CompExpressionInterface(this):4===this.data.ty?(this.layerInterface.shapeInterface=ShapeExpressionInterface(this.shapesData,this.itemsData,this.layerInterface),this.layerInterface.content=this.layerInterface.shapeInterface):5===this.data.ty&&(this.layerInterface.textInterface=TextExpressionInterface(this),this.layerInterface.text=this.layerInterface.textInterface)},setBlendMode:function(){var e=getBlendMode(this.data.bm);(this.baseElement||this.layerElement).style["mix-blend-mode"]=e},initBaseData:function(e,t,r){this.globalData=t,this.comp=r,this.data=e,this.layerId=createElementID(),this.data.sr||(this.data.sr=1),this.effectsManager=new EffectsManager(this.data,this,this.dynamicProperties)},getType:function(){return this.type},sourceRectAtTime:function(){}},NullElement.prototype.prepareFrame=function(e){this.prepareProperties(e,!0)},NullElement.prototype.renderFrame=function(){},NullElement.prototype.getBaseElement=function(){return null},NullElement.prototype.destroy=function(){},NullElement.prototype.sourceRectAtTime=function(){},NullElement.prototype.hide=function(){},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement],NullElement),SVGBaseElement.prototype={initRendererElement:function(){this.layerElement=createNS("g")},createContainerElements:function(){this.matteElement=createNS("g"),this.transformedElement=this.layerElement,this.maskedElement=this.layerElement,this._sizeChanged=!1;var e,t,r,n,i,o,s,a,c,l,u,d,h,f=null;this.data.td?3==this.data.td||1==this.data.td?((n=createNS("mask")).setAttribute("id",this.layerId),n.setAttribute("mask-type",3==this.data.td?"luminance":"alpha"),n.appendChild(this.layerElement),f=n,this.globalData.defs.appendChild(n),featureSupport.maskType||1!=this.data.td||(n.setAttribute("mask-type","luminance"),e=createElementID(),t=filtersFactory.createFilter(e),this.globalData.defs.appendChild(t),t.appendChild(filtersFactory.createAlphaToLuminanceFilter()),(r=createNS("g")).appendChild(this.layerElement),f=r,n.appendChild(r),r.setAttribute("filter","url("+locationHref+"#"+e+")"))):2==this.data.td&&((i=createNS("mask")).setAttribute("id",this.layerId),i.setAttribute("mask-type","alpha"),o=createNS("g"),i.appendChild(o),e=createElementID(),t=filtersFactory.createFilter(e),(s=createNS("feComponentTransfer")).setAttribute("in","SourceGraphic"),t.appendChild(s),(a=createNS("feFuncA")).setAttribute("type","table"),a.setAttribute("tableValues","1.0 0.0"),s.appendChild(a),this.globalData.defs.appendChild(t),(c=createNS("rect")).setAttribute("width",this.comp.data.w),c.setAttribute("height",this.comp.data.h),c.setAttribute("x","0"),c.setAttribute("y","0"),c.setAttribute("fill","#ffffff"),c.setAttribute("opacity","0"),o.setAttribute("filter","url("+locationHref+"#"+e+")"),o.appendChild(c),o.appendChild(this.layerElement),f=o,featureSupport.maskType||(i.setAttribute("mask-type","luminance"),t.appendChild(filtersFactory.createAlphaToLuminanceFilter()),r=createNS("g"),o.appendChild(c),r.appendChild(this.layerElement),f=r,o.appendChild(r)),this.globalData.defs.appendChild(i)):this.data.tt?(this.matteElement.appendChild(this.layerElement),f=this.matteElement,this.baseElement=this.matteElement):this.baseElement=this.layerElement,this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),0!==this.data.ty||this.data.hd||(l=createNS("clipPath"),(u=createNS("path")).setAttribute("d","M0,0 L"+this.data.w+",0 L"+this.data.w+","+this.data.h+" L0,"+this.data.h+"z"),d=createElementID(),l.setAttribute("id",d),l.appendChild(u),this.globalData.defs.appendChild(l),this.checkMasks()?((h=createNS("g")).setAttribute("clip-path","url("+locationHref+"#"+d+")"),h.appendChild(this.layerElement),this.transformedElement=h,f?f.appendChild(this.transformedElement):this.baseElement=this.transformedElement):this.layerElement.setAttribute("clip-path","url("+locationHref+"#"+d+")")),0!==this.data.bm&&this.setBlendMode()},renderElement:function(){this.finalTransform._matMdf&&this.transformedElement.setAttribute("transform",this.finalTransform.mat.to2dCSS()),this.finalTransform._opMdf&&this.transformedElement.setAttribute("opacity",this.finalTransform.mProp.o.v)},destroyBaseElement:function(){this.layerElement=null,this.matteElement=null,this.maskManager.destroy()},getBaseElement:function(){return this.data.hd?null:this.baseElement},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData),this.renderableEffectsManager=new SVGEffects(this)},setMatte:function(e){this.matteElement&&this.matteElement.setAttribute("mask","url("+locationHref+"#"+e+")")}},IShapeElement.prototype={addShapeToModifiers:function(e){for(var t=this.shapeModifiers.length,r=0;r<t;r+=1)this.shapeModifiers[r].addShape(e)},isShapeInAnimatedModifiers:function(e){for(var t=this.shapeModifiers.length;0<t;)if(this.shapeModifiers[0].isAnimatedWithShape(e))return!0;return!1},renderModifiers:function(){if(this.shapeModifiers.length){for(var e=this.shapes.length,t=0;t<e;t+=1)this.shapes[t].sh.reset();for(t=(e=this.shapeModifiers.length)-1;0<=t;--t)this.shapeModifiers[t].processShapes(this._isFirstFrame)}},lcEnum:{1:"butt",2:"round",3:"square"},ljEnum:{1:"miter",2:"round",3:"bevel"},searchProcessedElement:function(e){for(var t=this.processedElements,r=0,n=t.length;r<n;){if(t[r].elem===e)return t[r].pos;r+=1}return 0},addProcessedElement:function(e,t){for(var r=this.processedElements,n=r.length;n;)if(r[--n].elem===e)return void(r[n].pos=t);r.push(new ProcessedElement(e,t))},prepareFrame:function(e){this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange)}},ITextElement.prototype.initElement=function(e,t,r){this.lettersChangedFlag=!0,this.initFrame(),this.initBaseData(e,t,r),this.textProperty=new TextProperty(this,e.t,this.dynamicProperties),this.textAnimator=new TextAnimatorProperty(e.t,this.renderType,this),this.initTransform(e,t,r),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide(),this.textAnimator.searchProperties(this.dynamicProperties)},ITextElement.prototype.prepareFrame=function(e){this._mdf=!1,this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange),(this.textProperty._mdf||this.textProperty._isFirstFrame)&&(this.buildNewText(),this.textProperty._isFirstFrame=!1,this.textProperty._mdf=!1)},ITextElement.prototype.createPathShape=function(e,t){for(var r,n=t.length,i="",o=0;o<n;o+=1)r=t[o].ks.k,i+=buildShapeString(r,r.i.length,!0,e);return i},ITextElement.prototype.updateDocumentData=function(e,t){this.textProperty.updateDocumentData(e,t)},ITextElement.prototype.canResizeFont=function(e){this.textProperty.canResizeFont(e)},ITextElement.prototype.setMinimumFontSize=function(e){this.textProperty.setMinimumFontSize(e)},ITextElement.prototype.applyTextPropertiesToMatrix=function(e,t,r,n,i){switch(e.ps&&t.translate(e.ps[0],e.ps[1]+e.ascent,0),t.translate(0,-e.ls,0),e.j){case 1:t.translate(e.justifyOffset+(e.boxWidth-e.lineWidths[r]),0,0);break;case 2:t.translate(e.justifyOffset+(e.boxWidth-e.lineWidths[r])/2,0,0)}t.translate(n,i,0)},ITextElement.prototype.buildColor=function(e){return"rgb("+Math.round(255*e[0])+","+Math.round(255*e[1])+","+Math.round(255*e[2])+")"},ITextElement.prototype.emptyProp=new LetterProps,ITextElement.prototype.destroy=function(){},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement,RenderableDOMElement],ICompElement),ICompElement.prototype.initElement=function(e,t,r){this.initFrame(),this.initBaseData(e,t,r),this.initTransform(e,t,r),this.initRenderable(),this.initHierarchy(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),!this.data.xt&&t.progressiveLoad||this.buildAllItems(),this.hide()},ICompElement.prototype.prepareFrame=function(e){if(this._mdf=!1,this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange),this.isInRange||this.data.xt){var t;this.tm._placeholder?this.renderedFrame=e/this.data.sr:((t=this.tm.v)===this.data.op&&(t=this.data.op-1),this.renderedFrame=t);var r,n=this.elements.length;for(this.completeLayers||this.checkLayers(this.renderedFrame),r=n-1;0<=r;--r)(this.completeLayers||this.elements[r])&&(this.elements[r].prepareFrame(this.renderedFrame-this.layers[r].st),this.elements[r]._mdf&&(this._mdf=!0))}},ICompElement.prototype.renderInnerContent=function(){for(var e=this.layers.length,t=0;t<e;t+=1)(this.completeLayers||this.elements[t])&&this.elements[t].renderFrame()},ICompElement.prototype.setElements=function(e){this.elements=e},ICompElement.prototype.getElements=function(){return this.elements},ICompElement.prototype.destroyElements=function(){for(var e=this.layers.length,t=0;t<e;t+=1)this.elements[t]&&this.elements[t].destroy()},ICompElement.prototype.destroy=function(){this.destroyElements(),this.destroyBaseElement()},extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],IImageElement),IImageElement.prototype.createContent=function(){var e=this.globalData.getAssetsPath(this.assetData);this.innerElem=createNS("image"),this.innerElem.setAttribute("width",this.assetData.w+"px"),this.innerElem.setAttribute("height",this.assetData.h+"px"),this.innerElem.setAttribute("preserveAspectRatio",this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio),this.innerElem.setAttributeNS("http://www.w3.org/1999/xlink","href",e),this.layerElement.appendChild(this.innerElem)},IImageElement.prototype.sourceRectAtTime=function(){return this.sourceRect},extendPrototype([IImageElement],ISolidElement),ISolidElement.prototype.createContent=function(){var e=createNS("rect");e.setAttribute("width",this.data.sw),e.setAttribute("height",this.data.sh),e.setAttribute("fill",this.data.sc),this.layerElement.appendChild(e)},extendPrototype([SVGRenderer,ICompElement,SVGBaseElement],SVGCompElement),extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],SVGTextElement),SVGTextElement.prototype.createContent=function(){this.data.singleShape&&!this.globalData.fontManager.chars&&(this.textContainer=createNS("text"))},SVGTextElement.prototype.buildTextContents=function(e){for(var t=0,r=e.length,n=[],i="";t<r;)e[t]===String.fromCharCode(13)||e[t]===String.fromCharCode(3)?(n.push(i),i=""):i+=e[t],t+=1;return n.push(i),n},SVGTextElement.prototype.buildNewText=function(){var e=this.textProperty.currentData;this.renderedLetters=createSizedArray(e?e.l.length:0),e.fc?this.layerElement.setAttribute("fill",this.buildColor(e.fc)):this.layerElement.setAttribute("fill","rgba(0,0,0,0)"),e.sc&&(this.layerElement.setAttribute("stroke",this.buildColor(e.sc)),this.layerElement.setAttribute("stroke-width",e.sw)),this.layerElement.setAttribute("font-size",e.finalSize);var t,r,n=this.globalData.fontManager.getFontByName(e.f);n.fClass?this.layerElement.setAttribute("class",n.fClass):(this.layerElement.setAttribute("font-family",n.fFamily),t=e.fWeight,r=e.fStyle,this.layerElement.setAttribute("font-style",r),this.layerElement.setAttribute("font-weight",t)),this.layerElement.setAttribute("aria-label",e.t);var i,o=e.l||[],s=!!this.globalData.fontManager.chars;w=o.length;var a,c=this.mHelper,l="",u=this.data.singleShape,d=0,h=0,f=!0,p=e.tr/1e3*e.finalSize;if(!u||s||e.sz){var m,v,g=this.textSpans.length;for(k=0;k<w;k+=1)s&&u&&0!==k||(i=k<g?this.textSpans[k]:createNS(s?"path":"text"),g<=k&&(i.setAttribute("stroke-linecap","butt"),i.setAttribute("stroke-linejoin","round"),i.setAttribute("stroke-miterlimit","4"),this.textSpans[k]=i,this.layerElement.appendChild(i)),i.style.display="inherit"),c.reset(),c.scale(e.finalSize/100,e.finalSize/100),u&&(o[k].n&&(d=-p,h+=e.yOffset,h+=f?1:0,f=!1),this.applyTextPropertiesToMatrix(e,c,o[k].line,d,h),d+=o[k].l||0,d+=p),s?(a=(m=(v=this.globalData.fontManager.getCharData(e.finalText[k],n.fStyle,this.globalData.fontManager.getFontByName(e.f).fFamily))&&v.data||{}).shapes?m.shapes[0].it:[],u?l+=this.createPathShape(c,a):i.setAttribute("d",this.createPathShape(c,a))):(u&&i.setAttribute("transform","translate("+c.props[12]+","+c.props[13]+")"),i.textContent=o[k].val,i.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"));u&&i&&i.setAttribute("d",l)}else{var _=this.textContainer,y="start";switch(e.j){case 1:y="end";break;case 2:y="middle"}_.setAttribute("text-anchor",y),_.setAttribute("letter-spacing",p);for(var b=this.buildTextContents(e.finalText),w=b.length,k=(h=e.ps?e.ps[1]+e.ascent:0,0);k<w;k+=1)(i=this.textSpans[k]||createNS("tspan")).textContent=b[k],i.setAttribute("x",0),i.setAttribute("y",h),i.style.display="inherit",_.appendChild(i),this.textSpans[k]=i,h+=e.finalLineHeight;this.layerElement.appendChild(_)}for(;k<this.textSpans.length;)this.textSpans[k].style.display="none",k+=1;this._sizeChanged=!0},SVGTextElement.prototype.sourceRectAtTime=function(e){var t;return this.prepareFrame(this.comp.renderedFrame-this.data.st),this.renderInnerContent(),this._sizeChanged&&(this._sizeChanged=!1,t=this.layerElement.getBBox(),this.bbox={top:t.y,left:t.x,width:t.width,height:t.height}),this.bbox},SVGTextElement.prototype.renderInnerContent=function(){if(!this.data.singleShape&&(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag)){this._sizeChanged=!0;for(var e,t,r=this.textAnimator.renderedLetters,n=this.textProperty.currentData.l,i=n.length,o=0;o<i;o+=1)n[o].n||(e=r[o],t=this.textSpans[o],e._mdf.m&&t.setAttribute("transform",e.m),e._mdf.o&&t.setAttribute("opacity",e.o),e._mdf.sw&&t.setAttribute("stroke-width",e.sw),e._mdf.sc&&t.setAttribute("stroke",e.sc),e._mdf.fc&&t.setAttribute("fill",e.fc))}},extendPrototype([BaseElement,TransformElement,SVGBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableDOMElement],SVGShapeElement),SVGShapeElement.prototype.initSecondaryElement=function(){},SVGShapeElement.prototype.identityMatrix=new Matrix,SVGShapeElement.prototype.buildExpressionInterface=function(){},SVGShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes()},SVGShapeElement.prototype.filterUniqueShapes=function(){for(var e,t,r,n=this.shapes.length,i=this.stylesList.length,o=[],s=!1,a=0;a<i;a+=1){for(r=this.stylesList[a],s=!1,e=o.length=0;e<n;e+=1)-1!==(t=this.shapes[e]).styles.indexOf(r)&&(o.push(t),s=t._isAnimated||s);1<o.length&&s&&this.setShapesAsAnimated(o)}},SVGShapeElement.prototype.setShapesAsAnimated=function(e){for(var t=e.length,r=0;r<t;r+=1)e[r].setAsAnimated()},SVGShapeElement.prototype.createStyleElement=function(e,t){var r,n=new SVGStyleData(e,t),i=n.pElem;return"st"===e.ty?r=new SVGStrokeStyleData(this,e,n):"fl"===e.ty?r=new SVGFillStyleData(this,e,n):"gf"!==e.ty&&"gs"!==e.ty||(r=new("gf"===e.ty?SVGGradientFillStyleData:SVGGradientStrokeStyleData)(this,e,n),this.globalData.defs.appendChild(r.gf),r.maskId&&(this.globalData.defs.appendChild(r.ms),this.globalData.defs.appendChild(r.of),i.setAttribute("mask","url("+locationHref+"#"+r.maskId+")"))),"st"!==e.ty&&"gs"!==e.ty||(i.setAttribute("stroke-linecap",this.lcEnum[e.lc]||"round"),i.setAttribute("stroke-linejoin",this.ljEnum[e.lj]||"round"),i.setAttribute("fill-opacity","0"),1===e.lj&&i.setAttribute("stroke-miterlimit",e.ml)),2===e.r&&i.setAttribute("fill-rule","evenodd"),e.ln&&i.setAttribute("id",e.ln),e.cl&&i.setAttribute("class",e.cl),e.bm&&(i.style["mix-blend-mode"]=getBlendMode(e.bm)),this.stylesList.push(n),this.addToAnimatedContents(e,r),r},SVGShapeElement.prototype.createGroupElement=function(e){var t=new ShapeGroupData;return e.ln&&t.gr.setAttribute("id",e.ln),e.cl&&t.gr.setAttribute("class",e.cl),e.bm&&(t.gr.style["mix-blend-mode"]=getBlendMode(e.bm)),t},SVGShapeElement.prototype.createTransformElement=function(e,t){var r=TransformPropertyFactory.getTransformProperty(this,e,this),n=new SVGTransformData(r,r.o,t);return this.addToAnimatedContents(e,n),n},SVGShapeElement.prototype.createShapeElement=function(e,t,r){var n=4;"rc"===e.ty?n=5:"el"===e.ty?n=6:"sr"===e.ty&&(n=7);var i=new SVGShapeData(t,r,ShapePropertyFactory.getShapeProp(this,e,n,this));return this.shapes.push(i),this.addShapeToModifiers(i),this.addToAnimatedContents(e,i),i},SVGShapeElement.prototype.addToAnimatedContents=function(e,t){for(var r=0,n=this.animatedContents.length;r<n;){if(this.animatedContents[r].element===t)return;r+=1}this.animatedContents.push({fn:SVGElementsRenderer.createRenderFunction(e),element:t,data:e})},SVGShapeElement.prototype.setElementStyles=function(e){for(var t=e.styles,r=this.stylesList.length,n=0;n<r;n+=1)this.stylesList[n].closed||t.push(this.stylesList[n])},SVGShapeElement.prototype.reloadShapes=function(){this._isFirstFrame=!0;for(var e=this.itemsData.length,t=0;t<e;t+=1)this.prevViewData[t]=this.itemsData[t];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes(),e=this.dynamicProperties.length,t=0;t<e;t+=1)this.dynamicProperties[t].getValue();this.renderModifiers()},SVGShapeElement.prototype.searchShapes=function(e,t,r,n,i,o,s){for(var a,c,l,u,d,h=[].concat(o),f=e.length-1,p=[],m=[],v=f;0<=v;--v){if((d=this.searchProcessedElement(e[v]))?t[v]=r[d-1]:e[v]._render=s,"fl"==e[v].ty||"st"==e[v].ty||"gf"==e[v].ty||"gs"==e[v].ty)d?t[v].style.closed=!1:t[v]=this.createStyleElement(e[v],i),e[v]._render&&n.appendChild(t[v].style.pElem),p.push(t[v].style);else if("gr"==e[v].ty){if(d)for(c=t[v].it.length,a=0;a<c;a+=1)t[v].prevViewData[a]=t[v].it[a];else t[v]=this.createGroupElement(e[v]);this.searchShapes(e[v].it,t[v].it,t[v].prevViewData,t[v].gr,i+1,h,s),e[v]._render&&n.appendChild(t[v].gr)}else"tr"==e[v].ty?(d||(t[v]=this.createTransformElement(e[v],n)),l=t[v].transform,h.push(l)):"sh"==e[v].ty||"rc"==e[v].ty||"el"==e[v].ty||"sr"==e[v].ty?(d||(t[v]=this.createShapeElement(e[v],h,i)),this.setElementStyles(t[v])):"tm"==e[v].ty||"rd"==e[v].ty||"ms"==e[v].ty?(d?(u=t[v]).closed=!1:((u=ShapeModifiers.getModifier(e[v].ty)).init(this,e[v]),t[v]=u,this.shapeModifiers.push(u)),m.push(u)):"rp"==e[v].ty&&(d?(u=t[v]).closed=!0:(u=ShapeModifiers.getModifier(e[v].ty),(t[v]=u).init(this,e,v,t),this.shapeModifiers.push(u),s=!1),m.push(u));this.addProcessedElement(e[v],v+1)}for(f=p.length,v=0;v<f;v+=1)p[v].closed=!0;for(f=m.length,v=0;v<f;v+=1)m[v].closed=!0},SVGShapeElement.prototype.renderInnerContent=function(){this.renderModifiers();for(var e=this.stylesList.length,t=0;t<e;t+=1)this.stylesList[t].reset();for(this.renderShape(),t=0;t<e;t+=1)(this.stylesList[t]._mdf||this._isFirstFrame)&&(this.stylesList[t].msElem&&(this.stylesList[t].msElem.setAttribute("d",this.stylesList[t].d),this.stylesList[t].d="M0 0"+this.stylesList[t].d),this.stylesList[t].pElem.setAttribute("d",this.stylesList[t].d||"M0 0"))},SVGShapeElement.prototype.renderShape=function(){for(var e,t=this.animatedContents.length,r=0;r<t;r+=1)e=this.animatedContents[r],(this._isFirstFrame||e.element._isAnimated)&&!0!==e.data&&e.fn(e.data,e.element,this._isFirstFrame)},SVGShapeElement.prototype.destroy=function(){this.destroyBaseElement(),this.shapesData=null,this.itemsData=null},SVGTintFilter.prototype.renderFrame=function(e){var t,r,n;(e||this.filterManager._mdf)&&(t=this.filterManager.effectElements[0].p.v,r=this.filterManager.effectElements[1].p.v,n=this.filterManager.effectElements[2].p.v/100,this.matrixFilter.setAttribute("values",r[0]-t[0]+" 0 0 0 "+t[0]+" "+(r[1]-t[1])+" 0 0 0 "+t[1]+" "+(r[2]-t[2])+" 0 0 0 "+t[2]+" 0 0 0 "+n+" 0"))},SVGFillFilter.prototype.renderFrame=function(e){var t,r;(e||this.filterManager._mdf)&&(t=this.filterManager.effectElements[2].p.v,r=this.filterManager.effectElements[6].p.v,this.matrixFilter.setAttribute("values","0 0 0 0 "+t[0]+" 0 0 0 0 "+t[1]+" 0 0 0 0 "+t[2]+" 0 0 0 "+r+" 0"))},SVGGaussianBlurEffect.prototype.renderFrame=function(e){var t,r,n,i,o;(e||this.filterManager._mdf)&&(t=.3*this.filterManager.effectElements[0].p.v,n=3==(r=this.filterManager.effectElements[1].p.v)?0:t,i=2==r?0:t,this.feGaussianBlur.setAttribute("stdDeviation",n+" "+i),o=1==this.filterManager.effectElements[2].p.v?"wrap":"duplicate",this.feGaussianBlur.setAttribute("edgeMode",o))},SVGStrokeEffect.prototype.initialize=function(){var e,t,r,n,i=this.elem.layerElement.children||this.elem.layerElement.childNodes;for(1===this.filterManager.effectElements[1].p.v?(n=this.elem.maskManager.masksProperties.length,r=0):n=1+(r=this.filterManager.effectElements[0].p.v-1),(t=createNS("g")).setAttribute("fill","none"),t.setAttribute("stroke-linecap","round"),t.setAttribute("stroke-dashoffset",1);r<n;r+=1)e=createNS("path"),t.appendChild(e),this.paths.push({p:e,m:r});if(3===this.filterManager.effectElements[10].p.v){var o=createNS("mask"),s=createElementID();o.setAttribute("id",s),o.setAttribute("mask-type","alpha"),o.appendChild(t),this.elem.globalData.defs.appendChild(o);var a=createNS("g");for(a.setAttribute("mask","url("+locationHref+"#"+s+")");i[0];)a.appendChild(i[0]);this.elem.layerElement.appendChild(a),this.masker=o,t.setAttribute("stroke","#fff")}else if(1===this.filterManager.effectElements[10].p.v||2===this.filterManager.effectElements[10].p.v){if(2===this.filterManager.effectElements[10].p.v)for(i=this.elem.layerElement.children||this.elem.layerElement.childNodes;i.length;)this.elem.layerElement.removeChild(i[0]);this.elem.layerElement.appendChild(t),this.elem.layerElement.removeAttribute("mask"),t.setAttribute("stroke","#fff")}this.initialized=!0,this.pathMasker=t},SVGStrokeEffect.prototype.renderFrame=function(e){this.initialized||this.initialize();for(var t,r,n,i=this.paths.length,o=0;o<i;o+=1)if(-1!==this.paths[o].m&&(t=this.elem.maskManager.viewData[this.paths[o].m],r=this.paths[o].p,(e||this.filterManager._mdf||t.prop._mdf)&&r.setAttribute("d",t.lastPath),e||this.filterManager.effectElements[9].p._mdf||this.filterManager.effectElements[4].p._mdf||this.filterManager.effectElements[7].p._mdf||this.filterManager.effectElements[8].p._mdf||t.prop._mdf)){if(0!==this.filterManager.effectElements[7].p.v||100!==this.filterManager.effectElements[8].p.v){for(var s=Math.min(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v)/100,a=Math.max(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v)/100,c=r.getTotalLength(),l="0 0 0 "+c*s+" ",u=c*(a-s),d=1+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v/100,h=Math.floor(u/d),f=0;f<h;f+=1)l+="1 "+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v/100+" ";l+="0 "+10*c+" 0 0"}else l="1 "+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v/100;r.setAttribute("stroke-dasharray",l)}(e||this.filterManager.effectElements[4].p._mdf)&&this.pathMasker.setAttribute("stroke-width",2*this.filterManager.effectElements[4].p.v),(e||this.filterManager.effectElements[6].p._mdf)&&this.pathMasker.setAttribute("opacity",this.filterManager.effectElements[6].p.v),1!==this.filterManager.effectElements[10].p.v&&2!==this.filterManager.effectElements[10].p.v||(e||this.filterManager.effectElements[3].p._mdf)&&(n=this.filterManager.effectElements[3].p.v,this.pathMasker.setAttribute("stroke","rgb("+bm_floor(255*n[0])+","+bm_floor(255*n[1])+","+bm_floor(255*n[2])+")"))},SVGTritoneFilter.prototype.renderFrame=function(e){var t,r,n,i,o,s;(e||this.filterManager._mdf)&&(t=this.filterManager.effectElements[0].p.v,r=this.filterManager.effectElements[1].p.v,i=(n=this.filterManager.effectElements[2].p.v)[0]+" "+r[0]+" "+t[0],o=n[1]+" "+r[1]+" "+t[1],s=n[2]+" "+r[2]+" "+t[2],this.feFuncR.setAttribute("tableValues",i),this.feFuncG.setAttribute("tableValues",o),this.feFuncB.setAttribute("tableValues",s))},SVGProLevelsFilter.prototype.createFeFunc=function(e,t){var r=createNS(e);return r.setAttribute("type","table"),t.appendChild(r),r},SVGProLevelsFilter.prototype.getTableValue=function(e,t,r,n,i){for(var o,s,a=0,c=Math.min(e,t),l=Math.max(e,t),u=Array.call(null,{length:256}),d=0,h=i-n,f=t-e;a<=256;)s=(o=a/256)<=c?f<0?i:n:l<=o?f<0?n:i:n+h*Math.pow((o-e)/f,1/r),u[d++]=s,a+=256/255;return u.join(" ")},SVGProLevelsFilter.prototype.renderFrame=function(e){var t,r;(e||this.filterManager._mdf)&&(r=this.filterManager.effectElements,this.feFuncRComposed&&(e||r[3].p._mdf||r[4].p._mdf||r[5].p._mdf||r[6].p._mdf||r[7].p._mdf)&&(t=this.getTableValue(r[3].p.v,r[4].p.v,r[5].p.v,r[6].p.v,r[7].p.v),this.feFuncRComposed.setAttribute("tableValues",t),this.feFuncGComposed.setAttribute("tableValues",t),this.feFuncBComposed.setAttribute("tableValues",t)),this.feFuncR&&(e||r[10].p._mdf||r[11].p._mdf||r[12].p._mdf||r[13].p._mdf||r[14].p._mdf)&&(t=this.getTableValue(r[10].p.v,r[11].p.v,r[12].p.v,r[13].p.v,r[14].p.v),this.feFuncR.setAttribute("tableValues",t)),this.feFuncG&&(e||r[17].p._mdf||r[18].p._mdf||r[19].p._mdf||r[20].p._mdf||r[21].p._mdf)&&(t=this.getTableValue(r[17].p.v,r[18].p.v,r[19].p.v,r[20].p.v,r[21].p.v),this.feFuncG.setAttribute("tableValues",t)),this.feFuncB&&(e||r[24].p._mdf||r[25].p._mdf||r[26].p._mdf||r[27].p._mdf||r[28].p._mdf)&&(t=this.getTableValue(r[24].p.v,r[25].p.v,r[26].p.v,r[27].p.v,r[28].p.v),this.feFuncB.setAttribute("tableValues",t)),this.feFuncA&&(e||r[31].p._mdf||r[32].p._mdf||r[33].p._mdf||r[34].p._mdf||r[35].p._mdf)&&(t=this.getTableValue(r[31].p.v,r[32].p.v,r[33].p.v,r[34].p.v,r[35].p.v),this.feFuncA.setAttribute("tableValues",t)))},SVGDropShadowEffect.prototype.renderFrame=function(e){var t,r,n,i,o;(e||this.filterManager._mdf)&&((e||this.filterManager.effectElements[4].p._mdf)&&this.feGaussianBlur.setAttribute("stdDeviation",this.filterManager.effectElements[4].p.v/4),(e||this.filterManager.effectElements[0].p._mdf)&&(t=this.filterManager.effectElements[0].p.v,this.feFlood.setAttribute("flood-color",rgbToHex(Math.round(255*t[0]),Math.round(255*t[1]),Math.round(255*t[2])))),(e||this.filterManager.effectElements[1].p._mdf)&&this.feFlood.setAttribute("flood-opacity",this.filterManager.effectElements[1].p.v/255),(e||this.filterManager.effectElements[2].p._mdf||this.filterManager.effectElements[3].p._mdf)&&(r=this.filterManager.effectElements[3].p.v,n=(this.filterManager.effectElements[2].p.v-90)*degToRads,i=r*Math.cos(n),o=r*Math.sin(n),this.feOffset.setAttribute("dx",i),this.feOffset.setAttribute("dy",o)))};var _svgMatteSymbols=[];function SVGMatte3Effect(e,t,r){this.initialized=!1,this.filterManager=t,this.filterElem=e,(this.elem=r).matteElement=createNS("g"),r.matteElement.appendChild(r.layerElement),r.matteElement.appendChild(r.transformedElement),r.baseElement=r.matteElement}function SVGEffects(e){var t,r,n=e.data.ef?e.data.ef.length:0,i=createElementID(),o=filtersFactory.createFilter(i),s=0;for(this.filters=[],t=0;t<n;t+=1)r=null,20===e.data.ef[t].ty?(s+=1,r=new SVGTintFilter(o,e.effectsManager.effectElements[t])):21===e.data.ef[t].ty?(s+=1,r=new SVGFillFilter(o,e.effectsManager.effectElements[t])):22===e.data.ef[t].ty?r=new SVGStrokeEffect(e,e.effectsManager.effectElements[t]):23===e.data.ef[t].ty?(s+=1,r=new SVGTritoneFilter(o,e.effectsManager.effectElements[t])):24===e.data.ef[t].ty?(s+=1,r=new SVGProLevelsFilter(o,e.effectsManager.effectElements[t])):25===e.data.ef[t].ty?(s+=1,r=new SVGDropShadowEffect(o,e.effectsManager.effectElements[t])):28===e.data.ef[t].ty?r=new SVGMatte3Effect(o,e.effectsManager.effectElements[t],e):29===e.data.ef[t].ty&&(s+=1,r=new SVGGaussianBlurEffect(o,e.effectsManager.effectElements[t])),r&&this.filters.push(r);s&&(e.globalData.defs.appendChild(o),e.layerElement.setAttribute("filter","url("+locationHref+"#"+i+")")),this.filters.length&&e.addRenderableComponent(this)}SVGMatte3Effect.prototype.findSymbol=function(e){for(var t=0,r=_svgMatteSymbols.length;t<r;){if(_svgMatteSymbols[t]===e)return _svgMatteSymbols[t];t+=1}return null},SVGMatte3Effect.prototype.replaceInParent=function(e,t){var r=e.layerElement.parentNode;if(r){for(var n,i=r.children,o=0,s=i.length;o<s&&i[o]!==e.layerElement;)o+=1;o<=s-2&&(n=i[o+1]);var a=createNS("use");a.setAttribute("href","#"+t),n?r.insertBefore(a,n):r.appendChild(a)}},SVGMatte3Effect.prototype.setElementAsMask=function(e,t){var r,n,i,o,s;this.findSymbol(t)||(r=createElementID(),(n=createNS("mask")).setAttribute("id",t.layerId),n.setAttribute("mask-type","alpha"),_svgMatteSymbols.push(t),(i=e.globalData.defs).appendChild(n),(o=createNS("symbol")).setAttribute("id",r),this.replaceInParent(t,r),o.appendChild(t.layerElement),i.appendChild(o),(s=createNS("use")).setAttribute("href","#"+r),n.appendChild(s),t.data.hd=!1,t.show()),e.setMatte(t.layerId)},SVGMatte3Effect.prototype.initialize=function(){for(var e=this.filterManager.effectElements[0].p.v,t=this.elem.comp.elements,r=0,n=t.length;r<n;)t[r]&&t[r].data.ind===e&&this.setElementAsMask(this.elem,t[r]),r+=1;this.initialized=!0},SVGMatte3Effect.prototype.renderFrame=function(){this.initialized||this.initialize()},SVGEffects.prototype.renderFrame=function(e){for(var t=this.filters.length,r=0;r<t;r+=1)this.filters[r].renderFrame(e)};var animationManager=(uM={},vM=[],wM=0,xM=0,yM=0,zM=!0,AM=!1,uM.registerAnimation=CM,uM.loadAnimation=function(e){var t=new AnimationItem;return GM(t,null),t.setParams(e),t},uM.setSpeed=function(e,t){for(var r=0;r<xM;r+=1)vM[r].animation.setSpeed(e,t)},uM.setDirection=function(e,t){for(var r=0;r<xM;r+=1)vM[r].animation.setDirection(e,t)},uM.play=function(e){for(var t=0;t<xM;t+=1)vM[t].animation.play(e)},uM.pause=function(e){for(var t=0;t<xM;t+=1)vM[t].animation.pause(e)},uM.stop=function(e){for(var t=0;t<xM;t+=1)vM[t].animation.stop(e)},uM.togglePause=function(e){for(var t=0;t<xM;t+=1)vM[t].animation.togglePause(e)},uM.searchAnimations=function(e,t,r){for(var n,i,o=[].concat([].slice.call(document.getElementsByClassName("lottie")),[].slice.call(document.getElementsByClassName("bodymovin"))),s=o.length,a=0;a<s;a+=1)r&&o[a].setAttribute("data-bm-type",r),CM(o[a],e);t&&0===s&&(r=r||"svg",(n=document.getElementsByTagName("body")[0]).innerHTML="",(i=createTag("div")).style.width="100%",i.style.height="100%",i.setAttribute("data-bm-type",r),n.appendChild(i),CM(i,e))},uM.resize=function(){for(var e=0;e<xM;e+=1)vM[e].animation.resize()},uM.goToAndStop=function(e,t,r){for(var n=0;n<xM;n+=1)vM[n].animation.goToAndStop(e,t,r)},uM.destroy=function(e){for(var t=xM-1;0<=t;--t)vM[t].animation.destroy(e)},uM.freeze=function(){AM=!0},uM.unfreeze=function(){AM=!1,UM()},uM.getRegisteredAnimations=function(){for(var e=vM.length,t=[],r=0;r<e;r+=1)t.push(vM[r].animation);return t},uM),uM,vM,wM,xM,yM,zM,AM;function BM(e){for(var t=0,r=e.target;t<xM;)vM[t].animation===r&&(vM.splice(t,1),--t,--xM,r.isPaused||FM()),t+=1}function CM(e,t){if(!e)return null;for(var r=0;r<xM;){if(vM[r].elem==e&&null!==vM[r].elem)return vM[r].animation;r+=1}var n=new AnimationItem;return GM(n,e),n.setData(e,t),n}function EM(){yM+=1,UM()}function FM(){--yM}function GM(e,t){e.addEventListener("destroy",BM),e.addEventListener("_active",EM),e.addEventListener("_idle",FM),vM.push({elem:t,animation:e}),xM+=1}function LM(e){for(var t=e-wM,r=0;r<xM;r+=1)vM[r].animation.advanceTime(t);wM=e,yM&&!AM?window.requestAnimationFrame(LM):zM=!0}function MM(e){wM=e,window.requestAnimationFrame(LM)}function UM(){!AM&&yM&&zM&&(window.requestAnimationFrame(MM),zM=!1)}var AnimationItem=function(){this._cbs=[],this.name="",this.path="",this.isLoaded=!1,this.currentFrame=0,this.currentRawFrame=0,this.firstFrame=0,this.totalFrames=0,this.frameRate=0,this.frameMult=0,this.playSpeed=1,this.playDirection=1,this.playCount=0,this.animationData={},this.assets=[],this.isPaused=!0,this.autoplay=!1,this.loop=!0,this.renderer=null,this.animationID=createElementID(),this.assetsPath="",this.timeCompleted=0,this.segmentPos=0,this.isSubframeEnabled=subframeEnabled,this.segments=[],this._idle=!0,this._completedLoop=!1,this.projectInterface=ProjectInterface(),this.imagePreloader=new ImagePreloader};extendPrototype([BaseEvent],AnimationItem),AnimationItem.prototype.setParams=function(e){e.context&&(this.context=e.context),(e.wrapper||e.container)&&(this.wrapper=e.wrapper||e.container);var t=e.animType?e.animType:e.renderer?e.renderer:"svg";switch(t){case"canvas":this.renderer=new CanvasRenderer(this,e.rendererSettings);break;case"svg":this.renderer=new SVGRenderer(this,e.rendererSettings);break;default:this.renderer=new HybridRenderer(this,e.rendererSettings)}this.imagePreloader.setCacheType(t),this.renderer.setProjectInterface(this.projectInterface),this.animType=t,""===e.loop||null===e.loop||void 0===e.loop||!0===e.loop?this.loop=!0:!1===e.loop?this.loop=!1:this.loop=parseInt(e.loop),this.autoplay=!("autoplay"in e)||e.autoplay,this.name=e.name?e.name:"",this.autoloadSegments=!e.hasOwnProperty("autoloadSegments")||e.autoloadSegments,this.assetsPath=e.assetsPath,this.initialSegment=e.initialSegment,e.animationData?this.configAnimation(e.animationData):e.path&&(-1!==e.path.lastIndexOf("\\")?this.path=e.path.substr(0,e.path.lastIndexOf("\\")+1):this.path=e.path.substr(0,e.path.lastIndexOf("/")+1),this.fileName=e.path.substr(e.path.lastIndexOf("/")+1),this.fileName=this.fileName.substr(0,this.fileName.lastIndexOf(".json")),assetLoader.load(e.path,this.configAnimation.bind(this),function(){this.trigger("data_failed")}.bind(this)))},AnimationItem.prototype.setData=function(e,t){var r={wrapper:e,animationData:t?"object"==_typeof(t)?t:JSON.parse(t):null},n=e.attributes;r.path=n.getNamedItem("data-animation-path")?n.getNamedItem("data-animation-path").value:n.getNamedItem("data-bm-path")?n.getNamedItem("data-bm-path").value:n.getNamedItem("bm-path")?n.getNamedItem("bm-path").value:"",r.animType=n.getNamedItem("data-anim-type")?n.getNamedItem("data-anim-type").value:n.getNamedItem("data-bm-type")?n.getNamedItem("data-bm-type").value:n.getNamedItem("bm-type")?n.getNamedItem("bm-type").value:n.getNamedItem("data-bm-renderer")?n.getNamedItem("data-bm-renderer").value:n.getNamedItem("bm-renderer")?n.getNamedItem("bm-renderer").value:"canvas";var i=n.getNamedItem("data-anim-loop")?n.getNamedItem("data-anim-loop").value:n.getNamedItem("data-bm-loop")?n.getNamedItem("data-bm-loop").value:n.getNamedItem("bm-loop")?n.getNamedItem("bm-loop").value:"";""===i||(r.loop="false"!==i&&("true"===i||parseInt(i)));var o=n.getNamedItem("data-anim-autoplay")?n.getNamedItem("data-anim-autoplay").value:n.getNamedItem("data-bm-autoplay")?n.getNamedItem("data-bm-autoplay").value:!n.getNamedItem("bm-autoplay")||n.getNamedItem("bm-autoplay").value;r.autoplay="false"!==o,r.name=n.getNamedItem("data-name")?n.getNamedItem("data-name").value:n.getNamedItem("data-bm-name")?n.getNamedItem("data-bm-name").value:n.getNamedItem("bm-name")?n.getNamedItem("bm-name").value:"","false"===(n.getNamedItem("data-anim-prerender")?n.getNamedItem("data-anim-prerender").value:n.getNamedItem("data-bm-prerender")?n.getNamedItem("data-bm-prerender").value:n.getNamedItem("bm-prerender")?n.getNamedItem("bm-prerender").value:"")&&(r.prerender=!1),this.setParams(r)},AnimationItem.prototype.includeLayers=function(e){e.op>this.animationData.op&&(this.animationData.op=e.op,this.totalFrames=Math.floor(e.op-this.animationData.ip));for(var t,r=this.animationData.layers,n=r.length,i=e.layers,o=i.length,s=0;s<o;s+=1)for(t=0;t<n;){if(r[t].id==i[s].id){r[t]=i[s];break}t+=1}if((e.chars||e.fonts)&&(this.renderer.globalData.fontManager.addChars(e.chars),this.renderer.globalData.fontManager.addFonts(e.fonts,this.renderer.globalData.defs)),e.assets)for(n=e.assets.length,t=0;t<n;t+=1)this.animationData.assets.push(e.assets[t]);this.animationData.__complete=!1,dataManager.completeData(this.animationData,this.renderer.globalData.fontManager),this.renderer.includeLayers(e.layers),expressionsPlugin&&expressionsPlugin.initExpressions(this),this.loadNextSegment()},AnimationItem.prototype.loadNextSegment=function(){var e=this.animationData.segments;if(!e||0===e.length||!this.autoloadSegments)return this.trigger("data_ready"),void(this.timeCompleted=this.totalFrames);var t=e.shift();this.timeCompleted=t.time*this.frameRate;var r=this.path+this.fileName+"_"+this.segmentPos+".json";this.segmentPos+=1,assetLoader.load(r,this.includeLayers.bind(this),function(){this.trigger("data_failed")}.bind(this))},AnimationItem.prototype.loadSegments=function(){this.animationData.segments||(this.timeCompleted=this.totalFrames),this.loadNextSegment()},AnimationItem.prototype.imagesLoaded=function(){this.trigger("loaded_images"),this.checkLoaded()},AnimationItem.prototype.preloadImages=function(){this.imagePreloader.setAssetsPath(this.assetsPath),this.imagePreloader.setPath(this.path),this.imagePreloader.loadAssets(this.animationData.assets,this.imagesLoaded.bind(this))},AnimationItem.prototype.configAnimation=function(e){if(this.renderer)try{this.animationData=e,this.initialSegment?(this.totalFrames=Math.floor(this.initialSegment[1]-this.initialSegment[0]),this.firstFrame=Math.round(this.initialSegment[0])):(this.totalFrames=Math.floor(this.animationData.op-this.animationData.ip),this.firstFrame=Math.round(this.animationData.ip)),this.renderer.configAnimation(e),e.assets||(e.assets=[]),this.assets=this.animationData.assets,this.frameRate=this.animationData.fr,this.frameMult=this.animationData.fr/1e3,this.renderer.searchExtraCompositions(e.assets),this.trigger("config_ready"),this.preloadImages(),this.loadSegments(),this.updaFrameModifier(),this.waitForFontsLoaded()}catch(e){this.triggerConfigError(e)}},AnimationItem.prototype.waitForFontsLoaded=function(){this.renderer&&(this.renderer.globalData.fontManager.isLoaded?this.checkLoaded():setTimeout(this.waitForFontsLoaded.bind(this),20))},AnimationItem.prototype.checkLoaded=function(){this.isLoaded||!this.renderer.globalData.fontManager.isLoaded||!this.imagePreloader.loaded()&&"canvas"===this.renderer.rendererType||(this.isLoaded=!0,dataManager.completeData(this.animationData,this.renderer.globalData.fontManager),expressionsPlugin&&expressionsPlugin.initExpressions(this),this.renderer.initItems(),setTimeout(function(){this.trigger("DOMLoaded")}.bind(this),0),this.gotoFrame(),this.autoplay&&this.play())},AnimationItem.prototype.resize=function(){this.renderer.updateContainerSize()},AnimationItem.prototype.setSubframe=function(e){this.isSubframeEnabled=!!e},AnimationItem.prototype.gotoFrame=function(){this.currentFrame=this.isSubframeEnabled?this.currentRawFrame:~~this.currentRawFrame,this.timeCompleted!==this.totalFrames&&this.currentFrame>this.timeCompleted&&(this.currentFrame=this.timeCompleted),this.trigger("enterFrame"),this.renderFrame()},AnimationItem.prototype.renderFrame=function(){if(!1!==this.isLoaded)try{this.renderer.renderFrame(this.currentFrame+this.firstFrame)}catch(e){this.triggerRenderFrameError(e)}},AnimationItem.prototype.play=function(e){e&&this.name!=e||!0===this.isPaused&&(this.isPaused=!1,this._idle&&(this._idle=!1,this.trigger("_active")))},AnimationItem.prototype.pause=function(e){e&&this.name!=e||!1===this.isPaused&&(this.isPaused=!0,this._idle=!0,this.trigger("_idle"))},AnimationItem.prototype.togglePause=function(e){e&&this.name!=e||(!0===this.isPaused?this.play():this.pause())},AnimationItem.prototype.stop=function(e){e&&this.name!=e||(this.pause(),this.playCount=0,this._completedLoop=!1,this.setCurrentRawFrameValue(0))},AnimationItem.prototype.goToAndStop=function(e,t,r){r&&this.name!=r||(t?this.setCurrentRawFrameValue(e):this.setCurrentRawFrameValue(e*this.frameModifier),this.pause())},AnimationItem.prototype.goToAndPlay=function(e,t,r){this.goToAndStop(e,t,r),this.play()},AnimationItem.prototype.advanceTime=function(e){var t,r;!0!==this.isPaused&&!1!==this.isLoaded&&(r=!1,(t=this.currentRawFrame+e*this.frameModifier)>=this.totalFrames-1&&0<this.frameModifier?this.loop&&this.playCount!==this.loop?t>=this.totalFrames?(this.playCount+=1,this.checkSegments(t%this.totalFrames)||(this.setCurrentRawFrameValue(t%this.totalFrames),this._completedLoop=!0,this.trigger("loopComplete"))):this.setCurrentRawFrameValue(t):this.checkSegments(t>this.totalFrames?t%this.totalFrames:0)||(r=!0,t=this.totalFrames-1):t<0?this.checkSegments(t%this.totalFrames)||(!this.loop||this.playCount--<=0&&!0!==this.loop?(r=!0,t=0):(this.setCurrentRawFrameValue(this.totalFrames+t%this.totalFrames),this._completedLoop?this.trigger("loopComplete"):this._completedLoop=!0)):this.setCurrentRawFrameValue(t),r&&(this.setCurrentRawFrameValue(t),this.pause(),this.trigger("complete")))},AnimationItem.prototype.adjustSegment=function(e,t){this.playCount=0,e[1]<e[0]?(0<this.frameModifier&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(-1)),this.timeCompleted=this.totalFrames=e[0]-e[1],this.firstFrame=e[1],this.setCurrentRawFrameValue(this.totalFrames-.001-t)):e[1]>e[0]&&(this.frameModifier<0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(1)),this.timeCompleted=this.totalFrames=e[1]-e[0],this.firstFrame=e[0],this.setCurrentRawFrameValue(.001+t)),this.trigger("segmentStart")},AnimationItem.prototype.setSegment=function(e,t){var r=-1;this.isPaused&&(this.currentRawFrame+this.firstFrame<e?r=e:this.currentRawFrame+this.firstFrame>t&&(r=t-e)),this.firstFrame=e,this.timeCompleted=this.totalFrames=t-e,-1!==r&&this.goToAndStop(r,!0)},AnimationItem.prototype.playSegments=function(e,t){if(t&&(this.segments.length=0),"object"==_typeof(e[0]))for(var r=e.length,n=0;n<r;n+=1)this.segments.push(e[n]);else this.segments.push(e);this.segments.length&&t&&this.adjustSegment(this.segments.shift(),0),this.isPaused&&this.play()},AnimationItem.prototype.resetSegments=function(e){this.segments.length=0,this.segments.push([this.animationData.ip,this.animationData.op]),e&&this.checkSegments(0)},AnimationItem.prototype.checkSegments=function(e){return!!this.segments.length&&(this.adjustSegment(this.segments.shift(),e),!0)},AnimationItem.prototype.destroy=function(e){e&&this.name!=e||!this.renderer||(this.renderer.destroy(),this.imagePreloader.destroy(),this.trigger("destroy"),this._cbs=null,this.onEnterFrame=this.onLoopComplete=this.onComplete=this.onSegmentStart=this.onDestroy=null,this.renderer=null)},AnimationItem.prototype.setCurrentRawFrameValue=function(e){this.currentRawFrame=e,this.gotoFrame()},AnimationItem.prototype.setSpeed=function(e){this.playSpeed=e,this.updaFrameModifier()},AnimationItem.prototype.setDirection=function(e){this.playDirection=e<0?-1:1,this.updaFrameModifier()},AnimationItem.prototype.updaFrameModifier=function(){this.frameModifier=this.frameMult*this.playSpeed*this.playDirection},AnimationItem.prototype.getPath=function(){return this.path},AnimationItem.prototype.getAssetsPath=function(e){var t,r="";return e.e?r=e.p:this.assetsPath?(-1!==(t=e.p).indexOf("images/")&&(t=t.split("/")[1]),r=this.assetsPath+t):(r=this.path,r+=e.u?e.u:"",r+=e.p),r},AnimationItem.prototype.getAssetData=function(e){for(var t=0,r=this.assets.length;t<r;){if(e==this.assets[t].id)return this.assets[t];t+=1}},AnimationItem.prototype.hide=function(){this.renderer.hide()},AnimationItem.prototype.show=function(){this.renderer.show()},AnimationItem.prototype.getDuration=function(e){return e?this.totalFrames:this.totalFrames/this.frameRate},AnimationItem.prototype.trigger=function(e){if(this._cbs&&this._cbs[e])switch(e){case"enterFrame":this.triggerEvent(e,new BMEnterFrameEvent(e,this.currentFrame,this.totalFrames,this.frameModifier));break;case"loopComplete":this.triggerEvent(e,new BMCompleteLoopEvent(e,this.loop,this.playCount,this.frameMult));break;case"complete":this.triggerEvent(e,new BMCompleteEvent(e,this.frameMult));break;case"segmentStart":this.triggerEvent(e,new BMSegmentStartEvent(e,this.firstFrame,this.totalFrames));break;case"destroy":this.triggerEvent(e,new BMDestroyEvent(e,this));break;default:this.triggerEvent(e)}"enterFrame"===e&&this.onEnterFrame&&this.onEnterFrame.call(this,new BMEnterFrameEvent(e,this.currentFrame,this.totalFrames,this.frameMult)),"loopComplete"===e&&this.onLoopComplete&&this.onLoopComplete.call(this,new BMCompleteLoopEvent(e,this.loop,this.playCount,this.frameMult)),"complete"===e&&this.onComplete&&this.onComplete.call(this,new BMCompleteEvent(e,this.frameMult)),"segmentStart"===e&&this.onSegmentStart&&this.onSegmentStart.call(this,new BMSegmentStartEvent(e,this.firstFrame,this.totalFrames)),"destroy"===e&&this.onDestroy&&this.onDestroy.call(this,new BMDestroyEvent(e,this))},AnimationItem.prototype.triggerRenderFrameError=function(e){var t=new BMRenderFrameErrorEvent(e,this.currentFrame);this.triggerEvent("error",t),this.onError&&this.onError.call(this,t)},AnimationItem.prototype.triggerConfigError=function(e){var t=new BMConfigErrorEvent(e,this.currentFrame);this.triggerEvent("error",t),this.onError&&this.onError.call(this,t)};var Expressions=($O={},$O.initExpressions=function(e){var t=0,r=[];e.renderer.compInterface=CompExpressionInterface(e.renderer),e.renderer.globalData.projectInterface.registerComposition(e.renderer),e.renderer.globalData.pushExpression=function(){t+=1},e.renderer.globalData.popExpression=function(){0==--t&&function(){var e,t=r.length;for(e=0;e<t;e+=1)r[e].release();r.length=0}()},e.renderer.globalData.registerExpressionProperty=function(e){-1===r.indexOf(e)&&r.push(e)}},$O),$O,expressionsPlugin=Expressions,ExpressionManager=function(){var ob={},Math=BMMath,window=null,document=null;function $bm_isInstanceOfArray(e){return e.constructor===Array||e.constructor===Float32Array}function isNumerable(e,t){return"number"===e||"boolean"===e||"string"===e||t instanceof Number}function $bm_neg(e){var t=_typeof(e);if("number"==t||"boolean"==t||e instanceof Number)return-e;if($bm_isInstanceOfArray(e)){for(var r=e.length,n=[],i=0;i<r;i+=1)n[i]=-e[i];return n}return e.propType&&e.v}var easeInBez=BezierFactory.getBezierEasing(.333,0,.833,.833,"easeIn").get,easeOutBez=BezierFactory.getBezierEasing(.167,.167,.667,1,"easeOut").get,easeInOutBez=BezierFactory.getBezierEasing(.33,0,.667,1,"easeInOut").get;function sum(e,t){var r=_typeof(e),n=_typeof(t);if("string"==r||"string"==n)return e+t;if(isNumerable(r,e)&&isNumerable(n,t))return e+t;if($bm_isInstanceOfArray(e)&&isNumerable(n,t))return(e=e.slice(0))[0]=e[0]+t,e;if(isNumerable(r,e)&&$bm_isInstanceOfArray(t))return(t=t.slice(0))[0]=e+t[0],t;if($bm_isInstanceOfArray(e)&&$bm_isInstanceOfArray(t)){for(var i=0,o=e.length,s=t.length,a=[];i<o||i<s;)("number"==typeof e[i]||e[i]instanceof Number)&&("number"==typeof t[i]||t[i]instanceof Number)?a[i]=e[i]+t[i]:a[i]=void 0===t[i]?e[i]:e[i]||t[i],i+=1;return a}return 0}var add=sum;function sub(e,t){var r=_typeof(e),n=_typeof(t);if(isNumerable(r,e)&&isNumerable(n,t))return"string"==r&&(e=parseInt(e)),"string"==n&&(t=parseInt(t)),e-t;if($bm_isInstanceOfArray(e)&&isNumerable(n,t))return(e=e.slice(0))[0]=e[0]-t,e;if(isNumerable(r,e)&&$bm_isInstanceOfArray(t))return(t=t.slice(0))[0]=e-t[0],t;if($bm_isInstanceOfArray(e)&&$bm_isInstanceOfArray(t)){for(var i=0,o=e.length,s=t.length,a=[];i<o||i<s;)("number"==typeof e[i]||e[i]instanceof Number)&&("number"==typeof t[i]||t[i]instanceof Number)?a[i]=e[i]-t[i]:a[i]=void 0===t[i]?e[i]:e[i]||t[i],i+=1;return a}return 0}function mul(e,t){var r,n,i,o=_typeof(e),s=_typeof(t);if(isNumerable(o,e)&&isNumerable(s,t))return e*t;if($bm_isInstanceOfArray(e)&&isNumerable(s,t)){for(i=e.length,r=createTypedArray("float32",i),n=0;n<i;n+=1)r[n]=e[n]*t;return r}if(isNumerable(o,e)&&$bm_isInstanceOfArray(t)){for(i=t.length,r=createTypedArray("float32",i),n=0;n<i;n+=1)r[n]=e*t[n];return r}return 0}function div(e,t){var r,n,i,o=_typeof(e),s=_typeof(t);if(isNumerable(o,e)&&isNumerable(s,t))return e/t;if($bm_isInstanceOfArray(e)&&isNumerable(s,t)){for(i=e.length,r=createTypedArray("float32",i),n=0;n<i;n+=1)r[n]=e[n]/t;return r}if(isNumerable(o,e)&&$bm_isInstanceOfArray(t)){for(i=t.length,r=createTypedArray("float32",i),n=0;n<i;n+=1)r[n]=e/t[n];return r}return 0}function mod(e,t){return"string"==typeof e&&(e=parseInt(e)),"string"==typeof t&&(t=parseInt(t)),e%t}var $bm_sum=sum,$bm_sub=sub,$bm_mul=mul,$bm_div=div,$bm_mod=mod;function clamp(e,t,r){var n;return r<t&&(n=r,r=t,t=n),Math.min(Math.max(e,t),r)}function radiansToDegrees(e){return e/degToRads}var radians_to_degrees=radiansToDegrees;function degreesToRadians(e){return e*degToRads}var degrees_to_radians=radiansToDegrees,helperLengthArray=[0,0,0,0,0,0];function length(e,t){if("number"==typeof e||e instanceof Number)return t=t||0,Math.abs(e-t);t=t||helperLengthArray;for(var r=Math.min(e.length,t.length),n=0,i=0;i<r;i+=1)n+=Math.pow(t[i]-e[i],2);return Math.sqrt(n)}function normalize(e){return div(e,length(e))}function rgbToHsl(e){var t=e[0],r=e[1],n=e[2];return Math.max(t,r,n),Math.min(t,r,n),e[3],1}function hue2rgb(e,t,r){return r<0&&(r+=1),1<r&&--r,r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function hslToRgb(e){var t,r,n=e[0],i=e[1],o=e[2];return 0===i||(hue2rgb(r=2*o-(t=o<.5?o*(1+i):o+i-o*i),t,n+1/3),hue2rgb(r,t,n),hue2rgb(r,t,n-1/3)),e[3],1}function linear(e,t,r,n,i){var o;if(void 0!==n&&void 0!==i||(n=t,i=r,t=0,r=1),r<t&&(o=r,r=t,t=o),e<=t)return n;if(r<=e)return i;var s=r===t?0:(e-t)/(r-t);if(!n.length)return n+(i-n)*s;for(var a=n.length,c=createTypedArray("float32",a),l=0;l<a;l+=1)c[l]=n[l]+(i[l]-n[l])*s;return c}function random(e,t){if(void 0===t&&(void 0===e?(e=0,t=1):(t=e,e=void 0)),t.length){var r=t.length;e=e||createTypedArray("float32",r);for(var n=createTypedArray("float32",r),i=BMMath.random(),o=0;o<r;o+=1)n[o]=e[o]+i*(t[o]-e[o]);return n}return void 0===e&&(e=0),e+BMMath.random()*(t-e)}function createPath(e,t,r,n){var i=e.length,o=shape_pool.newElement();o.setPathData(!!n,i);for(var s,a,c=[0,0],l=0;l<i;l+=1)s=t&&t[l]?t[l]:c,a=r&&r[l]?r[l]:c,o.setTripleAt(e[l][0],e[l][1],a[0]+e[l][0],a[1]+e[l][1],s[0]+e[l][0],s[1]+e[l][1],l,!0);return o}function initiateExpression(elem,data,property){var val=data.x,needsVelocity=/velocity(?![\w\d])/.test(val),_needsRandom=-1!==val.indexOf("random"),elemType=elem.data.ty,transform,$bm_transform,content,effect,thisProperty=property;thisProperty.valueAtTime=thisProperty.getValueAtTime,Object.defineProperty(thisProperty,"value",{get:function(){return thisProperty.v}}),elem.comp.frameDuration=1/elem.comp.globalData.frameRate,elem.comp.displayStartTime=0;var inPoint=elem.data.ip/elem.comp.globalData.frameRate,outPoint=elem.data.op/elem.comp.globalData.frameRate,width=elem.data.sw?elem.data.sw:0,height=elem.data.sh?elem.data.sh:0,name=elem.data.nm,loopIn,loop_in,loopOut,loop_out,smooth,toWorld,fromWorld,fromComp,toComp,fromCompToSurface,position,rotation,anchorPoint,scale,thisLayer,thisComp,mask,valueAtTime,velocityAtTime,__expression_functions=[],scoped_bm_rt;if(data.xf)for(var i,len=data.xf.length,i=0;i<len;i+=1)__expression_functions[i]=eval("(function(){ return "+data.xf[i]+"}())");var expression_function=eval("[function _expression_function(){"+val+";scoped_bm_rt=$bm_rt}]")[0],numKeys=property.kf?data.k.length:0,active=!this.data||!0!==this.data.hd,wiggle=function(e,t){for(var r=this.pv.length?this.pv.length:1,n=createTypedArray("float32",r),i=Math.floor(5*time),o=0,s=0;o<i;){for(s=0;s<r;s+=1)n[s]+=-t+2*t*BMMath.random();o+=1}var a=5*time,c=a-Math.floor(a),l=createTypedArray("float32",r);if(1<r){for(s=0;s<r;s+=1)l[s]=this.pv[s]+n[s]+(-t+2*t*BMMath.random())*c;return l}return this.pv+n[0]+(-t+2*t*BMMath.random())*c}.bind(this);function loopInDuration(e,t){return loopIn(e,t,!0)}function loopOutDuration(e,t){return loopOut(e,t,!0)}thisProperty.loopIn&&(loopIn=thisProperty.loopIn.bind(thisProperty),loop_in=loopIn),thisProperty.loopOut&&(loopOut=thisProperty.loopOut.bind(thisProperty),loop_out=loopOut),thisProperty.smooth&&(smooth=thisProperty.smooth.bind(thisProperty)),this.getValueAtTime&&(valueAtTime=this.getValueAtTime.bind(this)),this.getVelocityAtTime&&(velocityAtTime=this.getVelocityAtTime.bind(this));var comp=elem.comp.globalData.projectInterface.bind(elem.comp.globalData.projectInterface),time,velocity,value,text,textIndex,textTotal,selectorValue;function lookAt(e,t){var r=[t[0]-e[0],t[1]-e[1],t[2]-e[2]];return Math.atan2(r[0],Math.sqrt(r[1]*r[1]+r[2]*r[2])),Math.atan2(r[1],r[2]),1}function easeOut(e,t,r,n,i){return applyEase(easeOutBez,e,t,r,n,i)}function easeIn(e,t,r,n,i){return applyEase(easeInBez,e,t,r,n,i)}function ease(e,t,r,n,i){return applyEase(easeInOutBez,e,t,r,n,i)}function applyEase(e,t,r,n,i,o){void 0===i?(i=r,o=n):t=(t-r)/(n-r);var s=e(t=1<t?1:t<0?0:t);if($bm_isInstanceOfArray(i)){for(var a=i.length,c=createTypedArray("float32",a),l=0;l<a;l+=1)c[l]=(o[l]-i[l])*s+i[l];return c}return(o-i)*s+i}function nearestKey(e){var t,r,n,i=data.k.length;if(data.k.length&&"number"!=typeof data.k[0])if(r=-1,(e*=elem.comp.globalData.frameRate)<data.k[0].t)r=1,n=data.k[0].t;else{for(t=0;t<i-1;t+=1){if(e===data.k[t].t){r=t+1,n=data.k[t].t;break}if(e>data.k[t].t&&e<data.k[t+1].t){n=e-data.k[t].t>data.k[t+1].t-e?(r=t+2,data.k[t+1].t):(r=t+1,data.k[t].t);break}}-1===r&&(r=t+1,n=data.k[t].t)}else n=r=0;var o={};return o.index=r,o.time=n/elem.comp.globalData.frameRate,o}function key(e){var t;if(!data.k.length||"number"==typeof data.k[0])throw new Error("The property has no keyframe at index "+e);--e,t={time:data.k[e].t/elem.comp.globalData.frameRate,value:[]};for(var r=data.k[e].hasOwnProperty("s")?data.k[e].s:data.k[e-1].e,n=r.length,i=0;i<n;i+=1)t[i]=r[i],t.value[i]=r[i];return t}function framesToTime(e,t){return e/(t||elem.comp.globalData.frameRate)}function timeToFrames(e,t){return e||0===e||(e=time),e*(t||elem.comp.globalData.frameRate)}function seedRandom(e){BMMath.seedrandom(randSeed+e)}function sourceRectAtTime(){return elem.sourceRectAtTime()}function substring(e,t){return"string"==typeof value&&(void 0===t?value.substring(e):value.substring(e,t))}function substr(e,t){return"string"==typeof value&&(void 0===t?value.substr(e):value.substr(e,t))}function posterizeTime(e){time=0===e?0:Math.floor(time*e)/e,value=valueAtTime(time)}var index=elem.data.ind,hasParent=!(!elem.hierarchy||!elem.hierarchy.length),parent,randSeed=Math.floor(1e6*Math.random()),globalData=elem.globalData;function executeExpression(e){return value=e,_needsRandom&&seedRandom(randSeed),this.frameExpressionId===elem.globalData.frameId&&"textSelector"!==this.propType?value:("textSelector"===this.propType&&(textIndex=this.textIndex,textTotal=this.textTotal,selectorValue=this.selectorValue),thisLayer||(text=elem.layerInterface.text,thisLayer=elem.layerInterface,thisComp=elem.comp.compInterface,toWorld=thisLayer.toWorld.bind(thisLayer),fromWorld=thisLayer.fromWorld.bind(thisLayer),fromComp=thisLayer.fromComp.bind(thisLayer),toComp=thisLayer.toComp.bind(thisLayer),mask=thisLayer.mask?thisLayer.mask.bind(thisLayer):null,fromCompToSurface=fromComp),transform||(transform=elem.layerInterface("ADBE Transform Group"),($bm_transform=transform)&&(anchorPoint=transform.anchorPoint)),4!==elemType||content||(content=thisLayer("ADBE Root Vectors Group")),effect=effect||thisLayer(4),(hasParent=!(!elem.hierarchy||!elem.hierarchy.length))&&!parent&&(parent=elem.hierarchy[0].layerInterface),time=this.comp.renderedFrame/this.comp.globalData.frameRate,needsVelocity&&(velocity=velocityAtTime(time)),expression_function(),this.frameExpressionId=elem.globalData.frameId,"shape"===scoped_bm_rt.propType&&(scoped_bm_rt=scoped_bm_rt.v),scoped_bm_rt)}return executeExpression}return ob.initiateExpression=initiateExpression,ob}(),expressionHelpers={searchExpressions:function(e,t,r){t.x&&(r.k=!0,r.x=!0,r.initiateExpression=ExpressionManager.initiateExpression,r.effectsSequence.push(r.initiateExpression(e,t,r).bind(r)))},getSpeedAtTime:function(e){var t=this.getValueAtTime(e),r=this.getValueAtTime(e+-.01),n=0;if(t.length){for(var i=0;i<t.length;i+=1)n+=Math.pow(r[i]-t[i],2);n=100*Math.sqrt(n)}else n=0;return n},getVelocityAtTime:function(e){if(void 0!==this.vel)return this.vel;var t=this.getValueAtTime(e),r=this.getValueAtTime(e+-.001);if(t.length)for(var n=createTypedArray("float32",t.length),i=0;i<t.length;i+=1)n[i]=(r[i]-t[i])/-.001;else n=(r-t)/-.001;return n},getValueAtTime:function(e){return e*=this.elem.globalData.frameRate,(e-=this.offsetTime)!==this._cachingAtTime.lastFrame&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastFrame<e?this._cachingAtTime.lastIndex:0,this._cachingAtTime.value=this.interpolateValue(e,this._cachingAtTime),this._cachingAtTime.lastFrame=e),this._cachingAtTime.value},getStaticValueAtTime:function(){return this.pv},setGroupProperty:function(e){this.propertyGroup=e}};!function(){function e(e,t,r){if(!this.k||!this.keyframes)return this.pv;e=e?e.toLowerCase():"";var n,i,o,s,a,c=this.comp.renderedFrame,l=this.keyframes,u=l[l.length-1].t;if(c<=u)return this.pv;if(r?i=u-(n=t?Math.abs(u-elem.comp.globalData.frameRate*t):Math.max(0,u-this.elem.data.ip)):((!t||t>l.length-1)&&(t=l.length-1),n=u-(i=l[l.length-1-t].t)),"pingpong"===e){if(Math.floor((c-i)/n)%2!=0)return this.getValueAtTime((n-(c-i)%n+i)/this.comp.globalData.frameRate,0)}else{if("offset"===e){var d=this.getValueAtTime(i/this.comp.globalData.frameRate,0),h=this.getValueAtTime(u/this.comp.globalData.frameRate,0),f=this.getValueAtTime(((c-i)%n+i)/this.comp.globalData.frameRate,0),p=Math.floor((c-i)/n);if(this.pv.length){for(s=(a=new Array(d.length)).length,o=0;o<s;o+=1)a[o]=(h[o]-d[o])*p+f[o];return a}return(h-d)*p+f}if("continue"===e){var m=this.getValueAtTime(u/this.comp.globalData.frameRate,0),v=this.getValueAtTime((u-.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(s=(a=new Array(m.length)).length,o=0;o<s;o+=1)a[o]=m[o]+(m[o]-v[o])*((c-u)/this.comp.globalData.frameRate)/5e-4;return a}return m+(c-u)/.001*(m-v)}}return this.getValueAtTime(((c-i)%n+i)/this.comp.globalData.frameRate,0)}function t(e,t,r){if(!this.k)return this.pv;e=e?e.toLowerCase():"";var n,i,o,s,a,c=this.comp.renderedFrame,l=this.keyframes,u=l[0].t;if(u<=c)return this.pv;if(r?i=u+(n=t?Math.abs(elem.comp.globalData.frameRate*t):Math.max(0,this.elem.data.op-u)):((!t||t>l.length-1)&&(t=l.length-1),n=(i=l[t].t)-u),"pingpong"===e){if(Math.floor((u-c)/n)%2==0)return this.getValueAtTime(((u-c)%n+u)/this.comp.globalData.frameRate,0)}else{if("offset"===e){var d=this.getValueAtTime(u/this.comp.globalData.frameRate,0),h=this.getValueAtTime(i/this.comp.globalData.frameRate,0),f=this.getValueAtTime((n-(u-c)%n+u)/this.comp.globalData.frameRate,0),p=Math.floor((u-c)/n)+1;if(this.pv.length){for(s=(a=new Array(d.length)).length,o=0;o<s;o+=1)a[o]=f[o]-(h[o]-d[o])*p;return a}return f-(h-d)*p}if("continue"===e){var m=this.getValueAtTime(u/this.comp.globalData.frameRate,0),v=this.getValueAtTime((u+.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(s=(a=new Array(m.length)).length,o=0;o<s;o+=1)a[o]=m[o]+(m[o]-v[o])*(u-c)/.001;return a}return m+(m-v)*(u-c)/.001}}return this.getValueAtTime((n-(u-c)%n+u)/this.comp.globalData.frameRate,0)}function r(e,t){if(!this.k)return this.pv;if(e=.5*(e||.4),(t=Math.floor(t||5))<=1)return this.pv;for(var r,n=this.comp.renderedFrame/this.comp.globalData.frameRate,i=n-e,o=1<t?(n+e-i)/(t-1):1,s=0,a=0,c=this.pv.length?createTypedArray("float32",this.pv.length):0;s<t;){if(r=this.getValueAtTime(i+s*o),this.pv.length)for(a=0;a<this.pv.length;a+=1)c[a]+=r[a];else c+=r;s+=1}if(this.pv.length)for(a=0;a<this.pv.length;a+=1)c[a]/=t;else c/=t;return c}var n=TransformPropertyFactory.getTransformProperty;TransformPropertyFactory.getTransformProperty=function(e,t,r){var i=n(e,t,r);return i.dynamicProperties.length?i.getValueAtTime=function(e){console.warn("Transform at time not supported")}.bind(i):i.getValueAtTime=function(e){}.bind(i),i.setGroupProperty=expressionHelpers.setGroupProperty,i};var i=PropertyFactory.getProp;PropertyFactory.getProp=function(n,o,s,a,c){var l=i(n,o,s,a,c);l.kf?l.getValueAtTime=expressionHelpers.getValueAtTime.bind(l):l.getValueAtTime=expressionHelpers.getStaticValueAtTime.bind(l),l.setGroupProperty=expressionHelpers.setGroupProperty,l.loopOut=e,l.loopIn=t,l.smooth=r,l.getVelocityAtTime=expressionHelpers.getVelocityAtTime.bind(l),l.getSpeedAtTime=expressionHelpers.getSpeedAtTime.bind(l),l.numKeys=1===o.a?o.k.length:0,l.propertyIndex=o.ix;var u=0;return 0!==s&&(u=createTypedArray("float32",1===o.a?o.k[0].s.length:o.k.length)),l._cachingAtTime={lastFrame:initialDefaultFrame,lastIndex:0,value:u},expressionHelpers.searchExpressions(n,o,l),l.k&&c.addDynamicProperty(l),l};var o=ShapePropertyFactory.getConstructorFunction(),s=ShapePropertyFactory.getKeyframedConstructorFunction();function a(){}a.prototype={vertices:function(e,t){this.k&&this.getValue();var r=this.v;void 0!==t&&(r=this.getValueAtTime(t,0));for(var n=r._length,i=r[e],o=r.v,s=createSizedArray(n),a=0;a<n;a+=1)s[a]="i"===e||"o"===e?[i[a][0]-o[a][0],i[a][1]-o[a][1]]:[i[a][0],i[a][1]];return s},points:function(e){return this.vertices("v",e)},inTangents:function(e){return this.vertices("i",e)},outTangents:function(e){return this.vertices("o",e)},isClosed:function(){return this.v.c},pointOnPath:function(e,t){var r=this.v;void 0!==t&&(r=this.getValueAtTime(t,0)),this._segmentsLength||(this._segmentsLength=bez.getSegmentsLength(r));for(var n=this._segmentsLength,i=n.lengths,o=n.totalLength*e,s=0,a=i.length,c=0;s<a;){if(c+i[s].addedLength>o){var l=r.c&&s===a-1?0:s+1,u=(o-c)/i[s].addedLength,d=bez.getPointInSegment(r.v[s],r.v[l],r.o[s],r.i[l],u,i[s]);break}c+=i[s].addedLength,s+=1}return d||(r.c?[r.v[0][0],r.v[0][1]]:[r.v[r._length-1][0],r.v[r._length-1][1]])},vectorOnPath:function(e,t,r){e=1==e?this.v.c?0:.999:e;var n=this.pointOnPath(e,t),i=this.pointOnPath(e+.001,t),o=i[0]-n[0],s=i[1]-n[1],a=Math.sqrt(Math.pow(o,2)+Math.pow(s,2));return 0===a?[0,0]:"tangent"===r?[o/a,s/a]:[-s/a,o/a]},tangentOnPath:function(e,t){return this.vectorOnPath(e,t,"tangent")},normalOnPath:function(e,t){return this.vectorOnPath(e,t,"normal")},setGroupProperty:expressionHelpers.setGroupProperty,getValueAtTime:expressionHelpers.getStaticValueAtTime},extendPrototype([a],o),extendPrototype([a],s),s.prototype.getValueAtTime=function(e){return this._cachingAtTime||(this._cachingAtTime={shapeValue:shape_pool.clone(this.pv),lastIndex:0,lastTime:initialDefaultFrame}),e*=this.elem.globalData.frameRate,(e-=this.offsetTime)!==this._cachingAtTime.lastTime&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastTime<e?this._caching.lastIndex:0,this._cachingAtTime.lastTime=e,this.interpolateShape(e,this._cachingAtTime.shapeValue,this._cachingAtTime)),this._cachingAtTime.shapeValue},s.prototype.initiateExpression=ExpressionManager.initiateExpression;var c=ShapePropertyFactory.getShapeProp;ShapePropertyFactory.getShapeProp=function(e,t,r,n,i){var o=c(e,t,r,n,i);return o.propertyIndex=t.ix,o.lock=!1,3===r?expressionHelpers.searchExpressions(e,t.pt,o):4===r&&expressionHelpers.searchExpressions(e,t.ks,o),o.k&&e.addDynamicProperty(o),o}}(),TextProperty.prototype.getExpressionValue=function(e,t){var r=this.calculateExpression(t);if(e.t===r)return e;var n={};return this.copyData(n,e),n.t=r.toString(),n.__complete=!1,n},TextProperty.prototype.searchProperty=function(){var e=this.searchKeyframes(),t=this.searchExpressions();return this.kf=e||t,this.kf},TextProperty.prototype.searchExpressions=function(){if(this.data.d.x)return this.calculateExpression=ExpressionManager.initiateExpression.bind(this)(this.elem,this.data.d,this),this.addEffect(this.getExpressionValue.bind(this)),!0};var ShapeExpressionInterface=function(e,t,r){var n;function i(e){if("number"==typeof e)return n[e-1];for(var t=0,r=n.length;t<r;){if(n[t]._name===e)return n[t];t+=1}}return i.propertyGroup=r,n=fV(e,t,i),i.numProperties=n.length,i};function fV(e,t,r){for(var n,i,o,s=[],a=e?e.length:0,c=0;c<a;c+=1)"gr"==e[c].ty?s.push(function(e,t,r){var n=function e(t){switch(t){case"ADBE Vectors Group":case"Contents":case 2:return e.content;default:return e.transform}};n.propertyGroup=function(e){return 1===e?n:r(e-1)};var i=function(e,t,r){function n(e){for(var t=0,r=i.length;t<r;){if(i[t]._name===e||i[t].mn===e||i[t].propertyIndex===e||i[t].ix===e||i[t].ind===e)return i[t];t+=1}if("number"==typeof e)return i[e-1]}var i;return n.propertyGroup=function(e){return 1===e?n:r(e-1)},i=fV(e.it,t.it,n.propertyGroup),n.numProperties=i.length,n.propertyIndex=e.cix,n._name=e.nm,n}(e,t,n.propertyGroup),o=function(e,t,r){function n(e){return 1==e?i:r(--e)}function i(t){return e.a.ix===t||"Anchor Point"===t?i.anchorPoint:e.o.ix===t||"Opacity"===t?i.opacity:e.p.ix===t||"Position"===t?i.position:e.r.ix===t||"Rotation"===t||"ADBE Vector Rotation"===t?i.rotation:e.s.ix===t||"Scale"===t?i.scale:e.sk&&e.sk.ix===t||"Skew"===t?i.skew:e.sa&&e.sa.ix===t||"Skew Axis"===t?i.skewAxis:void 0}return t.transform.mProps.o.setGroupProperty(n),t.transform.mProps.p.setGroupProperty(n),t.transform.mProps.a.setGroupProperty(n),t.transform.mProps.s.setGroupProperty(n),t.transform.mProps.r.setGroupProperty(n),t.transform.mProps.sk&&(t.transform.mProps.sk.setGroupProperty(n),t.transform.mProps.sa.setGroupProperty(n)),t.transform.op.setGroupProperty(n),Object.defineProperties(i,{opacity:{get:ExpressionPropertyInterface(t.transform.mProps.o)},position:{get:ExpressionPropertyInterface(t.transform.mProps.p)},anchorPoint:{get:ExpressionPropertyInterface(t.transform.mProps.a)},scale:{get:ExpressionPropertyInterface(t.transform.mProps.s)},rotation:{get:ExpressionPropertyInterface(t.transform.mProps.r)},skew:{get:ExpressionPropertyInterface(t.transform.mProps.sk)},skewAxis:{get:ExpressionPropertyInterface(t.transform.mProps.sa)},_name:{value:e.nm}}),i.ty="tr",i.mn=e.mn,i.propertyGroup=r,i}(e.it[e.it.length-1],t.it[t.it.length-1],n.propertyGroup);return n.content=i,n.transform=o,Object.defineProperty(n,"_name",{get:function(){return e.nm}}),n.numProperties=e.np,n.propertyIndex=e.ix,n.nm=e.nm,n.mn=e.mn,n}(e[c],t[c],r)):"fl"==e[c].ty?s.push((n=e[c],i=t[c],o=r,Object.defineProperties(l,{color:{get:ExpressionPropertyInterface(i.c)},opacity:{get:ExpressionPropertyInterface(i.o)},_name:{value:n.nm},mn:{value:n.mn}}),i.c.setGroupProperty(o),i.o.setGroupProperty(o),l)):"st"==e[c].ty?s.push(function(e,t,r){function n(e){return 1===e?ob:r(e-1)}function i(e){return 1===e?a:n(e-1)}var o,s=e.d?e.d.length:0,a={};for(o=0;o<s;o+=1)!function(r){Object.defineProperty(a,e.d[r].nm,{get:ExpressionPropertyInterface(t.d.dataProps[r].p)})}(o),t.d.dataProps[o].p.setGroupProperty(i);function c(e){return"Color"===e||"color"===e?c.color:"Opacity"===e||"opacity"===e?c.opacity:"Stroke Width"===e||"stroke width"===e?c.strokeWidth:void 0}return Object.defineProperties(c,{color:{get:ExpressionPropertyInterface(t.c)},opacity:{get:ExpressionPropertyInterface(t.o)},strokeWidth:{get:ExpressionPropertyInterface(t.w)},dash:{get:function(){return a}},_name:{value:e.nm},mn:{value:e.mn}}),t.c.setGroupProperty(n),t.o.setGroupProperty(n),t.w.setGroupProperty(n),c}(e[c],t[c],r)):"tm"==e[c].ty?s.push(function(e,t,r){function n(e){return 1==e?i:r(--e)}function i(t){return t===e.e.ix||"End"===t||"end"===t?i.end:t===e.s.ix?i.start:t===e.o.ix?i.offset:void 0}return i.propertyIndex=e.ix,t.s.setGroupProperty(n),t.e.setGroupProperty(n),t.o.setGroupProperty(n),i.propertyIndex=e.ix,i.propertyGroup=r,Object.defineProperties(i,{start:{get:ExpressionPropertyInterface(t.s)},end:{get:ExpressionPropertyInterface(t.e)},offset:{get:ExpressionPropertyInterface(t.o)},_name:{value:e.nm}}),i.mn=e.mn,i}(e[c],t[c],r)):"tr"==e[c].ty||("el"==e[c].ty?s.push(function(e,t,r){function n(e){return 1==e?o:r(--e)}o.propertyIndex=e.ix;var i="tm"===t.sh.ty?t.sh.prop:t.sh;function o(t){return e.p.ix===t?o.position:e.s.ix===t?o.size:void 0}return i.s.setGroupProperty(n),i.p.setGroupProperty(n),Object.defineProperties(o,{size:{get:ExpressionPropertyInterface(i.s)},position:{get:ExpressionPropertyInterface(i.p)},_name:{value:e.nm}}),o.mn=e.mn,o}(e[c],t[c],r)):"sr"==e[c].ty?s.push(function(e,t,r){function n(e){return 1==e?o:r(--e)}var i="tm"===t.sh.ty?t.sh.prop:t.sh;function o(t){return e.p.ix===t?o.position:e.r.ix===t?o.rotation:e.pt.ix===t?o.points:e.or.ix===t||"ADBE Vector Star Outer Radius"===t?o.outerRadius:e.os.ix===t?o.outerRoundness:!e.ir||e.ir.ix!==t&&"ADBE Vector Star Inner Radius"!==t?e.is&&e.is.ix===t?o.innerRoundness:void 0:o.innerRadius}return o.propertyIndex=e.ix,i.or.setGroupProperty(n),i.os.setGroupProperty(n),i.pt.setGroupProperty(n),i.p.setGroupProperty(n),i.r.setGroupProperty(n),e.ir&&(i.ir.setGroupProperty(n),i.is.setGroupProperty(n)),Object.defineProperties(o,{position:{get:ExpressionPropertyInterface(i.p)},rotation:{get:ExpressionPropertyInterface(i.r)},points:{get:ExpressionPropertyInterface(i.pt)},outerRadius:{get:ExpressionPropertyInterface(i.or)},outerRoundness:{get:ExpressionPropertyInterface(i.os)},innerRadius:{get:ExpressionPropertyInterface(i.ir)},innerRoundness:{get:ExpressionPropertyInterface(i.is)},_name:{value:e.nm}}),o.mn=e.mn,o}(e[c],t[c],r)):"sh"==e[c].ty?s.push(function(e,t,r){var n=t.sh;function i(e){if("Shape"===e||"shape"===e||"Path"===e||"path"===e||"ADBE Vector Shape"===e||2===e)return i.path}return n.setGroupProperty((function(e){return 1==e?i:r(--e)})),Object.defineProperties(i,{path:{get:function(){return n.k&&n.getValue(),n}},shape:{get:function(){return n.k&&n.getValue(),n}},_name:{value:e.nm},ix:{value:e.ix},propertyIndex:{value:e.ix},mn:{value:e.mn}}),i}(e[c],t[c],r)):"rc"==e[c].ty?s.push(function(e,t,r){function n(e){return 1==e?o:r(--e)}var i="tm"===t.sh.ty?t.sh.prop:t.sh;function o(t){return e.p.ix===t?o.position:e.r.ix===t?o.roundness:e.s.ix===t||"Size"===t||"ADBE Vector Rect Size"===t?o.size:void 0}return o.propertyIndex=e.ix,i.p.setGroupProperty(n),i.s.setGroupProperty(n),i.r.setGroupProperty(n),Object.defineProperties(o,{position:{get:ExpressionPropertyInterface(i.p)},roundness:{get:ExpressionPropertyInterface(i.r)},size:{get:ExpressionPropertyInterface(i.s)},_name:{value:e.nm}}),o.mn=e.mn,o}(e[c],t[c],r)):"rd"==e[c].ty?s.push(function(e,t,r){var n=t;function i(t){if(e.r.ix===t||"Round Corners 1"===t)return i.radius}return i.propertyIndex=e.ix,n.rd.setGroupProperty((function(e){return 1==e?i:r(--e)})),Object.defineProperties(i,{radius:{get:ExpressionPropertyInterface(n.rd)},_name:{value:e.nm}}),i.mn=e.mn,i}(e[c],t[c],r)):"rp"==e[c].ty&&s.push(function(e,t,r){function n(e){return 1==e?o:r(--e)}var i=t;function o(t){return e.c.ix===t||"Copies"===t?o.copies:e.o.ix===t||"Offset"===t?o.offset:void 0}return o.propertyIndex=e.ix,i.c.setGroupProperty(n),i.o.setGroupProperty(n),Object.defineProperties(o,{copies:{get:ExpressionPropertyInterface(i.c)},offset:{get:ExpressionPropertyInterface(i.o)},_name:{value:e.nm}}),o.mn=e.mn,o}(e[c],t[c],r)));function l(e){return"Color"===e||"color"===e?l.color:"Opacity"===e||"opacity"===e?l.opacity:void 0}return s}var TextExpressionInterface=function(e){var t;function r(){}return Object.defineProperty(r,"sourceText",{get:function(){e.textProperty.getValue();var r=e.textProperty.currentData.t;return void 0!==r&&(e.textProperty.currentData.t=void 0,(t=new String(r)).value=r||new String(r)),t}}),r},LayerExpressionInterface=function(e){var t;function r(e){switch(e){case"ADBE Root Vectors Group":case"Contents":case 2:return r.shapeInterface;case 1:case 6:case"Transform":case"transform":case"ADBE Transform Group":return t;case 4:case"ADBE Effect Parade":case"effects":case"Effects":return r.effect}}r.toWorld=DX,r.fromWorld=EX,r.toComp=DX,r.fromComp=FX,r.sampleImage=GX,r.sourceRectAtTime=e.sourceRectAtTime.bind(e);var n=getDescriptor(t=TransformExpressionInterface((r._elem=e).finalTransform.mProp),"anchorPoint");return Object.defineProperties(r,{hasParent:{get:function(){return e.hierarchy.length}},parent:{get:function(){return e.hierarchy[0].layerInterface}},rotation:getDescriptor(t,"rotation"),scale:getDescriptor(t,"scale"),position:getDescriptor(t,"position"),opacity:getDescriptor(t,"opacity"),anchorPoint:n,anchor_point:n,transform:{get:function(){return t}},active:{get:function(){return e.isInRange}}}),r.startTime=e.data.st,r.index=e.data.ind,r.source=e.data.refId,r.height=0===e.data.ty?e.data.h:100,r.width=0===e.data.ty?e.data.w:100,r.inPoint=e.data.ip/e.comp.globalData.frameRate,r.outPoint=e.data.op/e.comp.globalData.frameRate,r._name=e.data.nm,r.registerMaskInterface=function(t){r.mask=new MaskManagerInterface(t,e)},r.registerEffectsInterface=function(e){r.effect=e},r};function DX(e,t){var r=new Matrix;if(r.reset(),this._elem.finalTransform.mProp.applyToMatrix(r),this._elem.hierarchy&&this._elem.hierarchy.length){for(var n=this._elem.hierarchy.length,i=0;i<n;i+=1)this._elem.hierarchy[i].finalTransform.mProp.applyToMatrix(r);return r.applyToPointArray(e[0],e[1],e[2]||0)}return r.applyToPointArray(e[0],e[1],e[2]||0)}function EX(e,t){var r=new Matrix;if(r.reset(),this._elem.finalTransform.mProp.applyToMatrix(r),this._elem.hierarchy&&this._elem.hierarchy.length){for(var n=this._elem.hierarchy.length,i=0;i<n;i+=1)this._elem.hierarchy[i].finalTransform.mProp.applyToMatrix(r);return r.inversePoint(e)}return r.inversePoint(e)}function FX(e){var t=new Matrix;if(t.reset(),this._elem.finalTransform.mProp.applyToMatrix(t),this._elem.hierarchy&&this._elem.hierarchy.length){for(var r=this._elem.hierarchy.length,n=0;n<r;n+=1)this._elem.hierarchy[n].finalTransform.mProp.applyToMatrix(t);return t.inversePoint(e)}return t.inversePoint(e)}function GX(){return[1,1,1,1]}var CompExpressionInterface=function(e){function t(t){for(var r=0,n=e.layers.length;r<n;){if(e.layers[r].nm===t||e.layers[r].ind===t)return e.elements[r].layerInterface;r+=1}return null}return Object.defineProperty(t,"_name",{value:e.data.nm}),(t.layer=t).pixelAspect=1,t.height=e.data.h||e.globalData.compSize.h,t.width=e.data.w||e.globalData.compSize.w,t.pixelAspect=1,t.frameDuration=1/e.globalData.frameRate,t.displayStartTime=0,t.numLayers=e.layers.length,t},TransformExpressionInterface=function(e){function t(e){switch(e){case"scale":case"Scale":case"ADBE Scale":case 6:return t.scale;case"rotation":case"Rotation":case"ADBE Rotation":case"ADBE Rotate Z":case 10:return t.rotation;case"ADBE Rotate X":return t.xRotation;case"ADBE Rotate Y":return t.yRotation;case"position":case"Position":case"ADBE Position":case 2:return t.position;case"ADBE Position_0":return t.xPosition;case"ADBE Position_1":return t.yPosition;case"ADBE Position_2":return t.zPosition;case"anchorPoint":case"AnchorPoint":case"Anchor Point":case"ADBE AnchorPoint":case 1:return t.anchorPoint;case"opacity":case"Opacity":case 11:return t.opacity}}var r;return Object.defineProperty(t,"rotation",{get:ExpressionPropertyInterface(e.r||e.rz)}),Object.defineProperty(t,"zRotation",{get:ExpressionPropertyInterface(e.rz||e.r)}),Object.defineProperty(t,"xRotation",{get:ExpressionPropertyInterface(e.rx)}),Object.defineProperty(t,"yRotation",{get:ExpressionPropertyInterface(e.ry)}),Object.defineProperty(t,"scale",{get:ExpressionPropertyInterface(e.s)}),e.p&&(r=ExpressionPropertyInterface(e.p)),Object.defineProperty(t,"position",{get:function(){return e.p?r():[e.px.v,e.py.v,e.pz?e.pz.v:0]}}),Object.defineProperty(t,"xPosition",{get:ExpressionPropertyInterface(e.px)}),Object.defineProperty(t,"yPosition",{get:ExpressionPropertyInterface(e.py)}),Object.defineProperty(t,"zPosition",{get:ExpressionPropertyInterface(e.pz)}),Object.defineProperty(t,"anchorPoint",{get:ExpressionPropertyInterface(e.a)}),Object.defineProperty(t,"opacity",{get:ExpressionPropertyInterface(e.o)}),Object.defineProperty(t,"skew",{get:ExpressionPropertyInterface(e.sk)}),Object.defineProperty(t,"skewAxis",{get:ExpressionPropertyInterface(e.sa)}),Object.defineProperty(t,"orientation",{get:ExpressionPropertyInterface(e.or)}),t},ProjectInterface=function(){function e(e){for(var t=0,r=this.compositions.length;t<r;){if(this.compositions[t].data&&this.compositions[t].data.nm===e)return this.compositions[t].prepareFrame&&this.compositions[t].data.xt&&this.compositions[t].prepareFrame(this.currentFrame),this.compositions[t].compInterface;t+=1}}return e.compositions=[],e.currentFrame=0,e.registerComposition=nY,e};function nY(e){this.compositions.push(e)}var EffectsExpressionInterface={createEffectsInterface:function(e,t){if(e.effectsManager){var r,n=[],i=e.data.ef,o=e.effectsManager.effectElements.length;for(r=0;r<o;r+=1)n.push(function e(t,r,n,i){var o,s=[],a=t.ef.length;for(o=0;o<a;o+=1)5===t.ef[o].ty?s.push(e(t.ef[o],r.effectElements[o],r.effectElements[o].propertyGroup,i)):s.push(wY(r.effectElements[o],t.ef[o].ty,i,c));function c(e){return 1===e?l:n(e-1)}var l=function(e){for(var r=t.ef,n=0,i=r.length;n<i;){if(e===r[n].nm||e===r[n].mn||e===r[n].ix)return 5===r[n].ty?s[n]:s[n]();n+=1}return s[0]()};return l.propertyGroup=c,"ADBE Color Control"===t.mn&&Object.defineProperty(l,"color",{get:function(){return s[0]()}}),Object.defineProperty(l,"numProperties",{get:function(){return t.np}}),l.active=l.enabled=0!==t.en,l}(i[r],e.effectsManager.effectElements[r],t,e));return function(t){for(var r=e.data.ef||[],i=0,o=r.length;i<o;){if(t===r[i].nm||t===r[i].mn||t===r[i].ix)return n[i];i+=1}}}}};function wY(e,t,r,n){var i=ExpressionPropertyInterface(e.p);return e.p.setGroupProperty&&e.p.setGroupProperty(n),function(){return 10===t?r.comp.compInterface(e.p.v):i()}}var MaskManagerInterface=function(){function e(e,t){this._mask=e,this._data=t}return Object.defineProperty(e.prototype,"maskPath",{get:function(){return this._mask.prop.k&&this._mask.prop.getValue(),this._mask.prop}}),Object.defineProperty(e.prototype,"maskOpacity",{get:function(){return this._mask.op.k&&this._mask.op.getValue(),100*this._mask.op.v}}),function(t,r){for(var n=createSizedArray(t.viewData.length),i=t.viewData.length,o=0;o<i;o+=1)n[o]=new e(t.viewData[o],t.masksProperties[o]);return function(e){for(o=0;o<i;){if(t.masksProperties[o].nm===e)return n[o];o+=1}}}}(),ExpressionPropertyInterface=(mZ={pv:0,v:0,mult:1},nZ={pv:[0,0,0],v:[0,0,0],mult:1},function(e){return e?("unidimensional"===e.propType?function(e){e&&"pv"in e||(e=mZ);var t=1/e.mult,r=e.pv*t,n=new Number(r);return n.value=r,oZ(n,e,"unidimensional"),function(){return e.k&&e.getValue(),r=e.v*t,n.value!==r&&((n=new Number(r)).value=r,oZ(n,e,"unidimensional")),n}}:function(e){e&&"pv"in e||(e=nZ);var t=1/e.mult,r=e.pv.length,n=createTypedArray("float32",r),i=createTypedArray("float32",r);return n.value=i,oZ(n,e,"multidimensional"),function(){e.k&&e.getValue();for(var o=0;o<r;o+=1)n[o]=i[o]=e.v[o]*t;return n}})(e):rZ}),mZ,nZ,JZ,KZ;function oZ(e,t,r){Object.defineProperty(e,"velocity",{get:function(){return t.getVelocityAtTime(t.comp.currentFrame)}}),e.numKeys=t.keyframes?t.keyframes.length:0,e.key=function(n){if(e.numKeys){var i="s"in t.keyframes[n-1]?t.keyframes[n-1].s:"e"in t.keyframes[n-2]?t.keyframes[n-2].e:t.keyframes[n-2].s,o="unidimensional"===r?new Number(i):Object.assign({},i);return o.time=t.keyframes[n-1].t/t.elem.comp.globalData.frameRate,o}return 0},e.valueAtTime=t.getValueAtTime,e.speedAtTime=t.getSpeedAtTime,e.velocityAtTime=t.getVelocityAtTime,e.propertyGroup=t.propertyGroup}function rZ(){return mZ}function LZ(e,t){return this.textIndex=e+1,this.textTotal=t,this.v=this.getValue()*this.mult,this.v}function SliderEffect(e,t,r){this.p=PropertyFactory.getProp(t,e.v,0,0,r)}function AngleEffect(e,t,r){this.p=PropertyFactory.getProp(t,e.v,0,0,r)}function ColorEffect(e,t,r){this.p=PropertyFactory.getProp(t,e.v,1,0,r)}function PointEffect(e,t,r){this.p=PropertyFactory.getProp(t,e.v,1,0,r)}function LayerIndexEffect(e,t,r){this.p=PropertyFactory.getProp(t,e.v,0,0,r)}function MaskIndexEffect(e,t,r){this.p=PropertyFactory.getProp(t,e.v,0,0,r)}function CheckboxEffect(e,t,r){this.p=PropertyFactory.getProp(t,e.v,0,0,r)}function NoValueEffect(){this.p={}}function EffectsManager(){}function EffectsManager(e,t){var r=e.ef||[];this.effectElements=[];for(var n,i=r.length,o=0;o<i;o++)n=new GroupEffect(r[o],t),this.effectElements.push(n)}function GroupEffect(e,t){this.init(e,t)}JZ=function(e,t){this.pv=1,this.comp=e.comp,this.elem=e,this.mult=.01,this.propType="textSelector",this.textTotal=t.totalChars,this.selectorValue=100,this.lastValue=[1,1,1],this.k=!0,this.x=!0,this.getValue=ExpressionManager.initiateExpression.bind(this)(e,t,this),this.getMult=LZ,this.getVelocityAtTime=expressionHelpers.getVelocityAtTime,this.kf?this.getValueAtTime=expressionHelpers.getValueAtTime.bind(this):this.getValueAtTime=expressionHelpers.getStaticValueAtTime.bind(this),this.setGroupProperty=expressionHelpers.setGroupProperty},KZ=TextSelectorProp.getTextSelectorProp,TextSelectorProp.getTextSelectorProp=function(e,t,r){return 1===t.t?new JZ(e,t,r):KZ(e,t,r)},extendPrototype([DynamicPropertyContainer],GroupEffect),GroupEffect.prototype.getValue=GroupEffect.prototype.iterateDynamicProperties,GroupEffect.prototype.init=function(e,t){this.data=e,this.effectElements=[],this.initDynamicPropertyContainer(t);for(var r,n=this.data.ef.length,i=this.data.ef,o=0;o<n;o+=1){switch(r=null,i[o].ty){case 0:r=new SliderEffect(i[o],t,this);break;case 1:r=new AngleEffect(i[o],t,this);break;case 2:r=new ColorEffect(i[o],t,this);break;case 3:r=new PointEffect(i[o],t,this);break;case 4:case 7:r=new CheckboxEffect(i[o],t,this);break;case 10:r=new LayerIndexEffect(i[o],t,this);break;case 11:r=new MaskIndexEffect(i[o],t,this);break;case 5:r=new EffectsManager(i[o],t,this);break;default:r=new NoValueEffect(i[o],t,this)}r&&this.effectElements.push(r)}};var lottie={},_isFrozen=!1;function setLocationHref(e){locationHref=e}function searchAnimations(){!0===standalone?animationManager.searchAnimations(animationData,standalone,renderer):animationManager.searchAnimations()}function setSubframeRendering(e){subframeEnabled=e}function loadAnimation(e){return!0===standalone&&(e.animationData=JSON.parse(animationData)),animationManager.loadAnimation(e)}function setQuality(e){if("string"==typeof e)switch(e){case"high":defaultCurveSegments=200;break;case"medium":defaultCurveSegments=50;break;case"low":defaultCurveSegments=10}else!isNaN(e)&&1<e&&(defaultCurveSegments=e);roundValues(!(50<=defaultCurveSegments))}function inBrowser(){return"undefined"!=typeof navigator}function installPlugin(e,t){"expressions"===e&&(expressionsPlugin=t)}function getFactory(e){switch(e){case"propertyFactory":return PropertyFactory;case"shapePropertyFactory":return ShapePropertyFactory;case"matrix":return Matrix}}function checkReady(){"complete"===document.readyState&&(clearInterval(readyStateCheckInterval),searchAnimations())}function getQueryVariable(e){for(var t=queryString.split("&"),r=0;r<t.length;r++){var n=t[r].split("=");if(decodeURIComponent(n[0])==e)return decodeURIComponent(n[1])}}lottie.play=animationManager.play,lottie.pause=animationManager.pause,lottie.setLocationHref=setLocationHref,lottie.togglePause=animationManager.togglePause,lottie.setSpeed=animationManager.setSpeed,lottie.setDirection=animationManager.setDirection,lottie.stop=animationManager.stop,lottie.searchAnimations=searchAnimations,lottie.registerAnimation=animationManager.registerAnimation,lottie.loadAnimation=loadAnimation,lottie.setSubframeRendering=setSubframeRendering,lottie.resize=animationManager.resize,lottie.goToAndStop=animationManager.goToAndStop,lottie.destroy=animationManager.destroy,lottie.setQuality=setQuality,lottie.inBrowser=inBrowser,lottie.installPlugin=installPlugin,lottie.freeze=animationManager.freeze,lottie.unfreeze=animationManager.unfreeze,lottie.getRegisteredAnimations=animationManager.getRegisteredAnimations,lottie.__getFactory=getFactory,lottie.version="5.6.10";var standalone="__[STANDALONE]__",animationData="__[ANIMATIONDATA]__",renderer="",scripts,index,myScript,queryString,renderer;standalone&&(scripts=document.getElementsByTagName("script"),index=scripts.length-1,myScript=scripts[index]||{src:""},queryString=myScript.src.replace(/^[^\?]+\??/,""),renderer=getQueryVariable("renderer"));var readyStateCheckInterval=setInterval(checkReady,100);return lottie},module.exports?module.exports=factory(root):(root.lottie=factory(root),root.bodymovin=root.lottie))})(lottie_svg_min$2);var lottie_svg_minExports=lottie_svg_min$2.exports,lottie_svg_min$1=getDefaultExportFromCjs(lottie_svg_minExports),defaultLoadingBarColor="#000000",audioSrc="https://vyu-web-sdk.enncrypto.com/v1_sdk_assets/audio/camera-shutter.mp3",apiUrl="https://verification-api.enncrypto.com",apiV2Url="https://api.enncrypto.com",wasmLib="https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.2/wasm",modelPath="https://vyu-web-sdk.enncrypto.com/models/model_democarton.tflite",vision={wasmLoaderPath:"https://vyu-web-sdk.enncrypto.com/models/vision_wasm_internal.js",wasmBinaryPath:"https://vyu-web-sdk.enncrypto.com/models/vision_wasm_internal.wasm"},qrServiceBaseUrl="https://qrverine.ops.enncrypto.com",cpuModeList=["CPH2015","V2231","vivo 1929","SM-A336E","M2101K7BI"],imageUrls=[{name:"genuine",gif:"https://vyu-web-sdk.enncrypto.com/v1_sdk_assets/Lottie/Genuine.json",icon:"https://vyu-web-sdk.enncrypto.com/v1_sdk_assets/Icons/genuine.png"},{name:"potentialFake",gif:"https://vyu-web-sdk.enncrypto.com/v1_sdk_assets/Lottie/Potential Fake.json",icon:"https://vyu-web-sdk.enncrypto.com/v1_sdk_assets/Icons/potential_fake.png"},{name:"cannotConfirm",gif:"https://vyu-web-sdk.enncrypto.com/v1_sdk_assets/Lottie/Cannot Confirm.json",icon:"https://vyu-web-sdk.enncrypto.com/v1_sdk_assets/Icons/cannot_confirm.png"},{name:"photoQualityIssue",gif:"https://vyu-web-sdk.enncrypto.com/v1_sdk_assets/Lottie/Photo Quality.json",icon:"https://vyu-web-sdk.enncrypto.com/v1_sdk_assets/Icons/photo_quality_issue.png"},{name:"connectionTimeout",gif:"https://vyu-web-sdk.enncrypto.com/v1_sdk_assets/Lottie/Connection.json",icon:"https://vyu-web-sdk.enncrypto.com/v1_sdk_assets/Icons/connection_timeout.png"},{name:"overlayMask",icon:"https://vyu-web-sdk.enncrypto.com/v1_sdk_assets/Images/overlay_mask.png"},{name:"overlayImage",icon:"https://vyu-web-sdk.enncrypto.com/v1_sdk_assets/Images/overlayV1.png"},{name:"QRoverlayMask",icon:"https://vyu-web-sdk.enncrypto.com/v1_sdk_assets/Images/QR_scan_mask_1.png"},{name:"verifyAnimation",icon:"https://vyu-web-sdk.enncrypto.com/v1_sdk_assets/Gif/verify-loader.gif"},{name:"rotateLeft",icon:"https://vyu-web-sdk.enncrypto.com/v1_sdk_assets/Icons/rotate-left.png"},{name:"arrowLeft",icon:"https://vyu-web-sdk.enncrypto.com/v1_sdk_assets/Icons/arrow-left.png"},{name:"capture",icon:"https://vyu-web-sdk.enncrypto.com/v1_sdk_assets/Icons/capture.png"},{name:"startLoadingAnimation",icon:"https://vyu-web-sdk.enncrypto.com/v1_sdk_assets/Gif/loader_v2.gif"},{name:"support",icon:"https://ennoventure-public-assets.s3.us-east-1.amazonaws.com/vyu_brand_engagement/icon/MORE_DETAILS_ARROW.png"}],DEFAULT_OVERLAY_IMG="https://vyu-web-sdk.enncrypto.com/blank_overlay.png",OVERLAY_ALT="overlay",defaultRefWidth=11,OVERLAY_MAX_HEIGHT="200PX",OVERLAY_MAX_WIDTH="200PX",loadingTexts=["Loading...","Almost Done...","Unlocking the truth behind your product...","We are using cutting-edge tech to ensure authenticity...","Connecting to authentication server..."],defaultOverlayActionButton={capturingImage:"Taking picture hold phone still...",verifying:"Verifying Authenticity...",scanQr:"Scan QR code"},defaultRoiActionText={positionOverlay:"Position this image on product logo",moveCloser:"Move closer",moveAway:"Move further away",perfectDistance:"Perfect distance, Lets stay here",wrongQr:"Wrong Qr code",labelNotFullyVisible:"Entire label not visible"},yaraScanIds=["P_Yara_Ya_Fe_In_Pv_Lt_HW_4BU","P_Yara_Ya_Fe_In_Pv_Lt_HW_2LY","P_Yara_Ya_Fe_In_Pv_Lt_HW_7K8","P_Yara_Ya_Fe_In_Pv_Lt_HW_48E","P_Yara_Ya_Fe_In_Pv_Lt_HW_8QM","P_Yara_Ya_Fe_In_Pv_Lt_HW_I2O","P_Yara_Ya_Fe_In_Pv_Lt_HW_8YS","P_Yara_Ya_Fe_In_Pv_Lt_HW_FFA","P_Yara_Ya_Fe_In_Pv_Lt_HW_MQE","P_Yara_Ya_Fe_In_Pv_Lt_HW_FKY","P_Yara_Ya_Fe_In_Pv_Lt_HW_OP7","P_Yara_Ya_Fe_In_Pv_Lt_HW_Z5F","P_Yara_Ya_Fe_In_Pv_Lt_HW_GF2","P_Yara_Ya_Fe_In_Pv_Lt_HW_JRZ","P_Yara_Ya_Fe_In_Pv_Lt_HW_3NH","P_Yara_Ya_Fe_In_Pv_Lt_HW_U98","P_Yara_Ya_Fe_In_Pv_Lt_HW_5TS","P_Yara_Ya_Fe_In_Pv_Lt_HW_809","P_Yara_Ya_Fe_In_Pv_Lt_HW_W1L","P_Yara_Ya_Fe_In_Pv_Lt_HW_MNW","P_Yara_Ya_Fe_In_Pv_Lt_HW_S1Z","P_Yara_Ya_Fe_In_Pv_Lt_HW_IGI","P_Yara_Ya_Fe_In_Pv_Lt_HW_4SS","P_Yara_Ya_Fe_In_Pv_Lt_HW_MMB","P_Yara_Ya_Fe_In_Pv_Lt_HW_JU8"],isROINaturallyTooClose=!0,naturallyTooCloseEventLogged=!1,isV2DensoProduct=!1,uiUpdateTimeout=null,lastDisplayedPrompt="";function createDivElem(){return document.createElement("div")}function createVideoElem(){return document.createElement("video")}function createImageElem(){return document.createElement("img")}function createButtonElem(){return document.createElement("button")}function createHeadElem(e){return document.createElement("h".concat(e))}function createSpanElem(){return document.createElement("span")}function showElement(e,t){null!==e&&(e.style.display=t)}function hideElement(e){null!==e&&(e.style.display="none")}function addBlur(e){return"blur(".concat(e,")")}var getDeviceId=function(){return localStorage.getItem("deviceId")},setDeviceId=function(e){localStorage.setItem("deviceId",e)},setProductId=function(e){localStorage.setItem("productId",e)},getProductId=function(){return localStorage.getItem("productId")},getDeviceCapabilities=function(){return localStorage.getItem("deviceCapabilities")},setDeviceCapabilities=function(e){localStorage.setItem("deviceCapabilities",JSON.stringify(e))},getVideoDevices=function(){return localStorage.getItem("videoDevices")},setVideoDevices=function(e){localStorage.setItem("videoDevices",JSON.stringify(e))},checkIfIOS=function(){var e=navigator.userAgent;return!(null==e.match(/iPhone/i)&&null==e.match(/iPad/i))},checkIfAndroid=function(){return!(null==navigator.userAgent.match(/Android/i))},setLottieAnimation=function(e,t){lottie_svg_min$1.loadAnimation({container:e,renderer:"svg",loop:!0,autoplay:!0,path:t})},preloadImage=function(e){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t,r){var n=document.createElement("link");n.rel="preload",n.href=e,n.as="image",n.onload=function(){t()},n.onerror=function(e){r(e)},document.head.appendChild(n)}));case 2:case"end":return t.stop()}}),t)})))},preloadImages=function(e){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(e.map((function(e){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:preloadImage(e.icon);case 1:case"end":return t.stop()}}),t)})))})));case 2:case"end":return t.stop()}}),t)})))},setStyles=function(e,t){Object.assign(e.style,t)},assignClass=function(e,t){e.className=t},dataURLtoFile=function(e,t){if(void 0!==e&&"data:,"!==e){for(var r=e.split(","),n=r[0].match(/:(.*?);/)[1],i=atob(r[1]),o=i.length,s=new Uint8Array(o),a=0;a<o;a++)s[a]=i.charCodeAt(a);return new File([s],t,{type:n})}},stopCamera=function(e){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function t(){var r;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null==(r=e.getVideoTracks())||r.forEach((function(e){e.stop()}));case 2:case"end":return t.stop()}}),t)})))},captureOrCalculateTimestamp=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=new Date;return t?e instanceof Date?r.getTime()-e.getTime():r.getTime()-e:r.getTime()},setupSentry=function(e){try{var t=window.Sentry,r=window.Sentry.Tracing;t.init({dsn:e.dsn,release:e.release,environment:e.environment,integrations:void 0!==e.tracesSampleRate?[new r]:void 0,tracesSampleRate:void 0!==e.tracesSampleRate?void 0!==e.tracesSampleRate:1})}catch(e){console.error("Failed to initialize Sentry:",e)}},logEvents=function(e,t,r){var n=new Set(["sendCameraPermissionGrantedEvent","sendLocationPermissionGrantedEvent","sendCameraPermissionDeniedEvent","sendLocationPermissionDeniedEvent","sendScanAgainClickedEvent","sendCaptureClickedDelayEvent","sendResultDisplayedEvent","sendResultDisplayedDelayEvent","sendTimeToProcessResultsDelayEvent","sendNetworkDelayEvent","sendExperienceFetchedDelayEvent","sendSessionStartedDelayEvent","sendCameraSelectionEvent","sendModelLoadDelayEvent","sendNaturallyTooCloseEvent","mqtt_connection_failed","mqtt_reconnected","mqtt_connection_offline","mqtt_connection_closed","mqtt_connection_ended","mqtt_disconnected","mqtt_connection_error","mqtt_connection_established","session_result_triggered","session_result_failed","session_result_success","session_result_failed"]);void 0!==e?void 0!==e.capture&&"function"==typeof e.capture&&n.has(t)?e.capture(t,r):console.warn("eventName not present in analyticsToolsEventList"):console.warn("Analytics tools not provided.")},loadAudio=function(e){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t){e.addEventListener("loadedmetadata",(function(){t()})),e.addEventListener("error",(function(e){console.error("Error loading audio:",e),t()})),e.load()}));case 2:case"end":return t.stop()}}),t)})))},checkPolygonIsInside=function(e,t,r,n,i,o,s,a){var c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,l=e-c,u=t-c,d=r+c,h=n+c;return i>=l&&i<=d&&(o>=u&&o<=h)&&(s>=l&&s<=d)&&(a>=u&&a<=h)},checkPolygonOverlap=function(e,t,r,n,i,o,s,a,c,l,u,d){var h=arguments.length>12&&void 0!==arguments[12]?arguments[12]:checkIfIOS()?15:25,f=arguments.length>13&&void 0!==arguments[13]?arguments[13]:checkIfIOS()?55:75,p=arguments.length>14&&void 0!==arguments[14]?arguments[14]:85;"SM-A325F"===d&&(f=85);var m=Math.max(0,Math.min(r,s)-Math.max(e,i))*Math.max(0,Math.min(n,a)-Math.max(t,o)),v=m/((r-e)*(n-t))*100,g=m/((s-i)*(a-o))*100;return u===defaultRoiActionText.positionOverlay?v<=h-5&&g>=p+5&&checkPolygonIsInside(e,t,r,n,i,o,s,a)?(u=defaultRoiActionText.moveCloser,isROINaturallyTooClose=!1):v>=f+5&&g<=p+5&&(naturallyTooCloseEventLogged||void 0===l||(naturallyTooCloseEventLogged=!0,logEvents(l,"sendNaturallyTooCloseEvent",isROINaturallyTooClose)),u=defaultRoiActionText.moveAway):u===defaultRoiActionText.moveCloser?v>=h+5&&v<=f+5&&g>=p+5?u=defaultRoiActionText.positionOverlay:v>=f+5&&g<=p+5&&(naturallyTooCloseEventLogged||void 0===l||(naturallyTooCloseEventLogged=!0,logEvents(l,"sendNaturallyTooCloseEvent",isROINaturallyTooClose)),u=defaultRoiActionText.moveAway):u===defaultRoiActionText.moveAway?v<=h-5&&g>=p+5&&checkPolygonIsInside(e,t,r,n,i,o,s,a)?(u=defaultRoiActionText.moveCloser,isROINaturallyTooClose=!1):v>=h+5&&v<=f+5&&g>=p+5&&(u=defaultRoiActionText.positionOverlay):v<=h&&g>=p&&checkPolygonIsInside(e,t,r,n,i,o,s,a)?(u=defaultRoiActionText.moveCloser,isROINaturallyTooClose=!1):v>=f&&g<=p?(naturallyTooCloseEventLogged||void 0===l||(naturallyTooCloseEventLogged=!0,logEvents(l,"sendNaturallyTooCloseEvent",isROINaturallyTooClose)),u=defaultRoiActionText.moveAway):v>=h&&v<=f&&g>=p&&(u=defaultRoiActionText.positionOverlay),void 0===u&&(u=defaultRoiActionText.positionOverlay),c.innerHTML="<p>".concat(u,"</p>"),{isValid:v>=h&&v<=f&&g>=p,currentPrompt:u}};function clearTimeouts(e,t){void 0!==e&&clearTimeout(e),void 0!==t&&clearTimeout(t)}var throttle=function(e,t){var r=!1;return function(){if(!r){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];e.apply(this,i),r=!0,setTimeout((function(){r=!1}),t)}}};function calculateCoordinates(e,t){var r,n,i,o;return checkIfIOS()?(r=.2*e,n=.29*t,i=.8*e,o=.56*t):(r=.14*e,n=.27*t,i=.86*e,o=.57*t),{x1:r,x2:i,y1:n,y2:o}}function placeDot(e,t,r,n){var i=document.createElement("div");setStyles(i,{position:"absolute",width:"10px",height:"10px",backgroundColor:n,borderRadius:"50%",transform:"translate(-50%, -50%)",zIndex:"3"}),i.className="dot",i.style.left=t+"px",i.style.top=r+"px",e.appendChild(i)}function calculateCoordinatesV3(e,t,r){var n=sessionStorage.getItem("overlayCoords");if(null==n){var i=e.getBoundingClientRect(),o=i.x,s=i.y,a=(i.x+i.width+o)/2,c=t/(checkIfIOS()?1.6:1.4)/2,l=r/3.2/2,u=a-c,d=s-l,h=a+c,f=s+l;return sessionStorage.setItem("overlayCoords",JSON.stringify({x1:u,x2:h,y1:d,y2:f})),{x1:u,x2:h,y1:d,y2:f}}return JSON.parse(n)}var getImageUrl=function(e){return imageUrls.find((function(t){return t.name===e}))},handleWarningPrompts=function(e,t,r,n){var i=document.querySelector(".warning-prompt"),o=document.createElement("img");if(o.alt="Warning Icon",null===i){(i=createDivElem()).className="warning-prompt",setStyles(i,{display:"none",position:"absolute",width:"80%",height:"40px",left:"10%",borderRadius:"8px",flexDirection:"row-reverse",zIndex:"1",justifyContent:"flex-end",alignItems:"center",fontFamily:"Carnas-Bold",color:"white",textAlign:"center",padding:"5px",top:"calc(-50% - 55px)"});var s=document.querySelector(".scan-region-highlight");null!==s&&s.appendChild(i)}null!==i&&n.light.status?(i.innerHTML="<div>".concat(n.light.label,"</div>"),o.src=n.light.icon,i.appendChild(o),setStyles(i,{background:"rgba(240, 178, 22, 0.5)",display:"flex"})):null!==i&&!n.light.status&&n.shake.status&&e?(i.innerHTML="<div>".concat(n.shake.label,"</div>"),o.src=n.shake.icon,i.appendChild(o),setStyles(i,{background:"rgba(190, 37, 43, 0.66)",display:"flex"})):setStyles(i,{display:"none"}),null!=i&&e&&(i.style.display="flex",t.push(!1),t.length>r&&t.shift())},handleGuidePrompts=function(e,t,r){var n=document.querySelector(".guide-prompt");if(null===n){(n=createDivElem()).className="guide-prompt",setStyles(n,{display:"none",background:"#464646",position:"absolute",width:"80%",height:"40px",left:"10%",borderRadius:"8px",flexDirection:"row-reverse",zIndex:"1",justifyContent:"flex-end",alignItems:"center",fontFamily:"Carnas-Bold",color:"white",textAlign:"center",padding:"5px",top:"-50%"});var i=document.querySelector(".scan-region-highlight");null!==i&&i.appendChild(n)}if(n.innerHTML="<div>".concat(e,"</div>"),null!==n&&t)setStyles(n,{display:"flex"});else if(null!==n&&void 0!==r){setStyles(n,{display:"flex"});var o=document.createElement("img");o.src=r,o.alt="Warning Icon",n.appendChild(o)}};function applyImageFilters(e,t){function r(e){return Math.min(255,Math.max(0,e))}for(var n=e.getImageData(0,0,t.width,t.height),i=n.data,o=0;o<i.length;o+=4)i[o]=i[o]+40,i[o+1]=i[o+1]+40,i[o+2]=i[o+2]+40,i[o]=r(1.2*(i[o]-128)+128),i[o+1]=r(1.2*(i[o+1]-128)+128),i[o+2]=r(1.2*(i[o+2]-128)+128);return e.putImageData(n,0,0),t.toDataURL("image/png")}var lastX=null,lastY=null,lastZ=null,consecutiveFalseCount=0;function handleMotion(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.4,i=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0,a=arguments.length>7?arguments[7]:void 0;if(!r){var c=e.acceleration;if(void 0!==c){var l=c.x,u=c.y,d=c.z,h=logInfoOnUI(t,"handleMotionLogs");if(null!==lastX&&null!==lastY&&null!==lastZ){var f=Math.abs(l-lastX),p=Math.abs(u-lastY),m=Math.abs(d-lastZ);f>n||p>n||m>n?(a.shake.status=!0,handleWarningPrompts(!0,o,s,a),consecutiveFalseCount=0,i&&(h.innerHTML="<p>Shake Status: Shaking Detected!; shakeValue deltaX: ".concat(f,", deltaY: ").concat(p,", deltaZ: ").concat(m,"</p>"))):(consecutiveFalseCount+=1)>=30&&(a.shake.status=!1,handleWarningPrompts(!1,o,s,a))}lastX=l,lastY=u,lastZ=d}}}function logInfoOnUI(e,t){var r=document.querySelector(".".concat(t));return null===r&&((r=createDivElem()).className=t,r.style.zIndex="50000",r.style.position="absolute",r.style.top="1%",r.style.background="wheat",e.appendChild(r)),r}function calculateDimensions(e){if(4!==e.cornerPoints.length)throw new Error("Exactly 4 corner points are required.");var t=e.cornerPoints[0],r=e.cornerPoints[1],n=e.cornerPoints[3],i=Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2)),o=Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2));return{width:i,height:o,area:i*o}}var densoScanIdsV2=["P_Denso_De_Co_QX_I8G","P_Denso_De_Co_QX_PBS","P_Denso_De_Co_QX_2SL","P_Denso_De_Co_QX_MBU","P_Denso_De_Co_QX_5OU","P_Denso_De_Co_QX_GLJ","P_Denso_De_Co_QX_VEX","P_Denso_De_Co_QX_OCJ","P_Denso_De_Co_QX_8AY"];function checkIfDenso(){var e=getProductId(),t=[].concat(densoScanIdsV2,["denso_mexico","denso_colombia"]);return densoScanIdsV2.includes(null!=e?e:"")&&(isV2DensoProduct=!0),t.includes(null!=e?e:"")}function isDensoV2product(){var e=getProductId();return!!densoScanIdsV2.includes(null!=e?e:"")}function checkIfBigYara(){var e=getProductId();return null!==e&&yaraScanIds.includes(e)}var setDensoRoiActionText=function(e,t,r,n,i,o,s){var a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,d=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,h=arguments.length>12&&void 0!==arguments[12]?arguments[12]:10,f=arguments.length>14?arguments[14]:void 0;if(void 0===r&&(r=defaultRoiActionText.positionOverlay),null==f||!f){var p,m=function(e,t){r=e,handleStableBuffer(n,i,t)};if(0===d)p=setTimeout((function(){return r=defaultRoiActionText.positionOverlay}),2e3);else{clearTimeout(p);var v=getCenterCoordinates(),g=o.offsetWidth/o.videoWidth,_=o.offsetHeight/o.videoHeight,y=function(r,n,i){return r===defaultRoiActionText.perfectDistance||r===defaultRoiActionText.labelNotFullyVisible?n>=t-i&&n<=e+i:r===defaultRoiActionText.moveCloser?n>=t+i:r===defaultRoiActionText.moveAway&&n<=e-i};y(r,d,h)||isV2DensoProduct?!y(r,d,h)&&isV2DensoProduct&&(d>=t&&d<=e?c*g>=v.x&&u*_*1.05>v.y&&l*_*.95<v.y?m(defaultRoiActionText.perfectDistance,!0):c*g<v.x?m(defaultRoiActionText.labelNotFullyVisible,!1):m(defaultRoiActionText.positionOverlay,!1):d<t?m(defaultRoiActionText.moveCloser,!1):d>e&&m(defaultRoiActionText.moveAway,!1)):d>=t&&d<=e?a*g<=v.x&&u*_>v.y&&l*_<v.y?m(defaultRoiActionText.perfectDistance,!0):a*g>v.x?m(defaultRoiActionText.labelNotFullyVisible,!1):m(defaultRoiActionText.positionOverlay,!1):d<t?m(defaultRoiActionText.moveCloser,!1):d>e&&m(defaultRoiActionText.moveAway,!1)}var b=r.length>0?r:defaultRoiActionText.positionOverlay;b!==lastDisplayedPrompt&&(null!=uiUpdateTimeout&&clearTimeout(uiUpdateTimeout),""===(lastDisplayedPrompt=b)||b===defaultRoiActionText.perfectDistance||b===defaultRoiActionText.moveCloser||b===defaultRoiActionText.moveAway?handleGuidePrompts(b,!0,s):uiUpdateTimeout=setTimeout((function(){handleGuidePrompts(b,!0,s)}),1e3))}},setDensoRoiActionCustomDevicesText=function(e,t,r,n,i,o){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:10;void 0===r&&(r=defaultRoiActionText.positionOverlay);var c,l=function(e,t){r=e,handleStableBuffer(n,i,t)};if(0===s)c=setTimeout((function(){return r=defaultRoiActionText.positionOverlay}),2e3);else{clearTimeout(c);(function(r,n,i){return r===defaultRoiActionText.perfectDistance||r===defaultRoiActionText.labelNotFullyVisible?n>=t-i&&n<=e+i:r===defaultRoiActionText.moveCloser?n>=t+i:r===defaultRoiActionText.moveAway&&n<=e-i})(r,s,a)||(s>=t&&s<=e?l(defaultRoiActionText.perfectDistance,!0):s<t?l(defaultRoiActionText.moveCloser,!1):s>e&&l(defaultRoiActionText.moveAway,!1))}handleGuidePrompts(r,!0,o)},handleStableBuffer=function(e,t,r){e.push(r),e.length>t&&e.shift()},getCenterCoordinates=function(){var e=window.innerWidth,t=e/2;return{x:t+.05*e,y:window.innerHeight/2}};function createToggleButton(e){if(null===document.querySelector(".toggle-button")){var t=createDivElem();setStyles(t,{display:"flex",alignItems:"center",justifyContent:"center"});var r=createDivElem();r.innerHTML="<p>Enable Test Mode: </p>",setStyles(r,{fontFamily:"Carnas-Regular",fontSize:"1.2rem",marginRight:"6%"});var n=document.createElement("label");n.classList.add("toggle-button");var i=document.createElement("input");i.type="checkbox";var o=document.createElement("span");o.classList.add("slider"),n.appendChild(i),n.appendChild(o),t.appendChild(r),t.appendChild(n),e.appendChild(t),setStyles(n,{position:"relative",width:"60px",height:"34px"}),setStyles(o,{position:"absolute",cursor:"pointer",top:"0",left:"0",right:"0",bottom:"0",backgroundColor:"#ccc",transition:"0.4s",borderRadius:"34px"});var s=document.createElement("style");s.innerHTML='\n        .toggle-button .slider::before {\n            position: absolute;\n            content: "";\n            height: 26px;\n            width: 26px;\n            left: 4px;\n            bottom: 4px;\n            background-color: white;\n            transition: 0.4s;\n            border-radius: 50%;\n        }\n        .toggle-button input:checked + .slider {\n            background-color: #2196F3;\n        }\n        .toggle-button input:checked + .slider::before {\n            transform: translateX(26px);\n        }\n    ',document.head.appendChild(s);var a="true"===localStorage.getItem("enableTestDataCollection");i.checked=a,a&&setStyles(o,{backgroundColor:"#2196F3"}),i.addEventListener("change",(function(){var e=i.checked;localStorage.setItem("enableTestDataCollection","".concat(e)),setStyles(o,e?{backgroundColor:"#2196F3"}:{backgroundColor:"#ccc"}),window.location.reload()}))}}function applyConstraints(e,t){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function r(){var n;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(void 0===e){r.next=10;break}return n=e.getVideoTracks()[0],r.prev=2,r.next=5,n.applyConstraints(t);case 5:r.next=10;break;case 7:r.prev=7,r.t0=r.catch(2),console.error("Error applying constraints",r.t0);case 10:case"end":return r.stop()}}),r,null,[[2,7]])})))}function applyZoomConstraint(e,t){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function r(){return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,applyConstraints(e,{zoom:{exact:t}});case 2:case"end":return r.stop()}}),r)})))}function applyFocusMode(e,t){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function r(){return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,applyConstraints(t,{focusMode:e});case 2:case"end":return r.stop()}}),r)})))}function calculateAndSetPointOfInterest(e,t,r){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function n(){var i,o,s,a,c;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=(e.cornerPoints[0].x+e.cornerPoints[1].x+e.cornerPoints[2].x+e.cornerPoints[3].x)/4,o=(e.cornerPoints[0].y+e.cornerPoints[1].y+e.cornerPoints[2].y+e.cornerPoints[3].y)/4,s=t.offsetWidth/t.videoWidth,a=t.offsetHeight/t.videoHeight,c={pointsOfInterest:[{x:i*s,y:o*a}]},n.next=7,applyConstraints(r,{advanced:[c]});case 7:case"end":return n.stop()}}),n)})))}var _CROSS_BTN_ID$CROSS_S={CROSS_BTN_ID:"vyu-abort",CROSS_SVG_STRING:'<svg height="1rem" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M18.088 16.2324C18.3345 16.4702 18.4731 16.7926 18.4731 17.1289C18.4731 17.4651 18.3345 17.7876 18.088 18.0254C17.8414 18.2631 17.507 18.3967 17.1583 18.3967C16.8096 18.3967 16.4752 18.2631 16.2286 18.0254L9.28438 11.3271L2.33797 18.0233C2.0914 18.261 1.75698 18.3946 1.40828 18.3946C1.05958 18.3946 0.725164 18.261 0.478595 18.0233C0.232027 17.7855 0.0935059 17.463 0.0935059 17.1268C0.0935059 16.7905 0.232027 16.4681 0.478595 16.2303L7.425 9.53409L0.480782 2.83577C0.234214 2.59801 0.0956934 2.27553 0.0956934 1.93929C0.0956934 1.60304 0.234214 1.28056 0.480782 1.0428C0.727351 0.805038 1.06177 0.671465 1.41047 0.671465C1.75917 0.671465 2.09359 0.805038 2.34016 1.0428L9.28438 7.74112L16.2308 1.04175C16.4774 0.803983 16.8118 0.67041 17.1605 0.67041C17.5092 0.67041 17.8436 0.803983 18.0902 1.04175C18.3367 1.27951 18.4752 1.60198 18.4752 1.93823C18.4752 2.27448 18.3367 2.59695 18.0902 2.83471L11.1438 9.53409L18.088 16.2324Z" fill="white"/>\n  </svg>',CROSS_SVG_BLACK_STRING:'<svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M14.9663 0.798828C7.08468 0.798828 0.687988 7.25499 0.687988 15.2099C0.687988 23.1648 7.08468 29.621 14.9663 29.621C22.8479 29.621 29.2446 23.1648 29.2446 15.2099C29.2446 7.25499 22.8479 0.798828 14.9663 0.798828ZM14.9663 26.7388C8.66957 26.7388 3.54365 21.5652 3.54365 15.2099C3.54365 8.85462 8.66957 3.68104 14.9663 3.68104C21.263 3.68104 26.389 8.85462 26.389 15.2099C26.389 21.5652 21.263 26.7388 14.9663 26.7388Z" fill="white"/>\n  <path d="M9.89941 20.2754L20.0331 10.1445M9.89941 10.1445L20.0331 20.2754" stroke="white" stroke-width="2" stroke-linecap="round"/>\n  </svg>'},CROSS_BTN_ID=_CROSS_BTN_ID$CROSS_S.CROSS_BTN_ID,CROSS_SVG_STRING=_CROSS_BTN_ID$CROSS_S.CROSS_SVG_STRING,CROSS_SVG_BLACK_STRING=_CROSS_BTN_ID$CROSS_S.CROSS_SVG_BLACK_STRING;function createCrossButton(e,t,r,n){var i=createDivElem();i.id=CROSS_BTN_ID,i.className="vyu-scanner__abort",i.style.position="absolute",i.style.zIndex="2",i.style.top="4%",i.style.left="4%";var o=(new DOMParser).parseFromString(CROSS_SVG_BLACK_STRING,"image/svg+xml").documentElement;i.appendChild(o),i.onclick=function(){removePopup(),createLeaveConfirmationPopup(t,r,n),openPopup()},e.appendChild(i)}function openPopup(){var e=document.getElementById("leaveConfirmationPopup");null!==e&&(e.style.display="flex")}function removePopup(){var e=document.getElementById("leaveConfirmationPopup"),t=document.getElementById("qrIssuePopup");null!==e&&e.remove(),null!==t&&t.remove()}function closePopup(){var e=document.getElementById("leaveConfirmationPopup");null!==e&&(e.style.display="none")}function createLeaveConfirmationPopup(e,t,r){var n=createDivElem();n.id="leaveConfirmationPopup",n.style.display="none",n.style.width="80.5%",n.style.height="27%",n.style.top="28%",n.style.left="10%",n.style.position="absolute",n.style.zIndex="5",n.style.borderRadius="8px",n.style.textAlign="center",n.style.color="#1D1D1D",n.style.flexDirection="column",n.style.justifyContent="space-around",n.style.background="#cfcfcf";var i=createDivElem();i.style.height="54%",i.style.display="flex",i.style.flexDirection="column",i.style.justifyContent="center";var o=createDivElem();o.style.fontSize="17px",o.style.fontFamily="Carnas-Regular",o.style.fontWeight="800",o.innerText="Leave this page?",i.appendChild(o);var s=createDivElem();s.style.fontSize="13px",s.style.fontFamily="Carnas-Regular",s.style.color="#1D1D1D",s.style.paddingTop="5%",s.innerText="Do you want to leave the authentication process?",i.appendChild(s),n.appendChild(i);var a=createDivElem();a.classList.add("button-container"),a.style.display="flex",a.style.justifyContent="center",a.style.height="46%",a.style.flexDirection="column",a.style.paddingBottom="1%";var c=createDivElem();c.classList.add("popup-button"),c.style.borderTop="1px solid #E6E6E6",c.style.height="50%",c.style.display="flex",c.style.justifyContent="space-around",c.style.alignItems="center",c.style.fontSize="17px",c.style.fontFamily="Carnas-Regular",c.innerText="Leave",c.onclick=function(){destroy(e,t,r).catch((function(e){console.error("error in destory sdk",e)}))},a.appendChild(c);var l=createDivElem();l.classList.add("popup-button"),l.style.borderTop="1px solid #E6E6E6",l.style.height="50%",l.style.borderBottomLeftRadius="8px",l.style.borderBottomRightRadius="8px",l.style.display="flex",l.style.justifyContent="space-around",l.style.alignItems="center",l.style.fontSize="17px",l.style.fontFamily="Carnas-Regular",l.innerText="Cancel",l.onclick=function(){closePopup()},a.appendChild(l),n.appendChild(a),document.body.appendChild(n)}function createQRIssuePopup(e,t){removePopup();var r=document.getElementById("overlay");null!==r&&(r.style.display="flex");var n=createDivElem();n.id="qrIssuePopup",n.style.display="flex",n.style.width="72%",n.style.height="17%",n.style.top="34%",n.style.left="14.5%",n.style.position="absolute",n.style.zIndex="5",n.style.borderRadius="14px",n.style.textAlign="center",n.style.color="#1D1D1D",n.style.flexDirection="column",n.style.justifyContent="space-between",n.style.background="#cfcfcf";var i=createDivElem();i.style.height="65%",i.style.display="flex",i.style.flexDirection="column",i.style.justifyContent="center";var o=createDivElem();o.style.fontSize="17px",o.style.fontFamily="Carnas-Regular",o.style.fontWeight="800",o.innerText="Unable to read this code",i.appendChild(o);var s=createDivElem();s.style.fontSize="13px",s.style.fontFamily="Carnas-Regular",s.style.paddingTop="2%",s.innerText="Please scan a valid QR code",i.appendChild(s),n.appendChild(i);var a=createDivElem();a.classList.add("button-container"),a.style.display="flex",a.style.justifyContent="center",a.style.height="35%",a.style.flexDirection="column";var c=createDivElem();c.classList.add("popup-button"),c.style.borderTop="1px solid #E6E6E6",c.style.height="100%",c.style.display="flex",c.style.justifyContent="space-around",c.style.alignItems="center",c.style.fontSize="17px",c.style.fontFamily="Carnas-Regular",c.style.borderBottomLeftRadius="14px",c.style.borderBottomRightRadius="14px",c.innerText="Try Again",c.onclick=function(){e.start(),t.style.display="flex",removePopup()},a.appendChild(c),n.appendChild(a),document.body.appendChild(n)}function destroy(e,t,r){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function n(){return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0!==e&&(e.stop(),e.destroy()),void 0===t){n.next=4;break}return n.next=4,stopCamera(this.stream);case 4:r.remove(),removePopup();case 6:case"end":return n.stop()}}),n,this)})))}var createHowToScanScreen=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"How to scan?",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Start Scanning",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2e4,o=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0,a=arguments.length>7?arguments[7]:void 0,c=document.querySelector("demo-container");null!==c&&(c.style.display="none"===c.style.display?"flex":"none");var l=createDivElem();a&&createToggleButton(l),l.className="demo-container",setStyles(l,{position:"absolute",zIndex:"10",background:"#ffffff",height:"100%",width:"100%",display:"none"});var u=createHeadElem(2);u.textContent=r,setStyles(u,{textAlign:"center",margin:"20px 0",fontFamily:"Carnas-Bold"});var d=createDivElem();d.className="media-container",setStyles(d,{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"});var h,f=function(){var e=createDivElem();e.className="button-container",setStyles(e,{width:"100%",display:"flex",justifyContent:"space-around"});var t=createButtonElem();t.className="vyu-scanner__placeholder-btn",t.innerText=n,t.addEventListener("click",(function(){l.style.display="none";try{DeviceMotionEvent.requestPermission()}catch(e){console.error(e)}})),e.appendChild(t),l.appendChild(e)},p=function(){setTimeout((function(){l.style.display="none"}),i)};void 0!==t&&(t.endsWith(".mp4")||t.endsWith(".webm")||t.endsWith(".ogg"))?((h=createVideoElem()).src=t,h.alt="Loading Video",h.autoplay=!0,h.loop=!0,h.muted=!0,h.className="media-container__video",h.controls=!1,h.playsInline=!0,h.addEventListener("loadeddata",(function(){l.style.display="block",f(),p(),s(),o()}))):((h=createImageElem()).src=t,h.alt="Loading GIF",h.style.maxWidth="80%",h.addEventListener("load",(function(){l.style.display="block",f(),p(),s(),o()}))),d.appendChild(u),d.appendChild(h),l.appendChild(d),e.appendChild(l)},getPermission$1=function(e,t){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function r(){var n,i,o,s,a,c,l,u,d,h;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(console.log(" [Location] Starting location permission flow"),n="user_location_data",i=18e5,null==(o=localStorage.getItem(n))){r.next=26;break}if(console.log(" [Location] Found stored location data, checking validity"),r.prev=6,s=JSON.parse(o),a=(new Date).getTime(),c=a-s.timestamp,l=Math.floor(c/6e4),console.log(" [Location] Stored data age: ".concat(l," minutes (expires at ").concat(30," minutes)")),!(c<i)){r.next=17;break}return console.log(" [Location] Using cached location: lat=".concat(s.lat.toFixed(4),", long=").concat(s.long.toFixed(4))),r.abrupt("return",{lat:s.lat,long:s.long});case 17:console.log(" [Location] Cached data expired, fetching fresh coordinates");case 18:r.next=24;break;case 20:r.prev=20,r.t0=r.catch(6),console.error("Error parsing stored location data:",r.t0),console.log(" [Location] Will fetch fresh coordinates due to parse error");case 24:r.next=27;break;case 26:console.log(" [Location] No cached location data found, requesting new coordinates");case 27:return u={lat:0,long:0},r.prev=28,console.log(" [Location] Requesting geolocation permission from browser"),r.next=32,new Promise((function(t,r){navigator.geolocation.getCurrentPosition((function(r){var n={latitude:r.coords.latitude,longitude:r.coords.longitude};console.log(" [Location] Permission granted, received coordinates"),logEvents(e,"sendLocationPermissionGrantedEvent",captureOrCalculateTimestamp()),t(n)}),(function(t){console.warn(" [Location] Permission denied: ".concat(t.message)),logEvents(e,"sendLocationPermissionDeniedEvent",captureOrCalculateTimestamp()),r(t)}))}));case 32:return void 0!==(d=r.sent)&&(u.lat=d.latitude,u.long=d.longitude,console.log(" [Location] New coordinates: lat=".concat(u.lat.toFixed(4),", long=").concat(u.long.toFixed(4))),h={lat:u.lat,long:u.long,timestamp:(new Date).getTime()},localStorage.setItem(n,JSON.stringify(h)),console.log(" [Location] Stored new coordinates in localStorage with current timestamp")),r.abrupt("return",u);case 37:return r.prev=37,r.t1=r.catch(28),console.error(" [Location] Failed to get coordinates: ".concat(r.t1.message)),void 0!==t&&(console.log(" [Location] Calling error callback function"),t({type:"Location",err:"Error fetching coordinates: ".concat(r.t1.message)})),r.abrupt("return",void 0);case 42:case"end":return r.stop()}}),r,null,[[6,20],[28,37]])})))},_LOADING_ANIMATION_VE={LOADING_ANIMATION_VERIFYING_CONTAINER_CLASS:"vyu-loader__verification"},LOADING_ANIMATION_VERIFYING_CONTAINER_CLASS=_LOADING_ANIMATION_VE.LOADING_ANIMATION_VERIFYING_CONTAINER_CLASS,audio=new Audio;function setOverlay(e,t){var r,n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function a(){var c,l,u,d;return _regeneratorRuntime().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:c=null!==(r=null==t?void 0:t.actualLabelWidth)&&void 0!==r?r:0,l=window.innerWidth,u=null!==(n=checkIfIOS()?null==t?void 0:t.ios:null==t?void 0:t.android)&&void 0!==n?n:defaultRefWidth,d=c*l/u,void 0!==i?o.style.width=void 0!==d?"".concat(d,"px"):"100%":(o.style.maxHeight=OVERLAY_MAX_HEIGHT,o.style.maxWidth=OVERLAY_MAX_WIDTH),o.className=s,o.src=null!=e?e:DEFAULT_OVERLAY_IMG,o.alt=OVERLAY_ALT,o.style.position="absolute",o.onerror=function(e){e.currentTarget instanceof HTMLImageElement&&(e.currentTarget.src=DEFAULT_OVERLAY_IMG)};case 10:case"end":return a.stop()}}),a)})))}function setOverlayV1(e,t){var r,n,i,o,s,a,c,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,u=arguments.length>3?arguments[3]:void 0,d=arguments.length>4?arguments[4]:void 0,h=arguments.length>5?arguments[5]:void 0,f=arguments.length>6?arguments[6]:void 0,p=arguments.length>7?arguments[7]:void 0;return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function m(){var v,g,_,y,b,w,k,S,E,C,T,P,A,x,B,I;return _regeneratorRuntime().wrap((function(m){for(;;)switch(m.prev=m.next){case 0:null===document.querySelector(".".concat(h))&&(v=null!==(r=null==t?void 0:t.actualLabelWidth)&&void 0!==r?r:0,g=window.innerWidth,_=checkIfIOS()?null!==(n=null==t?void 0:t.ios)&&void 0!==n?n:defaultRefWidth:null!==(i=null==t?void 0:t.android)&&void 0!==i?i:defaultRefWidth,y=v*g/_,b=checkIfIOS()?.6:1,"SM-A325F"===p&&(b=1.55),void 0!==l?u.style.width=void 0!==y?"".concat(1.5*y*b,"px"):"100%":(u.style.maxHeight=OVERLAY_MAX_HEIGHT,u.style.maxWidth=OVERLAY_MAX_WIDTH),u.style.zIndex="2",w=createDivElem(),k=createImageElem(),w.className=h,u.alt=OVERLAY_ALT,S=null!=f?f:getImageUrl("overlayMask").icon,E=/\.(jpeg|jpg|gif|png|webp|bmp|svg)$/i,void 0!==e&&E.test(e)&&(C=e,u.src=C,u.classList.add("fadeIn"),setStyles(u,{position:"absolute",opacity:"0",animation:"fadeIn 1.5s forwards"}),w.appendChild(u)),preloadImage(S),k.src=S,P=(T=1.5*g/_)*(null!==(o=null==t?void 0:t.down)&&void 0!==o?o:0)*b,A=T*(null!==(s=null==t?void 0:t.left)&&void 0!==s?s:0)*b,x=T*(null!==(a=null==t?void 0:t.up)&&void 0!==a?a:0)*b,B=T*(null!==(c=null==t?void 0:t.right)&&void 0!==c?c:0)*b,setStyles(w,Object.assign({position:"absolute",width:"100%",height:"84%",bottom:"16%",display:"flex",alignItems:"center",justifyContent:"center",margin:"calc(-16dvh + ".concat(P,"px) ").concat(A,"px ").concat(x,"px ").concat(B,"px")},0===P?{bottom:"16%"}:{})),I=checkIfIOS()?"150%":"185%",setStyles(k,{width:I}),w.appendChild(k),d.appendChild(w),u.onerror=function(e){e.currentTarget instanceof HTMLImageElement&&(e.currentTarget.src=DEFAULT_OVERLAY_IMG)});case 2:case"end":return m.stop()}}),m)})))}function setQROverlayMask(e,t){var r=createDivElem();r.className=t,setStyles(r,{position:"absolute",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",zIndex:"1",bottom:"8%"});var n=createImageElem();n.src=getImageUrl("QRoverlayMask").icon;var i=checkIfIOS()?"150%":"185%";setStyles(n,{width:i}),r.appendChild(n),e.appendChild(r)}audio.src=audioSrc,document.addEventListener("DOMContentLoaded",(function(){loadAudio(audio),preloadImages(imageUrls)}));var setOverlayText=function(e,t){var r=createDivElem();r.className=t,e.appendChild(r)},createLoaderBar=function(e,t,r,n,i){var o=document.querySelector(".".concat(t));null!==o&&o instanceof HTMLElement&&(o.textContent=defaultOverlayActionButton.capturingImage,setStyles(o,{fontFamily:"Carnas-Regular",position:"absolute",borderRadius:"4px",width:"66%",height:"6%",top:"60%",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",backgroundColor:"#0A0A0A",fontSize:"15px",color:"#ffff"}));var s=createDivElem();s.classList.add("".concat(n)),setStyles(s,{width:"72%",backgroundColor:"#fffeff",top:"68%",height:"1.8%",borderRadius:"30px",overflow:"hidden",position:"absolute"});var a=createDivElem();a.classList.add("".concat(r)),setStyles(a,{width:"0",height:"100%",backgroundColor:i,transition:"width 0.5s ease-in-out"}),s.appendChild(a),e.appendChild(s)},updateLoadingBar=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function n(){var i,o;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!==(i=document.querySelector(".".concat(r)))){n.next=4;break}return console.error("Loader bar element not found"),n.abrupt("return");case 4:10,o=e/t*(10/t)*100,i.style.width="".concat(o,"%");case 7:case"end":return n.stop()}}),n)})))},playAudio=function(){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.appendChild(audio),e.next=3,audio.play();case 3:case"end":return e.stop()}}),e)})))},setPreview=function(e,t,r,n,i,o){1===e&&(t.removeChild(r),i.src=n,o.srcObject=null,t.replaceChild(i,o))},removeOverlay=function(e){var t=document.querySelector(".".concat(e));null!==t&&t instanceof HTMLElement&&t.remove()},setVerifyAnimation=function(e,t){var r=createDivElem();r.className=LOADING_ANIMATION_VERIFYING_CONTAINER_CLASS;var n=createImageElem();n.src=null!=t?t:getImageUrl("verifyAnimation").icon,setStyles(r,{position:"absolute",display:"flex",top:"40%",flexWrap:"nowrap",justifyContent:"space-around",width:"40%"}),setStyles(n,{width:"76%"}),r.appendChild(n),e.appendChild(r)},removeVerifyAnimation=function(){var e=document.querySelector(".".concat(LOADING_ANIMATION_VERIFYING_CONTAINER_CLASS));null!==e&&e instanceof HTMLElement&&e.remove()},setNewPreview=function(e,t,r,n,i,o,s,a,c,l){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function u(){var d;return _regeneratorRuntime().wrap((function(u){for(;;)switch(u.prev=u.next){case 0:if(0!==e){u.next=9;break}return u.next=3,cameraSnapEffect(o,t,s,a);case 3:d=createDivElem(),setStyles(d,{position:"absolute",height:"100%",width:"100%"}),c||setVerifyAnimation(t,l),n.src=r,d.appendChild(n),t.contains(i)?t.replaceChild(d,i):t.appendChild(d);case 9:case"end":return u.stop()}}),u)})))},cameraSnapEffect=function(e,t,r,n){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function i(){var o,s;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o=createDivElem(),setStyles(o,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",backgroundColor:"black",opacity:"1",transition:"opacity 0.3s ease-out",pointerEvents:"none",zIndex:"1"}),s=document.querySelector(".".concat(e)),removeOverlay(n),t.appendChild(o),i.prev=5,i.next=8,playAudio();case 8:i.next=13;break;case 10:i.prev=10,i.t0=i.catch(5),console.error("error in playAudio",i.t0);case 13:setTimeout((function(){t.removeChild(o);var e=document.querySelector(".".concat(r));null!==e&&e instanceof HTMLElement&&(setStyles(e,{fontFamily:"Carnas-Regular",position:"absolute",borderRadius:"4px",width:"66%",height:"6%",top:"64%",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",backgroundColor:"unset",fontSize:"15px",color:"#ffff"}),e.textContent=defaultOverlayActionButton.verifying,e.style.zIndex="2"),null!==s&&s instanceof HTMLElement&&(s.style.display="none")}),300);case 14:case"end":return i.stop()}}),i,null,[[5,10]])})))},manageBrandRedirection=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(!e.enableBrandRedirection||!e.brandRedirectionLink)return{shouldRedirect:!1,redirectAfterDelay:!1};var r="brandRedirection_".concat(t),n="brandRedirectionTime_".concat(t),i=Date.now(),o=sessionStorage.getItem(r),s=sessionStorage.getItem(n),a=0,c=i;o&&s?(a=parseInt(o,10)||0,i-(c=parseInt(s,10)||i)>60*(e.brandRedirectionResultTime||15)*1e3&&(a=0,c=i)):c=i;return a++,sessionStorage.setItem(r,a.toString()),sessionStorage.setItem(n,c.toString()),a>=(e.brandRedirectionResultCount||3)?{shouldRedirect:!0,redirectAfterDelay:!0}:{shouldRedirect:!1,redirectAfterDelay:!1}},handleDelayedRedirection=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=e.brandRedirectionWaitTime||1e3;setTimeout((function(){var r="brandRedirection_".concat(t),n="brandRedirectionTime_".concat(t);sessionStorage.removeItem(r),sessionStorage.removeItem(n),e.brandRedirectionLink&&(window.location.href=e.brandRedirectionLink)}),r)},createResultDiv=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"#121214",c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"",l={GENUINE:{status:"Genuine",text:"This product is genuine.",gifUrl:getImageUrl("genuine").gif,icon:getImageUrl("genuine").icon,button1:"Scan Again",button2:"Know More",showThisResult:!0},CANNOT_CONFIRM:{status:"Cannot Confirm",text:"This product may not be genuine.",gifUrl:getImageUrl("cannotConfirm").gif,icon:getImageUrl("cannotConfirm").icon,button1:"Scan Again",button2:"Know More",showThisResult:!0,supportButton:"Support"},PHOTO_QUALITY_ISSUE:{status:"Photo Quality Issue",text:"Couldn't capture a clear photo. Please scan again.",gifUrl:getImageUrl("photoQualityIssue").gif,icon:getImageUrl("photoQualityIssue").icon,button1:"Scan Again",button2:"Know More",showThisResult:!0,supportButton:"Support"},CONNECTION_TIMED_OUT:{status:"Connection Timed Out",text:"Connection timed out. Please retry scanning.",gifUrl:getImageUrl("connectionTimeout").gif,icon:getImageUrl("connectionTimeout").icon,button1:"Scan Again",button2:"Know More",showThisResult:!0,supportButton:"Support"},POTENTIAL_FAKE:{status:"Potential Fake",text:"This product may be a counterfeit.",gifUrl:getImageUrl("potentialFake").gif,icon:getImageUrl("potentialFake").icon,button1:"Scan Again",button2:"Know More",showThisResult:!0,supportButton:"Support"}},u=document.querySelector(".".concat(e)),d=createDivElem();void 0!==r?t=l[r]:(t=l.CONNECTION_TIMED_OUT,sessionStorage.setItem("triggerScanAgain","true"));var h=null!=t.supportButton&&null!=t.button2&&null!=t.button1;setStyles(d,{width:"100%",height:h?"48%":"42%",backgroundColor:a,position:"absolute",transform:"#translateX(-50%)",bottom:"-41%",borderTopRightRadius:"4%",borderTopLeftRadius:"4%",fontWeight:"bolder",textAlign:"center",display:"flex",placeContent:"flex-end space-evenly",flexFlow:"column",alignItems:"center",justifyContent:"space-evenly"});var f=manageBrandRedirection(t,r);if(null!==u&&u instanceof HTMLElement&&t.showThisResult){(d=displayResult(d,t,n,i,o,u,c,h)).className=s,d.style.zIndex="3",u.appendChild(d);var p=null===u?1:u.clientHeight;d.style.bottom="".concat(parseInt(d.style.bottom,10)/100*p,"px"),function e(){var t=d.style.bottom,r=parseInt(t,10);!isNaN(r)&&r<-11&&(d.style.bottom="".concat(r+15,"px"),requestAnimationFrame(e))}(),f.redirectAfterDelay&&handleDelayedRedirection(t,r)}},displayResult=function(e,t,r,n,i,o){var s,a,c,l,u,d,h,f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",p=arguments.length>7?arguments[7]:void 0,m=createDivElem();m.innerText=null!==(s=t.status)&&void 0!==s?s:"";var v=createImageElem();if(v.src=null!==(a=t.icon)&&void 0!==a?a:"",v.alt="status-Icon",v.className="status-icon",setStyles(v,{height:"50%",marginRight:"2%"}),m.appendChild(v),setStyles(m,{color:"#ffffff",fontFamily:"Carnas-Bold",fontSize:"24px",height:"20%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"row-reverse"}),e.appendChild(m),f.length>0){var g=createDivElem();g.innerText="Serial ID: ".concat(f),setStyles(g,{color:"#ffffff",fontFamily:"Carnas-Regular",fontSize:"16px",fontWeight:"400",backgroundColor:"#EBEBEB1A",padding:"8px 32px",borderRadius:"4px",marginBottom:"10px",boxSizing:"border-box",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",textAlign:"center",width:"85%"}),e.appendChild(g)}var _=createDivElem();if(_.innerHTML=null!==(l=null===(c=t.text)||void 0===c?void 0:c.replace(/\n/g,"<br>"))&&void 0!==l?l:"",setStyles(_,{color:"#ffffff",fontFamily:"Carnas-Regular",fontSize:"15px",maxWidth:"90%"}),e.appendChild(_),void 0!==t.button1||void 0!==t.button2||void 0!==t.supportButton){var y=createDivElem();if(setStyles(y,{display:"flex",flexDirection:"column",height:"100%",width:"100%",gap:"8px",alignContent:"center",alignItems:"center",justifyContent:"center",marginTop:"10px",marginBottom:"10px"}),void 0!==t.button1){var b=createButtonElem();b.className=i,b.innerText=null!==(u=t.button1)&&void 0!==u?u:"";var w=createImageElem();w.src=getImageUrl("rotateLeft").icon,w.alt="rotate-left-Icon",w.className="rotate-left-button-icon",setStyles(w,{height:"20px",width:"20px",marginRight:"8px"}),b.appendChild(w),setStyles(b,{borderRadius:"30px",background:"#F5F5F5",color:"#000000",border:"none",height:p?"52px":"39%",width:"90%",fontFamily:"Carnas-Bold",fontSize:"18px",fontWeight:"400",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"row-reverse"}),y.appendChild(b)}if(void 0!==t.supportButton){var k=createButtonElem();k.className=n,k.innerText=null!==(d=t.supportButton)&&void 0!==d?d:"Support",setStyles(k,{borderRadius:"30px",background:"#EBEBEB1A",color:"#ffffff",border:"none",height:p?"52px":"39%",width:"90%",fontFamily:"Carnas-Bold",fontSize:"18px",fontWeight:"400",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"row-reverse"}),y.appendChild(k)}if(void 0!==t.button2){var S=createButtonElem();S.innerText=null!==(h=t.button2)&&void 0!==h?h:"",S.className=r,setStyles(S,{borderRadius:"30px",background:"#EBEBEB1A",color:"#ffffff",border:"0px",height:p?"52px":"39%",width:"90%",fontFamily:"Carnas-Bold",fontSize:"18px",fontWeight:"400",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"row-reverse"}),y.appendChild(S)}e.appendChild(y)}var E=createDivElem();return setLottieAnimation(E,t.gifUrl),setStyles(E,{top:"18%",position:"absolute",width:"40%"}),o.appendChild(E),e};function removeQROverlayMask(e){var t=document.querySelector(".".concat(e));null!==t&&t.remove()}var splashScreen=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3,n=arguments.length>3?arguments[3]:void 0;return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function i(){var o,s,a,c,l,u,d,h,f,p,m,v,g,_,y,b;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(s=document.querySelector(".splash-screen-container"),a=null!==(o=null==n?void 0:n.showStartButton)&&void 0!==o&&o,null===s){i.next=6;break}return s.style.display="flex",a||scheduleRemoval(s,r),i.abrupt("return");case 6:if((s=createDivElem()).className="splash-screen-container",setStyles(s,{position:"absolute",zIndex:"15",background:"#ffffff",height:"100%",width:"100%",display:"flex",flexDirection:"column",overflow:"hidden"}),(c=createDivElem()).innerHTML="Loading...",setStyles(c,{fontSize:"20px",color:"#000",margin:"auto"}),s.appendChild(c),e.appendChild(s),i.prev=14,null==n){i.next=29;break}s.removeChild(c),l=createDivElem(),setStyles(l,{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",marginTop:"5%",height:"20%",marginBottom:"5%"}),null!=n.logo&&((u=createImageElem()).src=n.logo,u.alt="Logo",u.className="splash-logo-image",setStyles(u,{marginBottom:"5%",objectFit:"contain",maxHeight:null!=n.text?"75%":"100%"}),l.appendChild(u),n.text&&((d=createDivElem()).innerHTML=n.text,setStyles(d,{color:"#283583",fontFamily:"sans-serif",fontWeight:"700",height:"20%"}),l.appendChild(d))),s.appendChild(l),h=createDivElem(),setStyles(h,{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"50%",marginBottom:"5%",flex:"1"}),null!=n.backgroundImage&&((f=createImageElem()).src=n.backgroundImage,f.alt="Background Image",f.className="splash-background-image",setStyles(f,{maxHeight:"100%",maxWidth:"100%",objectFit:"contain"}),h.appendChild(f)),s.appendChild(h),a&&(p=createDivElem(),setStyles(p,{width:"100%",display:"flex",justifyContent:"center",height:"15%"}),(m=createButtonElem()).className="vyu-scanner__splash-btn",m.innerText="GET STARTED",setStyles(m,{padding:"12px 20px",borderRadius:"32px",backgroundColor:"rgba(235, 111, 49, 1)",color:"#ffffff",fontSize:"21px",border:"medium",fontWeight:"700",cursor:"pointer",width:"80%",alignSelf:"flex-end",height:"56px",marginBottom:"5%"}),m.addEventListener("click",(function(){null!=s&&(s.style.display="none")})),p.appendChild(m),s.appendChild(p)),a||scheduleRemoval(s,r),i.next=40;break;case 29:return v=function(){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,r){var n;void 0!==t&&(t.endsWith(".mp4")||t.endsWith(".webm")||t.endsWith(".ogg"))?((n=createVideoElem()).src=t,n.autoplay=!0,n.loop=!0,n.muted=!0,n.className="splash-media-container__video",n.controls=!1,n.playsInline=!0,n.addEventListener("loadeddata",(function(){e(n)}))):((n=createImageElem()).src=t,n.alt="Loading GIF",n.style.maxWidth="100%",n.addEventListener("load",(function(){e(n)})))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},i.next=32,v();case 32:g=i.sent,s.removeChild(c),(_=createDivElem()).className="splash-media-container",setStyles(_,{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",height:"100%"}),_.appendChild(g),s.appendChild(_),a?((y=createDivElem()).className="splash-button-container",setStyles(y,{position:"absolute",bottom:"40px",width:"100%",display:"flex",justifyContent:"center"}),(b=createButtonElem()).className="vyu-scanner__splash-btn",b.innerText="GET STARTED",setStyles(b,{padding:"12px 20px",borderRadius:"32px",backgroundColor:"rgba(235, 111, 49, 1)",color:"#ffffff",fontSize:"21px",border:"medium",fontWeight:"700",cursor:"pointer",width:"80%"}),b.addEventListener("click",(function(){null!=s&&(s.style.display="none")})),y.appendChild(b),s.appendChild(y)):scheduleRemoval(s,r);case 40:i.next=46;break;case 42:i.prev=42,i.t0=i.catch(14),console.error(i.t0),c.innerHTML="Failed to load media.";case 46:case"end":return i.stop()}}),i,null,[[14,42]])})))},scheduleRemoval=function(e,t){setTimeout((function(){console.log("demoContainer display set to none"),e.style.display="none"}),t)},Timeout=function(){function e(){_classCallCheck(this,e),this.timeouts={idle:null,upload:null,verification:null}}return _createClass(e,[{key:"setTimeout",value:function(e){function t(t,r,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,r){var n=this;this.clearTimeout(t),this.timeouts[t]=setTimeout((function(){r(),n.timeouts[t]=null}),e)}))},{key:"clearTimeout",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=this.timeouts[e];null!==t&&(clearTimeout(t),this.timeouts[e]=null)}))},{key:"startIdleTimeout",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e4;this.setTimeout(t,"idle",e)}},{key:"startUploadTimeout",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e4;this.setTimeout(t,"upload",e)}},{key:"startPartialImagesTimeout",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e4;this.setTimeout(t,"partialImageUpload",e)}},{key:"startVerifyTimeout",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e4;this.setTimeout(t,"verify",e)}},{key:"clearIdleTimeout",value:function(){this.clearTimeout("idle")}},{key:"clearUploadTimeout",value:function(){this.clearTimeout("upload")}},{key:"clearPartialImagesTimeout",value:function(){this.clearTimeout("partialImageUpload")}},{key:"clearVerifyTimeout",value:function(){this.clearTimeout("verify")}},{key:"clearAllTimeouts",value:function(){var e=this;Object.keys(this.timeouts).forEach((function(t){e.clearTimeout(t)}))}}]),e}(),iOSCameraLabels=["back camera","fotocamera (posteriore)","camera aan achterzijde","cmara trasera","","rckkamera","camra arrire","tylny aparat","cmara traseira","cmera traseira","",""," ","kamera p baksidan"],getCamera=function(e,t){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function r(){return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(void 0!==e&&0!==t.length){r.next=2;break}return r.abrupt("return",void 0);case 2:return r.abrupt("return",e.find((function(e){var r;return null===(r=null==e?void 0:e.label)||void 0===r?void 0:r.toLowerCase().includes(t)})));case 3:case"end":return r.stop()}}),r)})))},getStream=function(e,t){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function r(){var n;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n={audio:!1,video:{deviceId:{exact:e},facingMode:{exact:"environment"},width:{ideal:checkIfDenso()&&checkIfAndroid()?6e3:2e3},aspectRatio:{exact:void 0!==t?4/3:1}}},r.prev=1,r.next=4,navigator.mediaDevices.getUserMedia(n);case 4:return r.abrupt("return",r.sent);case 7:return r.prev=7,r.t0=r.catch(1),console.error("getStream err",r.t0),r.abrupt("return",void 0);case 11:case"end":return r.stop()}}),r,null,[[1,7]])})))},selectMainCamera=function(e){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!checkIfIOS()){t.next=4;break}return t.next=3,getIOSMainCamera(e);case 3:case 7:return t.abrupt("return",t.sent);case 4:if(!checkIfAndroid()){t.next=8;break}return t.next=7,getAndroidMainCamera(e);case 8:case"end":return t.stop()}}),t)})))},getBackCamera=function(e,t){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function r(){return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,getCamera(e,t);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r)})))},checkCapabilities=function(e){return!(checkIfIOS()||void 0===e.facingMode||void 0===e.focusMode||!e.focusMode.includes("continuous")||!e.facingMode.includes("environment"))||!(!checkIfIOS()||void 0===e.facingMode||!e.facingMode.includes("environment"))};function refreshCameraPermissions(){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({video:!0});case 3:e.sent.getTracks().forEach((function(e){e.stop()})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Failed to refresh camera permissions:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))}var getAndroidMainCamera=function(e){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function t(){var r,n,i,o,s,a,c,l,u,d,h;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=e.filter((function(e){return null==e?void 0:e.label.toLowerCase().includes("back")})),o=[],s=[],a=_createForOfIteratorHelper(i),t.prev=4,a.s();case 6:if((c=a.n()).done){t.next=19;break}return l=c.value,t.next=10,navigator.mediaDevices.getUserMedia({video:{deviceId:{ideal:l.deviceId},width:{ideal:6e3}}});case 10:u=t.sent,d=u.getVideoTracks()[0],h=d.getCapabilities(),Boolean(null===(r=null==h?void 0:h.focusMode)||void 0===r?void 0:r.includes("continuous"))&&Boolean(null===(n=null==h?void 0:h.facingMode)||void 0===n?void 0:n.includes("environment"))&&void 0!==h.deviceId&&(h.isSelected=!0,s.push(h.deviceId)),o.push(h),d.stop();case 17:t.next=6;break;case 19:t.next=24;break;case 21:t.prev=21,t.t0=t.catch(4),a.e(t.t0);case 24:return t.prev=24,a.f(),t.finish(24);case 27:return t.abrupt("return",{deviceId:s[0],deviceCapabilities:o});case 28:case"end":return t.stop()}}),t,null,[[4,21,24,27]])})))},getIOSMainCamera=function(e){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function t(){var r,n,i,o,s;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==(r=null==e?void 0:e.find((function(e){var t=null==e?void 0:e.label.toLowerCase();return iOSCameraLabels.includes(t)})))){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,getStream(r.deviceId);case 5:if(void 0!==(n=t.sent)){t.next=8;break}return t.abrupt("return");case 8:if(void 0!==(i=n.getVideoTracks()[0])){t.next=11;break}return t.abrupt("return");case 11:return o=[],(s=i.getCapabilities()).isSelected=!0,s.label=r.label,o.push(s),i.stop(),t.abrupt("return",{deviceId:r.deviceId,deviceCapabilities:o});case 18:case"end":return t.stop()}}),t)})))},verifyMainCameraSelection=function(e){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function t(){var r,n,i,o,s,a,c;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=e){t.next=2;break}return t.abrupt("return",!1);case 2:if(!checkIfAndroid()){t.next=11;break}return t.next=5,getStream(e);case 5:if(i=t.sent,o=null==i?void 0:i.getVideoTracks()[0],void 0!==(s=null==o?void 0:o.getCapabilities())){t.next=10;break}return t.abrupt("return",!1);case 10:return t.abrupt("return",checkCapabilities(s));case 11:if(!checkIfIOS()){t.next=26;break}return t.next=14,null===(r=navigator.mediaDevices)||void 0===r?void 0:r.enumerateDevices();case 14:if(t.t1=n=t.sent,t.t0=null===t.t1,t.t0){t.next=18;break}t.t0=void 0===n;case 18:if(!t.t0){t.next=22;break}t.t2=void 0,t.next=23;break;case 22:t.t2=n.filter((function(e){return"videoinput"===e.kind}));case 23:return a=t.t2,c=a.find((function(e){var t=null==e?void 0:e.label.toLowerCase();return iOSCameraLabels.includes(t)})),t.abrupt("return",e===(null==c?void 0:c.deviceId));case 26:return t.abrupt("return",!1);case 27:case"end":return t.stop()}}),t)})))};function setPhotoOptions(e,t,r,n,i,o){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:80,a=arguments.length>7?arguments[7]:void 0,c=arguments.length>8?arguments[8]:void 0,l=arguments.length>9?arguments[9]:void 0;return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function u(){var d,h,f,p,m,v,g,_,y,b,w,k;return _regeneratorRuntime().wrap((function(u){for(;;)switch(u.prev=u.next){case 0:if(d=t.sWidth,h=t.sHeight,f=document.createElement("canvas"),p=e.videoWidth,m=e.videoHeight,!(p<=0||m<=0)){u.next=7;break}return console.warn("Invalid video dimensions:",{videoWidth:p,videoHeight:m}),u.abrupt("return");case 7:if(g=void 0!==h?m*h:m,!((v=void 0!==d?p*d:p)<=0||g<=0)){u.next=12;break}return console.warn("Invalid canvas dimensions:",{canvasWidth:v,canvasHeight:g}),u.abrupt("return");case 12:return f.width=v,f.height=g,_=i?logInfoOnUI(n,"brightnessDiv"):null,y=f.getContext("2d"),u.next=18,getStream(r,!0);case 18:if(void 0!==(b=u.sent)){u.next=21;break}return u.abrupt("return");case 21:if(void 0!==(w=b.getVideoTracks()[0])&&null!==y&&"function"==typeof y.getImageData){u.next=24;break}return u.abrupt("return");case 24:k=setInterval((function(){if(o)clearInterval(k);else{null==y||y.drawImage(e,0,0,f.width,f.height);var t=null==y?void 0:y.getImageData(0,0,f.width,f.height),r=getAverageBrightness(null==t?void 0:t.data),n=r<=s;if(l.light.status=n,isDensoV2product()||handleWarningPrompts(n,a,c,l),r<80){null!==_&&(_.innerHTML="<p>Average Brightness: ".concat(r,"; setting brightnessValue: ").concat(.8,", iso: ").concat(800,", colorTemperature: ").concat(5e3,"</p>")),setExposure(1.5,.8,1,5e3,800,w).catch((function(e){console.error("error setting exposure",e)}))}else{var i=100;r>80&&r<100?i=400:r>100&&r<120&&(i=200);null!==_&&(_.innerHTML="<p>Average Brightness: ".concat(r,"; setting brightnessValue: ").concat(.5,", iso: ").concat(i,", colorTemperature: ").concat(5500,"</p>")),setExposure(.5,.5,1,5500,i,w).catch((function(e){console.error("error setting exposure",e)}))}}}),1e3);case 25:case"end":return u.stop()}}),u)})))}function getAverageBrightness(e){for(var t=0,r=0;r<e.length;r+=4){t+=(e[r]+e[r+1]+e[r+2])/3}return t/(e.length/4)}function setExposure(e,t,r,n,i,o){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function s(){var a,c,l,u,d,h,f,p,m,v,g,_,y,b,w,k,S,E,C,T,P,A;return _regeneratorRuntime().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(void 0===o){s.next=18;break}return a={advanced:[]},void 0!==(c=o.getCapabilities()).iso&&void 0!==i&&(l=c.iso,u=l.min,d=l.max,h=Math.min(Math.max(i,u),d),a.advanced.push({iso:h})),void 0!==c.exposureTime&&void 0!==e&&(f=c.exposureTime,p=f.min,m=f.max,v=Math.min(Math.max(e,p),m),a.advanced.push({exposureTime:v})),void 0!==c.colorTemperature&&void 0!==n&&(g=c.colorTemperature,_=g.min,y=g.max,b=Math.min(Math.max(n,_),y),a.advanced.push({whiteBalanceMode:"manual",colorTemperature:b})),void 0!==c.brightness&&void 0!==t&&(w=c.brightness,k=w.min,S=w.max,E=Math.min(Math.max(t,k),S),a.advanced.push({brightness:E})),void 0!==c.contrast&&void 0!==r&&(C=c.contrast,T=C.min,P=C.max,A=Math.min(Math.max(r,T),P),a.advanced.push({contrast:A})),s.next=10,o.applyConstraints(a);case 10:return s.prev=10,s.next=13,o.applyConstraints(a);case 13:s.next=18;break;case 15:s.prev=15,s.t0=s.catch(10),console.error("Error setting exposure:",s.t0);case 18:case"end":return s.stop()}}),s,null,[[10,15]])})))}var getPermission=function(e,t){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function r(){var n;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,null===(n=navigator.mediaDevices)||void 0===n?void 0:n.getUserMedia({video:!0,audio:!1}).then((function(t){t.getVideoTracks().forEach((function(e){e.stop()})),void 0!==e&&logEvents(e,"sendCameraPermissionGrantedEvent",captureOrCalculateTimestamp())}));case 3:r.next=10;break;case 5:r.prev=5,r.t0=r.catch(0),void 0!==e&&logEvents(e,"sendCameraPermissionDeniedEvent",captureOrCalculateTimestamp()),void 0!==t&&t({type:"Camera",err:"Camera permission error: ".concat(r.t0.message)}),console.error("Camera permission error: ".concat(r.t0.message));case 10:case"end":return r.stop()}}),r,null,[[0,5]])})))},getCameraDetails=function(e,t){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function r(){var n,i,o,s,a,c,l;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=getDeviceId(),s=getDeviceCapabilities(),a=getVideoDevices(),r.next=5,getPermission(e,t);case 5:return r.next=7,null===(n=navigator.mediaDevices)||void 0===n?void 0:n.enumerateDevices();case 7:if(r.t1=i=r.sent,r.t0=null===r.t1,r.t0){r.next=11;break}r.t0=void 0===i;case 11:if(!r.t0){r.next=15;break}r.t2=void 0,r.next=16;break;case 15:r.t2=i.filter((function(e){return"videoinput"===e.kind}));case 16:return a=r.t2,r.next=19,selectMainCamera(a);case 19:return void 0===(null==(c=r.sent)?void 0:c.deviceId)||void 0===c.deviceCapabilities?(o=null,s=null):(o=c.deviceId,s=JSON.stringify(c.deviceCapabilities)),void 0!==e&&(l=JSON.stringify(a),logEvents(e,"sendCameraSelectionEvent",{deviceId:o,deviceCapabilities:s,videoDeviceString:l})),r.abrupt("return",{deviceId:o,deviceCapabilities:null!==s?JSON.parse(s):s,videoDevices:null!=a?a:null});case 23:case"end":return r.stop()}}),r)})))},setCameraDetails=function(e,t){return __awaiter(void 0,void 0,void 0,_regeneratorRuntime().mark((function r(){var n,i,o,s,a,c,l;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=getDeviceId(),i=getDeviceCapabilities(),o=getVideoDevices(),r.next=5,verifyMainCameraSelection(n);case 5:if(!!r.sent){r.next=19;break}return r.next=9,getCameraDetails(e,t);case 9:if(s=r.sent,a=s.deviceId,c=s.deviceCapabilities,l=s.videoDevices,null===a||null===c||null===l){r.next=18;break}return setDeviceId(a),setDeviceCapabilities(c),setVideoDevices(l),r.abrupt("return",!0);case 18:return r.abrupt("return",!1);case 19:return void 0!==e&&logEvents(e,"sendCameraSelectionEvent",{deviceId:n,deviceCapabilities:i,videoDevices:o}),r.abrupt("return",!0);case 21:case"end":return r.stop()}}),r)})))};function startCameraSettingProcess(e,t,r){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function n(){var i,o;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=!1,o=0;case 2:if(i||!(o<e)){n.next=18;break}return n.next=5,setCameraDetails(t,r);case 5:if(!n.sent){n.next=10;break}i=!0,n.next=16;break;case 10:return o++,n.next=13,cleanup();case 13:return n.next=15,delay(1e3);case 15:return n.abrupt("continue",2);case 16:n.next=2;break;case 18:case"end":return n.stop()}}),n)})))}function cleanup(){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.removeItem("deviceId"),localStorage.removeItem("deviceCapabilities");case 2:case"end":return e.stop()}}),e)})))}function delay(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t){return setTimeout(t,e)}));case 2:case"end":return t.stop()}}),t)})))}var doubleQuoteEscape=function(e){return e.replace(/"/g,'\\"')},backslashEscape=function(e){return e.replace(/\\/g,"\\\\")},escapeDoubleQuoteAndBackslash=function(e){return"string"==typeof e&&void 0!==e&&(e=backslashEscape(e),e=doubleQuoteEscape(e)),e},getBrandsConcatenated=function(e){return e.map((function(e){var t=escapeDoubleQuoteAndBackslash(e.brand);return'"'.concat(t,'";v="').concat(e.version,'"')})).join(", ")},isValidArray=function(e){return void 0!==e&&Array.isArray(e)},getBrowserList=function(e,t){return isValidArray(e)?getBrandsConcatenated(e):isValidArray(t)?getBrandsConcatenated(t):void 0},getHintsValues=function(){return["brands","mobile","platform","architecture","bitness","fullVersionList","model","platformVersion","wow64"]};function getPropertyQuoted(e){if(void 0!==e){var t=escapeDoubleQuoteAndBackslash(e);return"".concat(t)}return e}var clientHintHeaders=new Promise((function(e){var t=null===navigator||void 0===navigator?void 0:navigator.userAgentData;void 0!==t?t.getHighEntropyValues(getHintsValues()).then((function(t){var r,n,i,o,s,a,c,l={"User-Agent":navigator.userAgent,"Sec-CH-UA":null!==(r=getBrowserList(t.brands,[]))&&void 0!==r?r:"","Sec-CH-UA-Arch":null!==(n=getPropertyQuoted(t.architecture))&&void 0!==n?n:"","Sec-CH-UA-Mobile":"?"+(void 0!==t.mobile?"1":"0"),"Sec-CH-UA-Model":null!==(i=getPropertyQuoted(t.model))&&void 0!==i?i:"","Sec-CH-UA-Platform":null!==(o=getPropertyQuoted(t.platform))&&void 0!==o?o:"","Sec-CH-UA-Platform-Version":null!==(s=getPropertyQuoted(t.platformVersion))&&void 0!==s?s:"","Sec-CH-UA-Full-Version-List":null!==(a=getBrowserList(t.fullVersionList,t.brands))&&void 0!==a?a:"","Sec-CH-UA-Bitness":null!==(c=getPropertyQuoted(t.bitness))&&void 0!==c?c:"","Sec-CH-UA-Wow64":"?"+(void 0!==t.wow64?"1":"0")};e(l)})):void 0!==navigator?e({"User-Agent":navigator.userAgent}):e({})})),_PLACEHOLDER_CLASS$PL={PLACEHOLDER_CLASS:"vyu-scanner__placeholder",PLACEHOLDER_QUESTION_MARK_ICON_CLASS:"vyu-scanner__placeholder-question",PLACEHOLDER_EXCLAMATION_ICON_CLASS:"vyu-scanner__placeholder-exclamation",PLACEHOLDER_ICON_CONTAINER_CLASS:"vyu-scanner__placeholder-icon",PLACEHOLDER_CLOSE_ICON_CONTAINER_CLASS:"vyu-scanner__placeholder-close-icon",PLACEHOLDER_HEADING_CLASS:"vyu-scanner__placeholder-heading",PLACEHOLDER_CONTENT_CLASS:"vyu-scanner__placeholder-content",PLACEHOLDER_BUTTON_CLASS:"vyu-scanner__placeholder-btn",QUESTION_MARK_PLACEHOLDER_HEADING:"How to Scan?",EXCLAMATION_PLACEHOLDER_HEADING:"Scan the front of the product",DISPLAY_FLEX:"flex",DISPLAY_BLOCK:"block",DISPLAY_NONE:"none",POINTER_NONE:"none",POINTER_AUTO:"auto",BUTTON_TEXT:"Start Scanning",SCANNER_PREVIEW:"vyu-scanner__preview",OVERLAY_ACTION_BUTTON_CLASS:"overlay-action-text-box",QUESTION_MARK_ICON:"https://vyu-web-sdk.enncrypto.com/v1_sdk_assets/Icons/question_mark_icon.svg",EXCLAMATION_ICON:"https://vyu-web-sdk.enncrypto.com/v1_sdk_assets/Icons/exclamation_icon.svg"},PLACEHOLDER_CLASS=_PLACEHOLDER_CLASS$PL.PLACEHOLDER_CLASS,PLACEHOLDER_QUESTION_MARK_ICON_CLASS=_PLACEHOLDER_CLASS$PL.PLACEHOLDER_QUESTION_MARK_ICON_CLASS,PLACEHOLDER_EXCLAMATION_ICON_CLASS=_PLACEHOLDER_CLASS$PL.PLACEHOLDER_EXCLAMATION_ICON_CLASS,PLACEHOLDER_ICON_CONTAINER_CLASS=_PLACEHOLDER_CLASS$PL.PLACEHOLDER_ICON_CONTAINER_CLASS,PLACEHOLDER_CLOSE_ICON_CONTAINER_CLASS=_PLACEHOLDER_CLASS$PL.PLACEHOLDER_CLOSE_ICON_CONTAINER_CLASS,PLACEHOLDER_HEADING_CLASS=_PLACEHOLDER_CLASS$PL.PLACEHOLDER_HEADING_CLASS,PLACEHOLDER_CONTENT_CLASS=_PLACEHOLDER_CLASS$PL.PLACEHOLDER_CONTENT_CLASS,PLACEHOLDER_BUTTON_CLASS=_PLACEHOLDER_CLASS$PL.PLACEHOLDER_BUTTON_CLASS,DISPLAY_FLEX=_PLACEHOLDER_CLASS$PL.DISPLAY_FLEX,DISPLAY_BLOCK=_PLACEHOLDER_CLASS$PL.DISPLAY_BLOCK,DISPLAY_NONE=_PLACEHOLDER_CLASS$PL.DISPLAY_NONE,POINTER_NONE=_PLACEHOLDER_CLASS$PL.POINTER_NONE,POINTER_AUTO=_PLACEHOLDER_CLASS$PL.POINTER_AUTO,QUESTION_MARK_PLACEHOLDER_HEADING=_PLACEHOLDER_CLASS$PL.QUESTION_MARK_PLACEHOLDER_HEADING,EXCLAMATION_PLACEHOLDER_HEADING=_PLACEHOLDER_CLASS$PL.EXCLAMATION_PLACEHOLDER_HEADING,BUTTON_TEXT=_PLACEHOLDER_CLASS$PL.BUTTON_TEXT,SCANNER_PREVIEW=_PLACEHOLDER_CLASS$PL.SCANNER_PREVIEW,OVERLAY_ACTION_BUTTON_CLASS$1=_PLACEHOLDER_CLASS$PL.OVERLAY_ACTION_BUTTON_CLASS,QUESTION_MARK_ICON=_PLACEHOLDER_CLASS$PL.QUESTION_MARK_ICON,EXCLAMATION_ICON=_PLACEHOLDER_CLASS$PL.EXCLAMATION_ICON,Placeholder=function(){function e(t,r,n,i,o){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:QUESTION_MARK_PLACEHOLDER_HEADING,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:BUTTON_TEXT;_classCallCheck(this,e),this.placeholderElem=createDivElem(),this.placeholderIconContainer=createDivElem(),this.placeholderCloseIconContainer=createDivElem(),this.placeholderHeading=createHeadElem(3),this.placeholderContentContainer=createDivElem(),this.placeholderBtn=createButtonElem(),this.placeholderQuestionMarkIcon=this.createPlaceholderIcon(QUESTION_MARK_ICON,PLACEHOLDER_QUESTION_MARK_ICON_CLASS),this.placeholderExclamationIcon=this.createPlaceholderIcon(EXCLAMATION_ICON,PLACEHOLDER_EXCLAMATION_ICON_CLASS),this.placeholderCloseIcon=(new DOMParser).parseFromString(CROSS_SVG_BLACK_STRING,"image/svg+xml").documentElement,this.timeoutInstance=t,this.idletimeout=r,this.howToScanButton=a,this.howToScanHeader=s,this.handleSessionTimeout=n,this.handleScanAgainButtonClick=i,this.closePopup=o,this.setupElements()}return _createClass(e,[{key:"setContentSrc",value:function(e,t){this.placeholderQuestionMarkIcon.style.display=void 0===e?"none":"flex",this.questionMarkContentSrc=e,this.placeholderExclamationIcon.style.display=void 0===t?"none":"flex",this.exclamationContentSrc=t}},{key:"setupElements",value:function(){var e=this;this.placeholderIconContainer.appendChild(this.placeholderQuestionMarkIcon),this.placeholderIconContainer.appendChild(this.placeholderExclamationIcon),this.placeholderCloseIconContainer.appendChild(this.placeholderCloseIcon),this.placeholderElem.appendChild(this.placeholderHeading),this.placeholderElem.appendChild(this.placeholderContentContainer),this.placeholderElem.appendChild(this.placeholderBtn),assignClass(this.placeholderElem,PLACEHOLDER_CLASS),assignClass(this.placeholderHeading,PLACEHOLDER_HEADING_CLASS),assignClass(this.placeholderContentContainer,PLACEHOLDER_CONTENT_CLASS),assignClass(this.placeholderBtn,PLACEHOLDER_BUTTON_CLASS),assignClass(this.placeholderIconContainer,PLACEHOLDER_ICON_CONTAINER_CLASS),assignClass(this.placeholderCloseIconContainer,PLACEHOLDER_CLOSE_ICON_CONTAINER_CLASS),hideElement(this.placeholderElem),hideElement(this.placeholderCloseIconContainer),showElement(this.placeholderIconContainer,DISPLAY_FLEX),this.placeholderBtn.textContent=this.howToScanButton,this.placeholderQuestionMarkIcon.onclick=function(t){e.handleIconClick(t)},this.placeholderExclamationIcon.onclick=function(t){e.handleIconClick(t)},this.placeholderBtn.onclick=function(t){e.handleBtnClick(t)},this.placeholderCloseIconContainer.onclick=function(t){e.handlePlaceholderCloseClick(t)}}},{key:"createPlaceholderIcon",value:function(e,t){var r=createImageElem();return assignClass(r,t),r.src=e,r}},{key:"handlePlaceholderCloseClick",value:function(e){var t=this,r=this.placeholderElem,n=this.placeholderIconContainer,i=r.style.display===DISPLAY_FLEX,o=!n.contains(e.target);i&&o&&(this.removeBgBlur(),this.hidePlaceholder(),null!==this.placeholderContentContainer.firstChild&&this.placeholderContentContainer.removeChild(this.placeholderContentContainer.firstChild),this.showOutsideContent(),hideElement(this.placeholderCloseIconContainer)),this.timeoutInstance.startIdleTimeout((function(){return __awaiter(t,void 0,void 0,_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handleSessionTimeout();case 2:case"end":return e.stop()}}),e,this)})))}),this.idletimeout)}},{key:"addSrcToPlaceholderContent",value:function(e){var t=this;if(void 0!==e){if(void 0!==Array.from(this.placeholderContentContainer.children).find((function(t){var r=t.tagName.toLowerCase();return"img"===r||"video"===r?t.src.includes(e):!("div"!==r||!t.classList.contains("lottie-animation"))})))return;var r=createDivElem();if(r.textContent="Loading...",r.className="loading-indicator",this.placeholderContentContainer.appendChild(r),e.endsWith(".json")){var n=createDivElem();n.className="lottie-animation",setLottieAnimation(n,e),this.placeholderContentContainer.appendChild(n),this.placeholderContentContainer.removeChild(r)}else if(e.endsWith(".gif")||e.endsWith(".jpg")||e.endsWith(".png")){var i=createImageElem(),o=new Image;o.onload=function(){t.placeholderContentContainer.removeChild(r),i.src=o.src,t.placeholderContentContainer.appendChild(i)},o.onerror=function(){r.textContent="Failed to load image."},o.src=e}else if(e.endsWith(".mp4")||e.endsWith(".webm")){var s=document.createElement("video");s.src=e,s.controls=!1,s.autoplay=!0,s.preload="auto",s.loop=!0,s.muted=!0,s.playsInline=!0,setStyles(s,{maxWidth:"100%",maxHeight:"100%",overflow:"hidden",objectFit:"cover",display:"flex"}),s.onloadeddata=function(){t.placeholderContentContainer.removeChild(r),t.placeholderContentContainer.appendChild(s)},s.onerror=function(){r.textContent="Failed to load video."}}else r.textContent="Unsupported content type."}}},{key:"addHeadingToPlaceholderContent",value:function(e){this.placeholderHeading.textContent=e}},{key:"addBgBlur",value:function(){var e,t=this;null!==(null===(e=this.placeholderElem)||void 0===e?void 0:e.parentElement)&&Array.from(this.placeholderElem.parentElement.children).filter((function(e){return e!==t.placeholderElem})).forEach((function(e){e!==t.placeholderCloseIconContainer&&(e.style.filter=addBlur("10px"),e.style.pointerEvents=POINTER_NONE)}))}},{key:"removeBgBlur",value:function(){var e,t=this;null!==(null===(e=this.placeholderElem)||void 0===e?void 0:e.parentElement)&&Array.from(this.placeholderElem.parentElement.children).filter((function(e){return e!==t.placeholderElem})).forEach((function(e){e.style.filter=DISPLAY_NONE,e.style.pointerEvents=POINTER_AUTO}))}},{key:"handleIconClick",value:function(e){this.closePopup(),this.addBgBlur(),showElement(this.placeholderCloseIconContainer,DISPLAY_BLOCK);var t=this.placeholderIconContainer.style.display===DISPLAY_FLEX,r=e.target===this.placeholderExclamationIcon,n=e.target===this.placeholderQuestionMarkIcon;t&&(this.hideOutsideContent(),n&&(this.addHeadingToPlaceholderContent(this.howToScanHeader),this.addSrcToPlaceholderContent(this.questionMarkContentSrc)),r&&(this.addHeadingToPlaceholderContent(EXCLAMATION_PLACEHOLDER_HEADING),this.addSrcToPlaceholderContent(this.exclamationContentSrc)),this.showPlaceholder(this.placeholderContentContainer)),this.timeoutInstance.clearIdleTimeout()}},{key:"handleBtnClick",value:function(e){e.preventDefault(),null!==this.placeholderContentContainer.firstChild&&this.placeholderContentContainer.removeChild(this.placeholderContentContainer.firstChild),this.hidePlaceholder(),this.showOutsideContent(),this.removeBgBlur(),hideElement(this.placeholderCloseIconContainer),this.timeoutInstance.clearIdleTimeout();var t=document.querySelector(".".concat(SCANNER_PREVIEW)),r=document.querySelector(".".concat(OVERLAY_ACTION_BUTTON_CLASS$1));null!==t&&null===r&&this.handleScanAgainButtonClick().catch((function(e){console.error("err",e)}));var n=sessionStorage.getItem("triggerScanAgain");null!==n&&"true"===n&&(sessionStorage.setItem("triggerScanAgain","false"),this.handleScanAgainButtonClick().catch((function(e){console.error("err",e)})))}},{key:"hidePlaceholder",value:function(){hideElement(this.placeholderElem)}},{key:"showPlaceholder",value:function(e){showElement(this.placeholderElem,DISPLAY_FLEX),this.placeholderElem.appendChild(e)}},{key:"hideOutsideContent",value:function(){hideElement(document.querySelector("#".concat(CROSS_BTN_ID))),hideElement(this.placeholderIconContainer)}},{key:"showOutsideContent",value:function(){var e=document.querySelector("#".concat(CROSS_BTN_ID));null!==e&&showElement(e,DISPLAY_BLOCK),showElement(this.placeholderIconContainer,DISPLAY_FLEX)}}]),e}(),ErrorMsg,DefaultMsg,ResultsMapping;!function(e){e.productListFetchError="Error: Cannot display product list.",e.productExperienceFetchError="Error: Cannot display product overlay.",e.streamError="Error: Cannot start webcam stream."}(ErrorMsg||(ErrorMsg={})),function(e){e.selectProduct="Please select a product"}(DefaultMsg||(DefaultMsg={})),function(e){e.GENUINE="GENUINE",e.CANNOT_CONFIRM="CANNOT_CONFIRM",e.PHOTO_QUALITY_ISSUE="PHOTO_QUALITY_ISSUE",e.CONNECTION_TIMED_OUT="CONNECTION_TIMED_OUT",e.POTENTIAL_FAKE="POTENTIAL_FAKE"}(ResultsMapping||(ResultsMapping={}));var _ROOT_CLASS$SCANNER_N={ROOT_CLASS:"vyu-root",SCANNER_NEW_CLASS:"vyu-scanner__new",SCANNER_CLASS:"vyu-scanner",PREVIEW_CLASS:"vyu-scanner__preview",CAMERA_LOADING_CLASS:"vyu-scanner__loading",OVERLAY_ACTION_BUTTON_CLASS:"overlay-action-text-box",OVERLAY_LOADER_BAR_CLASS:"loader-bar",OVERLAY_LOADER_CONTAINER_CLASS:"loader-container",OVERLAY_CLASS:"vyu-scanner__overlay",QR_OVERLAY_CLASS:"vyu-scanner__qr_overlay",OVERLAY_RESULT_BE_BUTTON_CLASS:"vyu-scanner__result-be-button",OVERLAY_RESULT_SCAN_AGAIN_BUTTON_CLASS:"vyu-scanner__scan-again-button",OVERLAY_RESULT_CONTAINER_CLASS:"vyu-scanner__result-container",CAPTURE_BUTTON_CLASS:"vyu-capture",START_LOADING_ANIMATION_CONTAINER_CLASS:"vyu-loader__start",QR_SCANNER_DETECTION_BOX_CLASS:"scan-region-highlight",QR_SCANNER_SVG_CLASS:"scan-region-highlight-svg",OVERLAY_RESULT_SUPPORT_BUTTON_CLASS:"vyu-scanner__result-support-button"},ROOT_CLASS=_ROOT_CLASS$SCANNER_N.ROOT_CLASS,SCANNER_NEW_CLASS=_ROOT_CLASS$SCANNER_N.SCANNER_NEW_CLASS,SCANNER_CLASS=_ROOT_CLASS$SCANNER_N.SCANNER_CLASS,PREVIEW_CLASS=_ROOT_CLASS$SCANNER_N.PREVIEW_CLASS,CAMERA_LOADING_CLASS=_ROOT_CLASS$SCANNER_N.CAMERA_LOADING_CLASS,OVERLAY_ACTION_BUTTON_CLASS=_ROOT_CLASS$SCANNER_N.OVERLAY_ACTION_BUTTON_CLASS,OVERLAY_LOADER_BAR_CLASS=_ROOT_CLASS$SCANNER_N.OVERLAY_LOADER_BAR_CLASS,OVERLAY_LOADER_CONTAINER_CLASS=_ROOT_CLASS$SCANNER_N.OVERLAY_LOADER_CONTAINER_CLASS,OVERLAY_CLASS=_ROOT_CLASS$SCANNER_N.OVERLAY_CLASS,QR_OVERLAY_CLASS=_ROOT_CLASS$SCANNER_N.QR_OVERLAY_CLASS,OVERLAY_RESULT_BE_BUTTON_CLASS=_ROOT_CLASS$SCANNER_N.OVERLAY_RESULT_BE_BUTTON_CLASS,OVERLAY_RESULT_SCAN_AGAIN_BUTTON_CLASS=_ROOT_CLASS$SCANNER_N.OVERLAY_RESULT_SCAN_AGAIN_BUTTON_CLASS,OVERLAY_RESULT_CONTAINER_CLASS=_ROOT_CLASS$SCANNER_N.OVERLAY_RESULT_CONTAINER_CLASS,CAPTURE_BUTTON_CLASS=_ROOT_CLASS$SCANNER_N.CAPTURE_BUTTON_CLASS,START_LOADING_ANIMATION_CONTAINER_CLASS=_ROOT_CLASS$SCANNER_N.START_LOADING_ANIMATION_CONTAINER_CLASS,QR_SCANNER_DETECTION_BOX_CLASS=_ROOT_CLASS$SCANNER_N.QR_SCANNER_DETECTION_BOX_CLASS,QR_SCANNER_SVG_CLASS=_ROOT_CLASS$SCANNER_N.QR_SCANNER_SVG_CLASS,OVERLAY_RESULT_SUPPORT_BUTTON_CLASS=_ROOT_CLASS$SCANNER_N.OVERLAY_RESULT_SUPPORT_BUTTON_CLASS,EMPTY_STRING="",CAMERA_LOADING_TEXT="Loading camera..",CAPTURE_BUTTON_ID="vyu-capture",DEFAULT_IMAGE_COUNT=1,DEFAULT_SNAP_DIMENSION=0,timeoutInstance=new Timeout,defaultTimeout=45e3,idleTimeout=defaultTimeout,maxRetryCount=2,DEFAULT_API_URL=apiUrl,DEFAULT_API_V2_URL=apiV2Url,DEFAULT_QR_SERVICE_URL=qrServiceBaseUrl,DEFAULT_FAKE_THRESHOLD=1,DEFAULT_GENUINE_THRESHOLD=1,DEFAULT_CANNOT_CONFIRM_THRESHOLD=0,DEFAULT_PHOTO_QUALITY_ISSUE_THRESHOLD=0,DEFAULT_RESULT_MAPPING={GENUINE:ResultsMapping.GENUINE,CANNOT_CONFIRM:ResultsMapping.CANNOT_CONFIRM,PHOTO_QUALITY_ISSUE:ResultsMapping.PHOTO_QUALITY_ISSUE,CONNECTION_TIMED_OUT:ResultsMapping.CONNECTION_TIMED_OUT,POTENTIAL_FAKE:ResultsMapping.POTENTIAL_FAKE},MQTT_PROD_CREDENTIALS={url:"wss://emqxlistener.ops.enncrypto.com/mqtt",username:"admin",password:"z2gP5Y1QXhO9"},MQTT_DEFAULT_CREDENTIALS={url:"wss://dev-emqxlistener.ops.enncrypto.com/mqtt",username:"admin",password:"8hEg1F3q3KuP1qy"},WS_PROD_URL="wss://api.enncrypto.com/ws-upload",WS_STAGE_URL="wss://s.api.enncrypto.com/ws-upload",WS_QA_URL="wss://q.api.enncrypto.com/ws-upload",WS_DEFAULT_URL="wss://d.api.enncrypto.com/ws-upload",fontCarnasRegular=new FontFaceObserver("Carnas-Regular"),fontCarnasBold=new FontFaceObserver("Carnas-Bold"),Vyu=function(){function e(t,r,n){var i,o,s,a,c,l,u,d,h,f,p,m,v,g,_,y,b,w=this;_classCallCheck(this,e),this.zoomValue=1,this.children=[],this.stableFrameRateBuffer=[],this.isStableFrameCount=checkIfIOS()?10:5,this.startModelDetection=!0,this.lastVideoTime=-1,this.takeSnapshotTriggered=!1,this.qrSvgStrokeColor="64a2f3",this.priorityPrompt={light:{status:!1,label:"Low Light Detected! Move to a well-lit area to scan.",icon:""},shake:{status:!1,label:"Shaking Detected! Stabilize your device to capture images.",icon:""}},this.mqttMessageHandlers=new Map,this.wsClient=null,this.wsMessageHandlers=new Map,this.resultMapping=DEFAULT_RESULT_MAPPING,this.productConfig=null,this.sdkConfig=null,this.mqttImageResultProcessed=!1,this.handleImageCount=function(){w.imageCount--,w.isAutoCapture&&void 0!==w.canvas&&w.canvas.addEventListener("webglcontextlost",(function(e){console.error("WebGL context lost"),e.preventDefault(),w.imageCount++,w.webGlContextLossCamFix().catch((function(e){console.error("err in initiateWebcam webglcontextlost",e)}))}))},this.getImageBase64Url=function(e,t,r,n,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"image/jpeg";return e.drawImage(t,r*t.videoWidth,n*t.videoHeight,i.width,i.height,0,0,i.width,i.height),i.toDataURL(o)},this.createFormData=function(e){return __awaiter(w,void 0,void 0,_regeneratorRuntime().mark((function t(){var r,n;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return 0===this.imageCount&&(this.previewImage=e),r=dataURLtoFile(e,"capture.jpg"),n=new FormData,void 0!==r&&n.append("input_image",r),t.abrupt("return",n);case 5:case"end":return t.stop()}}),t,this)})))},this.rootElem=t,this.identificationType=null!==(i=null==n?void 0:n.identificationType)&&void 0!==i?i:"QR",this.apiUrl=null!==(o=r.serverBaseUrl)&&void 0!==o?o:DEFAULT_API_URL,this.apiV2Url=null!==(s=r.serverV2BaseUrl)&&void 0!==s?s:DEFAULT_API_V2_URL,this.qrServiceBaseUrl=null!==(a=null==r?void 0:r.qrServiceBaseUrl)&&void 0!==a?a:DEFAULT_QR_SERVICE_URL,this.clientAccessToken=r.accessToken,this.apiKey=r.apiKey,this.isAutoCapture=null!==(c=null==n?void 0:n.isAutoCapture)&&void 0!==c&&c,this.showHowToCaptureScreen=null!==(l=null==n?void 0:n.showHowToCaptureScreen)&&void 0!==l&&l,this.haveShownHowToCaptureScreen=!1,this.haveShownSplashScreen=!1,this.isDebugging=null!==(u=null==n?void 0:n.isDebugging)&&void 0!==u&&u,this.environment=null!==(d=null==n?void 0:n.environment)&&void 0!==d?d:"dev",this.clientId=v4(),this.mqttCredentials=null!==(h=r.mqtt)&&void 0!==h?h:this.getMqttCredentials(),this.wsURL=null!==(f=r.wsServerURL)&&void 0!==f?f:this.getWSURL();var k=null!==(p=null==n?void 0:n.customCssConfigurations)&&void 0!==p?p:{},S=k.loadingElemColor,E=void 0===S?defaultLoadingBarColor:S,C=k.verificationAnimation,T=k.startLoadingAnimation,P=k.startLoadingTexts;this.loadingElemColor=E,this.verificationAnimation=C,this.startLoadingAnimationSrc=T,this.startLoadingTexts=null!=P?P:loadingTexts,this.isNewUI=null!==(m=null==n?void 0:n.isNewUI)&&void 0!==m&&m,this.shouldShowResult=null!==(v=null==n?void 0:n.showResult)&&void 0!==v&&v,this.shouldShowCrossButton=null===(g=null==n?void 0:n.showCrossButton)||void 0===g||g,this.successCallbackFn=null==n?void 0:n.successCallbackFn,this.errorCallbackFn=null==n?void 0:n.errorCallbackFn,this.onQrScannerLoadCallbackFn=null==n?void 0:n.onQrScannerLoadCallbackFn,this.analyticsTools=null==n?void 0:n.analyticsTools,this.brandResultConfig=null==n?void 0:n.brandResultConfig,this.homeBtnCallbackFn=null==n?void 0:n.homeBtnCallbackFn,this.brandEngagementBtnCallbackFn=null==n?void 0:n.brandEngagementBtnCallbackFn,this.scanAgainBtnCallbackFn=null==n?void 0:n.scanAgainBtnCallbackFn,this.isValidateFlowV2=null!==(_=null==n?void 0:n.isValidateFlowV2)&&void 0!==_&&_,this.supportCallbackFn=null!==(y=null==n?void 0:n.supportCallbackFn)&&void 0!==y?y:void 0,this.sdkConfig=null!==(b=null==n?void 0:n.sdkConfig)&&void 0!==b?b:null,null!=(null==n?void 0:n.sentryConfig)&&this.initializeSentry(n.sentryConfig).catch((function(e){console.error("Failed to initialize Sentry script",e)})),this.throttleTakeSnapshot=throttle((function(){var e=document.querySelector(".warning-prompt"),t=document.querySelector(".guide-prompt");null!==e&&hideElement(e),null!==t&&hideElement(t);var r=document.querySelector(".scan-region-highlight-svg");null!==r&&(r.style.stroke="rgb(90 223 84)"),w.startModelDetection=!1,w.cleanPredictionBox(),w.isAutoCapture&&!checkIfBigYara()&&(w.roiActionText.innerHTML="<p>".concat(defaultOverlayActionButton.capturingImage,"</p>")),w.takeSnapshot((function(e){var t=e.data;void 0!==w.qrScanner&&w.qrScanner.destroy(),clearInterval(w.intervalId),cancelAnimationFrame(w.animationId),w.shouldShowResult&&w.displayResults(w.scannerElem.className,t.status).catch((function(e){console.error("error during displayResults",e)})),void 0!==w.successCallbackFn&&w.successCallbackFn({data:{status:w.verifySessionStatus,sessionId:w.sessionId,previewImage:w.previewImage}})})).catch((function(e){console.error("error during takeSnapshot",e)}))}),1e4),this.handleHomeButtonClick=this.handleHomeButtonClick.bind(this),this.handleBEButtonClick=this.handleBEButtonClick.bind(this),this.handleScanAgainButtonClick=this.handleScanAgainButtonClick.bind(this),this.handleSupportButtonClick=this.handleSupportButtonClick.bind(this),this.setupElements(),document.body.style.backgroundColor="black",document.body.style.margin="unset";try{var A=sessionStorage.getItem("shortIdData"),x="",B=!1;if(null!==A){var I=JSON.parse(A);"string"==typeof I.shortId&&(x=I.shortId),B="true"===(null==I?void 0:I.alwaysGenuine)}this.shortId=x,this.showGenuine=B,console.log("shortId : ",x)}catch(e){console.error("Error retrieving url params data from sessionStorage:",e)}}return _createClass(e,[{key:"setupElements",value:function(){var e,t=this;this.scannerElem=createDivElem(),this.videoElem=createVideoElem(),this.previewElem=createImageElem(),this.cameraLoadingElem=createDivElem(),this.overlayImgElem=createImageElem(),this.overlayImgElem.id="overlayImgElem",this.startLoadingAnimationContainer=createDivElem();var r=createImageElem(),n=createSpanElem();assignClass(this.rootElem,ROOT_CLASS),assignClass(this.scannerElem,this.isNewUI?SCANNER_NEW_CLASS:SCANNER_CLASS),assignClass(this.previewElem,PREVIEW_CLASS),assignClass(this.cameraLoadingElem,CAMERA_LOADING_CLASS),assignClass(this.startLoadingAnimationContainer,START_LOADING_ANIMATION_CONTAINER_CLASS),this.cameraLoadingElem.textContent=CAMERA_LOADING_TEXT,this.videoElem.autoplay=!0,this.videoElem.playsInline=!0,this.videoElem.muted=!0,this.isNewUI&&this.createCrossButton(),r.src=null!==(e=this.startLoadingAnimationSrc)&&void 0!==e?e:getImageUrl("startLoadingAnimation").icon,new Promise((function(e){var r,i=null===(r=t.startLoadingTexts)||void 0===r?void 0:r.length,o=0;e(setInterval((function(){o<i?(n.textContent=t.startLoadingTexts[o],o++):o=0}),1500))})).catch((function(){})),this.rootElem.appendChild(this.scannerElem),this.rootElem.appendChild(this.startLoadingAnimationContainer),this.handleCaptureButton(),this.startLoadingAnimationContainer.appendChild(r),this.startLoadingAnimationContainer.appendChild(n),this.isNewUI||this.scannerElem.appendChild(this.cameraLoadingElem),this.scannerElem.appendChild(this.videoElem)}},{key:"handleCaptureButton",value:function(){this.isAutoCapture||void 0!==this.captureBtn||(this.captureBtn=createButtonElem(),assignClass(this.captureBtn,CAPTURE_BUTTON_CLASS),this.captureBtn.onclick=this.handleCaptureClick.bind(this),this.rootElem.appendChild(this.captureBtn)),this.isAutoCapture||void 0===this.captureBtn||hideElement(this.captureBtn)}},{key:"initializeObjectDetector",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.canvas=document.createElement("canvas"),t.next=4,Wc.createFromOptions(vision,{baseOptions:{modelAssetPath:e,delegate:"GPU"},scoreThreshold:.5,runningMode:"VIDEO",canvas:this.canvas});case 4:this.objectDetector=t.sent,t.next=11;break;case 7:throw t.prev=7,t.t0=t.catch(0),console.error("error during initializeObjectDetector",t.t0),t.t0;case 11:case"end":return t.stop()}}),t,this,[[0,7]])})))}},{key:"initializeObjectDetectorWithRetry",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function r(){var n;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=0;case 1:if(!(n<t)){r.next=17;break}return r.prev=2,r.next=5,this.initializeObjectDetector(e);case 5:return r.abrupt("return");case 8:if(r.prev=8,r.t0=r.catch(2),n++,console.error("Attempt ".concat(n," - error during initializeObjectDetector:"),r.t0),!(n>=t)){r.next=15;break}throw console.error("Max retries reached. Could not initialize object detector."),r.t0;case 15:r.next=1;break;case 17:case"end":return r.stop()}}),r,this,[[2,8]])})))}},{key:"hideStartLoader",value:function(){hideElement(this.startLoadingAnimationContainer)}},{key:"appendDemoPlaceholder",value:function(){this.rootElem.appendChild(this.placeholder.placeholderElem),this.rootElem.appendChild(this.placeholder.placeholderIconContainer),this.rootElem.appendChild(this.placeholder.placeholderCloseIconContainer)}},{key:"cleanPredictionBox",value:function(){for(var e=0;e<this.children.length;e++)this.scannerElem.removeChild(this.children[0]);this.children.splice(0)}},{key:"loadFonts",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([fontCarnasRegular.load(),fontCarnasBold.load()]).then(e);case 2:case"end":return t.stop()}}),t)})))}},{key:"handleHomeButtonClick",value:function(){this.shouldShowResult&&void 0!==this.homeBtnCallbackFn?this.homeBtnCallbackFn():window.location.reload()}},{key:"handleBEButtonClick",value:function(){this.shouldShowResult&&void 0!==this.brandEngagementBtnCallbackFn?this.brandEngagementBtnCallbackFn():window.location.href="https://vyu.enncrypto.com/brand-engagement/v1"}},{key:"removeScannerElement",value:function(){this.scannerElem.remove()}},{key:"createAndAppendScannerElement",value:function(){this.scannerElem=createDivElem(),this.scannerElem.className=this.isNewUI?SCANNER_NEW_CLASS:SCANNER_CLASS,this.rootElem.appendChild(this.scannerElem)}},{key:"createCrossButton",value:function(){this.shouldShowCrossButton&&createCrossButton(this.scannerElem,this.qrScanner,this.stream,this.rootElem)}},{key:"initializeSentry",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function t(){var r;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{(r=document.createElement("script")).src="https://browser.sentry-cdn.com/5.28.0/bundle.min.js",r.async=!0,r.onload=function(){setupSentry(e)},document.head.appendChild(r)}catch(e){console.error("Failed to load Sentry script:",e)}case 1:case"end":return t.stop()}}),t)})))}},{key:"handleSessionTimeout",value:function(){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function e(){var t;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.isAutoCapture&&hideElement(this.roiActionText),this.showGenuine){e.next=9;break}if(!this.isValidateFlowV2){e.next=7;break}this.cleanUpAfterSessionResult(),e.next=9;break;case 7:return e.next=9,abortSession(this.apiUrl,this.sessionId,this.accessToken,"NONE_IMGS_CLICKED");case 9:if(console.error("Session aborted"),null!=(t=document.querySelector("#".concat(CAPTURE_BUTTON_ID)))&&(t.style.display="none"),e.t0=this.shouldShowResult,!e.t0){e.next=16;break}return e.next=16,this.displayResults(this.scannerElem.className);case 16:e.next=21;break;case 18:e.prev=18,e.t1=e.catch(0),console.error("An error occurred while handling session timeout:",e.t1);case 21:void 0!==this.errorCallbackFn&&this.errorCallbackFn({type:"TimedOut",err:"NONE_IMGS_CLICKED"});case 22:case"end":return e.stop()}}),e,this,[[0,18]])})))}},{key:"uploadImage",value:function(e){var t,r;return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function n(){var i,o;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.showGenuine){n.next=4;break}return n.next=3,new Promise((function(e){return setTimeout(e,100)}));case 3:return n.abrupt("return");case 4:if(!this.isValidateFlowV2){n.next=8;break}return i={type:"image_upload",scan_id:this.productScanId,image:e.split(",")[1]},null===(t=this.wsClient)||void 0===t||t.send(JSON.stringify(i)),n.abrupt("return");case 8:return n.next=10,this.createFormData(e);case 10:o=n.sent,uploadImage(this.apiUrl,this.sessionId,o,this.accessToken,null===(r=this.analyticsTools)||void 0===r?void 0:r.logger);case 12:case"end":return n.stop()}}),n,this)})))}},{key:"handleCaptureClick",value:function(){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function e(){var t=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isAutoCapture||hideElement(this.captureBtn),e.next=3,this.takeSnapshot(this.shouldShowResult?function(e){var r=e.data;t.displayResults(t.scannerElem.className,r.status)}:function(){removeVerifyAnimation()});case 3:void 0!==this.successCallbackFn&&this.successCallbackFn({data:{status:this.verifySessionStatus,sessionId:this.sessionId,previewImage:this.previewImage}});case 4:case"end":return e.stop()}}),e,this)})))}},{key:"stopCameraIfStreaming",value:function(){var e;return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(e=this.qrScanner)||void 0===e?void 0:e.destroy();case 2:if(void 0===this.stream){t.next=5;break}return t.next=5,stopCamera(this.stream);case 5:case"end":return t.stop()}}),t,this)})))}},{key:"setupButtonEventListeners",value:function(){var e=this,t=document.querySelector(".".concat(OVERLAY_RESULT_SUPPORT_BUTTON_CLASS)),r=document.querySelector(".".concat(OVERLAY_RESULT_SCAN_AGAIN_BUTTON_CLASS)),n=document.querySelector(".".concat(OVERLAY_RESULT_BE_BUTTON_CLASS));null!=r&&r.addEventListener("click",(function(){e.handleScanAgainButtonClick().catch((function(e){console.error("error while handleScanAgainButtonClick",e)}))})),null!=t&&t.addEventListener("click",(function(){e.handleSupportButtonClick()})),null!=n&&n.addEventListener("click",(function(){e.handleBEButtonClick()}))}},{key:"setupRoiActionText",value:function(){this.roiActionText=createDivElem(),this.roiActionText.className="detect_roi-action-text-box",setStyles(this.roiActionText,{position:"absolute",color:"#ffff",display:"flex",borderRadius:"50px",fontFamily:"Carnas-Regular",fontSize:"1rem",height:"1%",padding:"3%",justifyContent:"center",alignItems:"center",zIndex:"2",width:"58%"}),this.roiActionText.style.top=checkIfIOS()?"16%":"18%",this.roiActionText.innerHTML="<p>".concat(defaultOverlayActionButton.scanQr,"</p>"),this.scannerElem.appendChild(this.roiActionText)}},{key:"handleScanAgainButtonClick",value:function(){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function e(){var t,r=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(this.isAutoCapture||checkIfDenso())&&(this.stableFrameRateBuffer=[]),this.takeSnapshotTriggered=!1,void 0!==this.scanAgainBtnCallbackFn&&this.scanAgainBtnCallbackFn(),t=document.querySelector(".vyu-capture-image-class"),showElement(this.startLoadingAnimationContainer,"flex"),hideElement(this.overlayImgElem),this.removeScannerElement(),this.createAndAppendScannerElement(),e.prev=8,e.next=11,this.reInitiateProductScan((function(){r.createCrossButton(),showElement(r.overlayImgElem,"block")}));case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(8),console.error("reInitiateProductScan error",e.t0);case 16:if(this.isAutoCapture){this.setupRoiActionText(),this.roiActionText.classList.add("fadeIn"),this.roiActionText.innerHTML="<p>".concat(defaultRoiActionText.positionOverlay,"</p>"),setStyles(this.roiActionText,{opacity:"0",animation:"fadeIn 1.5s forwards",backgroundColor:"#161515",fontSize:"1rem",width:"76%"});try{this.startModelDetection=!0}catch(e){console.error("error in initializeObjectDetector",e)}}else showElement(this.captureBtn,"block"),checkIfDenso()&&hideElement(this.captureBtn);return null!==t&&hideElement(t),e.next=20,applyZoomConstraint(this.stream,this.zoomValue);case 20:if(!checkIfDenso()){e.next=23;break}return e.next=23,this.densoQrDetection();case 23:case"end":return e.stop()}}),e,this,[[8,13]])})))}},{key:"triggerScanAgain",value:function(){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.handleScanAgainButtonClick();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("Error in triggerScanAgain:",e.t0);case 8:case"end":return e.stop()}}),e,this,[[0,5]])})))}},{key:"handleSupportButtonClick",value:function(){void 0!==this.supportCallbackFn&&this.supportCallbackFn({sessionId:this.sessionId,productInfo:{client:getProductId()},verificationResult:this.verifySessionStatus})}},{key:"setAccessToken",value:function(){var e;return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function t(){var r,n;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,login(this.apiUrl,this.apiKey,this.clientAccessToken,null===(e=this.analyticsTools)||void 0===e?void 0:e.logger);case 2:if(r=t.sent,n=r.access_token,!(void 0===n)){t.next=9;break}throw new Error("invalidAccessToken");case 9:this.accessToken=n;case 10:case"end":return t.stop()}}),t,this)})))}},{key:"setSDKConfig",value:function(){var e,t;return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function r(){return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null===(e=this.sdkConfig)||void 0===e){r.next=4;break}r.t0=e,r.next=7;break;case 4:return r.next=6,fetchSDKConfig(this.apiV2Url,this.environment,null===(t=this.analyticsTools)||void 0===t?void 0:t.logger);case 6:r.t0=r.sent;case 7:this.sdkConfig=r.t0;case 8:case"end":return r.stop()}}),r,this)})))}},{key:"setIsValidateFlowV2",value:function(){var e,t;this.isValidateFlowV2=null!=this.productScanId&&Boolean(null===(t=null===(e=this.sdkConfig)||void 0===e?void 0:e.validationFlowV2Ids)||void 0===t?void 0:t.includes(this.productScanId))}},{key:"setExperience",value:function(e){var t,r,n,i,o,s,a,c,l,u,d,h,f,p,m,v,g,_,y,b,w,k,S,E,C,T,P,A,x,B,I,R,O,M,L,D,N,F,$,U,j,q,G,V,z,H,W,K,Z,Y,X,Q,J,ee,te,re,ne,ie,oe,se,ae,ce,le,ue,de,he,fe,pe,me,ve,ge,_e,ye,be,we,ke,Se,Ee,Ce,Te,Pe,Ae,xe,Be,Ie,Re,Oe,Me,Le,De,Ne,Fe,$e,Ue,je,qe,Ge,Ve,ze,He,We,Ke,Ze,Ye,Xe,Qe,Je,et,tt,rt,nt,it,ot,st,at,ct,lt,ut,dt,ht,ft,pt,mt,vt,gt,_t,yt,bt,wt,kt,St,Et,Ct,Tt,Pt,At,xt,Bt,It,Rt,Ot,Mt;return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function Lt(){var Dt,Nt,Ft,$t,Ut,jt,qt,Gt,Vt,zt,Ht,Wt=this;return _regeneratorRuntime().wrap((function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:if(Dt=(new Date).getTime(),null===(t=this.productConfig)||void 0===t){Lt.next=5;break}Lt.t0=t,Lt.next=15;break;case 5:if(!this.isValidateFlowV2){Lt.next=11;break}return Lt.next=8,fetchExperienceV2(this.apiV2Url,e,this.environment,null===(r=this.analyticsTools)||void 0===r?void 0:r.logger);case 8:Lt.t1=Lt.sent,Lt.next=14;break;case 11:return Lt.next=13,fetchExperience(this.apiUrl,e,this.accessToken,(function(){}),null===(n=this.analyticsTools)||void 0===n?void 0:n.logger);case 13:Lt.t1=Lt.sent;case 14:Lt.t0=Lt.t1;case 15:if(this.productConfig=Lt.t0,Nt=this.productConfig,Ft=Nt.overlay_file_url,$t=Nt.product_config_id,Ut=Nt.experience_config,null===(o=null===(i=this.analyticsTools)||void 0===i?void 0:i.logger)||void 0===o||o.info("Experience config fetched",{productScanId:e,validateFlowV2:this.isValidateFlowV2,config:this.productConfig}),defaultOverlayActionButton.capturingImage=null!==(u=null===(l=null===(c=null===(a=null===(s=null==Ut?void 0:Ut.brand_engagement)||void 0===s?void 0:s.sdk_custom_props)||void 0===a?void 0:a.texts)||void 0===c?void 0:c.v1)||void 0===l?void 0:l.capturingImage)&&void 0!==u?u:defaultOverlayActionButton.capturingImage,defaultOverlayActionButton.verifying=null!==(m=null===(p=null===(f=null===(h=null===(d=null==Ut?void 0:Ut.brand_engagement)||void 0===d?void 0:d.sdk_custom_props)||void 0===h?void 0:h.texts)||void 0===f?void 0:f.v1)||void 0===p?void 0:p.verifying)&&void 0!==m?m:defaultOverlayActionButton.verifying,defaultOverlayActionButton.scanQr=null!==(b=null===(y=null===(_=null===(g=null===(v=null==Ut?void 0:Ut.brand_engagement)||void 0===v?void 0:v.sdk_custom_props)||void 0===g?void 0:g.texts)||void 0===_?void 0:_.v1)||void 0===y?void 0:y.scanQr)&&void 0!==b?b:defaultOverlayActionButton.scanQr,defaultRoiActionText.positionOverlay=null!==(C=null===(E=null===(S=null===(k=null===(w=null==Ut?void 0:Ut.brand_engagement)||void 0===w?void 0:w.sdk_custom_props)||void 0===k?void 0:k.texts)||void 0===S?void 0:S.v2)||void 0===E?void 0:E.positionOverlay)&&void 0!==C?C:defaultRoiActionText.positionOverlay,defaultRoiActionText.moveAway=null!==(B=null===(x=null===(A=null===(P=null===(T=null==Ut?void 0:Ut.brand_engagement)||void 0===T?void 0:T.sdk_custom_props)||void 0===P?void 0:P.texts)||void 0===A?void 0:A.v2)||void 0===x?void 0:x.moveAway)&&void 0!==B?B:defaultRoiActionText.moveAway,defaultRoiActionText.moveCloser=null!==(L=null===(M=null===(O=null===(R=null===(I=null==Ut?void 0:Ut.brand_engagement)||void 0===I?void 0:I.sdk_custom_props)||void 0===R?void 0:R.texts)||void 0===O?void 0:O.v2)||void 0===M?void 0:M.moveCloser)&&void 0!==L?L:defaultRoiActionText.moveCloser,defaultRoiActionText.perfectDistance=null!==(U=null===($=null===(F=null===(N=null===(D=null==Ut?void 0:Ut.brand_engagement)||void 0===D?void 0:D.sdk_custom_props)||void 0===N?void 0:N.texts)||void 0===F?void 0:F.v2)||void 0===$?void 0:$.perfectDistance)&&void 0!==U?U:defaultRoiActionText.perfectDistance,defaultRoiActionText.wrongQr=null!==(z=null===(V=null===(G=null===(q=null===(j=null==Ut?void 0:Ut.brand_engagement)||void 0===j?void 0:j.sdk_custom_props)||void 0===q?void 0:q.texts)||void 0===G?void 0:G.v2)||void 0===V?void 0:V.wrongQr)&&void 0!==z?z:defaultRoiActionText.wrongQr,defaultRoiActionText.labelNotFullyVisible=null!==(Y=null===(Z=null===(K=null===(W=null===(H=null==Ut?void 0:Ut.brand_engagement)||void 0===H?void 0:H.sdk_custom_props)||void 0===W?void 0:W.texts)||void 0===K?void 0:K.v2)||void 0===Z?void 0:Z.labelNotFullyVisible)&&void 0!==Y?Y:defaultRoiActionText.labelNotFullyVisible,jt=getImageUrl("potentialFake").icon,this.brandResultConfig=Object.assign(Object.assign({},this.brandResultConfig),null==Ut?void 0:Ut.ui_result_config),this.resultMapping=Object.assign(Object.assign({},this.resultMapping),null!==(X=null==Ut?void 0:Ut.result_aggregation_mapping)&&void 0!==X?X:{}),this.loadingElemColor=null!==(ee=null===(J=null===(Q=null==Ut?void 0:Ut.brand_engagement)||void 0===Q?void 0:Q.sdk_custom_props)||void 0===J?void 0:J.verification_loading_bar_color)&&void 0!==ee?ee:defaultLoadingBarColor,this.priorityPrompt.shake.icon=null!==(ne=null===(re=null===(te=null==Ut?void 0:Ut.brand_engagement)||void 0===te?void 0:te.sdkWarning)||void 0===re?void 0:re.shake_warning_icon)&&void 0!==ne?ne:jt,this.priorityPrompt.light.icon=null!==(se=null===(oe=null===(ie=null==Ut?void 0:Ut.brand_engagement)||void 0===ie?void 0:ie.sdkWarning)||void 0===oe?void 0:oe.low_light_warning_icon)&&void 0!==se?se:jt,this.wrongQrCodeIcon=null!==(le=null===(ce=null===(ae=null==Ut?void 0:Ut.brand_engagement)||void 0===ae?void 0:ae.sdkWarning)||void 0===ce?void 0:ce.wrong_qr_code_icon)&&void 0!==le?le:jt,this.wrongQrCodeLabelIcon=null!==(he=null===(de=null===(ue=null==Ut?void 0:Ut.brand_engagement)||void 0===ue?void 0:ue.sdkWarning)||void 0===de?void 0:de.wrong_qr_code_label_icon)&&void 0!==he?he:jt,this.labelNotFullyVisibleIcon=null!==(me=null===(pe=null===(fe=null==Ut?void 0:Ut.brand_engagement)||void 0===fe?void 0:fe.sdkWarning)||void 0===pe?void 0:pe.label_not_fully_visible_icon)&&void 0!==me?me:jt,logEvents(this.analyticsTools,"sendExperienceFetchedDelayEvent",captureOrCalculateTimestamp(Dt,!0)),null!=Ft&&null!=$t&&null!=Ut){Lt.next=39;break}throw new Error("Invalid experience data");case 39:if(this.enableSessionTimeOut=null!==(ge=null===(ve=Ut.session_config)||void 0===ve?void 0:ve.is_timeout)&&void 0!==ge&&ge,this.imageUploadTimeout=null!==(ye=null===(_e=Ut.session_config)||void 0===_e?void 0:_e.upload_timeout)&&void 0!==ye?ye:defaultTimeout,this.verifyTimeout=null!==(we=null===(be=Ut.session_config)||void 0===be?void 0:be.verify_timeout)&&void 0!==we?we:defaultTimeout,this.howToScanHeader=null===(Se=null===(ke=Ut.brand_engagement)||void 0===ke?void 0:ke.howToScan)||void 0===Se?void 0:Se.howToScanHeader,this.howToScanButton=null===(Ce=null===(Ee=Ut.brand_engagement)||void 0===Ee?void 0:Ee.howToScan)||void 0===Ce?void 0:Ce.howToScanButton,this.howToScanTimeOut=null===(Pe=null===(Te=Ut.brand_engagement)||void 0===Te?void 0:Te.howToScan)||void 0===Pe?void 0:Pe.timeOut,this.splashScreenTimeOut=null===(Ae=Ut.brand_engagement)||void 0===Ae?void 0:Ae.splashScreenTimeOut,this.priorityPrompt.light.label=null===(Be=null===(xe=Ut.brand_engagement)||void 0===xe?void 0:xe.sdkWarning)||void 0===Be?void 0:Be.lowLightDetected,this.lowLightThreshold=null===(Re=null===(Ie=Ut.brand_engagement)||void 0===Ie?void 0:Ie.sdkWarning)||void 0===Re?void 0:Re.lowLightThreshold,this.priorityPrompt.shake.label=null===(Me=null===(Oe=Ut.brand_engagement)||void 0===Oe?void 0:Oe.sdkWarning)||void 0===Me?void 0:Me.shakeDetectedPrompt,this.shakeThreshold=null===(De=null===(Le=Ut.brand_engagement)||void 0===Le?void 0:Le.sdkWarning)||void 0===De?void 0:De.shakeThreshold,this.splashScreenConfig=null!==(Fe=null===(Ne=Ut.brand_engagement)||void 0===Ne?void 0:Ne.customSplashScreenConfig)&&void 0!==Fe?Fe:null,this.qrUrl=null===(Ue=null===($e=Ut.brand_engagement)||void 0===$e?void 0:$e.QRAutocapture)||void 0===Ue?void 0:Ue.qrUrl,this.qrWidthFactor=null!==(Ge=null===(qe=null===(je=Ut.brand_engagement)||void 0===je?void 0:je.QRAutocapture)||void 0===qe?void 0:qe.qrWidthFactor)&&void 0!==Ge?Ge:3.7,this.minWidthAndroid=null===(ze=null===(Ve=Ut.brand_engagement)||void 0===Ve?void 0:Ve.QRAutocapture)||void 0===ze?void 0:ze.minWidthAndroid,this.minWidthIOS=null===(We=null===(He=Ut.brand_engagement)||void 0===He?void 0:He.QRAutocapture)||void 0===We?void 0:We.minWidthIOS,this.maxWidthAndroid=null===(Ze=null===(Ke=Ut.brand_engagement)||void 0===Ke?void 0:Ke.QRAutocapture)||void 0===Ze?void 0:Ze.maxWidthAndroid,this.maxWidthIOS=null===(Xe=null===(Ye=Ut.brand_engagement)||void 0===Ye?void 0:Ye.QRAutocapture)||void 0===Xe?void 0:Xe.maxWidthIOS,this.snapDimensions={sx:null!==(Je=null===(Qe=Ut.crop_config)||void 0===Qe?void 0:Qe.xOffset)&&void 0!==Je?Je:DEFAULT_SNAP_DIMENSION,sy:null!==(tt=null===(et=Ut.crop_config)||void 0===et?void 0:et.yOffset)&&void 0!==tt?tt:DEFAULT_SNAP_DIMENSION,sHeight:null===(rt=Ut.crop_config)||void 0===rt?void 0:rt.height,sWidth:null===(nt=Ut.crop_config)||void 0===nt?void 0:nt.width},this.imageCount=null!==(it=Ut.image_count)&&void 0!==it?it:DEFAULT_IMAGE_COUNT,this.totalImageCount=null!==(ot=Ut.image_count)&&void 0!==ot?ot:DEFAULT_IMAGE_COUNT,this.fakeThreshold=null!==(at=null===(st=Ut.result_aggregation_config)||void 0===st?void 0:st.fake_threshold)&&void 0!==at?at:DEFAULT_FAKE_THRESHOLD,this.genuineThreshold=null!==(lt=null===(ct=Ut.result_aggregation_config)||void 0===ct?void 0:ct.genuine_threshold)&&void 0!==lt?lt:DEFAULT_GENUINE_THRESHOLD,this.cannotConfirmThreshold=null!==(dt=null===(ut=Ut.result_aggregation_config)||void 0===ut?void 0:ut.cannot_confirm_threshold)&&void 0!==dt?dt:DEFAULT_CANNOT_CONFIRM_THRESHOLD,this.photoQualityIssueThreshold=null!==(ft=null===(ht=Ut.result_aggregation_config)||void 0===ht?void 0:ht.photo_quality_issue_threshold)&&void 0!==ft?ft:DEFAULT_PHOTO_QUALITY_ISSUE_THRESHOLD,this.productConfigId=$t,this.overlayFileUrl=Ft,this.overlayMaskFileUrl=null===(pt=Ut.overlay_config)||void 0===pt?void 0:pt.overlay_mask_file_url,void 0===this.overlayMaskFileUrl){Lt.next=70;break}return Lt.next=70,preloadImage(this.overlayMaskFileUrl);case 70:return void 0===this.verificationAnimation&&(this.verificationAnimation=null===(mt=Ut.brand_engagement)||void 0===mt?void 0:mt.verification_animation_url),this.overlayConfig=Ut.overlay_config,qt=null!==(gt=null===(vt=Ut.brand_engagement)||void 0===vt?void 0:vt.focusMode)&&void 0!==gt?gt:"continuous",Lt.next=75,applyFocusMode(qt,this.stream);case 75:return this.placeholderQuestionMarkContent=null===(_t=null==Ut?void 0:Ut.brand_engagement)||void 0===_t?void 0:_t.placeholder_question_mark_content,Gt=null===(yt=null==Ut?void 0:Ut.brand_engagement)||void 0===yt?void 0:yt.placeholder_exclamation_content,this.splashScreenContent=null===(bt=null==Ut?void 0:Ut.brand_engagement)||void 0===bt?void 0:bt.splashScreenContent,this.customZoom=null!==(kt=null===(wt=null==Ut?void 0:Ut.brand_engagement)||void 0===wt?void 0:wt.customZoom)&&void 0!==kt?kt:{},this.showEnableTestDataCollectionButton=null!==(Et=null===(St=null==Ut?void 0:Ut.brand_engagement)||void 0===St?void 0:St.showEnableTestDataCollectionButton)&&void 0!==Et&&Et,this.customAutoFocus=null!==(Tt=null===(Ct=null==Ut?void 0:Ut.brand_engagement)||void 0===Ct?void 0:Ct.customAutoFocus)&&void 0!==Tt?Tt:{},this.customResultDivColour=null!==(At=null===(Pt=null==Ut?void 0:Ut.brand_engagement)||void 0===Pt?void 0:Pt.customResultDivColour)&&void 0!==At?At:"#121214",this.zoomValue=checkIfIOS()?null!==(Bt=null===(xt=null==Ut?void 0:Ut.brand_engagement)||void 0===xt?void 0:xt.iosZoomValue)&&void 0!==Bt?Bt:this.zoomValue:null!==(Rt=null===(It=null==Ut?void 0:Ut.brand_engagement)||void 0===It?void 0:It.androidZoomValue)&&void 0!==Rt?Rt:this.zoomValue,this.zoomValue>2.2&&(this.zoomValue=2.2),this.zoomValue<1&&(this.zoomValue=1),void 0!==this.modelType&&void 0!==this.customZoom[this.modelType]&&(this.zoomValue=this.customZoom[this.modelType]),Lt.next=88,applyZoomConstraint(this.stream,this.zoomValue);case 88:if(this.placeholder=new Placeholder(timeoutInstance,idleTimeout,this.handleSessionTimeout.bind(this),this.handleScanAgainButtonClick.bind(this),closePopup,this.howToScanHeader,this.howToScanButton),!this.isNewUI){Lt.next=92;break}return Lt.next=92,this.handleSplashScreen();case 92:if(!this.isAutoCapture||void 0!==this.objectDetector){Lt.next=107;break}if(Vt=performance.now(),this.modelPath=null!==(Mt=null===(Ot=null==Ut?void 0:Ut.brand_engagement)||void 0===Ot?void 0:Ot.brand_engagement_model)&&void 0!==Mt?Mt:modelPath,Lt.prev=95,void 0===this.modelPath){Lt.next=99;break}return Lt.next=99,this.initializeObjectDetectorWithRetry(this.modelPath);case 99:Lt.next=104;break;case 101:Lt.prev=101,Lt.t2=Lt.catch(95),console.error("error in initializeObjectDetector",Lt.t2);case 104:zt=performance.now(),Ht=zt-Vt,logEvents(this.analyticsTools,"sendModelLoadDelayEvent",Ht);case 107:this.placeholder.setContentSrc(this.placeholderQuestionMarkContent,Gt),window.addEventListener("devicemotion",(function(e){handleMotion(e,Wt.rootElem,Wt.takeSnapshotTriggered,Wt.shakeThreshold,Wt.isDebugging,Wt.stableFrameRateBuffer,Wt.isStableFrameCount,Wt.priorityPrompt)}),!0);case 109:case"end":return Lt.stop()}}),Lt,this,[[95,101]])})))}},{key:"setupMQTTMessageRouter",value:function(){var e=this;null!=this.mqttClient&&this.mqttClient.on("message",(function(t,r){try{var n=JSON.parse(r.toString());console.info("[MQTT] Received message on topic:",t);var i=e.mqttMessageHandlers.get(t);"function"==typeof i?i(n):console.warn("[MQTT] No handler for topic:",t)}catch(e){console.error("[MQTT] Message parse error:",e)}}))}},{key:"initializeMQTT",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function t(){var r=this;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.info("[MQTT] Attempting to connect..., Session ID: ",e),t.next=3,new Promise((function(t,n){var i=mqtt.connect(r.mqttCredentials.url,{username:r.mqttCredentials.username,password:r.mqttCredentials.password,clean:!0,clientId:e,rejectUnauthorized:!1});i.on("error",(function(t){logEvents(r.analyticsTools,"mqtt_connection_failed",{error:t.message,sessionId:e}),console.error("[MQTT] Connection Error:",t.message),n(new Error("MQTT Connection Error"+t.message))}));var o=setTimeout((function(){i.end(),n(new Error("MQTT connection timeout - check your internet connection"))}),1e4);i.on("connect",(function(n){var s,a,c,l,u,d;clearTimeout(o),console.info("[MQTT] Connection established successfully"),logEvents(r.analyticsTools,"mqtt_connection_established",{sessionId:e,isSessionPresent:n.sessionPresent}),r.mqttClient=i,null===(s=r.mqttClient)||void 0===s||s.on("error",(function(t){console.error("[MQTT] Error:",t),logEvents(r.analyticsTools,"mqtt_connection_error",{error:t.message,sessionId:e})})),null===(a=r.mqttClient)||void 0===a||a.on("disconnect",(function(){console.info("[MQTT] Disconnected"),logEvents(r.analyticsTools,"mqtt_disconnected",{sessionId:e}),r.mqttClient=null})),null===(c=r.mqttClient)||void 0===c||c.on("end",(function(){console.info("[MQTT] Connection ended"),logEvents(r.analyticsTools,"mqtt_connection_ended",{sessionId:e}),r.mqttClient=null})),null===(l=r.mqttClient)||void 0===l||l.on("close",(function(){console.info("[MQTT] Connection closed"),logEvents(r.analyticsTools,"mqtt_connection_closed",{sessionId:e}),r.mqttClient=null})),null===(u=r.mqttClient)||void 0===u||u.on("offline",(function(){console.info("[MQTT] Connection offline"),logEvents(r.analyticsTools,"mqtt_connection_offline",{sessionId:e})})),null===(d=r.mqttClient)||void 0===d||d.on("reconnect",(function(){console.info("[MQTT] Reconnected"),logEvents(r.analyticsTools,"mqtt_reconnected",{sessionId:e})})),r.setupMQTTMessageRouter(),t()}))}));case 3:case"end":return t.stop()}}),t)})))}},{key:"subscribeToImageResults",value:function(){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function e(){var t,r,n,i,o,s,a=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="".concat(this.sessionId,"-image-stream/results"),null!=this.mqttClient){e.next=3;break}throw new Error("MQTT client not connected");case 3:return r=0,n=0,i=0,o=0,s=0,e.next=10,new Promise((function(e,c){var l;null===(l=a.mqttClient)||void 0===l||l.subscribe(t,{},(function(l){null==l?(console.info("[MQTT] Subscribed to image results topic ".concat(t)),a.mqttMessageHandlers.set(t,(function(e){var t=e;if(a.mqttImageResultProcessed)console.debug("[MQTT] Skipping because image result already processed. duplicate image result:",t);else if(a.isValidDetection(t)){r++;var c=t.prediction_result;0===c?n++:1===c?i++:-2===c?o++:-1===c&&s++,console.debug("[MQTT] Result ".concat(r,"/").concat(a.totalImageCount,":"),c),(a.shouldMakeDecision(n,i,o,s,r)||r>=a.totalImageCount)&&(console.debug("[MQTT] Final counts - Accept: ".concat(n,", Reject: ").concat(i,", Cannot: ").concat(s)),a.processFinalResult(n,i,o,r).catch((function(e){console.error("[MQTT] Error processing final result:",e)})))}else console.error("[MQTT] Invalid detection result received:",t)})),e()):c(new Error("Failed to subscribe to ".concat(t,": ").concat(l.message)))}))}));case 10:case"end":return e.stop()}}),e,this)})))}},{key:"shouldMakeDecision",value:function(e,t,r,n,i){return e>0&&e>=this.genuineThreshold?(console.info("[MQTT]  Genuine result received - proceeding immediately"),!0):t>0&&t>=this.fakeThreshold?(console.debug("[MQTT] Maximum fake threshold exceeded - declaring FAKE"),!0):this.photoQualityIssueThreshold>0&&r>=this.photoQualityIssueThreshold?(console.info("[MQTT] Photo quality issue threshold exceeded - declaring PHOTO_QUALITY_ISSUE"),!0):this.cannotConfirmThreshold>0&&n>=this.cannotConfirmThreshold?(console.info("[MQTT] Cannot confirm threshold exceeded - declaring CANNOT_CONFIRM"),!0):i>=this.totalImageCount&&(console.info("[MQTT] All images received - proceeding immediately"),!0)}},{key:"processFinalResult",value:function(e,t,r,n){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function i(){var o,s;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return console.info("[MQTT] Processing final result from ".concat(n," images")),o=this.resultMapping.CANNOT_CONFIRM,o=e>=this.genuineThreshold?this.resultMapping.GENUINE:t>=this.fakeThreshold?this.resultMapping.POTENTIAL_FAKE:this.photoQualityIssueThreshold>0&&r>=this.photoQualityIssueThreshold?this.resultMapping.PHOTO_QUALITY_ISSUE:this.resultMapping.CANNOT_CONFIRM,console.debug("[MQTT] Final verification status:",o),s=this.calculateAnalysisResult(e,t,r),i.prev=5,this.mqttImageResultProcessed=!0,i.next=9,this.sendSessionResult(this.getPredictionLabel(s),s,o,this.genuineThreshold,this.fakeThreshold,this.sessionId);case 9:this.verifySessionStatus=o,void 0!==this.stream&&stopCamera(this.stream).catch(console.error),this.enableSessionTimeOut&&timeoutInstance.clearVerifyTimeout(),i.next=17;break;case 14:i.prev=14,i.t0=i.catch(5),console.error("[MQTT] Error sending session result:",i.t0);case 17:return i.prev=17,this.cleanUpAfterSessionResult(),i.finish(17);case 20:case"end":return i.stop()}}),i,this,[[5,14,17,20]])})))}},{key:"sendSessionResult",value:function(e,t,r,n,i,o){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function s(){var a,c;return _regeneratorRuntime().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return a={sessionId:o,source:"stream",result:e,sessionCompletedAt:(new Date).toISOString(),analysisResult:t,imageCountConfig:JSON.stringify({genuine_threshold:n,fake_threshold:i}),uiResult:r},s.prev=1,logEvents(this.analyticsTools,"session_result_triggered",{sessionId:o,sessionData:a}),s.next=5,fetch("".concat(this.apiV2Url,"/session-result"),{method:"POST",headers:{"Content-Type":"application/json",accept:"application/json"},body:JSON.stringify(a)});case 5:(c=s.sent).ok?(logEvents(this.analyticsTools,"session_result_success",{sessionId:o}),console.log("Session result sent successfully")):(console.error("Failed to send session result:",c.status,c.statusText),logEvents(this.analyticsTools,"session_result_failed",{sessionId:o,error:"Failed to send session result",status:c.status,statusText:c.statusText})),s.next=13;break;case 9:throw s.prev=9,s.t0=s.catch(1),logEvents(this.analyticsTools,"session_result_failed",{sessionId:o,error:s.t0}),new Error("Failed to send session result: ".concat(s.t0));case 13:case"end":return s.stop()}}),s,this,[[1,9]])})))}},{key:"calculateAnalysisResult",value:function(e,t,r){return e>=this.genuineThreshold?0:t>=this.fakeThreshold?1:this.photoQualityIssueThreshold>0&&r>=this.photoQualityIssueThreshold?4:2}},{key:"cleanUpMQTTSession",value:function(){var e;console.debug("[MQTT] Cleaning up MQTT session"),null===(e=this.mqttClient)||void 0===e||e.end(),this.mqttClient=null,this.mqttImageResultProcessed=!1}},{key:"cleanUpWebSocketSession",value:function(){console.debug("[WebSocket] Cleaning up WebSocket session"),null!=this.wsClient&&this.wsClient.readyState!==WebSocket.CLOSED&&this.wsClient.close(1e3,"Session ended"),this.wsClient=null}},{key:"cleanUpAfterSessionResult",value:function(){this.cleanUpMQTTSession(),this.cleanUpWebSocketSession()}},{key:"isValidDetection",value:function(e){return null!==(null==e?void 0:e.prediction_result)&&void 0!==e.prediction_result&&[0,1,-1,-2].includes(e.prediction_result)}},{key:"getPredictionLabel",value:function(e){switch(e){case 0:return"GENUINE";case 1:return"FAKE";case 2:return"CANNOT_CONFIRM";case 4:return"PHOTO_QUALITY_ISSUE";default:return"UNKNOWN"}}},{key:"setupWSMessageRouter",value:function(){var e=this;null!=this.wsClient&&(this.wsClient.onmessage=function(t){try{var r=JSON.parse(t.data);console.debug("[WebSocket] Received message type:",r.type);var n=e.wsMessageHandlers.get(r.type);"function"==typeof n?n(r):console.warn("[WebSocket] No handler registered for message type:",r.type)}catch(e){console.error("[WebSocket] Failed to parse message:",e)}})}},{key:"getWSURL",value:function(){if(null==this.environment)return WS_DEFAULT_URL;switch(this.environment.toUpperCase()){case"PROD":case"PRODUCTION":return WS_PROD_URL;case"STAGE":case"STAGING":return WS_STAGE_URL;case"QA":return WS_QA_URL;default:return WS_DEFAULT_URL}}},{key:"getMqttCredentials",value:function(){if(null==this.environment)return MQTT_DEFAULT_CREDENTIALS;switch(this.environment.toUpperCase()){case"PROD":case"PRODUCTION":case"STAGE":case"STAGING":return MQTT_PROD_CREDENTIALS;default:return MQTT_DEFAULT_CREDENTIALS}}},{key:"initializeWebSocket",value:function(){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function e(){var t=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.debug("[WebSocket] Attempting to connect to:",this.wsURL),e.next=3,new Promise((function(e,r){null!==t.wsClient&&t.cleanUpWebSocketSession();var n=new WebSocket(t.wsURL),i=setTimeout((function(){n.close(),r(new Error("WebSocket connection timeout - check your internet connection"))}),1e4);n.onopen=function(){clearTimeout(i),t.wsClient=n,console.debug("[WebSocket] Connection established successfully"),t.setupWSMessageRouter(),n.onclose=function(e){if(t.wsClient=null,console.warn("[WebSocket] Connection lost:",{code:e.code,reason:e.reason,wasClean:e.wasClean}),1006===e.code){if(!navigator.onLine)throw console.error("[WebSocket] Disconnected due to network issue"),new Error("Websocket disconnected due to Network issue");console.error("[WebSocket] Disconnected due to abnormal close event"),void 0!==t.errorCallbackFn&&t.errorCallbackFn({type:"API",err:"Websocket error: Websocket closed due to ".concat(e.reason)})}else console.info("[WebSocket] Server closed connection")},n.onerror=function(e){console.error("[WebSocket] Error during active connection:",e instanceof ErrorEvent?e.message:"Unknown error")},e()},n.onerror=function(e){clearTimeout(i);var t=e instanceof ErrorEvent?e.message:"Unknown error",o="WebSocket connection failed";navigator.onLine?n.readyState===WebSocket.CONNECTING&&(o="Unable to reach server"):o="No internet connection available",console.error("[WebSocket] Connection error:",t),r(new Error("".concat(o,": ").concat(t)))},n.onclose=function(e){if(clearTimeout(i),null===t.wsClient){var n="Connection closed unexpectedly";switch(e.code){case 1e3:n="Connection closed by server";break;case 1006:n=navigator.onLine?"Connection lost - server unavailable":"Connection lost - no internet";break;default:n="Connection closed (code: ".concat(e.code,")")}console.error("[WebSocket] Connection closed during initialization:",n),r(new Error("WebSocket connection closed: ".concat(n)))}}}));case 3:case"end":return e.stop()}}),e,this)})))}},{key:"setSessionId",value:function(){var e;return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function t(){var r,n,i,o,s,a;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,getPermission$1(this.analyticsTools,this.errorCallbackFn);case 2:if(r=t.sent,n=(new Date).getTime(),i="true"===localStorage.getItem("enableTestDataCollection"),this.userCurrentLocation=r,!this.showGenuine){t.next=9;break}return this.sessionId="mock-session-".concat(Date.now()),t.abrupt("return");case 9:return o={product_config_id:this.productConfigId,access_token:this.accessToken,geo_location:r,metadata:{camList:getDeviceCapabilities(),devicePixelRatio:window.devicePixelRatio,enableTestDataCollection:this.showEnableTestDataCollectionButton&&i}},t.next=12,startSession(this.apiUrl,o,null===(e=this.analyticsTools)||void 0===e?void 0:e.logger);case 12:if(s=t.sent,a=s.session_id,logEvents(this.analyticsTools,"sendSessionStartedDelayEvent",captureOrCalculateTimestamp(n,!0)),null!=a){t.next=19;break}throw new Error("Invalid session ID");case 19:this.sessionId=a;case 20:case"end":return t.stop()}}),t,this)})))}},{key:"setWSSessionId",value:function(e){var t,r,n,i,o,s,a;return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function c(){var l,u,d,h,f,p,m,v,g,_=this;return _regeneratorRuntime().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(null!=this.wsClient){c.next=2;break}throw new Error("[Websocket] connection not established");case 2:return c.next=4,getPermission$1(this.analyticsTools,this.errorCallbackFn);case 4:if(l=c.sent,u=localStorage.getItem("deviceModel"),d=new uaParserExports.UAParser,h=d.getResult(),f=null!=u?"".concat(null===(t=h.device)||void 0===t?void 0:t.model," ").concat(u):null===(r=h.device)||void 0===r?void 0:r.model,p=Object.assign(Object.assign({},h),{device:Object.assign(Object.assign({},h.device),{model:f})}),m=(new Date).getTime(),this.userCurrentLocation=l,!this.showGenuine){c.next=15;break}return this.sessionId="mock-session-".concat(Date.now()),c.abrupt("return");case 15:return v={clientId:this.clientId,sessionId:e,context:{user_agent:navigator.userAgent,phone:f,browser:null===(n=h.browser)||void 0===n?void 0:n.toString(),session_metadata:{geo_address:{geo_lat:null===(i=null==l?void 0:l.lat)||void 0===i?void 0:i.toString(),geo_long:null===(o=null==l?void 0:l.long)||void 0===o?void 0:o.toString()},device_details:p},appType:null!==(a=null===(s=h.device)||void 0===s?void 0:s.type)&&void 0!==a?a:"desktop",app_id:1,bandwidth:5,imageTag:"static",scanId:this.productScanId}},c.next=18,new Promise((function(t){var r;_.wsMessageHandlers.set("session_init",(function(e){var r=null==e?void 0:e.session_id;console.debug("[WebSocket] Session initialized:",r),_.wsMessageHandlers.delete("session_init"),t(r)})),console.info("[WebSocket] Sending session initialization...",e),null===(r=_.wsClient)||void 0===r||r.send(JSON.stringify(v))}));case 18:if(g=c.sent,logEvents(this.analyticsTools,"sendSessionStartedDelayEvent",captureOrCalculateTimestamp(m,!0)),null!=g&&g===e){c.next=24;break}throw new Error("Invalid session ID");case 24:this.sessionId=g;case 25:case"end":return c.stop()}}),c,this)})))}},{key:"fetchAndDisplayOverlay",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function t(){var r,n,i,o=this;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.productScanId=e,t.next=4,this.setSDKConfig();case 4:if(this.setIsValidateFlowV2(),this.isValidateFlowV2){t.next=8;break}return t.next=8,this.setAccessToken();case 8:return r=[this.setExperience(e)],this.isValidateFlowV2&&(n=v4(),i=function(){return __awaiter(o,void 0,void 0,_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initializeWebSocket();case 2:return e.next=4,this.setWSSessionId(n);case 4:case"end":return e.stop()}}),e,this)})))},r.push(i(),this.initializeMQTT(n))),t.next=12,Promise.all(r);case 12:if(!this.isValidateFlowV2){t.next=17;break}return t.next=15,this.subscribeToImageResults();case 15:t.next=19;break;case 17:return t.next=19,this.setSessionId();case 19:t.next=28;break;case 21:throw t.prev=21,t.t0=t.catch(0),console.error("An error occurred while API calls:",t.t0),void 0!==this.errorCallbackFn&&this.errorCallbackFn({type:"API",err:"API error: ".concat(t.t0.message)}),null!=this.wsClient&&this.cleanUpWebSocketSession(),null!=this.mqttClient&&(console.debug("[MQTT] Closing connection..."),this.mqttClient.end()),new Error("An error occurred while API calls ".concat(t.t0));case 28:if(t.prev=28,!this.isNewUI){t.next=36;break}if(checkIfDenso()){t.next=34;break}return t.next=33,setOverlayV1(this.overlayFileUrl,this.overlayConfig,!0,this.overlayImgElem,this.scannerElem,OVERLAY_CLASS,this.overlayMaskFileUrl,this.modelType);case 33:setOverlayText(this.scannerElem,OVERLAY_ACTION_BUTTON_CLASS);case 34:t.next=38;break;case 36:return t.next=38,setOverlay(this.overlayFileUrl,this.overlayConfig,!0,this.overlayImgElem,OVERLAY_CLASS);case 38:this.displayOverlayTimestamp=(new Date).getTime(),t.next=45;break;case 41:t.prev=41,t.t1=t.catch(28),console.error("An error occurred while fetching and displaying overlay:",t.t1),void 0!==this.errorCallbackFn&&this.errorCallbackFn({type:"TimedOut",err:"NONE_IMGS_CLICKED"});case 45:case"end":return t.stop()}}),t,this,[[0,21],[28,41]])})))}},{key:"verifySession",value:function(){var e;return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function t(){var r;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.showGenuine){t.next=9;break}return t.next=3,new Promise((function(e){return setTimeout(e,500)}));case 3:if(void 0===this.stream){t.next=6;break}return t.next=6,stopCamera(this.stream);case 6:return this.enableSessionTimeOut&&timeoutInstance.clearVerifyTimeout(),this.verifySessionStatus="GENUINE",t.abrupt("return");case 9:return t.prev=9,t.next=12,verifyProduct(this.apiUrl,this.sessionId,this.accessToken,null===(e=this.analyticsTools)||void 0===e?void 0:e.logger);case 12:if("COMPLETED"!==(r=t.sent).status){t.next=21;break}if(void 0===this.stream){t.next=17;break}return t.next=17,stopCamera(this.stream);case 17:this.enableSessionTimeOut&&timeoutInstance.clearVerifyTimeout(),this.verifySessionStatus=r.result,t.next=26;break;case 21:return t.next=23,new Promise((function(e){return setTimeout(e,100)}));case 23:return t.next=25,this.verifySession();case 25:return t.abrupt("return",t.sent);case 26:t.next=32;break;case 28:t.prev=28,t.t0=t.catch(9),console.error("An error occurred while verifying session:",t.t0),void 0!==this.errorCallbackFn&&this.errorCallbackFn({type:"API",err:t.t0.message});case 32:case"end":return t.stop()}}),t,this,[[9,28]])})))}},{key:"handleSplashScreen",value:function(){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.splashScreenContent&&null===this.splashScreenConfig||this.haveShownSplashScreen){e.next=4;break}return e.next=3,splashScreen(this.rootElem,this.splashScreenContent,this.splashScreenTimeOut,this.splashScreenConfig);case 3:this.haveShownSplashScreen=!0;case 4:case"end":return e.stop()}}),e,this)})))}},{key:"handleHowToScanScreen",value:function(){var e,t;void 0!==this.placeholderQuestionMarkContent&&this.showHowToCaptureScreen&&(this.howToScanTimeOut=(null!==(e=this.howToScanTimeOut)&&void 0!==e?e:2e4)+(null!==(t=this.splashScreenTimeOut)&&void 0!==t?t:5),createHowToScanScreen(this.rootElem,this.placeholderQuestionMarkContent,this.howToScanHeader,this.howToScanButton,this.howToScanTimeOut,this.hideStartLoader.bind(this),this.appendDemoPlaceholder.bind(this),this.showEnableTestDataCollectionButton),this.haveShownHowToCaptureScreen=!0)}},{key:"initiateWebcam",value:function(){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function e(){var t,r=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(t=getDeviceId())){e.next=3;break}throw new Error("cameraIdError");case 3:return e.next=5,getStream(t,this.isNewUI);case 5:if(this.stream=e.sent,void 0!==this.stream){e.next=10;break}throw new Error("cameraStartError");case 10:checkIfDenso()?document.addEventListener("visibilitychange",(function(){applyZoomConstraint(r.stream,r.zoomValue).catch((function(e){console.error("error in applyZoomConstraint",e)}))})):(document.addEventListener("visibilitychange",(function(){applyZoomConstraint(r.stream,r.zoomValue).catch((function(e){console.error("error in applyZoomConstraint",e)}))})),this.videoElem.srcObject=this.stream,this.isAutoCapture&&(this.intervalId=setInterval((function(){r.animationId=window.requestAnimationFrame(r.predictWebcam.bind(r))}),200)),this.isNewUI||(this.scannerElem.appendChild(this.overlayImgElem),this.scannerElem.removeChild(this.cameraLoadingElem)));case 11:case"end":return e.stop()}}),e,this)})))}},{key:"webGlContextLossCamFix",value:function(){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function e(){var t;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(t=getDeviceId())){e.next=3;break}throw new Error("cameraIdError");case 3:return e.next=5,getStream(t,this.isNewUI);case 5:if(this.stream=e.sent,void 0!==this.stream){e.next=10;break}throw new Error("cameraStartError");case 10:this.videoElem.srcObject=this.stream;case 11:case"end":return e.stop()}}),e,this)})))}},{key:"identifyProduct",value:function(e,t,r){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function n(){var i,o,s,a,c,l,u,d,h,f=this;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this.isNewUI&&(this.setupRoiActionText(),setQROverlayMask(this.scannerElem,QR_OVERLAY_CLASS)),n.next=3,clientHintHeaders;case 3:for(i=n.sent,o=0,s=Object.entries(i);o<s.length;o++)a=_slicedToArray(s[o],2),c=a[0],l=a[1],"Sec-CH-UA-Model"===c&&(this.modelType=l);return void 0!==this.modelType&&Boolean(cpuModeList.includes(this.modelType))&&(this.isAutoCapture=!1,this.handleCaptureButton()),n.next=8,startCameraSettingProcess(maxRetryCount,this.analyticsTools,this.errorCallbackFn);case 8:return u=getDeviceId(),d=function(t){return __awaiter(f,void 0,void 0,_regeneratorRuntime().mark((function n(){var i=this;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return void 0!==r&&r({result:t}),setProductId(t.data),this.isNewUI&&(this.roiActionText.style.display="none"),n.next=5,this.qrScanner.stop();case 5:n.prev=5,this.isAutoCapture&&(this.roiActionText.style.display="flex",this.roiActionText.classList.add("fadeIn"),this.roiActionText.innerHTML="<p>".concat(defaultRoiActionText.positionOverlay,"</p>"),this.startModelDetection=!0,setStyles(this.roiActionText,{opacity:"0",animation:"fadeIn 1.5s forwards",backgroundColor:"#161515",fontSize:"1rem",width:"76%"}),this.coordinates=calculateCoordinatesV3(this.overlayImgElem,window.innerWidth,window.innerHeight)),n.next=14;break;case 9:throw n.prev=9,n.t0=n.catch(5),this.isAutoCapture||hideElement(this.captureBtn),createQRIssuePopup(this.qrScanner,this.roiActionText),n.t0;case 14:return n.next=16,this.qrScanner.destroy();case 16:if(removeQROverlayMask(QR_OVERLAY_CLASS),closePopup(),!this.isNewUI){n.next=23;break}return n.next=21,this.loadFonts((function(){return __awaiter(i,void 0,void 0,_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.initiateWebcam();case 1:case"end":return e.stop()}}),e,this)})))}));case 21:n.next=24;break;case 23:this.initiateWebcam();case 24:return n.next=26,this.fetchAndDisplayOverlay(t.data);case 26:this.isNewUI&&this.handleHowToScanScreen(),this.isAutoCapture||showElement(this.captureBtn,"block"),void 0!==e&&e({result:t});case 29:case"end":return n.stop()}}),n,this,[[5,9]])})))},h=function(){void 0!==t&&t("qrScanError")},"List"===this.identificationType&&void 0!==t&&t("invalidIdentificationType"),n.prev=12,n.next=15,this.initiateQRScan(d,h,u);case 15:this.haveShownHowToCaptureScreen||this.hideStartLoader(),this.enableSessionTimeOut&&timeoutInstance.startIdleTimeout((function(){return __awaiter(f,void 0,void 0,_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handleSessionTimeout();case 2:case"end":return e.stop()}}),e,this)})))}),idleTimeout),void 0!==this.onQrScannerLoadCallbackFn&&this.onQrScannerLoadCallbackFn({}),n.next=24;break;case 20:n.prev=20,n.t0=n.catch(12),void 0!==t&&t("qrScannerStartError"),void 0!==this.errorCallbackFn&&this.errorCallbackFn({type:"Camera",err:"Camera permission error: Permission denied"});case 24:case"end":return n.stop()}}),n,this,[[12,20]])})))}},{key:"initiateQRScan",value:function(e,t,r){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function n(){return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this.qrScanner=new e$1(this.videoElem,e,{onDecodeError:t,preferredCamera:null!=r?r:"environment",maxScansPerSecond:10}),n.next=3,this.qrScanner.start();case 3:case"end":return n.stop()}}),n,this)})))}},{key:"initiateQRScanV1",value:function(e,t,r){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function n(){var i,o=this;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this.qrScanner=new f$1(this.videoElem,(function(t){return __awaiter(o,void 0,void 0,_regeneratorRuntime().mark((function r(){var n;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=t,r.next=3,e({data:n});case 3:case"end":return r.stop()}}),r)})))}),{onDecodeError:t,preferredCamera:null!=r?r:"environment",maxScansPerSecond:30,highlightScanRegion:!0,highlightCodeOutline:!1,stream:this.stream}),this.qrScanner.setInversionMode("both"),n.next=4,this.qrScanner.start();case 4:null!==(i=document.querySelector(".".concat(QR_SCANNER_SVG_CLASS)))&&(i.style.stroke="#".concat(this.qrSvgStrokeColor));case 6:case"end":return n.stop()}}),n,this)})))}},{key:"selectProduct",value:function(e,t){var r,n;return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function i(){var o,s,a,c,l,u,d=this;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return this.isValidateFlowV2=null!==(r=null==t?void 0:t.isValidateFlowV2)&&void 0!==r&&r,"QR"===this.identificationType&&void 0!==(null==t?void 0:t.errorCallbackFn)&&(null==t||t.errorCallbackFn("invalidIdentificationType")),i.prev=2,i.next=5,clientHintHeaders;case 5:for(o=i.sent,s=0,a=Object.entries(o);s<a.length;s++)c=_slicedToArray(a[s],2),l=c[0],u=c[1],"Sec-CH-UA-Model"===l&&(this.modelType=u);return void 0!==this.modelType&&Boolean(cpuModeList.includes(this.modelType))&&(this.isAutoCapture=!1,this.handleCaptureButton()),setProductId(e),i.next=11,startCameraSettingProcess(maxRetryCount,this.analyticsTools,this.errorCallbackFn);case 11:if(!this.isNewUI){i.next=16;break}return i.next=14,this.loadFonts((function(){return __awaiter(d,void 0,void 0,_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.initiateWebcam();case 1:case"end":return e.stop()}}),e,this)})))}));case 14:i.next=17;break;case 16:this.initiateWebcam();case 17:return this.productConfig=null!==(n=null==t?void 0:t.productConfig)&&void 0!==n?n:null,i.next=20,this.fetchAndDisplayOverlay(e);case 20:if(!checkIfDenso()){i.next=23;break}return i.next=23,this.densoQrDetection();case 23:this.isNewUI&&this.handleHowToScanScreen(),this.isNewUI&&this.isAutoCapture&&(this.setupRoiActionText(),this.roiActionText.style.display="flex",this.roiActionText.classList.add("fadeIn"),this.roiActionText.innerHTML="<p>".concat(defaultRoiActionText.positionOverlay,"</p>"),this.startModelDetection=!0,setStyles(this.roiActionText,{opacity:"0",animation:"fadeIn 1.5s forwards",backgroundColor:"#161515",fontSize:"1rem",width:"76%"}),this.coordinates=calculateCoordinatesV3(this.overlayImgElem,window.innerWidth,window.innerHeight)),this.isAutoCapture||checkIfDenso()||showElement(this.captureBtn,"block"),this.haveShownHowToCaptureScreen||(this.appendDemoPlaceholder(),this.hideStartLoader()),setPhotoOptions(this.videoElem,this.snapDimensions,getDeviceId(),this.rootElem,this.isDebugging,this.takeSnapshotTriggered,this.lowLightThreshold,this.stableFrameRateBuffer,this.isStableFrameCount,this.priorityPrompt).catch((function(e){console.error("error in analyzeVideo",e)})),this.enableSessionTimeOut&&timeoutInstance.startIdleTimeout((function(){return __awaiter(d,void 0,void 0,_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handleSessionTimeout();case 2:case"end":return e.stop()}}),e,this)})))}),idleTimeout),void 0!==(null==t?void 0:t.successCallbackFn)&&t.successCallbackFn({}),i.next=36;break;case 32:i.prev=32,i.t0=i.catch(2),console.error("selectProduct err",i.t0),void 0!==(null==t?void 0:t.errorCallbackFn)&&t.errorCallbackFn("webCamStartError");case 36:case"end":return i.stop()}}),i,this,[[2,32]])})))}},{key:"getProductList",value:function(e){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function t(){var r;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("QR"!==this.identificationType){t.next=2;break}return t.abrupt("return",{data:null,error:"invalidIdentificationType"});case 2:return t.next=4,fetchProductList(e);case 4:if(void 0===(r=t.sent)){t.next=9;break}return t.abrupt("return",{data:r,error:null});case 9:return t.abrupt("return",{data:null,error:"productListFetchError"});case 10:case"end":return t.stop()}}),t,this)})))}},{key:"reInitiateProductScan",value:function(e,t){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function r(){var n,i=this;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return this.isResultDisplayed=!1,r.next=3,refreshCameraPermissions();case 3:if(r.prev=3,logEvents(this.analyticsTools,"sendScanAgainClickedEvent",captureOrCalculateTimestamp()),this.isNewUI||this.scannerElem.appendChild(this.cameraLoadingElem),this.verifySessionStatus=void 0,null==(n=getProductId())){r.next=23;break}if(!this.isNewUI||this.scannerElem.contains(this.videoElem)&&this.scannerElem.contains(this.previewElem)?(this.scannerElem.replaceChild(this.videoElem,this.previewElem),this.previewElem.src=EMPTY_STRING):this.scannerElem.appendChild(this.videoElem),!this.isNewUI){r.next=15;break}return r.next=13,this.loadFonts((function(){return __awaiter(i,void 0,void 0,_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.initiateWebcam();case 1:case"end":return e.stop()}}),e,this)})))}));case 13:r.next=16;break;case 15:this.initiateWebcam();case 16:return r.next=18,this.fetchAndDisplayOverlay(n);case 18:this.hideStartLoader(),this.enableSessionTimeOut&&timeoutInstance.startIdleTimeout((function(){return __awaiter(i,void 0,void 0,_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handleSessionTimeout();case 2:case"end":return e.stop()}}),e,this)})))}),idleTimeout),void 0!==e&&e({}),r.next=24;break;case 23:window.location.reload();case 24:r.next=29;break;case 26:r.prev=26,r.t0=r.catch(3),void 0!==t&&t("initiateProductScan");case 29:case"end":return r.stop()}}),r,this,[[3,26]])})))}},{key:"takeSnapshot",value:function(e,t){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function r(){var n,i,o,s,a,c,l,u,d,h,f,p,m,v=this;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n="image/jpeg",this.takeSnapshotTriggered=!0,this.captureButtonClickTimestamp=(new Date).getTime(),logEvents(this.analyticsTools,"sendCaptureClickedDelayEvent",captureOrCalculateTimestamp(this.displayOverlayTimestamp,!0)),this.isNewUI&&!this.isAutoCapture&&(null!=(i=document.querySelector("#".concat(CAPTURE_BUTTON_ID)))&&(i.style.display="none"),checkIfBigYara()||createLoaderBar(this.scannerElem,OVERLAY_ACTION_BUTTON_CLASS,OVERLAY_LOADER_BAR_CLASS,OVERLAY_LOADER_CONTAINER_CLASS,this.loadingElemColor)),o=this.snapDimensions,s=o.sWidth,a=o.sHeight,c=o.sx,l=o.sy,u=this.videoElem,this.enableSessionTimeOut&&timeoutInstance.clearIdleTimeout(),void 0===u&&void 0!==t&&t("invalidVideoRef"),(d=document.createElement("canvas")).width=void 0!==s?u.videoWidth*s:u.videoWidth,d.height=void 0!==a?u.videoHeight*a:u.videoHeight,null!==(h=d.getContext("2d"))){r.next=16;break}return void 0!==t&&t("invalidCanvasContext"),r.abrupt("return");case 16:if(this.enableSessionTimeOut&&(this.showGenuine?(timeoutInstance.startUploadTimeout((function(){console.error("Session aborted (mock)");var e=document.querySelector("#".concat(CAPTURE_BUTTON_ID));null!=e&&(e.style.display="none"),v.shouldShowResult&&v.displayResults(v.scannerElem.className).catch((function(e){return console.error("Error displaying results:",e)})),void 0!==v.errorCallbackFn&&v.errorCallbackFn({type:"TimedOut",err:"NONE_IMGS_UPLOADED"})}),this.imageUploadTimeout),timeoutInstance.startPartialImagesTimeout((function(){console.error("Session aborted (mock)");var e=document.querySelector("#".concat(CAPTURE_BUTTON_ID));null!=e&&(e.style.display="none"),v.shouldShowResult&&v.displayResults(v.scannerElem.className).catch((function(e){return console.error("Error displaying results:",e)})),void 0!==v.errorCallbackFn&&v.errorCallbackFn({type:"TimedOut",err:"PARTIAL_IMGS_UPLOADED"})}),this.imageUploadTimeout)):(timeoutInstance.startUploadTimeout((function(){__awaiter(v,void 0,void 0,_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.isValidateFlowV2){e.next=5;break}this.cleanUpAfterSessionResult(),e.next=7;break;case 5:return e.next=7,abortSession(this.apiUrl,this.sessionId,this.accessToken,"NONE_IMGS_UPLOADED");case 7:return console.error("Session aborted"),e.next=10,this.updateUIAborted();case 10:e.next=17;break;case 12:return e.prev=12,e.t0=e.catch(0),console.error("An error occurred during timeout handling:",e.t0),e.next=17,this.updateUIAborted();case 17:return e.prev=17,void 0!==this.errorCallbackFn&&this.errorCallbackFn({type:"TimedOut",err:"NONE_IMGS_UPLOADED"}),e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[0,12,17,20]])}))).catch((function(e){console.error("An error occurred during timeout execution:",e)}))}),this.imageUploadTimeout),timeoutInstance.startPartialImagesTimeout((function(){__awaiter(v,void 0,void 0,_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.isValidateFlowV2){e.next=5;break}this.cleanUpAfterSessionResult(),e.next=7;break;case 5:return e.next=7,abortSession(this.apiUrl,this.sessionId,this.accessToken,"PARTIAL_IMGS_UPLOADED");case 7:return console.error("Session aborted"),e.next=10,this.updateUIAborted();case 10:e.next=17;break;case 12:return e.prev=12,e.t0=e.catch(0),console.error("An error occurred:",e.t0),e.next=17,this.updateUIAborted();case 17:return e.prev=17,void 0!==this.errorCallbackFn&&this.errorCallbackFn({type:"TimedOut",err:"PARTIAL_IMGS_UPLOADED"}),e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[0,12,17,20]])}))).catch((function(e){console.error("An error occurred during timeout execution:",e)}))}),this.imageUploadTimeout))),this.enableSessionTimeOut&&(timeoutInstance.clearUploadTimeout(),this.showGenuine?timeoutInstance.startVerifyTimeout((function(){console.error("Session aborted (mock)");var e=document.querySelector("#".concat(CAPTURE_BUTTON_ID));null!=e&&(e.style.display="none"),v.shouldShowResult&&v.displayResults(v.scannerElem.className).catch((function(e){return console.error("Error displaying results:",e)})),void 0!==v.errorCallbackFn&&v.errorCallbackFn({type:"TimedOut",err:"BACKEND_API_FAILURE"})}),this.verifyTimeout):timeoutInstance.startVerifyTimeout((function(){__awaiter(v,void 0,void 0,_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.isValidateFlowV2){e.next=5;break}this.cleanUpAfterSessionResult(),e.next=7;break;case 5:return e.next=7,abortSession(this.apiUrl,this.sessionId,this.accessToken,"BACKEND_API_FAILURE");case 7:return console.error("Session aborted"),e.next=10,this.updateUIAborted();case 10:e.next=17;break;case 12:return e.prev=12,e.t0=e.catch(0),console.error("An error occurred:",e.t0),e.next=17,this.updateUIAborted();case 17:return e.prev=17,void 0!==this.errorCallbackFn&&this.errorCallbackFn({type:"TimedOut",err:"BACKEND_API_FAILURE"}),e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[0,12,17,20]])}))).catch((function(e){console.error("An error occurred during timeout execution:",e)}))}),this.verifyTimeout)),f=this.getImageBase64Url(h,u,c,l,d,n),this.showGenuine&&(this.previewImage=f),!this.isNewUI){r.next=25;break}return r.next=23,this.uploadImage(f);case 23:r.next=26;break;case 25:this.uploadImage(f);case 26:if(!this.showGenuine){r.next=32;break}return r.next=29,new Promise((function(e){return setTimeout(e,1e3)}));case 29:this.verifySessionStatus="GENUINE",r.next=33;break;case 32:this.isValidateFlowV2||this.verifySession();case 33:if(this.handleImageCount(),p=setInterval((function(){return __awaiter(v,void 0,void 0,_regeneratorRuntime().mark((function e(){var t,r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.imageCount>0)){e.next=15;break}if(t=this.getImageBase64Url(h,u,c,l,d,n),this.showGenuine&&1===this.imageCount&&(this.previewImage=t),!this.isNewUI){e.next=8;break}return e.next=6,this.uploadImage(t);case 6:e.next=9;break;case 8:this.uploadImage(t);case 9:if(this.handleImageCount(),!this.isNewUI||this.isAutoCapture){e.next=13;break}return e.next=13,updateLoadingBar(this.totalImageCount-this.imageCount,this.totalImageCount,OVERLAY_LOADER_BAR_CLASS);case 13:e.next=31;break;case 15:if(clearInterval(p),d.width=u.videoWidth,d.height=u.videoHeight,r=this.getImageBase64Url(h,u,0,0,d,n),!this.isNewUI){e.next=24;break}return e.next=22,setNewPreview(this.imageCount,this.scannerElem,r,this.previewElem,this.videoElem,OVERLAY_LOADER_CONTAINER_CLASS,OVERLAY_ACTION_BUTTON_CLASS,OVERLAY_CLASS,this.isResultDisplayed,this.verificationAnimation);case 22:e.next=25;break;case 24:setPreview(this.imageCount,this.scannerElem,this.overlayImgElem,r,this.previewElem,this.videoElem);case 25:if(this.isAutoCapture&&hideElement(this.roiActionText),void 0===this.stream){e.next=29;break}return e.next=29,stopCamera(this.stream);case 29:logEvents(this.analyticsTools,"sendNetworkDelayEvent",captureOrCalculateTimestamp(this.captureButtonClickTimestamp,!0)),timeoutInstance.clearPartialImagesTimeout();case 31:case"end":return e.stop()}}),e,this)})))}),250),!this.showGenuine){r.next=40;break}return r.next=38,new Promise((function(e){return setTimeout(e,2e3)}));case 38:r.next=46;break;case 40:if(void 0!==this.verifySessionStatus){r.next=46;break}return r.next=43,new Promise((function(e){return setTimeout(e,100)}));case 43:this.previewImage||(this.previewImage=this.getImageBase64Url(h,u,0,0,d,n)),r.next=40;break;case 46:this.isNewUI&&null!=(m=document.querySelector(".".concat(OVERLAY_ACTION_BUTTON_CLASS)))&&m instanceof HTMLElement&&m.remove(),logEvents(this.analyticsTools,"sendTimeToProcessResultsDelayEvent",captureOrCalculateTimestamp(this.captureButtonClickTimestamp,!0)),logEvents(this.analyticsTools,"sendResultDisplayedDelayEvent",captureOrCalculateTimestamp(this.displayOverlayTimestamp,!0)),logEvents(this.analyticsTools,"sendResultDisplayedEvent",this.verifySessionStatus),void 0!==e&&void 0!==this.verifySessionStatus&&e({data:{status:this.verifySessionStatus,sessionId:this.sessionId}});case 51:case"end":return r.stop()}}),r,this)})))}},{key:"updateUIAborted",value:function(){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function e(){var t;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(t=document.querySelector("#".concat(CAPTURE_BUTTON_ID)))&&(t.style.display="none"),e.t0=this.shouldShowResult,!e.t0){e.next=6;break}return e.next=6,this.displayResults(this.scannerElem.className);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"handleQRflow",value:function(e){var t,r,n;return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function i(){var o,s;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,updateQRScan(this.qrServiceBaseUrl,this.accessToken,this.showGenuine?"":this.sessionId,null!==(t=this.shortId)&&void 0!==t?t:"",{context:{location:this.userCurrentLocation}},!e,e,null===(r=this.analyticsTools)||void 0===r?void 0:r.logger);case 3:if(o=i.sent,null===(s=null===(n=null==o?void 0:o.data)||void 0===n?void 0:n.serial)||!e){i.next=7;break}return i.abrupt("return",s);case 7:i.next=12;break;case 9:i.prev=9,i.t0=i.catch(0),console.error("An error occurred while updating serial QR scan",i.t0);case 12:return i.abrupt("return",void 0);case 13:case"end":return i.stop()}}),i,this,[[0,9]])})))}},{key:"displayResults",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function r(){var n,i,o;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.stopCameraIfStreaming();case 2:if(n="",null==this.shortId||""===this.shortId){r.next=13;break}return r.prev=4,r.next=7,this.handleQRflow(!!this.showGenuine||"genuine"===(null==t?void 0:t.toLowerCase()));case 7:n=r.sent,r.next=13;break;case 10:r.prev=10,r.t0=r.catch(4),console.error("Error fetching serial code:",r.t0);case 13:this.isResultDisplayed=!0,null!==(i=document.querySelector(".detect_roi-action-text-box"))&&hideElement(i),this.isAutoCapture||hideElement(this.captureBtn),removeOverlay(OVERLAY_CLASS),removeVerifyAnimation(),o=this.showGenuine?"GENUINE":t,createResultDiv(e,o,OVERLAY_RESULT_BE_BUTTON_CLASS,OVERLAY_RESULT_SUPPORT_BUTTON_CLASS,OVERLAY_RESULT_SCAN_AGAIN_BUTTON_CLASS,OVERLAY_RESULT_CONTAINER_CLASS,this.brandResultConfig,this.customResultDivColour,n),this.setupButtonEventListeners();case 22:case"end":return r.stop()}}),r,this,[[4,10]])})))}},{key:"destroy",value:function(){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.qrScanner.stop(),this.qrScanner.destroy(),e.t0=void 0!==this.stream,!e.t0){e.next=6;break}return e.next=6,stopCamera(this.stream);case 6:this.rootElem.remove();case 7:case"end":return e.stop()}}),e,this)})))}},{key:"predictWebcam",value:function(){var e,t,r,n,i;return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function o(){var s,a,c,l,u,d,h,f;return _regeneratorRuntime().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:s=performance.now();try{this.videoElem.currentTime!==this.lastVideoTime&&this.startModelDetection&&void 0!==this.objectDetector&&(this.lastVideoTime=this.videoElem.currentTime,a=this.objectDetector.detectForVideo(this.videoElem,s),c=this.videoElem.offsetWidth/this.videoElem.videoWidth,l=this.videoElem.offsetHeight/this.videoElem.videoHeight,void 0!==(null===(e=null==a?void 0:a.detections[0])||void 0===e?void 0:e.boundingBox)?(u=(null===(t=a.detections[0])||void 0===t?void 0:t.boundingBox.originX)*c,d=(null===(r=a.detections[0])||void 0===r?void 0:r.boundingBox.originY)*l,h=u+(null===(n=a.detections[0])||void 0===n?void 0:n.boundingBox.width)*c,f=d+(null===(i=a.detections[0])||void 0===i?void 0:i.boundingBox.height)*l,this.renderPredictionBoxes(d,u,f,h)):void 0!==this.roiActionText&&(void 0!==this.setCurrentPrompt&&this.setCurrentPrompt!==defaultRoiActionText.moveAway||(this.setCurrentPrompt=defaultRoiActionText.positionOverlay),this.roiActionText.innerHTML="<p>".concat(this.setCurrentPrompt,"</p>"),this.cleanPredictionBox()))}catch(e){console.error("error in predictWebcam",e)}case 2:case"end":return o.stop()}}),o,this)})))}},{key:"renderPredictionBoxes",value:function(e,t,r,n){if(this.cleanPredictionBox(),!checkPolygonIsInside(this.coordinates.x1,this.coordinates.y1,this.coordinates.x2,this.coordinates.y2,t,e,n,r,35)){var i=(n-t).toFixed(0),o=(r-e).toFixed(0),s=createDivElem();s.className="highlighter",s.style.left=t+"px",s.style.top=e+"px",s.style.width=i+"px",s.style.height=o+"px",s.style.position="absolute",s.style.border="2px solid rgba(225, 225, 225, 1)",s.style.transform="rotate(90deg)",s.style.background="rgb(204, 204, 255, 0.2)",s.style.zIndex="1",this.scannerElem.appendChild(s),this.children.push(s)}var a=checkPolygonOverlap(this.coordinates.x1,this.coordinates.y1,this.coordinates.x2,this.coordinates.y2,t,e,n,r,this.roiActionText,this.analyticsTools,this.setCurrentPrompt,this.modelType);this.stableFrameRateBuffer.push(a.isValid),this.setCurrentPrompt=a.currentPrompt,this.stableFrameRateBuffer.length>this.isStableFrameCount&&this.stableFrameRateBuffer.shift(),this.stableFrameRateBuffer.every((function(e){return!0===e}))&&this.throttleTakeSnapshot()}},{key:"densoQrDetection",value:function(){return __awaiter(this,void 0,void 0,_regeneratorRuntime().mark((function e(){var t,r,n,i=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.maxWidthIOS&&void 0!==this.maxWidthAndroid&&void 0!==this.minWidthIOS&&void 0!==this.minWidthAndroid&&void 0!==this.qrUrl){e.next=3;break}return console.error("fields like maxWidthIOS, maxWidthAndroid, minWidthIOS, minWidthAndroid and qrUrl must be configured in fetch experience api to use QR auto capture functionality"),e.abrupt("return");case 3:if(t=checkIfIOS()?this.maxWidthIOS*this.zoomValue:this.maxWidthAndroid*this.zoomValue,r=checkIfIOS()?this.minWidthIOS*this.zoomValue:this.minWidthAndroid*this.zoomValue,!checkIfDenso()){e.next=9;break}return n=function(){setDensoRoiActionText(t,r,i.currentPrompt,i.stableFrameRateBuffer,i.isStableFrameCount,i.videoElem,i.labelNotFullyVisibleIcon,0,0,0,0,0,10,null,i.takeSnapshotTriggered)},e.next=9,this.initiateQRScanV1((function(e){return __awaiter(i,void 0,void 0,_regeneratorRuntime().mark((function n(){var i,o,s,a,c;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=e.data.data===this.qrUrl||""===e.data.data,o=document.querySelector("#wrong-qr-code"),i){n.next=7;break}s=document.querySelector(".".concat(QR_SCANNER_DETECTION_BOX_CLASS)),null===o?((o=createImageElem()).id="wrong-qr-code",o.src=this.wrongQrCodeIcon,null!==s&&s.appendChild(o)):"block"!==o.style.display&&(showElement(o,"block"),handleGuidePrompts(defaultRoiActionText.wrongQr,!1,this.wrongQrCodeLabelIcon),setTimeout((function(){null!==o&&hideElement(o)}),3e3)),n.next=15;break;case 7:if(null!==o&&hideElement(o),!(checkIfIOS()||void 0!==this.modelType&&!0===this.customAutoFocus[this.modelType])){n.next=11;break}return n.next=11,calculateAndSetPointOfInterest(e.data,this.videoElem,this.stream);case 11:a=calculateDimensions(e.data),c=a.width,setDensoRoiActionText(t,r,this.currentPrompt,this.stableFrameRateBuffer,this.isStableFrameCount,this.videoElem,this.labelNotFullyVisibleIcon,e.data.cornerPoints[1].x,e.data.cornerPoints[0].x,e.data.cornerPoints[1].y,e.data.cornerPoints[2].y,c*this.qrWidthFactor,10,null,this.takeSnapshotTriggered),this.stableFrameRateBuffer.every((function(e){return!0===e}))&&this.stableFrameRateBuffer.length===this.isStableFrameCount&&(this.stableFrameRateBuffer=[],this.throttleTakeSnapshot());case 15:case"end":return n.stop()}}),n,this)})))}),n,getDeviceId()).catch((function(e){console.error("issue in densoQrDetection",e)}));case 9:case"end":return e.stop()}}),e,this)})))}}]),e}(),createWorker$1=function(){return new Worker(URL.createObjectURL(new Blob(['class x{constructor(a,b){this.width=b;this.height=a.length/b;this.data=a}static createEmpty(a,b){return new x(new Uint8ClampedArray(a*b),a)}get(a,b){return 0>a||a>=this.width||0>b||b>=this.height?!1:!!this.data[b*this.width+a]}set(a,b,c){this.data[b*this.width+a]=c?1:0}setRegion(a,b,c,d,e){for(let f=b;f<b+d;f++)for(let g=a;g<a+c;g++)this.set(g,f,!!e)}}\nclass A{constructor(a,b,c){this.width=a;a*=b;if(c&&c.length!==a)throw Error("Wrong buffer size");this.data=c||new Uint8ClampedArray(a)}get(a,b){return this.data[b*this.width+a]}set(a,b,c){this.data[b*this.width+a]=c}}\nclass ba{constructor(a){this.bitOffset=this.byteOffset=0;this.bytes=a}readBits(a){if(1>a||32<a||a>this.available())throw Error("Cannot read "+a.toString()+" bits");var b=0;if(0<this.bitOffset){b=8-this.bitOffset;var c=a<b?a:b;b-=c;b=(this.bytes[this.byteOffset]&255>>8-c<<b)>>b;a-=c;this.bitOffset+=c;8===this.bitOffset&&(this.bitOffset=0,this.byteOffset++)}if(0<a){for(;8<=a;)b=b<<8|this.bytes[this.byteOffset]&255,this.byteOffset++,a-=8;0<a&&(c=8-a,b=b<<a|(this.bytes[this.byteOffset]&255>>c<<c)>>c,\nthis.bitOffset+=a)}return b}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var B,C=B||(B={});C.Numeric="numeric";C.Alphanumeric="alphanumeric";C.Byte="byte";C.Kanji="kanji";C.ECI="eci";C.StructuredAppend="structuredappend";var D,E=D||(D={});E[E.Terminator=0]="Terminator";E[E.Numeric=1]="Numeric";E[E.Alphanumeric=2]="Alphanumeric";E[E.Byte=4]="Byte";E[E.Kanji=8]="Kanji";E[E.ECI=7]="ECI";E[E.StructuredAppend=3]="StructuredAppend";let F="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:".split("");\nfunction ca(a,b){let c=[],d="";b=a.readBits([8,16,16][b]);for(let e=0;e<b;e++){let f=a.readBits(8);c.push(f)}try{d+=decodeURIComponent(c.map(e=>`%${("0"+e.toString(16)).substr(-2)}`).join(""))}catch(e){}return{bytes:c,text:d}}\nfunction da(a,b){a=new ba(a);let c=9>=b?0:26>=b?1:2;for(b={text:"",bytes:[],chunks:[],version:b};4<=a.available();){var d=a.readBits(4);if(d===D.Terminator)return b;if(d===D.ECI)0===a.readBits(1)?b.chunks.push({type:B.ECI,assignmentNumber:a.readBits(7)}):0===a.readBits(1)?b.chunks.push({type:B.ECI,assignmentNumber:a.readBits(14)}):0===a.readBits(1)?b.chunks.push({type:B.ECI,assignmentNumber:a.readBits(21)}):b.chunks.push({type:B.ECI,assignmentNumber:-1});else if(d===D.Numeric){var e=a,f=[];d="";for(var g=\ne.readBits([10,12,14][c]);3<=g;){var h=e.readBits(10);if(1E3<=h)throw Error("Invalid numeric value above 999");var k=Math.floor(h/100),m=Math.floor(h/10)%10;h%=10;f.push(48+k,48+m,48+h);d+=k.toString()+m.toString()+h.toString();g-=3}if(2===g){g=e.readBits(7);if(100<=g)throw Error("Invalid numeric value above 99");e=Math.floor(g/10);g%=10;f.push(48+e,48+g);d+=e.toString()+g.toString()}else if(1===g){e=e.readBits(4);if(10<=e)throw Error("Invalid numeric value above 9");f.push(48+e);d+=e.toString()}b.text+=\nd;b.bytes.push(...f);b.chunks.push({type:B.Numeric,text:d})}else if(d===D.Alphanumeric){e=a;f=[];d="";for(g=e.readBits([9,11,13][c]);2<=g;)m=e.readBits(11),k=Math.floor(m/45),m%=45,f.push(F[k].charCodeAt(0),F[m].charCodeAt(0)),d+=F[k]+F[m],g-=2;1===g&&(e=e.readBits(6),f.push(F[e].charCodeAt(0)),d+=F[e]);b.text+=d;b.bytes.push(...f);b.chunks.push({type:B.Alphanumeric,text:d})}else if(d===D.Byte)d=ca(a,c),b.text+=d.text,b.bytes.push(...d.bytes),b.chunks.push({type:B.Byte,bytes:d.bytes,text:d.text});\nelse if(d===D.Kanji){f=a;d=[];e=f.readBits([8,10,12][c]);for(g=0;g<e;g++)k=f.readBits(13),k=Math.floor(k/192)<<8|k%192,k=7936>k?k+33088:k+49472,d.push(k>>8,k&255);f=(new TextDecoder("shift-jis")).decode(Uint8Array.from(d));b.text+=f;b.bytes.push(...d);b.chunks.push({type:B.Kanji,bytes:d,text:f})}else d===D.StructuredAppend&&b.chunks.push({type:B.StructuredAppend,currentSequence:a.readBits(4),totalSequence:a.readBits(4),parity:a.readBits(8)})}if(0===a.available()||0===a.readBits(a.available()))return b}\nclass G{constructor(a,b){if(0===b.length)throw Error("No coefficients.");this.field=a;let c=b.length;if(1<c&&0===b[0]){let d=1;for(;d<c&&0===b[d];)d++;if(d===c)this.coefficients=a.zero.coefficients;else for(this.coefficients=new Uint8ClampedArray(c-d),a=0;a<this.coefficients.length;a++)this.coefficients[a]=b[d+a]}else this.coefficients=b}degree(){return this.coefficients.length-1}isZero(){return 0===this.coefficients[0]}getCoefficient(a){return this.coefficients[this.coefficients.length-1-a]}addOrSubtract(a){if(this.isZero())return a;\nif(a.isZero())return this;let b=this.coefficients;a=a.coefficients;b.length>a.length&&([b,a]=[a,b]);let c=new Uint8ClampedArray(a.length),d=a.length-b.length;for(var e=0;e<d;e++)c[e]=a[e];for(e=d;e<a.length;e++)c[e]=b[e-d]^a[e];return new G(this.field,c)}multiply(a){if(0===a)return this.field.zero;if(1===a)return this;let b=this.coefficients.length,c=new Uint8ClampedArray(b);for(let d=0;d<b;d++)c[d]=this.field.multiply(this.coefficients[d],a);return new G(this.field,c)}multiplyPoly(a){if(this.isZero()||\na.isZero())return this.field.zero;let b=this.coefficients,c=b.length;a=a.coefficients;let d=a.length,e=new Uint8ClampedArray(c+d-1);for(let f=0;f<c;f++){let g=b[f];for(let h=0;h<d;h++)e[f+h]=H(e[f+h],this.field.multiply(g,a[h]))}return new G(this.field,e)}multiplyByMonomial(a,b){if(0>a)throw Error("Invalid degree less than 0");if(0===b)return this.field.zero;let c=this.coefficients.length;a=new Uint8ClampedArray(c+a);for(let d=0;d<c;d++)a[d]=this.field.multiply(this.coefficients[d],b);return new G(this.field,\na)}evaluateAt(a){let b=0;if(0===a)return this.getCoefficient(0);let c=this.coefficients.length;if(1===a)return this.coefficients.forEach(d=>{b^=d}),b;b=this.coefficients[0];for(let d=1;d<c;d++)b=H(this.field.multiply(a,b),this.coefficients[d]);return b}}function H(a,b){return a^b}\nclass ea{constructor(a,b,c){this.primitive=a;this.size=b;this.generatorBase=c;this.expTable=Array(this.size);this.logTable=Array(this.size);a=1;for(b=0;b<this.size;b++)this.expTable[b]=a,a*=2,a>=this.size&&(a=(a^this.primitive)&this.size-1);for(a=0;a<this.size-1;a++)this.logTable[this.expTable[a]]=a;this.zero=new G(this,Uint8ClampedArray.from([0]));this.one=new G(this,Uint8ClampedArray.from([1]))}multiply(a,b){return 0===a||0===b?0:this.expTable[(this.logTable[a]+this.logTable[b])%(this.size-1)]}inverse(a){if(0===\na)throw Error("Can\'t invert 0");return this.expTable[this.size-this.logTable[a]-1]}buildMonomial(a,b){if(0>a)throw Error("Invalid monomial degree less than 0");if(0===b)return this.zero;a=new Uint8ClampedArray(a+1);a[0]=b;return new G(this,a)}log(a){if(0===a)throw Error("Can\'t take log(0)");return this.logTable[a]}exp(a){return this.expTable[a]}}\nfunction fa(a,b,c,d){b.degree()<c.degree()&&([b,c]=[c,b]);let e=a.zero;for(var f=a.one;c.degree()>=d/2;){var g=b;let h=e;b=c;e=f;if(b.isZero())return null;c=g;f=a.zero;g=b.getCoefficient(b.degree());for(g=a.inverse(g);c.degree()>=b.degree()&&!c.isZero();){let k=c.degree()-b.degree(),m=a.multiply(c.getCoefficient(c.degree()),g);f=f.addOrSubtract(a.buildMonomial(k,m));c=c.addOrSubtract(b.multiplyByMonomial(k,m))}f=f.multiplyPoly(e).addOrSubtract(h);if(c.degree()>=b.degree())return null}d=f.getCoefficient(0);\nif(0===d)return null;a=a.inverse(d);return[f.multiply(a),c.multiply(a)]}\nfunction ha(a,b){let c=new Uint8ClampedArray(a.length);c.set(a);a=new ea(285,256,0);var d=new G(a,c),e=new Uint8ClampedArray(b),f=!1;for(var g=0;g<b;g++){var h=d.evaluateAt(a.exp(g+a.generatorBase));e[e.length-1-g]=h;0!==h&&(f=!0)}if(!f)return c;d=new G(a,e);d=fa(a,a.buildMonomial(b,1),d,b);if(null===d)return null;b=d[0];g=b.degree();if(1===g)b=[b.getCoefficient(1)];else{e=Array(g);f=0;for(h=1;h<a.size&&f<g;h++)0===b.evaluateAt(h)&&(e[f]=a.inverse(h),f++);b=f!==g?null:e}if(null==b)return null;e=d[1];\nf=b.length;d=Array(f);for(g=0;g<f;g++){h=a.inverse(b[g]);let k=1;for(let m=0;m<f;m++)g!==m&&(k=a.multiply(k,H(1,a.multiply(b[m],h))));d[g]=a.multiply(e.evaluateAt(h),a.inverse(k));0!==a.generatorBase&&(d[g]=a.multiply(d[g],h))}for(e=0;e<b.length;e++){f=c.length-1-a.log(b[e]);if(0>f)return null;c[f]^=d[e]}return c}\nlet I=[{infoBits:null,versionNumber:1,alignmentPatternCenters:[],errorCorrectionLevels:[{ecCodewordsPerBlock:7,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:10,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:16}]},{ecCodewordsPerBlock:13,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:13}]},{ecCodewordsPerBlock:17,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:9}]}]},{infoBits:null,versionNumber:2,alignmentPatternCenters:[6,18],errorCorrectionLevels:[{ecCodewordsPerBlock:10,ecBlocks:[{numBlocks:1,\ndataCodewordsPerBlock:34}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:28}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:22}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:16}]}]},{infoBits:null,versionNumber:3,alignmentPatternCenters:[6,22],errorCorrectionLevels:[{ecCodewordsPerBlock:15,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:55}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:18,\necBlocks:[{numBlocks:2,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:13}]}]},{infoBits:null,versionNumber:4,alignmentPatternCenters:[6,26],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:80}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:32}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:9}]}]},\n{infoBits:null,versionNumber:5,alignmentPatternCenters:[6,30],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:43}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:15},{numBlocks:2,dataCodewordsPerBlock:16}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:11},{numBlocks:2,dataCodewordsPerBlock:12}]}]},{infoBits:null,versionNumber:6,alignmentPatternCenters:[6,\n34],errorCorrectionLevels:[{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:68}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:27}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:15}]}]},{infoBits:31892,versionNumber:7,alignmentPatternCenters:[6,22,38],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:78}]},{ecCodewordsPerBlock:18,\necBlocks:[{numBlocks:4,dataCodewordsPerBlock:31}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:4,dataCodewordsPerBlock:15}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:13},{numBlocks:1,dataCodewordsPerBlock:14}]}]},{infoBits:34236,versionNumber:8,alignmentPatternCenters:[6,24,42],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:97}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:38},\n{numBlocks:2,dataCodewordsPerBlock:39}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:18},{numBlocks:2,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:14},{numBlocks:2,dataCodewordsPerBlock:15}]}]},{infoBits:39577,versionNumber:9,alignmentPatternCenters:[6,26,46],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:36},\n{numBlocks:2,dataCodewordsPerBlock:37}]},{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:16},{numBlocks:4,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:12},{numBlocks:4,dataCodewordsPerBlock:13}]}]},{infoBits:42195,versionNumber:10,alignmentPatternCenters:[6,28,50],errorCorrectionLevels:[{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:68},{numBlocks:2,dataCodewordsPerBlock:69}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,\ndataCodewordsPerBlock:43},{numBlocks:1,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:19},{numBlocks:2,dataCodewordsPerBlock:20}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:15},{numBlocks:2,dataCodewordsPerBlock:16}]}]},{infoBits:48118,versionNumber:11,alignmentPatternCenters:[6,30,54],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:81}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:1,\ndataCodewordsPerBlock:50},{numBlocks:4,dataCodewordsPerBlock:51}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:22},{numBlocks:4,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:12},{numBlocks:8,dataCodewordsPerBlock:13}]}]},{infoBits:51042,versionNumber:12,alignmentPatternCenters:[6,32,58],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:92},{numBlocks:2,dataCodewordsPerBlock:93}]},\n{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:36},{numBlocks:2,dataCodewordsPerBlock:37}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:20},{numBlocks:6,dataCodewordsPerBlock:21}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:14},{numBlocks:4,dataCodewordsPerBlock:15}]}]},{infoBits:55367,versionNumber:13,alignmentPatternCenters:[6,34,62],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:107}]},\n{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:37},{numBlocks:1,dataCodewordsPerBlock:38}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:20},{numBlocks:4,dataCodewordsPerBlock:21}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:11},{numBlocks:4,dataCodewordsPerBlock:12}]}]},{infoBits:58893,versionNumber:14,alignmentPatternCenters:[6,26,46,66],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:115},\n{numBlocks:1,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:40},{numBlocks:5,dataCodewordsPerBlock:41}]},{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:16},{numBlocks:5,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:12},{numBlocks:5,dataCodewordsPerBlock:13}]}]},{infoBits:63784,versionNumber:15,alignmentPatternCenters:[6,26,48,70],errorCorrectionLevels:[{ecCodewordsPerBlock:22,\necBlocks:[{numBlocks:5,dataCodewordsPerBlock:87},{numBlocks:1,dataCodewordsPerBlock:88}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:41},{numBlocks:5,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:24},{numBlocks:7,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:12},{numBlocks:7,dataCodewordsPerBlock:13}]}]},{infoBits:68472,versionNumber:16,alignmentPatternCenters:[6,26,50,\n74],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:98},{numBlocks:1,dataCodewordsPerBlock:99}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:45},{numBlocks:3,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:19},{numBlocks:2,dataCodewordsPerBlock:20}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:15},{numBlocks:13,dataCodewordsPerBlock:16}]}]},{infoBits:70749,\nversionNumber:17,alignmentPatternCenters:[6,30,54,78],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:107},{numBlocks:5,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:46},{numBlocks:1,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:22},{numBlocks:15,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:17,\ndataCodewordsPerBlock:15}]}]},{infoBits:76311,versionNumber:18,alignmentPatternCenters:[6,30,56,82],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:120},{numBlocks:1,dataCodewordsPerBlock:121}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:9,dataCodewordsPerBlock:43},{numBlocks:4,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:22},{numBlocks:1,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,\ndataCodewordsPerBlock:14},{numBlocks:19,dataCodewordsPerBlock:15}]}]},{infoBits:79154,versionNumber:19,alignmentPatternCenters:[6,30,58,86],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:113},{numBlocks:4,dataCodewordsPerBlock:114}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:44},{numBlocks:11,dataCodewordsPerBlock:45}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:21},{numBlocks:4,dataCodewordsPerBlock:22}]},\n{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:9,dataCodewordsPerBlock:13},{numBlocks:16,dataCodewordsPerBlock:14}]}]},{infoBits:84390,versionNumber:20,alignmentPatternCenters:[6,34,62,90],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:107},{numBlocks:5,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:41},{numBlocks:13,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:24},\n{numBlocks:5,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:15},{numBlocks:10,dataCodewordsPerBlock:16}]}]},{infoBits:87683,versionNumber:21,alignmentPatternCenters:[6,28,50,72,94],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:116},{numBlocks:4,dataCodewordsPerBlock:117}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:22},\n{numBlocks:6,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:16},{numBlocks:6,dataCodewordsPerBlock:17}]}]},{infoBits:92361,versionNumber:22,alignmentPatternCenters:[6,26,50,74,98],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:111},{numBlocks:7,dataCodewordsPerBlock:112}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:24},\n{numBlocks:16,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:34,dataCodewordsPerBlock:13}]}]},{infoBits:96236,versionNumber:23,alignmentPatternCenters:[6,30,54,74,102],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:121},{numBlocks:5,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:47},{numBlocks:14,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:24},\n{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:16,dataCodewordsPerBlock:15},{numBlocks:14,dataCodewordsPerBlock:16}]}]},{infoBits:102084,versionNumber:24,alignmentPatternCenters:[6,28,54,80,106],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:117},{numBlocks:4,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:45},{numBlocks:14,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,\necBlocks:[{numBlocks:11,dataCodewordsPerBlock:24},{numBlocks:16,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:30,dataCodewordsPerBlock:16},{numBlocks:2,dataCodewordsPerBlock:17}]}]},{infoBits:102881,versionNumber:25,alignmentPatternCenters:[6,32,58,84,110],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:106},{numBlocks:4,dataCodewordsPerBlock:107}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:47},{numBlocks:13,\ndataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:24},{numBlocks:22,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:15},{numBlocks:13,dataCodewordsPerBlock:16}]}]},{infoBits:110507,versionNumber:26,alignmentPatternCenters:[6,30,58,86,114],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:114},{numBlocks:2,dataCodewordsPerBlock:115}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:19,\ndataCodewordsPerBlock:46},{numBlocks:4,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:28,dataCodewordsPerBlock:22},{numBlocks:6,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:33,dataCodewordsPerBlock:16},{numBlocks:4,dataCodewordsPerBlock:17}]}]},{infoBits:110734,versionNumber:27,alignmentPatternCenters:[6,34,62,90,118],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:122},{numBlocks:4,dataCodewordsPerBlock:123}]},\n{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:45},{numBlocks:3,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:23},{numBlocks:26,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:15},{numBlocks:28,dataCodewordsPerBlock:16}]}]},{infoBits:117786,versionNumber:28,alignmentPatternCenters:[6,26,50,74,98,122],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:117},\n{numBlocks:10,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:45},{numBlocks:23,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:24},{numBlocks:31,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:15},{numBlocks:31,dataCodewordsPerBlock:16}]}]},{infoBits:119615,versionNumber:29,alignmentPatternCenters:[6,30,54,78,102,126],errorCorrectionLevels:[{ecCodewordsPerBlock:30,\necBlocks:[{numBlocks:7,dataCodewordsPerBlock:116},{numBlocks:7,dataCodewordsPerBlock:117}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:21,dataCodewordsPerBlock:45},{numBlocks:7,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:23},{numBlocks:37,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:15},{numBlocks:26,dataCodewordsPerBlock:16}]}]},{infoBits:126325,versionNumber:30,alignmentPatternCenters:[6,\n26,52,78,104,130],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:115},{numBlocks:10,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:47},{numBlocks:10,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:24},{numBlocks:25,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:23,dataCodewordsPerBlock:15},{numBlocks:25,dataCodewordsPerBlock:16}]}]},\n{infoBits:127568,versionNumber:31,alignmentPatternCenters:[6,30,56,82,108,134],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:115},{numBlocks:3,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:46},{numBlocks:29,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:42,dataCodewordsPerBlock:24},{numBlocks:1,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:23,dataCodewordsPerBlock:15},\n{numBlocks:28,dataCodewordsPerBlock:16}]}]},{infoBits:133589,versionNumber:32,alignmentPatternCenters:[6,34,60,86,112,138],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:115}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:46},{numBlocks:23,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:24},{numBlocks:35,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,\ndataCodewordsPerBlock:15},{numBlocks:35,dataCodewordsPerBlock:16}]}]},{infoBits:136944,versionNumber:33,alignmentPatternCenters:[6,30,58,86,114,142],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:115},{numBlocks:1,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:14,dataCodewordsPerBlock:46},{numBlocks:21,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:29,dataCodewordsPerBlock:24},{numBlocks:19,dataCodewordsPerBlock:25}]},\n{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:15},{numBlocks:46,dataCodewordsPerBlock:16}]}]},{infoBits:141498,versionNumber:34,alignmentPatternCenters:[6,34,62,90,118,146],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:115},{numBlocks:6,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:14,dataCodewordsPerBlock:46},{numBlocks:23,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:44,\ndataCodewordsPerBlock:24},{numBlocks:7,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:59,dataCodewordsPerBlock:16},{numBlocks:1,dataCodewordsPerBlock:17}]}]},{infoBits:145311,versionNumber:35,alignmentPatternCenters:[6,30,54,78,102,126,150],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:121},{numBlocks:7,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:47},{numBlocks:26,dataCodewordsPerBlock:48}]},\n{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:39,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:15},{numBlocks:41,dataCodewordsPerBlock:16}]}]},{infoBits:150283,versionNumber:36,alignmentPatternCenters:[6,24,50,76,102,128,154],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:121},{numBlocks:14,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,\ndataCodewordsPerBlock:47},{numBlocks:34,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:46,dataCodewordsPerBlock:24},{numBlocks:10,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:15},{numBlocks:64,dataCodewordsPerBlock:16}]}]},{infoBits:152622,versionNumber:37,alignmentPatternCenters:[6,28,54,80,106,132,158],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:122},{numBlocks:4,dataCodewordsPerBlock:123}]},\n{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:29,dataCodewordsPerBlock:46},{numBlocks:14,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:49,dataCodewordsPerBlock:24},{numBlocks:10,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:24,dataCodewordsPerBlock:15},{numBlocks:46,dataCodewordsPerBlock:16}]}]},{infoBits:158308,versionNumber:38,alignmentPatternCenters:[6,32,58,84,110,136,162],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,\ndataCodewordsPerBlock:122},{numBlocks:18,dataCodewordsPerBlock:123}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:46},{numBlocks:32,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:48,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:42,dataCodewordsPerBlock:15},{numBlocks:32,dataCodewordsPerBlock:16}]}]},{infoBits:161089,versionNumber:39,alignmentPatternCenters:[6,26,54,82,110,138,166],\nerrorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:20,dataCodewordsPerBlock:117},{numBlocks:4,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:40,dataCodewordsPerBlock:47},{numBlocks:7,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:43,dataCodewordsPerBlock:24},{numBlocks:22,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:15},{numBlocks:67,dataCodewordsPerBlock:16}]}]},{infoBits:167017,\nversionNumber:40,alignmentPatternCenters:[6,30,58,86,114,142,170],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:118},{numBlocks:6,dataCodewordsPerBlock:119}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:18,dataCodewordsPerBlock:47},{numBlocks:31,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:34,dataCodewordsPerBlock:24},{numBlocks:34,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:20,dataCodewordsPerBlock:15},\n{numBlocks:61,dataCodewordsPerBlock:16}]}]}];function J(a,b){a^=b;for(b=0;a;)b++,a&=a-1;return b}function K(a,b){return b<<1|a}\nlet ia=[{bits:21522,formatInfo:{errorCorrectionLevel:1,dataMask:0}},{bits:20773,formatInfo:{errorCorrectionLevel:1,dataMask:1}},{bits:24188,formatInfo:{errorCorrectionLevel:1,dataMask:2}},{bits:23371,formatInfo:{errorCorrectionLevel:1,dataMask:3}},{bits:17913,formatInfo:{errorCorrectionLevel:1,dataMask:4}},{bits:16590,formatInfo:{errorCorrectionLevel:1,dataMask:5}},{bits:20375,formatInfo:{errorCorrectionLevel:1,dataMask:6}},{bits:19104,formatInfo:{errorCorrectionLevel:1,dataMask:7}},{bits:30660,formatInfo:{errorCorrectionLevel:0,\ndataMask:0}},{bits:29427,formatInfo:{errorCorrectionLevel:0,dataMask:1}},{bits:32170,formatInfo:{errorCorrectionLevel:0,dataMask:2}},{bits:30877,formatInfo:{errorCorrectionLevel:0,dataMask:3}},{bits:26159,formatInfo:{errorCorrectionLevel:0,dataMask:4}},{bits:25368,formatInfo:{errorCorrectionLevel:0,dataMask:5}},{bits:27713,formatInfo:{errorCorrectionLevel:0,dataMask:6}},{bits:26998,formatInfo:{errorCorrectionLevel:0,dataMask:7}},{bits:5769,formatInfo:{errorCorrectionLevel:3,dataMask:0}},{bits:5054,\nformatInfo:{errorCorrectionLevel:3,dataMask:1}},{bits:7399,formatInfo:{errorCorrectionLevel:3,dataMask:2}},{bits:6608,formatInfo:{errorCorrectionLevel:3,dataMask:3}},{bits:1890,formatInfo:{errorCorrectionLevel:3,dataMask:4}},{bits:597,formatInfo:{errorCorrectionLevel:3,dataMask:5}},{bits:3340,formatInfo:{errorCorrectionLevel:3,dataMask:6}},{bits:2107,formatInfo:{errorCorrectionLevel:3,dataMask:7}},{bits:13663,formatInfo:{errorCorrectionLevel:2,dataMask:0}},{bits:12392,formatInfo:{errorCorrectionLevel:2,\ndataMask:1}},{bits:16177,formatInfo:{errorCorrectionLevel:2,dataMask:2}},{bits:14854,formatInfo:{errorCorrectionLevel:2,dataMask:3}},{bits:9396,formatInfo:{errorCorrectionLevel:2,dataMask:4}},{bits:8579,formatInfo:{errorCorrectionLevel:2,dataMask:5}},{bits:11994,formatInfo:{errorCorrectionLevel:2,dataMask:6}},{bits:11245,formatInfo:{errorCorrectionLevel:2,dataMask:7}}],ja=[a=>0===(a.y+a.x)%2,a=>0===a.y%2,a=>0===a.x%3,a=>0===(a.y+a.x)%3,a=>0===(Math.floor(a.y/2)+Math.floor(a.x/3))%2,a=>0===a.x*a.y%\n2+a.x*a.y%3,a=>0===(a.y*a.x%2+a.y*a.x%3)%2,a=>0===((a.y+a.x)%2+a.y*a.x%3)%2];\nfunction ka(a,b,c){c=ja[c.dataMask];let d=a.height;var e=17+4*b.versionNumber;let f=x.createEmpty(e,e);f.setRegion(0,0,9,9,!0);f.setRegion(e-8,0,8,9,!0);f.setRegion(0,e-8,9,8,!0);for(var g of b.alignmentPatternCenters)for(var h of b.alignmentPatternCenters)6===g&&6===h||6===g&&h===e-7||g===e-7&&6===h||f.setRegion(g-2,h-2,5,5,!0);f.setRegion(6,9,1,e-17,!0);f.setRegion(9,6,e-17,1,!0);6<b.versionNumber&&(f.setRegion(e-11,0,3,6,!0),f.setRegion(0,e-11,6,3,!0));b=[];h=g=0;e=!0;for(let k=d-1;0<k;k-=2){6===\nk&&k--;for(let m=0;m<d;m++){let l=e?d-1-m:m;for(let n=0;2>n;n++){let q=k-n;if(!f.get(q,l)){h++;let r=a.get(q,l);c({y:l,x:q})&&(r=!r);g=g<<1|r;8===h&&(b.push(g),g=h=0)}}}e=!e}return b}\nfunction la(a){var b=a.height,c=Math.floor((b-17)/4);if(6>=c)return I[c-1];c=0;for(var d=5;0<=d;d--)for(var e=b-9;e>=b-11;e--)c=K(a.get(e,d),c);d=0;for(e=5;0<=e;e--)for(let g=b-9;g>=b-11;g--)d=K(a.get(e,g),d);a=Infinity;let f;for(let g of I){if(g.infoBits===c||g.infoBits===d)return g;b=J(c,g.infoBits);b<a&&(f=g,a=b);b=J(d,g.infoBits);b<a&&(f=g,a=b)}if(3>=a)return f}\nfunction ma(a){let b=0;for(var c=0;8>=c;c++)6!==c&&(b=K(a.get(c,8),b));for(c=7;0<=c;c--)6!==c&&(b=K(a.get(8,c),b));var d=a.height;c=0;for(var e=d-1;e>=d-7;e--)c=K(a.get(8,e),c);for(e=d-8;e<d;e++)c=K(a.get(e,8),c);a=Infinity;d=null;for(let {bits:f,formatInfo:g}of ia){if(f===b||f===c)return g;e=J(b,f);e<a&&(d=g,a=e);b!==c&&(e=J(c,f),e<a&&(d=g,a=e))}return 3>=a?d:null}\nfunction na(a,b,c){let d=b.errorCorrectionLevels[c],e=[],f=0;d.ecBlocks.forEach(h=>{for(let k=0;k<h.numBlocks;k++)e.push({numDataCodewords:h.dataCodewordsPerBlock,codewords:[]}),f+=h.dataCodewordsPerBlock+d.ecCodewordsPerBlock});if(a.length<f)return null;a=a.slice(0,f);b=d.ecBlocks[0].dataCodewordsPerBlock;for(c=0;c<b;c++)for(var g of e)g.codewords.push(a.shift());if(1<d.ecBlocks.length)for(g=d.ecBlocks[0].numBlocks,b=d.ecBlocks[1].numBlocks,c=0;c<b;c++)e[g+c].codewords.push(a.shift());for(;0<a.length;)for(let h of e)h.codewords.push(a.shift());\nreturn e}function L(a){let b=la(a);if(!b)return null;var c=ma(a);if(!c)return null;a=ka(a,b,c);var d=na(a,b,c.errorCorrectionLevel);if(!d)return null;c=d.reduce((e,f)=>e+f.numDataCodewords,0);c=new Uint8ClampedArray(c);a=0;for(let e of d){d=ha(e.codewords,e.codewords.length-e.numDataCodewords);if(!d)return null;for(let f=0;f<e.numDataCodewords;f++)c[a++]=d[f]}try{return da(c,b.versionNumber)}catch(e){return null}}\nfunction M(a,b,c,d){var e=a.x-b.x+c.x-d.x;let f=a.y-b.y+c.y-d.y;if(0===e&&0===f)return{a11:b.x-a.x,a12:b.y-a.y,a13:0,a21:c.x-b.x,a22:c.y-b.y,a23:0,a31:a.x,a32:a.y,a33:1};let g=b.x-c.x;var h=d.x-c.x;let k=b.y-c.y,m=d.y-c.y;c=g*m-h*k;h=(e*m-h*f)/c;e=(g*f-e*k)/c;return{a11:b.x-a.x+h*b.x,a12:b.y-a.y+h*b.y,a13:h,a21:d.x-a.x+e*d.x,a22:d.y-a.y+e*d.y,a23:e,a31:a.x,a32:a.y,a33:1}}\nfunction oa(a,b,c,d){a=M(a,b,c,d);return{a11:a.a22*a.a33-a.a23*a.a32,a12:a.a13*a.a32-a.a12*a.a33,a13:a.a12*a.a23-a.a13*a.a22,a21:a.a23*a.a31-a.a21*a.a33,a22:a.a11*a.a33-a.a13*a.a31,a23:a.a13*a.a21-a.a11*a.a23,a31:a.a21*a.a32-a.a22*a.a31,a32:a.a12*a.a31-a.a11*a.a32,a33:a.a11*a.a22-a.a12*a.a21}}\nfunction pa(a,b){var c=oa({x:3.5,y:3.5},{x:b.dimension-3.5,y:3.5},{x:b.dimension-6.5,y:b.dimension-6.5},{x:3.5,y:b.dimension-3.5}),d=M(b.topLeft,b.topRight,b.alignmentPattern,b.bottomLeft),e=d.a11*c.a11+d.a21*c.a12+d.a31*c.a13,f=d.a12*c.a11+d.a22*c.a12+d.a32*c.a13,g=d.a13*c.a11+d.a23*c.a12+d.a33*c.a13,h=d.a11*c.a21+d.a21*c.a22+d.a31*c.a23,k=d.a12*c.a21+d.a22*c.a22+d.a32*c.a23,m=d.a13*c.a21+d.a23*c.a22+d.a33*c.a23,l=d.a11*c.a31+d.a21*c.a32+d.a31*c.a33,n=d.a12*c.a31+d.a22*c.a32+d.a32*c.a33,q=d.a13*\nc.a31+d.a23*c.a32+d.a33*c.a33;c=x.createEmpty(b.dimension,b.dimension);d=(r,u)=>{const p=g*r+m*u+q;return{x:(e*r+h*u+l)/p,y:(f*r+k*u+n)/p}};for(let r=0;r<b.dimension;r++)for(let u=0;u<b.dimension;u++){let p=d(u+.5,r+.5);c.set(u,r,a.get(Math.floor(p.x),Math.floor(p.y)))}return{matrix:c,mappingFunction:d}}let N=(a,b)=>Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2));function O(a){return a.reduce((b,c)=>b+c)}\nfunction qa(a,b,c){let d=N(a,b),e=N(b,c),f=N(a,c),g,h,k;e>=d&&e>=f?[g,h,k]=[b,a,c]:f>=e&&f>=d?[g,h,k]=[a,b,c]:[g,h,k]=[a,c,b];0>(k.x-h.x)*(g.y-h.y)-(k.y-h.y)*(g.x-h.x)&&([g,k]=[k,g]);return{bottomLeft:g,topLeft:h,topRight:k}}\nfunction ra(a,b,c,d){d=(O(P(a,c,d,5))/7+O(P(a,b,d,5))/7+O(P(c,a,d,5))/7+O(P(b,a,d,5))/7)/4;if(1>d)throw Error("Invalid module size");b=Math.round(N(a,b)/d);a=Math.round(N(a,c)/d);a=Math.floor((b+a)/2)+7;switch(a%4){case 0:a++;break;case 2:a--}return{dimension:a,moduleSize:d}}\nfunction Q(a,b,c,d){let e=[{x:Math.floor(a.x),y:Math.floor(a.y)}];var f=Math.abs(b.y-a.y)>Math.abs(b.x-a.x);if(f){var g=Math.floor(a.y);var h=Math.floor(a.x);a=Math.floor(b.y);b=Math.floor(b.x)}else g=Math.floor(a.x),h=Math.floor(a.y),a=Math.floor(b.x),b=Math.floor(b.y);let k=Math.abs(a-g),m=Math.abs(b-h),l=Math.floor(-k/2),n=g<a?1:-1,q=h<b?1:-1,r=!0;for(let u=g,p=h;u!==a+n;u+=n){g=f?p:u;h=f?u:p;if(c.get(g,h)!==r&&(r=!r,e.push({x:g,y:h}),e.length===d+1))break;l+=m;if(0<l){if(p===b)break;p+=q;l-=k}}c=\n[];for(f=0;f<d;f++)e[f]&&e[f+1]?c.push(N(e[f],e[f+1])):c.push(0);return c}function P(a,b,c,d){let e=b.y-a.y,f=b.x-a.x;b=Q(a,b,c,Math.ceil(d/2));a=Q(a,{x:a.x-f,y:a.y-e},c,Math.ceil(d/2));c=b.shift()+a.shift()-1;return a.concat(c).concat(...b)}function R(a,b){let c=O(a)/O(b),d=0;b.forEach((e,f)=>{d+=Math.pow(a[f]-e*c,2)});return{averageSize:c,error:d}}\nfunction S(a,b,c){try{let d=P(a,{x:-1,y:a.y},c,b.length),e=P(a,{x:a.x,y:-1},c,b.length),f=P(a,{x:Math.max(0,a.x-a.y)-1,y:Math.max(0,a.y-a.x)-1},c,b.length),g=P(a,{x:Math.min(c.width,a.x+a.y)+1,y:Math.min(c.height,a.y+a.x)+1},c,b.length),h=R(d,b),k=R(e,b),m=R(f,b),l=R(g,b),n=(h.averageSize+k.averageSize+m.averageSize+l.averageSize)/4;return Math.sqrt(h.error*h.error+k.error*k.error+m.error*m.error+l.error*l.error)+(Math.pow(h.averageSize-n,2)+Math.pow(k.averageSize-n,2)+Math.pow(m.averageSize-n,2)+\nMath.pow(l.averageSize-n,2))/n}catch(d){return Infinity}}function T(a,b){for(var c=Math.round(b.x);a.get(c,Math.round(b.y));)c--;for(var d=Math.round(b.x);a.get(d,Math.round(b.y));)d++;c=(c+d)/2;for(d=Math.round(b.y);a.get(Math.round(c),d);)d--;for(b=Math.round(b.y);a.get(Math.round(c),b);)b++;return{x:c,y:(d+b)/2}}\nfunction sa(a){var b=[],c=[];let d=[];var e=[];for(let p=0;p<=a.height;p++){var f=0,g=!1;let t=[0,0,0,0,0];for(let v=-1;v<=a.width;v++){var h=a.get(v,p);if(h===g)f++;else{t=[t[1],t[2],t[3],t[4],f];f=1;g=h;var k=O(t)/7;k=Math.abs(t[0]-k)<k&&Math.abs(t[1]-k)<k&&Math.abs(t[2]-3*k)<3*k&&Math.abs(t[3]-k)<k&&Math.abs(t[4]-k)<k&&!h;var m=O(t.slice(-3))/3;h=Math.abs(t[2]-m)<m&&Math.abs(t[3]-m)<m&&Math.abs(t[4]-m)<m&&h;if(k){let z=v-t[3]-t[4],y=z-t[2];k={startX:y,endX:z,y:p};m=c.filter(w=>y>=w.bottom.startX&&\ny<=w.bottom.endX||z>=w.bottom.startX&&y<=w.bottom.endX||y<=w.bottom.startX&&z>=w.bottom.endX&&1.5>t[2]/(w.bottom.endX-w.bottom.startX)&&.5<t[2]/(w.bottom.endX-w.bottom.startX));0<m.length?m[0].bottom=k:c.push({top:k,bottom:k})}if(h){let z=v-t[4],y=z-t[3];h={startX:y,y:p,endX:z};k=e.filter(w=>y>=w.bottom.startX&&y<=w.bottom.endX||z>=w.bottom.startX&&y<=w.bottom.endX||y<=w.bottom.startX&&z>=w.bottom.endX&&1.5>t[2]/(w.bottom.endX-w.bottom.startX)&&.5<t[2]/(w.bottom.endX-w.bottom.startX));0<k.length?\nk[0].bottom=h:e.push({top:h,bottom:h})}}}b.push(...c.filter(v=>v.bottom.y!==p&&2<=v.bottom.y-v.top.y));c=c.filter(v=>v.bottom.y===p);d.push(...e.filter(v=>v.bottom.y!==p));e=e.filter(v=>v.bottom.y===p)}b.push(...c.filter(p=>2<=p.bottom.y-p.top.y));d.push(...e);c=[];for(var l of b)2>l.bottom.y-l.top.y||(b=(l.top.startX+l.top.endX+l.bottom.startX+l.bottom.endX)/4,e=(l.top.y+l.bottom.y+1)/2,a.get(Math.round(b),Math.round(e))&&(f=[l.top.endX-l.top.startX,l.bottom.endX-l.bottom.startX,l.bottom.y-l.top.y+\n1],f=O(f)/f.length,g=S({x:Math.round(b),y:Math.round(e)},[1,1,3,1,1],a),c.push({score:g,x:b,y:e,size:f})));if(3>c.length)return null;c.sort((p,t)=>p.score-t.score);l=[];for(b=0;b<Math.min(c.length,5);++b){e=c[b];f=[];for(var n of c)n!==e&&f.push(Object.assign(Object.assign({},n),{score:n.score+Math.pow(n.size-e.size,2)/e.size}));f.sort((p,t)=>p.score-t.score);l.push({points:[e,f[0],f[1]],score:e.score+f[0].score+f[1].score})}l.sort((p,t)=>p.score-t.score);let {topRight:q,topLeft:r,bottomLeft:u}=qa(...l[0].points);\nl=U(a,d,q,r,u);n=[];l&&n.push({alignmentPattern:{x:l.alignmentPattern.x,y:l.alignmentPattern.y},bottomLeft:{x:u.x,y:u.y},dimension:l.dimension,topLeft:{x:r.x,y:r.y},topRight:{x:q.x,y:q.y}});l=T(a,q);b=T(a,r);c=T(a,u);(a=U(a,d,l,b,c))&&n.push({alignmentPattern:{x:a.alignmentPattern.x,y:a.alignmentPattern.y},bottomLeft:{x:c.x,y:c.y},topLeft:{x:b.x,y:b.y},topRight:{x:l.x,y:l.y},dimension:a.dimension});return 0===n.length?null:n}\nfunction U(a,b,c,d,e){let f,g;try{({dimension:f,moduleSize:g}=ra(d,c,e,a))}catch(l){return null}var h=c.x-d.x+e.x,k=c.y-d.y+e.y;c=(N(d,e)+N(d,c))/2/g;e=1-3/c;let m={x:d.x+e*(h-d.x),y:d.y+e*(k-d.y)};b=b.map(l=>{const n=(l.top.startX+l.top.endX+l.bottom.startX+l.bottom.endX)/4;l=(l.top.y+l.bottom.y+1)/2;if(a.get(Math.floor(n),Math.floor(l))){var q=S({x:Math.floor(n),y:Math.floor(l)},[1,1,1],a)+N({x:n,y:l},m);return{x:n,y:l,score:q}}}).filter(l=>!!l).sort((l,n)=>l.score-n.score);return{alignmentPattern:15<=\nc&&b.length?b[0]:m,dimension:f}}\nfunction V(a){var b=sa(a);if(!b)return null;for(let e of b){b=pa(a,e);var c=b.matrix;if(null==c)c=null;else{var d=L(c);if(d)c=d;else{for(d=0;d<c.width;d++)for(let f=d+1;f<c.height;f++)c.get(d,f)!==c.get(f,d)&&(c.set(d,f,!c.get(d,f)),c.set(f,d,!c.get(f,d)));c=L(c)}}if(c)return{binaryData:c.bytes,data:c.text,chunks:c.chunks,version:c.version,location:{topRightCorner:b.mappingFunction(e.dimension,0),topLeftCorner:b.mappingFunction(0,0),bottomRightCorner:b.mappingFunction(e.dimension,e.dimension),bottomLeftCorner:b.mappingFunction(0,\ne.dimension),topRightFinderPattern:e.topRight,topLeftFinderPattern:e.topLeft,bottomLeftFinderPattern:e.bottomLeft,bottomRightAlignmentPattern:e.alignmentPattern},matrix:b.matrix}}return null}let ta={inversionAttempts:"attemptBoth",greyScaleWeights:{red:.2126,green:.7152,blue:.0722,useIntegerApproximation:!1},canOverwriteImage:!0};function W(a,b){Object.keys(b).forEach(c=>{a[c]=b[c]})}\nfunction X(a,b,c,d={}){let e=Object.create(null);W(e,ta);W(e,d);d="onlyInvert"===e.inversionAttempts||"invertFirst"===e.inversionAttempts;var f="attemptBoth"===e.inversionAttempts||d;var g=e.greyScaleWeights,h=e.canOverwriteImage,k=b*c;if(a.length!==4*k)throw Error("Malformed data passed to binarizer.");var m=0;if(h){var l=new Uint8ClampedArray(a.buffer,m,k);m+=k}l=new A(b,c,l);if(g.useIntegerApproximation)for(var n=0;n<c;n++)for(var q=0;q<b;q++){var r=4*(n*b+q);l.set(q,n,g.red*a[r]+g.green*a[r+1]+\ng.blue*a[r+2]+128>>8)}else for(n=0;n<c;n++)for(q=0;q<b;q++)r=4*(n*b+q),l.set(q,n,g.red*a[r]+g.green*a[r+1]+g.blue*a[r+2]);g=Math.ceil(b/8);n=Math.ceil(c/8);q=g*n;if(h){var u=new Uint8ClampedArray(a.buffer,m,q);m+=q}u=new A(g,n,u);for(q=0;q<n;q++)for(r=0;r<g;r++){var p=Infinity,t=0;for(var v=0;8>v;v++)for(let w=0;8>w;w++){let aa=l.get(8*r+w,8*q+v);p=Math.min(p,aa);t=Math.max(t,aa)}v=(p+t)/2;v=Math.min(255,1.11*v);24>=t-p&&(v=p/2,0<q&&0<r&&(t=(u.get(r,q-1)+2*u.get(r-1,q)+u.get(r-1,q-1))/4,p<t&&(v=t)));\nu.set(r,q,v)}h?(q=new Uint8ClampedArray(a.buffer,m,k),m+=k,q=new x(q,b)):q=x.createEmpty(b,c);r=null;f&&(h?(a=new Uint8ClampedArray(a.buffer,m,k),r=new x(a,b)):r=x.createEmpty(b,c));for(b=0;b<n;b++)for(a=0;a<g;a++){c=g-3;c=2>a?2:a>c?c:a;h=n-3;h=2>b?2:b>h?h:b;k=0;for(m=-2;2>=m;m++)for(p=-2;2>=p;p++)k+=u.get(c+m,h+p);c=k/25;for(h=0;8>h;h++)for(k=0;8>k;k++)m=8*a+h,p=8*b+k,t=l.get(m,p),q.set(m,p,t<=c),f&&r.set(m,p,!(t<=c))}f=f?{binarized:q,inverted:r}:{binarized:q};let {binarized:z,inverted:y}=f;(f=V(d?\ny:z))||"attemptBoth"!==e.inversionAttempts&&"invertFirst"!==e.inversionAttempts||(f=V(d?z:y));return f}X.default=X;let Y="dontInvert",Z={red:77,green:150,blue:29,useIntegerApproximation:!0};\nself.onmessage=a=>{let b=a.data.id,c=a.data.data;switch(a.data.type){case "decode":(a=X(c.data,c.width,c.height,{inversionAttempts:Y,greyScaleWeights:Z}))?self.postMessage({id:b,type:"qrResult",data:a.data,cornerPoints:[a.location.topLeftCorner,a.location.topRightCorner,a.location.bottomRightCorner,a.location.bottomLeftCorner]}):self.postMessage({id:b,type:"qrResult",data:null});break;case "grayscaleWeights":Z.red=c.red;Z.green=c.green;Z.blue=c.blue;Z.useIntegerApproximation=c.useIntegerApproximation;\nbreak;case "inversionMode":switch(c){case "original":Y="dontInvert";break;case "invert":Y="onlyInvert";break;case "both":Y="attemptBoth";break;default:throw Error("Invalid inversion mode");}break;case "close":self.close()}}\n']),{type:"application/javascript"}))},qrScannerWorker_min$1=Object.freeze({__proto__:null,createWorker:createWorker$1}),createWorker=function(){return new Worker(URL.createObjectURL(new Blob(['class x{constructor(a,b){this.width=b;this.height=a.length/b;this.data=a}static createEmpty(a,b){return new x(new Uint8ClampedArray(a*b),a)}get(a,b){return 0>a||a>=this.width||0>b||b>=this.height?!1:!!this.data[b*this.width+a]}set(a,b,c){this.data[b*this.width+a]=c?1:0}setRegion(a,b,c,d,e){for(let f=b;f<b+d;f++)for(let g=a;g<a+c;g++)this.set(g,f,!!e)}}\nclass A{constructor(a,b,c){this.width=a;a*=b;if(c&&c.length!==a)throw Error("Wrong buffer size");this.data=c||new Uint8ClampedArray(a)}get(a,b){return this.data[b*this.width+a]}set(a,b,c){this.data[b*this.width+a]=c}}\nclass ba{constructor(a){this.bitOffset=this.byteOffset=0;this.bytes=a}readBits(a){if(1>a||32<a||a>this.available())throw Error("Cannot read "+a.toString()+" bits");var b=0;if(0<this.bitOffset){b=8-this.bitOffset;var c=a<b?a:b;b-=c;b=(this.bytes[this.byteOffset]&255>>8-c<<b)>>b;a-=c;this.bitOffset+=c;8===this.bitOffset&&(this.bitOffset=0,this.byteOffset++)}if(0<a){for(;8<=a;)b=b<<8|this.bytes[this.byteOffset]&255,this.byteOffset++,a-=8;0<a&&(c=8-a,b=b<<a|(this.bytes[this.byteOffset]&255>>c<<c)>>c,\nthis.bitOffset+=a)}return b}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var B,C=B||(B={});C.Numeric="numeric";C.Alphanumeric="alphanumeric";C.Byte="byte";C.Kanji="kanji";C.ECI="eci";C.StructuredAppend="structuredappend";var D,E=D||(D={});E[E.Terminator=0]="Terminator";E[E.Numeric=1]="Numeric";E[E.Alphanumeric=2]="Alphanumeric";E[E.Byte=4]="Byte";E[E.Kanji=8]="Kanji";E[E.ECI=7]="ECI";E[E.StructuredAppend=3]="StructuredAppend";let F="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:".split("");\nfunction ca(a,b){let c=[],d="";b=a.readBits([8,16,16][b]);for(let e=0;e<b;e++){let f=a.readBits(8);c.push(f)}try{d+=decodeURIComponent(c.map(e=>`%${("0"+e.toString(16)).substr(-2)}`).join(""))}catch(e){}return{bytes:c,text:d}}\nfunction da(a,b){a=new ba(a);let c=9>=b?0:26>=b?1:2;for(b={text:"",bytes:[],chunks:[],version:b};4<=a.available();){var d=a.readBits(4);if(d===D.Terminator)return b;if(d===D.ECI)0===a.readBits(1)?b.chunks.push({type:B.ECI,assignmentNumber:a.readBits(7)}):0===a.readBits(1)?b.chunks.push({type:B.ECI,assignmentNumber:a.readBits(14)}):0===a.readBits(1)?b.chunks.push({type:B.ECI,assignmentNumber:a.readBits(21)}):b.chunks.push({type:B.ECI,assignmentNumber:-1});else if(d===D.Numeric){var e=a,f=[];d="";for(var g=\ne.readBits([10,12,14][c]);3<=g;){var h=e.readBits(10);if(1E3<=h)throw Error("Invalid numeric value above 999");var k=Math.floor(h/100),m=Math.floor(h/10)%10;h%=10;f.push(48+k,48+m,48+h);d+=k.toString()+m.toString()+h.toString();g-=3}if(2===g){g=e.readBits(7);if(100<=g)throw Error("Invalid numeric value above 99");e=Math.floor(g/10);g%=10;f.push(48+e,48+g);d+=e.toString()+g.toString()}else if(1===g){e=e.readBits(4);if(10<=e)throw Error("Invalid numeric value above 9");f.push(48+e);d+=e.toString()}b.text+=\nd;b.bytes.push(...f);b.chunks.push({type:B.Numeric,text:d})}else if(d===D.Alphanumeric){e=a;f=[];d="";for(g=e.readBits([9,11,13][c]);2<=g;)m=e.readBits(11),k=Math.floor(m/45),m%=45,f.push(F[k].charCodeAt(0),F[m].charCodeAt(0)),d+=F[k]+F[m],g-=2;1===g&&(e=e.readBits(6),f.push(F[e].charCodeAt(0)),d+=F[e]);b.text+=d;b.bytes.push(...f);b.chunks.push({type:B.Alphanumeric,text:d})}else if(d===D.Byte)d=ca(a,c),b.text+=d.text,b.bytes.push(...d.bytes),b.chunks.push({type:B.Byte,bytes:d.bytes,text:d.text});\nelse if(d===D.Kanji){f=a;d=[];e=f.readBits([8,10,12][c]);for(g=0;g<e;g++)k=f.readBits(13),k=Math.floor(k/192)<<8|k%192,k=7936>k?k+33088:k+49472,d.push(k>>8,k&255);f=(new TextDecoder("shift-jis")).decode(Uint8Array.from(d));b.text+=f;b.bytes.push(...d);b.chunks.push({type:B.Kanji,bytes:d,text:f})}else d===D.StructuredAppend&&b.chunks.push({type:B.StructuredAppend,currentSequence:a.readBits(4),totalSequence:a.readBits(4),parity:a.readBits(8)})}if(0===a.available()||0===a.readBits(a.available()))return b}\nclass G{constructor(a,b){if(0===b.length)throw Error("No coefficients.");this.field=a;let c=b.length;if(1<c&&0===b[0]){let d=1;for(;d<c&&0===b[d];)d++;if(d===c)this.coefficients=a.zero.coefficients;else for(this.coefficients=new Uint8ClampedArray(c-d),a=0;a<this.coefficients.length;a++)this.coefficients[a]=b[d+a]}else this.coefficients=b}degree(){return this.coefficients.length-1}isZero(){return 0===this.coefficients[0]}getCoefficient(a){return this.coefficients[this.coefficients.length-1-a]}addOrSubtract(a){if(this.isZero())return a;\nif(a.isZero())return this;let b=this.coefficients;a=a.coefficients;b.length>a.length&&([b,a]=[a,b]);let c=new Uint8ClampedArray(a.length),d=a.length-b.length;for(var e=0;e<d;e++)c[e]=a[e];for(e=d;e<a.length;e++)c[e]=b[e-d]^a[e];return new G(this.field,c)}multiply(a){if(0===a)return this.field.zero;if(1===a)return this;let b=this.coefficients.length,c=new Uint8ClampedArray(b);for(let d=0;d<b;d++)c[d]=this.field.multiply(this.coefficients[d],a);return new G(this.field,c)}multiplyPoly(a){if(this.isZero()||\na.isZero())return this.field.zero;let b=this.coefficients,c=b.length;a=a.coefficients;let d=a.length,e=new Uint8ClampedArray(c+d-1);for(let f=0;f<c;f++){let g=b[f];for(let h=0;h<d;h++)e[f+h]=H(e[f+h],this.field.multiply(g,a[h]))}return new G(this.field,e)}multiplyByMonomial(a,b){if(0>a)throw Error("Invalid degree less than 0");if(0===b)return this.field.zero;let c=this.coefficients.length;a=new Uint8ClampedArray(c+a);for(let d=0;d<c;d++)a[d]=this.field.multiply(this.coefficients[d],b);return new G(this.field,\na)}evaluateAt(a){let b=0;if(0===a)return this.getCoefficient(0);let c=this.coefficients.length;if(1===a)return this.coefficients.forEach(d=>{b^=d}),b;b=this.coefficients[0];for(let d=1;d<c;d++)b=H(this.field.multiply(a,b),this.coefficients[d]);return b}}function H(a,b){return a^b}\nclass ea{constructor(a,b,c){this.primitive=a;this.size=b;this.generatorBase=c;this.expTable=Array(this.size);this.logTable=Array(this.size);a=1;for(b=0;b<this.size;b++)this.expTable[b]=a,a*=2,a>=this.size&&(a=(a^this.primitive)&this.size-1);for(a=0;a<this.size-1;a++)this.logTable[this.expTable[a]]=a;this.zero=new G(this,Uint8ClampedArray.from([0]));this.one=new G(this,Uint8ClampedArray.from([1]))}multiply(a,b){return 0===a||0===b?0:this.expTable[(this.logTable[a]+this.logTable[b])%(this.size-1)]}inverse(a){if(0===\na)throw Error("Can\'t invert 0");return this.expTable[this.size-this.logTable[a]-1]}buildMonomial(a,b){if(0>a)throw Error("Invalid monomial degree less than 0");if(0===b)return this.zero;a=new Uint8ClampedArray(a+1);a[0]=b;return new G(this,a)}log(a){if(0===a)throw Error("Can\'t take log(0)");return this.logTable[a]}exp(a){return this.expTable[a]}}\nfunction fa(a,b,c,d){b.degree()<c.degree()&&([b,c]=[c,b]);let e=a.zero;for(var f=a.one;c.degree()>=d/2;){var g=b;let h=e;b=c;e=f;if(b.isZero())return null;c=g;f=a.zero;g=b.getCoefficient(b.degree());for(g=a.inverse(g);c.degree()>=b.degree()&&!c.isZero();){let k=c.degree()-b.degree(),m=a.multiply(c.getCoefficient(c.degree()),g);f=f.addOrSubtract(a.buildMonomial(k,m));c=c.addOrSubtract(b.multiplyByMonomial(k,m))}f=f.multiplyPoly(e).addOrSubtract(h);if(c.degree()>=b.degree())return null}d=f.getCoefficient(0);\nif(0===d)return null;a=a.inverse(d);return[f.multiply(a),c.multiply(a)]}\nfunction ha(a,b){let c=new Uint8ClampedArray(a.length);c.set(a);a=new ea(285,256,0);var d=new G(a,c),e=new Uint8ClampedArray(b),f=!1;for(var g=0;g<b;g++){var h=d.evaluateAt(a.exp(g+a.generatorBase));e[e.length-1-g]=h;0!==h&&(f=!0)}if(!f)return c;d=new G(a,e);d=fa(a,a.buildMonomial(b,1),d,b);if(null===d)return null;b=d[0];g=b.degree();if(1===g)b=[b.getCoefficient(1)];else{e=Array(g);f=0;for(h=1;h<a.size&&f<g;h++)0===b.evaluateAt(h)&&(e[f]=a.inverse(h),f++);b=f!==g?null:e}if(null==b)return null;e=d[1];\nf=b.length;d=Array(f);for(g=0;g<f;g++){h=a.inverse(b[g]);let k=1;for(let m=0;m<f;m++)g!==m&&(k=a.multiply(k,H(1,a.multiply(b[m],h))));d[g]=a.multiply(e.evaluateAt(h),a.inverse(k));0!==a.generatorBase&&(d[g]=a.multiply(d[g],h))}for(e=0;e<b.length;e++){f=c.length-1-a.log(b[e]);if(0>f)return null;c[f]^=d[e]}return c}\nlet I=[{infoBits:null,versionNumber:1,alignmentPatternCenters:[],errorCorrectionLevels:[{ecCodewordsPerBlock:7,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:10,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:16}]},{ecCodewordsPerBlock:13,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:13}]},{ecCodewordsPerBlock:17,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:9}]}]},{infoBits:null,versionNumber:2,alignmentPatternCenters:[6,18],errorCorrectionLevels:[{ecCodewordsPerBlock:10,ecBlocks:[{numBlocks:1,\ndataCodewordsPerBlock:34}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:28}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:22}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:16}]}]},{infoBits:null,versionNumber:3,alignmentPatternCenters:[6,22],errorCorrectionLevels:[{ecCodewordsPerBlock:15,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:55}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:18,\necBlocks:[{numBlocks:2,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:13}]}]},{infoBits:null,versionNumber:4,alignmentPatternCenters:[6,26],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:80}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:32}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:9}]}]},\n{infoBits:null,versionNumber:5,alignmentPatternCenters:[6,30],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:43}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:15},{numBlocks:2,dataCodewordsPerBlock:16}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:11},{numBlocks:2,dataCodewordsPerBlock:12}]}]},{infoBits:null,versionNumber:6,alignmentPatternCenters:[6,\n34],errorCorrectionLevels:[{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:68}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:27}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:15}]}]},{infoBits:31892,versionNumber:7,alignmentPatternCenters:[6,22,38],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:78}]},{ecCodewordsPerBlock:18,\necBlocks:[{numBlocks:4,dataCodewordsPerBlock:31}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:4,dataCodewordsPerBlock:15}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:13},{numBlocks:1,dataCodewordsPerBlock:14}]}]},{infoBits:34236,versionNumber:8,alignmentPatternCenters:[6,24,42],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:97}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:38},\n{numBlocks:2,dataCodewordsPerBlock:39}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:18},{numBlocks:2,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:14},{numBlocks:2,dataCodewordsPerBlock:15}]}]},{infoBits:39577,versionNumber:9,alignmentPatternCenters:[6,26,46],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:36},\n{numBlocks:2,dataCodewordsPerBlock:37}]},{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:16},{numBlocks:4,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:12},{numBlocks:4,dataCodewordsPerBlock:13}]}]},{infoBits:42195,versionNumber:10,alignmentPatternCenters:[6,28,50],errorCorrectionLevels:[{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:68},{numBlocks:2,dataCodewordsPerBlock:69}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,\ndataCodewordsPerBlock:43},{numBlocks:1,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:19},{numBlocks:2,dataCodewordsPerBlock:20}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:15},{numBlocks:2,dataCodewordsPerBlock:16}]}]},{infoBits:48118,versionNumber:11,alignmentPatternCenters:[6,30,54],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:81}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:1,\ndataCodewordsPerBlock:50},{numBlocks:4,dataCodewordsPerBlock:51}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:22},{numBlocks:4,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:12},{numBlocks:8,dataCodewordsPerBlock:13}]}]},{infoBits:51042,versionNumber:12,alignmentPatternCenters:[6,32,58],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:92},{numBlocks:2,dataCodewordsPerBlock:93}]},\n{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:36},{numBlocks:2,dataCodewordsPerBlock:37}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:20},{numBlocks:6,dataCodewordsPerBlock:21}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:14},{numBlocks:4,dataCodewordsPerBlock:15}]}]},{infoBits:55367,versionNumber:13,alignmentPatternCenters:[6,34,62],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:107}]},\n{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:37},{numBlocks:1,dataCodewordsPerBlock:38}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:20},{numBlocks:4,dataCodewordsPerBlock:21}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:11},{numBlocks:4,dataCodewordsPerBlock:12}]}]},{infoBits:58893,versionNumber:14,alignmentPatternCenters:[6,26,46,66],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:115},\n{numBlocks:1,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:40},{numBlocks:5,dataCodewordsPerBlock:41}]},{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:16},{numBlocks:5,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:12},{numBlocks:5,dataCodewordsPerBlock:13}]}]},{infoBits:63784,versionNumber:15,alignmentPatternCenters:[6,26,48,70],errorCorrectionLevels:[{ecCodewordsPerBlock:22,\necBlocks:[{numBlocks:5,dataCodewordsPerBlock:87},{numBlocks:1,dataCodewordsPerBlock:88}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:41},{numBlocks:5,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:24},{numBlocks:7,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:12},{numBlocks:7,dataCodewordsPerBlock:13}]}]},{infoBits:68472,versionNumber:16,alignmentPatternCenters:[6,26,50,\n74],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:98},{numBlocks:1,dataCodewordsPerBlock:99}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:45},{numBlocks:3,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:19},{numBlocks:2,dataCodewordsPerBlock:20}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:15},{numBlocks:13,dataCodewordsPerBlock:16}]}]},{infoBits:70749,\nversionNumber:17,alignmentPatternCenters:[6,30,54,78],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:107},{numBlocks:5,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:46},{numBlocks:1,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:22},{numBlocks:15,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:17,\ndataCodewordsPerBlock:15}]}]},{infoBits:76311,versionNumber:18,alignmentPatternCenters:[6,30,56,82],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:120},{numBlocks:1,dataCodewordsPerBlock:121}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:9,dataCodewordsPerBlock:43},{numBlocks:4,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:22},{numBlocks:1,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,\ndataCodewordsPerBlock:14},{numBlocks:19,dataCodewordsPerBlock:15}]}]},{infoBits:79154,versionNumber:19,alignmentPatternCenters:[6,30,58,86],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:113},{numBlocks:4,dataCodewordsPerBlock:114}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:44},{numBlocks:11,dataCodewordsPerBlock:45}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:21},{numBlocks:4,dataCodewordsPerBlock:22}]},\n{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:9,dataCodewordsPerBlock:13},{numBlocks:16,dataCodewordsPerBlock:14}]}]},{infoBits:84390,versionNumber:20,alignmentPatternCenters:[6,34,62,90],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:107},{numBlocks:5,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:41},{numBlocks:13,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:24},\n{numBlocks:5,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:15},{numBlocks:10,dataCodewordsPerBlock:16}]}]},{infoBits:87683,versionNumber:21,alignmentPatternCenters:[6,28,50,72,94],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:116},{numBlocks:4,dataCodewordsPerBlock:117}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:22},\n{numBlocks:6,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:16},{numBlocks:6,dataCodewordsPerBlock:17}]}]},{infoBits:92361,versionNumber:22,alignmentPatternCenters:[6,26,50,74,98],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:111},{numBlocks:7,dataCodewordsPerBlock:112}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:24},\n{numBlocks:16,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:34,dataCodewordsPerBlock:13}]}]},{infoBits:96236,versionNumber:23,alignmentPatternCenters:[6,30,54,74,102],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:121},{numBlocks:5,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:47},{numBlocks:14,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:24},\n{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:16,dataCodewordsPerBlock:15},{numBlocks:14,dataCodewordsPerBlock:16}]}]},{infoBits:102084,versionNumber:24,alignmentPatternCenters:[6,28,54,80,106],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:117},{numBlocks:4,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:45},{numBlocks:14,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,\necBlocks:[{numBlocks:11,dataCodewordsPerBlock:24},{numBlocks:16,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:30,dataCodewordsPerBlock:16},{numBlocks:2,dataCodewordsPerBlock:17}]}]},{infoBits:102881,versionNumber:25,alignmentPatternCenters:[6,32,58,84,110],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:106},{numBlocks:4,dataCodewordsPerBlock:107}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:47},{numBlocks:13,\ndataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:24},{numBlocks:22,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:15},{numBlocks:13,dataCodewordsPerBlock:16}]}]},{infoBits:110507,versionNumber:26,alignmentPatternCenters:[6,30,58,86,114],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:114},{numBlocks:2,dataCodewordsPerBlock:115}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:19,\ndataCodewordsPerBlock:46},{numBlocks:4,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:28,dataCodewordsPerBlock:22},{numBlocks:6,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:33,dataCodewordsPerBlock:16},{numBlocks:4,dataCodewordsPerBlock:17}]}]},{infoBits:110734,versionNumber:27,alignmentPatternCenters:[6,34,62,90,118],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:122},{numBlocks:4,dataCodewordsPerBlock:123}]},\n{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:45},{numBlocks:3,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:23},{numBlocks:26,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:15},{numBlocks:28,dataCodewordsPerBlock:16}]}]},{infoBits:117786,versionNumber:28,alignmentPatternCenters:[6,26,50,74,98,122],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:117},\n{numBlocks:10,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:45},{numBlocks:23,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:24},{numBlocks:31,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:15},{numBlocks:31,dataCodewordsPerBlock:16}]}]},{infoBits:119615,versionNumber:29,alignmentPatternCenters:[6,30,54,78,102,126],errorCorrectionLevels:[{ecCodewordsPerBlock:30,\necBlocks:[{numBlocks:7,dataCodewordsPerBlock:116},{numBlocks:7,dataCodewordsPerBlock:117}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:21,dataCodewordsPerBlock:45},{numBlocks:7,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:23},{numBlocks:37,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:15},{numBlocks:26,dataCodewordsPerBlock:16}]}]},{infoBits:126325,versionNumber:30,alignmentPatternCenters:[6,\n26,52,78,104,130],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:115},{numBlocks:10,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:47},{numBlocks:10,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:24},{numBlocks:25,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:23,dataCodewordsPerBlock:15},{numBlocks:25,dataCodewordsPerBlock:16}]}]},\n{infoBits:127568,versionNumber:31,alignmentPatternCenters:[6,30,56,82,108,134],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:115},{numBlocks:3,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:46},{numBlocks:29,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:42,dataCodewordsPerBlock:24},{numBlocks:1,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:23,dataCodewordsPerBlock:15},\n{numBlocks:28,dataCodewordsPerBlock:16}]}]},{infoBits:133589,versionNumber:32,alignmentPatternCenters:[6,34,60,86,112,138],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:115}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:46},{numBlocks:23,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:24},{numBlocks:35,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,\ndataCodewordsPerBlock:15},{numBlocks:35,dataCodewordsPerBlock:16}]}]},{infoBits:136944,versionNumber:33,alignmentPatternCenters:[6,30,58,86,114,142],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:115},{numBlocks:1,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:14,dataCodewordsPerBlock:46},{numBlocks:21,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:29,dataCodewordsPerBlock:24},{numBlocks:19,dataCodewordsPerBlock:25}]},\n{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:15},{numBlocks:46,dataCodewordsPerBlock:16}]}]},{infoBits:141498,versionNumber:34,alignmentPatternCenters:[6,34,62,90,118,146],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:115},{numBlocks:6,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:14,dataCodewordsPerBlock:46},{numBlocks:23,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:44,\ndataCodewordsPerBlock:24},{numBlocks:7,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:59,dataCodewordsPerBlock:16},{numBlocks:1,dataCodewordsPerBlock:17}]}]},{infoBits:145311,versionNumber:35,alignmentPatternCenters:[6,30,54,78,102,126,150],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:121},{numBlocks:7,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:47},{numBlocks:26,dataCodewordsPerBlock:48}]},\n{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:39,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:15},{numBlocks:41,dataCodewordsPerBlock:16}]}]},{infoBits:150283,versionNumber:36,alignmentPatternCenters:[6,24,50,76,102,128,154],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:121},{numBlocks:14,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,\ndataCodewordsPerBlock:47},{numBlocks:34,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:46,dataCodewordsPerBlock:24},{numBlocks:10,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:15},{numBlocks:64,dataCodewordsPerBlock:16}]}]},{infoBits:152622,versionNumber:37,alignmentPatternCenters:[6,28,54,80,106,132,158],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:122},{numBlocks:4,dataCodewordsPerBlock:123}]},\n{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:29,dataCodewordsPerBlock:46},{numBlocks:14,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:49,dataCodewordsPerBlock:24},{numBlocks:10,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:24,dataCodewordsPerBlock:15},{numBlocks:46,dataCodewordsPerBlock:16}]}]},{infoBits:158308,versionNumber:38,alignmentPatternCenters:[6,32,58,84,110,136,162],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,\ndataCodewordsPerBlock:122},{numBlocks:18,dataCodewordsPerBlock:123}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:46},{numBlocks:32,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:48,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:42,dataCodewordsPerBlock:15},{numBlocks:32,dataCodewordsPerBlock:16}]}]},{infoBits:161089,versionNumber:39,alignmentPatternCenters:[6,26,54,82,110,138,166],\nerrorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:20,dataCodewordsPerBlock:117},{numBlocks:4,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:40,dataCodewordsPerBlock:47},{numBlocks:7,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:43,dataCodewordsPerBlock:24},{numBlocks:22,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:15},{numBlocks:67,dataCodewordsPerBlock:16}]}]},{infoBits:167017,\nversionNumber:40,alignmentPatternCenters:[6,30,58,86,114,142,170],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:118},{numBlocks:6,dataCodewordsPerBlock:119}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:18,dataCodewordsPerBlock:47},{numBlocks:31,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:34,dataCodewordsPerBlock:24},{numBlocks:34,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:20,dataCodewordsPerBlock:15},\n{numBlocks:61,dataCodewordsPerBlock:16}]}]}];function J(a,b){a^=b;for(b=0;a;)b++,a&=a-1;return b}function K(a,b){return b<<1|a}\nlet ia=[{bits:21522,formatInfo:{errorCorrectionLevel:1,dataMask:0}},{bits:20773,formatInfo:{errorCorrectionLevel:1,dataMask:1}},{bits:24188,formatInfo:{errorCorrectionLevel:1,dataMask:2}},{bits:23371,formatInfo:{errorCorrectionLevel:1,dataMask:3}},{bits:17913,formatInfo:{errorCorrectionLevel:1,dataMask:4}},{bits:16590,formatInfo:{errorCorrectionLevel:1,dataMask:5}},{bits:20375,formatInfo:{errorCorrectionLevel:1,dataMask:6}},{bits:19104,formatInfo:{errorCorrectionLevel:1,dataMask:7}},{bits:30660,formatInfo:{errorCorrectionLevel:0,\ndataMask:0}},{bits:29427,formatInfo:{errorCorrectionLevel:0,dataMask:1}},{bits:32170,formatInfo:{errorCorrectionLevel:0,dataMask:2}},{bits:30877,formatInfo:{errorCorrectionLevel:0,dataMask:3}},{bits:26159,formatInfo:{errorCorrectionLevel:0,dataMask:4}},{bits:25368,formatInfo:{errorCorrectionLevel:0,dataMask:5}},{bits:27713,formatInfo:{errorCorrectionLevel:0,dataMask:6}},{bits:26998,formatInfo:{errorCorrectionLevel:0,dataMask:7}},{bits:5769,formatInfo:{errorCorrectionLevel:3,dataMask:0}},{bits:5054,\nformatInfo:{errorCorrectionLevel:3,dataMask:1}},{bits:7399,formatInfo:{errorCorrectionLevel:3,dataMask:2}},{bits:6608,formatInfo:{errorCorrectionLevel:3,dataMask:3}},{bits:1890,formatInfo:{errorCorrectionLevel:3,dataMask:4}},{bits:597,formatInfo:{errorCorrectionLevel:3,dataMask:5}},{bits:3340,formatInfo:{errorCorrectionLevel:3,dataMask:6}},{bits:2107,formatInfo:{errorCorrectionLevel:3,dataMask:7}},{bits:13663,formatInfo:{errorCorrectionLevel:2,dataMask:0}},{bits:12392,formatInfo:{errorCorrectionLevel:2,\ndataMask:1}},{bits:16177,formatInfo:{errorCorrectionLevel:2,dataMask:2}},{bits:14854,formatInfo:{errorCorrectionLevel:2,dataMask:3}},{bits:9396,formatInfo:{errorCorrectionLevel:2,dataMask:4}},{bits:8579,formatInfo:{errorCorrectionLevel:2,dataMask:5}},{bits:11994,formatInfo:{errorCorrectionLevel:2,dataMask:6}},{bits:11245,formatInfo:{errorCorrectionLevel:2,dataMask:7}}],ja=[a=>0===(a.y+a.x)%2,a=>0===a.y%2,a=>0===a.x%3,a=>0===(a.y+a.x)%3,a=>0===(Math.floor(a.y/2)+Math.floor(a.x/3))%2,a=>0===a.x*a.y%\n2+a.x*a.y%3,a=>0===(a.y*a.x%2+a.y*a.x%3)%2,a=>0===((a.y+a.x)%2+a.y*a.x%3)%2];\nfunction ka(a,b,c){c=ja[c.dataMask];let d=a.height;var e=17+4*b.versionNumber;let f=x.createEmpty(e,e);f.setRegion(0,0,9,9,!0);f.setRegion(e-8,0,8,9,!0);f.setRegion(0,e-8,9,8,!0);for(var g of b.alignmentPatternCenters)for(var h of b.alignmentPatternCenters)6===g&&6===h||6===g&&h===e-7||g===e-7&&6===h||f.setRegion(g-2,h-2,5,5,!0);f.setRegion(6,9,1,e-17,!0);f.setRegion(9,6,e-17,1,!0);6<b.versionNumber&&(f.setRegion(e-11,0,3,6,!0),f.setRegion(0,e-11,6,3,!0));b=[];h=g=0;e=!0;for(let k=d-1;0<k;k-=2){6===\nk&&k--;for(let m=0;m<d;m++){let l=e?d-1-m:m;for(let n=0;2>n;n++){let q=k-n;if(!f.get(q,l)){h++;let r=a.get(q,l);c({y:l,x:q})&&(r=!r);g=g<<1|r;8===h&&(b.push(g),g=h=0)}}}e=!e}return b}\nfunction la(a){var b=a.height,c=Math.floor((b-17)/4);if(6>=c)return I[c-1];c=0;for(var d=5;0<=d;d--)for(var e=b-9;e>=b-11;e--)c=K(a.get(e,d),c);d=0;for(e=5;0<=e;e--)for(let g=b-9;g>=b-11;g--)d=K(a.get(e,g),d);a=Infinity;let f;for(let g of I){if(g.infoBits===c||g.infoBits===d)return g;b=J(c,g.infoBits);b<a&&(f=g,a=b);b=J(d,g.infoBits);b<a&&(f=g,a=b)}if(3>=a)return f}\nfunction ma(a){let b=0;for(var c=0;8>=c;c++)6!==c&&(b=K(a.get(c,8),b));for(c=7;0<=c;c--)6!==c&&(b=K(a.get(8,c),b));var d=a.height;c=0;for(var e=d-1;e>=d-7;e--)c=K(a.get(8,e),c);for(e=d-8;e<d;e++)c=K(a.get(e,8),c);a=Infinity;d=null;for(let {bits:f,formatInfo:g}of ia){if(f===b||f===c)return g;e=J(b,f);e<a&&(d=g,a=e);b!==c&&(e=J(c,f),e<a&&(d=g,a=e))}return 3>=a?d:null}\nfunction na(a,b,c){let d=b.errorCorrectionLevels[c],e=[],f=0;d.ecBlocks.forEach(h=>{for(let k=0;k<h.numBlocks;k++)e.push({numDataCodewords:h.dataCodewordsPerBlock,codewords:[]}),f+=h.dataCodewordsPerBlock+d.ecCodewordsPerBlock});if(a.length<f)return null;a=a.slice(0,f);b=d.ecBlocks[0].dataCodewordsPerBlock;for(c=0;c<b;c++)for(var g of e)g.codewords.push(a.shift());if(1<d.ecBlocks.length)for(g=d.ecBlocks[0].numBlocks,b=d.ecBlocks[1].numBlocks,c=0;c<b;c++)e[g+c].codewords.push(a.shift());for(;0<a.length;)for(let h of e)h.codewords.push(a.shift());\nreturn e}function L(a){let b=la(a);if(!b)return null;var c=ma(a);if(!c)return null;a=ka(a,b,c);var d=na(a,b,c.errorCorrectionLevel);if(!d)return null;c=d.reduce((e,f)=>e+f.numDataCodewords,0);c=new Uint8ClampedArray(c);a=0;for(let e of d){d=ha(e.codewords,e.codewords.length-e.numDataCodewords);if(!d)return null;for(let f=0;f<e.numDataCodewords;f++)c[a++]=d[f]}try{return da(c,b.versionNumber)}catch(e){return null}}\nfunction M(a,b,c,d){var e=a.x-b.x+c.x-d.x;let f=a.y-b.y+c.y-d.y;if(0===e&&0===f)return{a11:b.x-a.x,a12:b.y-a.y,a13:0,a21:c.x-b.x,a22:c.y-b.y,a23:0,a31:a.x,a32:a.y,a33:1};let g=b.x-c.x;var h=d.x-c.x;let k=b.y-c.y,m=d.y-c.y;c=g*m-h*k;h=(e*m-h*f)/c;e=(g*f-e*k)/c;return{a11:b.x-a.x+h*b.x,a12:b.y-a.y+h*b.y,a13:h,a21:d.x-a.x+e*d.x,a22:d.y-a.y+e*d.y,a23:e,a31:a.x,a32:a.y,a33:1}}\nfunction oa(a,b,c,d){a=M(a,b,c,d);return{a11:a.a22*a.a33-a.a23*a.a32,a12:a.a13*a.a32-a.a12*a.a33,a13:a.a12*a.a23-a.a13*a.a22,a21:a.a23*a.a31-a.a21*a.a33,a22:a.a11*a.a33-a.a13*a.a31,a23:a.a13*a.a21-a.a11*a.a23,a31:a.a21*a.a32-a.a22*a.a31,a32:a.a12*a.a31-a.a11*a.a32,a33:a.a11*a.a22-a.a12*a.a21}}\nfunction pa(a,b){var c=oa({x:3.5,y:3.5},{x:b.dimension-3.5,y:3.5},{x:b.dimension-6.5,y:b.dimension-6.5},{x:3.5,y:b.dimension-3.5}),d=M(b.topLeft,b.topRight,b.alignmentPattern,b.bottomLeft),e=d.a11*c.a11+d.a21*c.a12+d.a31*c.a13,f=d.a12*c.a11+d.a22*c.a12+d.a32*c.a13,g=d.a13*c.a11+d.a23*c.a12+d.a33*c.a13,h=d.a11*c.a21+d.a21*c.a22+d.a31*c.a23,k=d.a12*c.a21+d.a22*c.a22+d.a32*c.a23,m=d.a13*c.a21+d.a23*c.a22+d.a33*c.a23,l=d.a11*c.a31+d.a21*c.a32+d.a31*c.a33,n=d.a12*c.a31+d.a22*c.a32+d.a32*c.a33,q=d.a13*\nc.a31+d.a23*c.a32+d.a33*c.a33;c=x.createEmpty(b.dimension,b.dimension);d=(r,u)=>{const p=g*r+m*u+q;return{x:(e*r+h*u+l)/p,y:(f*r+k*u+n)/p}};for(let r=0;r<b.dimension;r++)for(let u=0;u<b.dimension;u++){let p=d(u+.5,r+.5);c.set(u,r,a.get(Math.floor(p.x),Math.floor(p.y)))}return{matrix:c,mappingFunction:d}}let N=(a,b)=>Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2));function O(a){return a.reduce((b,c)=>b+c)}\nfunction qa(a,b,c){let d=N(a,b),e=N(b,c),f=N(a,c),g,h,k;e>=d&&e>=f?[g,h,k]=[b,a,c]:f>=e&&f>=d?[g,h,k]=[a,b,c]:[g,h,k]=[a,c,b];0>(k.x-h.x)*(g.y-h.y)-(k.y-h.y)*(g.x-h.x)&&([g,k]=[k,g]);return{bottomLeft:g,topLeft:h,topRight:k}}\nfunction ra(a,b,c,d){d=(O(P(a,c,d,5))/7+O(P(a,b,d,5))/7+O(P(c,a,d,5))/7+O(P(b,a,d,5))/7)/4;if(1>d)throw Error("Invalid module size");b=Math.round(N(a,b)/d);a=Math.round(N(a,c)/d);a=Math.floor((b+a)/2)+7;switch(a%4){case 0:a++;break;case 2:a--}return{dimension:a,moduleSize:d}}\nfunction Q(a,b,c,d){let e=[{x:Math.floor(a.x),y:Math.floor(a.y)}];var f=Math.abs(b.y-a.y)>Math.abs(b.x-a.x);if(f){var g=Math.floor(a.y);var h=Math.floor(a.x);a=Math.floor(b.y);b=Math.floor(b.x)}else g=Math.floor(a.x),h=Math.floor(a.y),a=Math.floor(b.x),b=Math.floor(b.y);let k=Math.abs(a-g),m=Math.abs(b-h),l=Math.floor(-k/2),n=g<a?1:-1,q=h<b?1:-1,r=!0;for(let u=g,p=h;u!==a+n;u+=n){g=f?p:u;h=f?u:p;if(c.get(g,h)!==r&&(r=!r,e.push({x:g,y:h}),e.length===d+1))break;l+=m;if(0<l){if(p===b)break;p+=q;l-=k}}c=\n[];for(f=0;f<d;f++)e[f]&&e[f+1]?c.push(N(e[f],e[f+1])):c.push(0);return c}function P(a,b,c,d){let e=b.y-a.y,f=b.x-a.x;b=Q(a,b,c,Math.ceil(d/2));a=Q(a,{x:a.x-f,y:a.y-e},c,Math.ceil(d/2));c=b.shift()+a.shift()-1;return a.concat(c).concat(...b)}function R(a,b){let c=O(a)/O(b),d=0;b.forEach((e,f)=>{d+=Math.pow(a[f]-e*c,2)});return{averageSize:c,error:d}}\nfunction S(a,b,c){try{let d=P(a,{x:-1,y:a.y},c,b.length),e=P(a,{x:a.x,y:-1},c,b.length),f=P(a,{x:Math.max(0,a.x-a.y)-1,y:Math.max(0,a.y-a.x)-1},c,b.length),g=P(a,{x:Math.min(c.width,a.x+a.y)+1,y:Math.min(c.height,a.y+a.x)+1},c,b.length),h=R(d,b),k=R(e,b),m=R(f,b),l=R(g,b),n=(h.averageSize+k.averageSize+m.averageSize+l.averageSize)/4;return Math.sqrt(h.error*h.error+k.error*k.error+m.error*m.error+l.error*l.error)+(Math.pow(h.averageSize-n,2)+Math.pow(k.averageSize-n,2)+Math.pow(m.averageSize-n,2)+\nMath.pow(l.averageSize-n,2))/n}catch(d){return Infinity}}function T(a,b){for(var c=Math.round(b.x);a.get(c,Math.round(b.y));)c--;for(var d=Math.round(b.x);a.get(d,Math.round(b.y));)d++;c=(c+d)/2;for(d=Math.round(b.y);a.get(Math.round(c),d);)d--;for(b=Math.round(b.y);a.get(Math.round(c),b);)b++;return{x:c,y:(d+b)/2}}\nfunction sa(a){var b=[],c=[];let d=[];var e=[];for(let p=0;p<=a.height;p++){var f=0,g=!1;let t=[0,0,0,0,0];for(let v=-1;v<=a.width;v++){var h=a.get(v,p);if(h===g)f++;else{t=[t[1],t[2],t[3],t[4],f];f=1;g=h;var k=O(t)/7;k=Math.abs(t[0]-k)<k&&Math.abs(t[1]-k)<k&&Math.abs(t[2]-3*k)<3*k&&Math.abs(t[3]-k)<k&&Math.abs(t[4]-k)<k&&!h;var m=O(t.slice(-3))/3;h=Math.abs(t[2]-m)<m&&Math.abs(t[3]-m)<m&&Math.abs(t[4]-m)<m&&h;if(k){let z=v-t[3]-t[4],y=z-t[2];k={startX:y,endX:z,y:p};m=c.filter(w=>y>=w.bottom.startX&&\ny<=w.bottom.endX||z>=w.bottom.startX&&y<=w.bottom.endX||y<=w.bottom.startX&&z>=w.bottom.endX&&1.5>t[2]/(w.bottom.endX-w.bottom.startX)&&.5<t[2]/(w.bottom.endX-w.bottom.startX));0<m.length?m[0].bottom=k:c.push({top:k,bottom:k})}if(h){let z=v-t[4],y=z-t[3];h={startX:y,y:p,endX:z};k=e.filter(w=>y>=w.bottom.startX&&y<=w.bottom.endX||z>=w.bottom.startX&&y<=w.bottom.endX||y<=w.bottom.startX&&z>=w.bottom.endX&&1.5>t[2]/(w.bottom.endX-w.bottom.startX)&&.5<t[2]/(w.bottom.endX-w.bottom.startX));0<k.length?\nk[0].bottom=h:e.push({top:h,bottom:h})}}}b.push(...c.filter(v=>v.bottom.y!==p&&2<=v.bottom.y-v.top.y));c=c.filter(v=>v.bottom.y===p);d.push(...e.filter(v=>v.bottom.y!==p));e=e.filter(v=>v.bottom.y===p)}b.push(...c.filter(p=>2<=p.bottom.y-p.top.y));d.push(...e);c=[];for(var l of b)2>l.bottom.y-l.top.y||(b=(l.top.startX+l.top.endX+l.bottom.startX+l.bottom.endX)/4,e=(l.top.y+l.bottom.y+1)/2,a.get(Math.round(b),Math.round(e))&&(f=[l.top.endX-l.top.startX,l.bottom.endX-l.bottom.startX,l.bottom.y-l.top.y+\n1],f=O(f)/f.length,g=S({x:Math.round(b),y:Math.round(e)},[1,1,3,1,1],a),c.push({score:g,x:b,y:e,size:f})));if(3>c.length)return null;c.sort((p,t)=>p.score-t.score);l=[];for(b=0;b<Math.min(c.length,5);++b){e=c[b];f=[];for(var n of c)n!==e&&f.push(Object.assign(Object.assign({},n),{score:n.score+Math.pow(n.size-e.size,2)/e.size}));f.sort((p,t)=>p.score-t.score);l.push({points:[e,f[0],f[1]],score:e.score+f[0].score+f[1].score})}l.sort((p,t)=>p.score-t.score);let {topRight:q,topLeft:r,bottomLeft:u}=qa(...l[0].points);\nl=U(a,d,q,r,u);n=[];l&&n.push({alignmentPattern:{x:l.alignmentPattern.x,y:l.alignmentPattern.y},bottomLeft:{x:u.x,y:u.y},dimension:l.dimension,topLeft:{x:r.x,y:r.y},topRight:{x:q.x,y:q.y}});l=T(a,q);b=T(a,r);c=T(a,u);(a=U(a,d,l,b,c))&&n.push({alignmentPattern:{x:a.alignmentPattern.x,y:a.alignmentPattern.y},bottomLeft:{x:c.x,y:c.y},topLeft:{x:b.x,y:b.y},topRight:{x:l.x,y:l.y},dimension:a.dimension});return 0===n.length?null:n}\nfunction U(a,b,c,d,e){let f,g;try{({dimension:f,moduleSize:g}=ra(d,c,e,a))}catch(l){return null}var h=c.x-d.x+e.x,k=c.y-d.y+e.y;c=(N(d,e)+N(d,c))/2/g;e=1-3/c;let m={x:d.x+e*(h-d.x),y:d.y+e*(k-d.y)};b=b.map(l=>{const n=(l.top.startX+l.top.endX+l.bottom.startX+l.bottom.endX)/4;l=(l.top.y+l.bottom.y+1)/2;if(a.get(Math.floor(n),Math.floor(l))){var q=S({x:Math.floor(n),y:Math.floor(l)},[1,1,1],a)+N({x:n,y:l},m);return{x:n,y:l,score:q}}}).filter(l=>!!l).sort((l,n)=>l.score-n.score);return{alignmentPattern:15<=\nc&&b.length?b[0]:m,dimension:f}}\nfunction V(a){var b=sa(a);if(!b)return null;for(let e of b){b=pa(a,e);var c=b.matrix;if(null==c)c=null;else{var d=L(c);if(d)c=d;else{for(d=0;d<c.width;d++)for(let f=d+1;f<c.height;f++)c.get(d,f)!==c.get(f,d)&&(c.set(d,f,!c.get(d,f)),c.set(f,d,!c.get(f,d)));c=L(c)}}if(c)return{binaryData:c.bytes,data:c.text,chunks:c.chunks,version:c.version,location:{topRightCorner:b.mappingFunction(e.dimension,0),topLeftCorner:b.mappingFunction(0,0),bottomRightCorner:b.mappingFunction(e.dimension,e.dimension),bottomLeftCorner:b.mappingFunction(0,\ne.dimension),topRightFinderPattern:e.topRight,topLeftFinderPattern:e.topLeft,bottomLeftFinderPattern:e.bottomLeft,bottomRightAlignmentPattern:e.alignmentPattern},matrix:b.matrix}}return null}let ta={inversionAttempts:"attemptBoth",greyScaleWeights:{red:.2126,green:.7152,blue:.0722,useIntegerApproximation:!1},canOverwriteImage:!0};function W(a,b){Object.keys(b).forEach(c=>{a[c]=b[c]})}\nfunction X(a,b,c,d={}){let e=Object.create(null);W(e,ta);W(e,d);d="onlyInvert"===e.inversionAttempts||"invertFirst"===e.inversionAttempts;var f="attemptBoth"===e.inversionAttempts||d;var g=e.greyScaleWeights,h=e.canOverwriteImage,k=b*c;if(a.length!==4*k)throw Error("Malformed data passed to binarizer.");var m=0;if(h){var l=new Uint8ClampedArray(a.buffer,m,k);m+=k}l=new A(b,c,l);if(g.useIntegerApproximation)for(var n=0;n<c;n++)for(var q=0;q<b;q++){var r=4*(n*b+q);l.set(q,n,g.red*a[r]+g.green*a[r+1]+\ng.blue*a[r+2]+128>>8)}else for(n=0;n<c;n++)for(q=0;q<b;q++)r=4*(n*b+q),l.set(q,n,g.red*a[r]+g.green*a[r+1]+g.blue*a[r+2]);g=Math.ceil(b/8);n=Math.ceil(c/8);q=g*n;if(h){var u=new Uint8ClampedArray(a.buffer,m,q);m+=q}u=new A(g,n,u);for(q=0;q<n;q++)for(r=0;r<g;r++){var p=Infinity,t=0;for(var v=0;8>v;v++)for(let w=0;8>w;w++){let aa=l.get(8*r+w,8*q+v);p=Math.min(p,aa);t=Math.max(t,aa)}v=(p+t)/2;v=Math.min(255,1.11*v);24>=t-p&&(v=p/2,0<q&&0<r&&(t=(u.get(r,q-1)+2*u.get(r-1,q)+u.get(r-1,q-1))/4,p<t&&(v=t)));\nu.set(r,q,v)}h?(q=new Uint8ClampedArray(a.buffer,m,k),m+=k,q=new x(q,b)):q=x.createEmpty(b,c);r=null;f&&(h?(a=new Uint8ClampedArray(a.buffer,m,k),r=new x(a,b)):r=x.createEmpty(b,c));for(b=0;b<n;b++)for(a=0;a<g;a++){c=g-3;c=2>a?2:a>c?c:a;h=n-3;h=2>b?2:b>h?h:b;k=0;for(m=-2;2>=m;m++)for(p=-2;2>=p;p++)k+=u.get(c+m,h+p);c=k/25;for(h=0;8>h;h++)for(k=0;8>k;k++)m=8*a+h,p=8*b+k,t=l.get(m,p),q.set(m,p,t<=c),f&&r.set(m,p,!(t<=c))}f=f?{binarized:q,inverted:r}:{binarized:q};let {binarized:z,inverted:y}=f;(f=V(d?\ny:z))||"attemptBoth"!==e.inversionAttempts&&"invertFirst"!==e.inversionAttempts||(f=V(d?z:y));return f}X.default=X;let Y="dontInvert",Z={red:77,green:150,blue:29,useIntegerApproximation:!0};\nself.onmessage=a=>{let b=a.data.id,c=a.data.data;switch(a.data.type){case "decode":(a=X(c.data,c.width,c.height,{inversionAttempts:Y,greyScaleWeights:Z}))?self.postMessage({id:b,type:"qrResult",data:a.data,cornerPoints:[a.location.topLeftCorner,a.location.topRightCorner,a.location.bottomRightCorner,a.location.bottomLeftCorner]}):self.postMessage({id:b,type:"qrResult",data:null});break;case "grayscaleWeights":Z.red=c.red;Z.green=c.green;Z.blue=c.blue;Z.useIntegerApproximation=c.useIntegerApproximation;\nbreak;case "inversionMode":switch(c){case "original":Y="dontInvert";break;case "invert":Y="onlyInvert";break;case "both":Y="attemptBoth";break;default:throw Error("Invalid inversion mode");}break;case "close":self.close()}}\n']),{type:"application/javascript"}))},qrScannerWorker_min=Object.freeze({__proto__:null,createWorker:createWorker});return Vyu}));
//# sourceMappingURL=vyu_sdk.min.js.map
